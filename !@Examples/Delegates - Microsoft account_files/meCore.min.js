(function(n){function o(r){function tt(){var n=o.authenticatedState;w=n==u.SignedIn||n==u.SignedInIdp}function it(){var n;return n=o.enabled?w?"statussignedin":"statussignedout":"statusunavailable",t.getString(n)}function d(n){n.preventDefault(),n.stopPropagation(),o.enabled&&r.onSwitchUser&&r.onSwitchUser()}function g(i){i.preventDefault(),i.stopPropagation(),c.hide(),y.show(),p.text(t.getString(w?"statussigningout":"statusremoving")),o.onSignOutUser&&o.onSignOutUser(function(){n(l).trigger("remove")},function(){c.show(),y.hide(),p.text(t.getString(w?"statussignoutfailed":"statusremovingfailed"))})}function nt(n,t){t&&n&&n.which===13&&t(n)}var l=this,a=!1,v=!1,o=r,k="msame_ai"+e++,h=null,s=null,b=null,y=null,c=null,p=null,w=null;l.render=function(){var n=i.PictureLoaderCache.isCached(o.tileUrl)?o.tileUrl:"";return t.format(f,k,n,t.encodeHtml(o.displayName),t.encodeHtml(o.memberName),t.encodeHtml(it()),t.getString(o.authenticatedState==u.SignedInIdp?"signoutremovetip":"removetip",!0),o.removeImgUrl)},l.activate=function(){if(!a&&!v){a=!0,s=n("#"+k),c=n(".msame_Drop_AI_remove",s),y=n(".msame_Drop_AI_prog",s),b=n(".msame_Drop_AI_piccont img",s),p=n(".msame_Drop_AI_status",s),s.toggleClass("disabled",!o.enabled),s.toggleClass("switch",o.enabled),h=new i.PictureLoader(b,o.tileUrl,o.errorImgUrl),setTimeout(h.activate,0);s.on("click",d);s.on("keydown",function(n){nt(n,d)});c.on("click",g);c.on("keydown",function(n){nt(n,g)})}},l.deactivate=function(){a&&!v&&(a=!1,h&&h.deactivate(),c.off())},l.dispose=function(){v||(l.deactivate(),h&&h.dispose(),s.remove(),o=r=h=null,s=c=b=y=p=null,v=!0)},tt()}var r=window;r.MSA=r.MSA||{};var i=r.MSA.MeControl=r.MSA.MeControl||{},t=i.Strings,u=i.AuthState,f='<div id="{0}" class="msame_Drop_AI switch" tabIndex="0"><div class="msame_Drop_AI_pic"><div class="msame_Drop_AI_piccont"><div class="msame_Drop_AI_picframe"><img role="presentation" src="{1}"><\/div><\/div><\/div><div class="msame_Drop_AI_right"><div class="msame_TxtTrunc msame_Drop_AI_name">{2}<\/div><div class="msame_TxtTrunc msame_Drop_AI_email">{3}<\/div><div class="msame_TxtTrunc msame_Drop_AI_status">{4}<\/div><\/div><div class="msame_Drop_AI_remove" tabIndex="0"><img alt="{5}" src="{6}" /><\/div><div class="msame_Drop_AI_prog" style="display:none;"><\/div><\/div>',e=0;i.AccountItemControl=o})(window.MejQuery),function(n){function f(t,f){function v(){if(c)for(var n=0;n<c.length;n++)e.push(new i.AccountItemControl(f.getAccountItemData(c[n])))}function y(t){var i=e.indexOf(t);t.dispose(),e.splice(i,1),n(t).off("remove"),e.length===0&&n(o).trigger("empty")}var o=this,s=!1,h=!1,p=!1,a=t||{},c=a.userList,e=[],l=null;o.render=function(){for(var t="",n=0;n<e.length;n++)t+=e[n].render();return r.format(u,t)},o.activate=function(){if(!s&&!h){s=!0,l=n(".msame_Drop_AL");for(var t=0;t<e.length;t++){e[t].activate();n(e[t]).on("remove",function(n){return function(){y(n)}}(e[t]))}}},o.deactivate=function(){if(s&&!h){s=!1;for(var t=0;t<e.length;t++)e[t].deactivate(),n(e[t]).off("remove")}},o.dispose=function(){if(!h){o.deactivate();for(var n=0;n<e.length;n++)e[n].dispose();l.remove(),a=t=e=null,l=null,h=!0}},v()}var t=window;t.MSA=t.MSA||{};var i=t.MSA.MeControl=t.MSA.MeControl||{},r=i.Strings,u='<div class="msame_Drop_AL"><div class="msame_Drop_ALItems">{0}<\/div><\/div>';i.AccountsListControl=f}(window.MejQuery),function(n){function e(t){function a(n){n.preventDefault(),n.stopPropagation(),t.onClick&&t.onClick()}var i=this,o=!1,s=!1,c=t,l="msame_si"+f++,h=null,e=null;i.focus=function(){e&&e.focus()},i.render=function(){return r.format(u,l,r.encodeHtml(c.string))},i.activate=function(){if(!o&&!s){o=!0,h=n("#"+l),e=n("a",h);e.on("click",a)}},i.deactivate=function(){o&&!s&&(o=!1,e.off())},i.dispose=function(){s||(i.deactivate(),c=t=null,h=e=null,s=!0)}}var t=window;t.MSA=t.MSA||{};var i=t.MSA.MeControl=t.MSA.MeControl||{},r=i.Strings,u='<div id="{0}" class="msame_Drop_SI"><a href="#" class="msame_TxtTrunc">{1}<\/a><\/div>',f=0;i.SectionItemControl=e}(window.MejQuery),function(n){function e(r){var s=this,h=!1,c=!1,e=r,o=null,l=null,a=null;s.setUserPicture=function(n){o&&o.reset(n)},s.render=function(){var h=t.PictureLoaderCache.isCached(e.tileUrl)?e.tileUrl:"",n="",o,s;return r.idp!==t.IDP.MSA||e.nickName?n=i.format(u,i.encodeHtml(e.displayName),i.encodeHtml(e.orgName||e.nickName),"email"):(o=t.Loc.lf?e.lastName:e.firstName,s=t.Loc.lf?e.firstName:e.lastName,n=i.format(u,i.encodeHtml(o),i.encodeHtml(s),"name")),i.format(f,h,n,i.encodeHtml(e.memberName))},s.activate=function(){h||c||(h=!0,l=n(".msame_Drop_active"),a=n(".msame_Drop_active_piccont img",l),o=new t.PictureLoader(a,e.tileUrl,e.errorImgUrl),setTimeout(o.activate,0))},s.deactivate=function(){h&&!c&&(h=!1,o&&o.deactivate(),l=a=null)},s.dispose=function(){c||(s.deactivate(),o&&(o.dispose(),o=null),e=r=null,a=l=null,c=!0)}}var r=window;r.MSA=r.MSA||{};var t=r.MSA.MeControl=r.MSA.MeControl||{},i=t.Strings,o=t.Log,f='<div class="msame_Drop_active_pic"><div class="msame_Drop_active_piccont"><div class="msame_Drop_active_picframe"><img role="presentation" src="{0}"><\/div><\/div><\/div><div class="msame_Drop_active_right">{1}<div class="msame_TxtTrunc msame_Drop_active_email">{2}<\/div><\/div>',u='<div class="msame_TxtTrunc msame_Drop_active_name">{0}<\/div><div class="msame_TxtTrunc msame_Drop_active_{2}">{1}<\/div>';t.ActiveAccountControl=e}(window.MejQuery),function(n){function v(a,v){function gt(){if(bt){it=new t.ActiveAccountControl(a.activeAccountData()),w.push(it);var n=a.userStateModel().getIdpInfo().accountSettingsUrl;n&&(rt=new t.SectionItemControl({string:u.getString("viewaccount"),onClick:function(){f.logEvent("ViewAccount",{idp:a.userData().idp}),r.location.href=n}}),w.push(rt)),ut=new t.SectionItemControl({string:u.getString("signout"),onClick:a.signOut}),w.push(ut)}!a.isReady()||!a.userStateModel().canSignInOtherAccount()||a.options.events&&a.options.events.onSignIn||(ft=new t.SectionItemControl({string:u.getString("signinotheraccount"),onClick:a.signIn}),w.push(ft))}function yt(){nt&&!d&&y.toggleClass("msame_Mobile",ht)}function ni(n){y.toggleClass("msame_ClickStart",!n)}function pt(){if(et){for(var n=0;n<et.length;n++)et[n].dispose();et=null}}function ti(n){if(!d){var t=y.height();y.css({top:"-="+o,height:t/2,opacity:"0",display:""}),y.animate({top:"+="+o,height:t+"px"},{duration:l,easing:"easeOutQuintPartial",queue:!1,complete:function(){d||(y.css("height",""),n&&n())}}),y.animate({opacity:"1"},{duration:s,queue:!1,easing:"linear"})}}function ii(){if(!at&&(at=!0,!ot&&a.isReady()&&(ot=a.userStateModel()),ot)){var i=Date.now();ot.getUserState(function(r){var u,e;if(!d){if(r&&r.length>0){b=new t.AccountsListControl({userList:r},a);n(b).on("empty",ri);w.push(b),u=n(".msame_Drop_accts_list",y),u.html(b.render()),b.activate(),e=n(".msame_Drop_accts",y),e.show()}f.logEvent("AccountListReady",{duration:Date.now()-i,count:r&&r.length})}},function(){})}}function ri(){var t,i;b&&(t=n(".msame_Drop_accts",y),t.slideUp("fast"),b.dispose(),i=w.indexOf(b),w.splice(i,1),n(b).off("empty"),b=null)}function wt(n,t){try{for(var i=t;i&&i!==n&&i!==tt[0];)i=i.parentNode;return i===n}catch(r){return!1}}function st(n){d||!g||!k||n.type==="mousewheel"||n.target===k[0]||wt(k[0],n.target)||wt(y[0],n.target)||(n.preventDefault(),n.stopPropagation(),p.hide())}function ui(n){g&&n.which===27&&p.hide(!0)}var p=this,nt=!1,d=!1,g=!1,bt=a.hasActiveUser(),at=!1,ht=a.mobileState()===t.MobileState.Mobile,w=[],it=null,b=null,rt=null,ut=null,ft=null,et=null,ot=a.userStateModel(),kt,y=null,ct=null,lt=null,vt=null,k=v&&v.anchor,tt=n(document),dt=n(document.body);p.setMobileState=function(n){ht=n===t.MobileState.Mobile,yt()},p.setUserPicture=function(n){it&&it.setUserPicture(n)},p.updateExtensibleLinks=function(){var n,i,r;if(ct.hide(),lt.html(""),n=a.extensibleLinks(),n&&n.length>0)for(pt(),et=[],ct.show(),i=0;i<n.length;i++)r=new t.SectionItemControl(n[i]),lt.append(r.render()),r.activate(),et.push(r)},p.render=function(){return u.format(h,it?it.render():"",rt?rt.render():"",ft?ft.render():"",ut?ut.render():"")},p.activate=function(){var f,u;if(!nt&&!d){if(f=n("#meControlDropdown"),f.length>0){nt=!0,y=f,ct=n(".msame_Drop_links",y),lt=n(".msame_Drop_links_list",y),vt=n(".msame_Drop_topb",y),t.Browser.ie8&&y.addClass("msaie8");tt.on("click"+i,st);tt.on("mousedown"+i,st);tt.on("touchend"+i,st);tt.on("mousewheel"+i,st);tt.on("keyup"+i,ui);n(r).on("resize"+i,st);for(u=0;u<w.length;u++)w[u].activate();ii()}yt(),p.updateExtensibleLinks()}},p.deactivate=function(){if(nt&&!d){nt=!1,tt.off(i),n(r).off(i),b&&n(b).off("empty");for(var t=0;t<w.length;t++)w[t].deactivate()}},p.toggle=function(n){nt&&(ni(n),g?p.hide():p.show())},p.show=function(){if(nt&&!g){if(g=!0,f.logEvent("DropdownOpen"),k){var i=k.offset(),r=dt.offset();i.left-=r.left,i.top-=r.top,y.css({top:i.top+k.height()+"px",left:(t.Loc.rtl?i.left:i.left-y.width()+k.width())+"px"}),vt.css("width",y.width()-k.outerWidth()+c+"px")}ti(function(){var t=ht?(y[0].clientWidth-108).toString():"";n(".msame_Drop_AI_right",y).css("width",t),rt?rt.focus():ft?ft.focus():ut&&ut.focus()}),n(p).trigger(e,{visible:g})}},p.hide=function(t){nt&&g&&(g=!1,y.fadeOut(s,function(){t&&k&&k.focus(),n(p).trigger(e,{visible:g})}))},p.dispose=function(){if(!d){p.deactivate(),pt();for(var n=0;n<w.length;n++)w[n].dispose();y.remove(),a=kt=ot=w=null,y=k=tt=null,d=!0}},gt()}var r=window;r.MSA=r.MSA||{};var t=r.MSA.MeControl=r.MSA.MeControl||{},u=t.Strings,f=t.Log,e="visible",i=".msame",h='<div id="meControlDropdown" class="msame_Drop_root" style="display: none;"><div class="msame_Drop_topb"><\/div><div class="msame_Drop_content"><div class="msame_Drop_active">{0}<\/div><div class="msame_Drop_account">{1}<\/div><div class="msame_Drop_links" style="display: none;"><div class="msame_Drop_links_list"><\/div><\/div><div class="msame_Drop_signIn">{2}<\/div><div class="msame_Drop_signOut">{3}<\/div><div class="msame_Drop_accts" style="display: none;"><div class="msame_Drop_sep"><\/div><div class="msame_Drop_accts_list"><\/div><\/div><\/div><\/div>',c=2,o=60,l=833,s=100,a=.2;n.extend(n.easing,{easeOutQuintPartial:function(n){return n+=a*(1-n),Math.pow(n-1,5)+1}}),t.MeDropdownControl=v}(window.MejQuery),function(n){function u(){function l(t,i,r){var h,v;if(!e&&t){var y=Date.now(),l="mecontrol_iframe_index_"+s++,a=n('<iframe style="display:none"><\/iframe>').attr("id",l).attr("src",t);a.appendTo("body"),i&&(h=f.getDomainFromUrl(t),u[h]||(u[h]={}),v=setTimeout(function(){c(h,l)},o),u[h][l]={callback:i,iframe:a[0],start:y,timeoutId:v,timeoutCallback:r})}}function h(t){var i=t.originalEvent;i&&u[i.origin]&&n.each(u[i.origin],function(t,f){if(i.source==f.iframe.contentWindow){r.logQos("IFrameCtrl",!0,Date.now()-f.start,"",{src:f.iframe.src});var e=f.callback(i);e?(clearTimeout(f.timeoutId),n(f.iframe).remove(),delete u[i.origin][t]):(clearTimeout(f.timeoutId),f.timeoutId=setTimeout(function(){c(i.origin,t)},o))}})}function c(t,i){if(!e&&u&&u[t]){var r=u[t][i];r&&(r.timeoutCallback&&r.timeoutCallback(),n(r.iframe).remove(),delete u[t][i])}}var o=3e4,f=this,e=!0,s,u;f.init=function(){if(e){u={},s=0,e=!1;n(t).on("message",h)}},f.getDomainFromUrl=function(n){var t=document.createElement("a"),i;return t.href=n,i=t.protocol+"//"+t.hostname,t.port!==null&&t.port!==""&&t.port!=="443"&&t.port!=="80"&&t.port!=="0"&&(i+=":"+t.port),i},f.openIFrame=function(n,t,r,u){u&&(n=i.Util.appendQueryParams(n,u)),l(n,t,r)},f.dispose=function(){var r,i;if(!e){n(t).off("message",h);for(r in u)for(i in r)clearTimeout(i.timeoutId),n(i.iframe).remove();u=null,e=!0}},f.init();n(t).on("unload.msame",f.dispose)}var t=window,i=t.MSA.MeControl,r=i.Log;i.IFrameControl=new u}(window.MejQuery),function(n){function w(w,b,k){function pt(){if(nt.isIdpEnabled(t.AAD)){var n=g.aadInfo;n.meUrl||(n.meUrl=e.format(y,s,encodeURIComponent(n.appId),encodeURIComponent(n.siteUrl))),n.signInUrl||(n.signInUrl=e.format(p,s,encodeURIComponent(n.appId),encodeURIComponent(dt()),encodeURIComponent(n.siteUrl)))}}function at(){var r,n,i;if(tt&&it){for(r=[],n=0;n<tt.length;n++)i=!0,wt(it,tt[n])&&(i=!1,it.idp===t.AAD&&(it.sessionId=tt[n].sessionId)),tt[n].idp===t.ORG_ID&&(i=!1),i&&r.push(tt[n]);tt=r}}function wt(n,i){return!n||!i||n.idp!==i.idp?!1:n.idp===t.MSA?n.cid===i.cid:n.memberName&&i.memberName&&n.memberName.toLowerCase()===i.memberName.toLowerCase()}function ht(i){var e,s,u,r,o;return et&&(e=g.msaInfo.meTrustedOrigin&&i.origin===g.msaInfo.meTrustedOrigin,s=g.aadInfo.meTrustedOrigin&&i.origin===g.aadInfo.meTrustedOrigin,(e||s)&&typeof i.data=="string"&&(ut--,u={currentIdp:e?t.MSA:t.AAD,messagesMissing:ut},r=n.parseJSON(i.data),r&&r.userList&&r.userList.length>0?rt.push.apply(rt,r.userList):(o="InvalidIdpData",r&&r.error&&(u.IDPError=r.error,o="IDPError"),f.logQos("UserStatePartial",!1,Date.now()-st,o,u)),ut===0))?(rt&&rt.length>0?ft(!0):ft(!1,"NoIdpData",u),!0):!1}function ft(n,t,i){var r,u;for(tt=rt||[],at(),i=i||{},i.userCount=tt.length,f.logQos("UserState",n,Date.now()-st,t,i),r=0;r<ot.length;r++)u=ot[r],n?u.success(tt):u.failure&&u.failure();bt()}function ct(){et&&(ut-=1,ut===0&&(rt&&rt.length>0?ft(!0,"",{timeout:!0,messagesMissing:ut}):ft(!1,"Timeout")))}function bt(){ut=0,et=!1,st=0,rt=[],ot=[]}function kt(){var n=g.msaInfo;return nt.isIdpEnabled(t.MSA)&&n.signInUrl.indexOf("login.srf")>=0}function vt(){var n=g.msaInfo;return nt.isIdpEnabled(t.MSA)&&i.hasQueryParam(n.signOutUrl,"ru")&&i.hasQueryParam(n.signInUrl,"wreply")}function yt(){var n=g.aadInfo;return nt.isIdpEnabled(t.AAD)&&i.hasQueryParam(n.signInUrl,"client_id")&&i.hasQueryParam(n.signInUrl,"redirect_uri")}function dt(){return f.id}var nt=this,lt=!1,g=w,it=null,rt=[],tt=null,ot=[],ut=0,et=!1,st;nt.setActiveUser=function(n){it=n,at()},nt.currentState=function(){return tt||[]},nt.getUserState=function(n,i){if(tt){n(tt);return}if(ot.push({success:n,failure:i}),!et){if(tt=null,st=Date.now(),!o.postMessage){ft(!1,"PostMessageNotSupported");return}if(location.protocol!=="https:"){ft(!1,"HttpNotSupported");return}et=!0,ut=b?2:1;var u={uaid:f.id};g&&g.msaInfo&&g.aadInfo?nt.isIdpEnabled(t.MSA)?(g.msaInfo.meTrustedOrigin=r.getDomainFromUrl(g.msaInfo.meUrl),nt.isIdpEnabled(t.AAD)?(g.aadInfo.meTrustedOrigin=r.getDomainFromUrl(g.aadInfo.meUrl),r.openIFrame(g.msaInfo.meUrl,ht,ct,u),b&&(u.appId=g.aadInfo.appId,r.openIFrame(g.aadInfo.meUrl,ht,ct,u))):(k&&(u.idpflag=c),r.openIFrame(g.msaInfo.meUrl,ht,ct,u))):nt.isIdpEnabled(t.AAD)&&b&&(g.aadInfo.meTrustedOrigin=r.getDomainFromUrl(g.aadInfo.meUrl),k&&(u.idpflag=c),u.appId=g.aadInfo.appId,r.openIFrame(g.aadInfo.meUrl,ht,ct,u)):ft(!1,"InvalidRpData")}},nt.getIdpInfo=function(n){n=n||it&&it.idp;var i;switch(n){case t.MSA:i=g.msaInfo;break;case t.AAD:i=g.aadInfo;break;case t.MSA_FED:i=g.aadInfo}return i||{}},nt.isIdpEnabled=function(n){if(!n)return!1;var i=nt.getIdpInfo(n);return!!(i&&(i.meUrl||n==t.AAD&&i.appId))},nt.dispose=function(){lt||(lt=!0)},nt.getSignInUrl=function(n){var f=it&&it.authenticatedState==u.AuthState.SignedIn;n=n||f&&it.idp||g.preferredIdp||t.MSA;var e=n==t.AAD,o=n==t.MSA,r=e?g.aadInfo:g.msaInfo;return f?o&&vt()?i.setQueryParam(r.signOutUrl,"ru",encodeURIComponent(r.signInUrl)):e&&yt()?i.setQueryParam(r.signInUrl,"prompt","select_account"):r.signInUrl:r.signInUrl},nt.canSignInOtherAccount=function(){var n=it&&it.authenticatedState==u.AuthState.SignedIn;return!n||yt()||vt()},nt.getSignOutUrl=function(n){var r=n.idp===t.AAD||n.idp===t.MSA_FED,u=r?g.aadInfo:g.msaInfo;return i.appendContextParam(u.signOutUrl)},nt.signOutUser=function(i,u,h){var p,w,c,y;i.idp===t.AAD||i.idp===t.MSA_FED?(p=i,w=g.aadInfo,c=nt.isIdpEnabled(t.AAD)?e.format(v,s,encodeURIComponent(w.appId),encodeURIComponent(p.sessionId),encodeURIComponent(w.siteUrl)):e.format(a,l,encodeURIComponent(p.sessionId),encodeURIComponent(r.getDomainFromUrl(o.location.href))),y=Date.now(),r.openIFrame(c,function(t){var e=r.getDomainFromUrl(c),i;return t.origin!==e?!1:(i=n.parseJSON(t.data),i&&i.signoutStatus&&i.signoutStatus.toString()==="true"?(f.logQos("SignOutUser",!0,Date.now()-y),u()):(f.logQos("SignOutUser",!1,Date.now()-y,i.error||""),h()),!0)},function(){h(),f.logQos("SignOutUser",!1,Date.now()-y,"Timeout")})):i.idp===t.MSA&&nt.isIdpEnabled(t.MSA)?h&&h():h&&h()},nt.getSwitchToUrl=function(n){if(n.idp==t.MSA)return kt()?i.appendQueryParams(g.msaInfo.signInUrl,{username:n.memberName}):g.msaInfo.signInUrl;if(n.idp==t.AAD||n.idp==t.MSA_FED){var r=g.aadInfo.signInUrl;return i.hasQueryParam(r,h)&&(r=i.setQueryParam(r,h,"")),r=i.setQueryParam(r,"nonce",encodeURIComponent(f.id)),i.setQueryParam(r,"login_hint",encodeURIComponent(n.memberName))}return""},pt()}var o=window,u=o.MSA.MeControl,r=u.IFrameControl,f=u.Log,t=u.IDP,i=u.Util,e=u.Strings,h="prompt",c="proxy",s="https://login.microsoftonline.com",l="https://login.live.com",a="{0}/logout.srf?aadsession={1}&idpflag=proxy&ru={2}",v="{0}/uxlogout?appid={1}&sessionId={2}&wreply={3}&shouldForgetUser=true&isIframe=true&slice=TestSlice",y="{0}/savedusers?appid={1}&wreply={2}",p="{0}/common/oauth2/authorize?response_type=id_token&client_id={1}&scope=openid&nonce={2}&response_mode=form_post&redirect_uri={3}";u.UserStateModel=w}(window.MejQuery);window.MSA.MeControl.Loc={rtl:false,lf:false};window.MSA.MeControl.Strings.addStrings({
"editdone":"Done",
"statussigningout":"Signing out",
"viewaccount":"View account",
"signinotheraccount":"Sign in with another account",
"statusremoving":"Removing from list",
"statussignoutfailed":"Sign-out failed",
"removetip":"Remove from list",
"updatephoto":"Update your photo",
"statussignedin":"Signed in",
"signoutremovetip":"Sign out and remove from list",
"statusunavailable":"Not available",
"editlist":"Edit list",
"account":"Account",
"statusremovingfailed":"Removal failed",
"statussignedout":"Signed out"});window.MSA.MeControl.Loader.scriptLoaded('meCore');