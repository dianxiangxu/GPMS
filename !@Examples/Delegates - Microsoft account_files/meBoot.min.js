(function(n){function e(){function o(n,t,i){var u=i.s===t,r,f,e;return u||(t=t||0,r=n.charCodeAt(t),i.s=-1,r<55296||r>57343?i.c=r:r<=56319?(f=r,e=n.charCodeAt(t+1),i.c=(f-55296)*1024+(e-56320)+65536,i.s=t+1):(i.c=-1,u=!0)),!u}var t=this,e=!1,i={};t.addStrings=function(t){n.extend(i,t)},t.getString=function(n,r){var u=i[n]||t.format("ERROR: {0}",n);return r?t.encodeHtml(u):u},t.startsWith=function(n,t){return n.substr(0,t.length)===t},t.format=function(n){function f(n){var t=i[parseInt(n.replace(u,""))];return t==null&&(t=""),t}for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return n.replace(r,f)},t.dispose=function(){e||(i=null,e=!0)},t.encodeHtml=function(n){if(!n)return"";var t={c:0,s:-1};return n.replace(f,function(n,i,r){return o(r,i,t)?["&#",t.c,";"].join(""):""})}}var t=window,i=t.MSA.MeControl,r=/\{\d+\}/g,u=/[\{\}]/g,f=/[^\w .,-]/g;i.Strings=new e})(window.MejQuery),function(){var r=window,n=r.MSA.MeControl,t=n.Strings,u="uictx",f="me",i="([&?]{0}=)[^&]*";n.Util={appendQueryParams:function(n,t){var r,i;if(!n)return"";r=[];for(i in t)this.hasQueryParam(n,i,t[i])?n=this.setQueryParam(n,i,t[i]):r.push(i+"="+(t[i]?t[i]:""));return r.length===0?n:n+(n.indexOf("?")===-1?"?":"&")+r.join("&")},appendContextParam:function(n,t){return t=t||{},t[u]=f,this.appendQueryParams(n,t)},hasQueryParam:function(n,r){var u=t.format(i,r),f=new RegExp(u,"i");return f.test(n)},setQueryParam:function(n,r,u){var o=t.format(i,r),e=new RegExp(o,"i"),f;return e.test(n)?n.replace(e,"$1"+u):(f={},f[r]=u,this.appendQueryParams(n,f))},getCookie:function(n){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(n).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null}}}(),function(){function e(i,r,e){function a(){var n=i.prop("src")||r;return t[n]||(t[n]={succeeded:!1,instances:[]}),t[n]}function p(){var t=a(),i;if(!t.succeeded&&(t.succeeded=!0,t.instances.length>0))for(n.logQos("TileLoad",!1,Date.now()-c,"ImageRestored: "+r,{url:r}),i=0;i<t.instances.length;i++)t.instances[i].reset();n.logQos("TileLoad",!0,Date.now()-c)}function v(){var t,r,u,f,e,o;try{if(p(),u=0,r=i[0].naturalWidth,t=i[0].naturalHeight,f=i.css("width"),e=i.css("height"),r==1&&t==1||f=="1px"&&e=="1px"){y();return}if(o=Math.round,r&&t&&r!=t)if(r>t){var s=parseInt(e),h=parseInt(f),c=o(r*(s/t));u=-o((c-h)/2),i.css({width:"auto","max-width":"none","margin-left":u+"px"})}else i.css({height:"auto","max-height":"none"});i.css("visibility","")}catch(l){n.logEvent("TileLoadError",{message:l.message})}}function y(){var t,f,u;try{f=a(),f.instances.push(o),t=i.parent(),i.remove(),u=e,i.attr("src")!=u&&(n.logQos("TileLoad",!0,Date.now()-c,"ImageFailed: "+r,{url:r,clientError:!0}),setTimeout(function(){i&&i.attr("src",u).css("visibility","")},0))}catch(s){n.logEvent("TileLoadError",{message:s.message})}finally{null!=t&&t.append(i)}}var o=this,l=!1,s=!1,h=!1,c;o.activate=function(){if(i&&!l)if(l=!0,s=!0,c=Date.now(),i.prop("src")===r)v();else{i.on("load",v);i.on("error",y);r&&u.startsWith(r.toLowerCase(),f)?i.prop("src",r):i.prop("src",e)}},o.deactivate=function(){s&&!h&&(s=!1,i&&i.off())},o.reset=function(n){s&&!h&&(n&&(r=n),o.deactivate(),l=!1,o.activate())},o.dispose=function(){h||(o.deactivate(),i=null,h=!0)}}var r=window,i=r.MSA.MeControl,u=i.Strings,n=i.Log,t={},f="https://";i.PictureLoaderCache={isCached:function(n){return t[n]&&t[n].succeeded}},i.PictureLoader=e}(),function(){function u(n,t,r){var u=n.exec(i);return u&&u[1]===t&&u[2]===r}var n=window,t=n.MSA.MeControl,i=navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase(),r=/(msie) ([\w.]+)/;t.Browser={ie8:u(r,"msie","8.0")}}(),function(n){function p(p){function ot(){var u,i;g=!0,w.hasActiveUser()&&(g=!!(b.memberName&&b.idp),b.idp===t.MSA&&(u=b,g=!!(g&&u.cid),u.cid=g&&u.cid.toLowerCase()),w.isReady()&&k.setActiveUser(b)),b=n.extend({},v,b),g=!!(g&&d&&(d.msaInfo||d.aadInfo)),d=n.extend(!0,{},y,d),i=d.msaInfo.accountSettingsUrl,r.hasQueryParam(i,"ref")||(i=r.appendQueryParams(i,{ref:"MeControl"})),d.msaInfo.accountSettingsUrl=r.appendQueryParams(i,{lang:p.market}),rt=w.imageUrl("bluemanmxxl.png"),ft=w.imageUrl("Blue_round_AD.PNG"),ut=w.imageUrl("Gray_round_AD.PNG"),et=w.imageUrl("cross.png"),w.extensibleLinks(p.extensibleLinks),ht()}function ht(){if(g&&!w.hasActiveUser()&&d.msaInfo&&p.autoSignIn&&d.msaInfo.signInUrl&&p.autoSignInReturnUrl&&ct()){var t=n('<iframe class="msame_auto_frame">');t.attr("src",vt()),n(document.body).append(t)}}function ct(){return!!r.getCookie(o)}function lt(){var n=f.format("{0}=; path=/; expires=Fri, 31 Dec 9999 23:59:59 GMT",o);document.cookie=n}function at(){var n=f.format("{0}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",o);document.cookie=n}function vt(){var i=t.MSA,n=d.msaInfo.signInUrl,f=encodeURIComponent(p.autoSignInReturnUrl),u;return n=r.setQueryParam(n,h[i],f),u={},r.hasQueryParam(n,s[i])||(u[s[i]]="1"),r.appendContextParam(n,u)}p=p||{},p.events=p.events||{},p.mobileBreakpoints=p.mobileBreakpoints||{};var w=this,tt=!1,g=!0,b=p.userData,d=p.rpData,st=p.urlBase,it=null,rt,ut,ft,et,nt=i.MobileState.Auto,k=null;w.options=p||{},w.imageUrl=function(n){return f.format("{0}/MeControl/{1}/{2}",st,i.Version,n)},w.errorImgUrl=w.imageUrl("bluemanmxxl.png"),w.isValid=function(){return g},w.isReady=function(){return!!(g&&k)},w.mobileState=function(n){var t=i.MobileState,r;return(typeof n=="number"&&n>=t.Auto&&n<=t.Mobile&&(nt=n),nt!==t.Auto)?nt:(r=p.mobileBreakpoints,r.mobile&&r.mobile>=u.innerWidth)?t.Mobile:r.shortHeader&&r.shortHeader>=u.innerWidth?t.ShortHeader:t.Full},w.hasActiveUser=function(){return b&&b.authenticatedState==i.AuthState.SignedIn},w.setActiveUser=function(n){n&&(b=n,ot())},w.getProfilePictureUrl=function(n){var i,u,e;n=n||{},i="";switch(n.idp){case t.MSA:i=n.tileUrl,i||(i=f.format(a,n.cid,p.isINT?"-int":"",r.getCookie("upck")||"1"));break;case t.AAD:u=n,i=u.largeTileUrl||u.smallTileUrl||u.tileUrl||(n===b||w.isReady()&&k.isIdpEnabled(n.idp)?ft:ut);break;case t.MSA_FED:e=n,i=e.largeTileUrl||e.smallTileUrl||e.tileUrl||rt}return i},w.getDisplayName=function(n){n=n||{};var u=function(n,t){return f.format(i.Loc.lf?"{1} {0}":"{0} {1}",n,t)},r="";switch(n.idp){case t.MSA:r=u(n.firstName,n.lastName);break;case t.AAD:case t.MSA_FED:r=n.displayName||u(n.firstName,n.lastName)}return r.trim&&(r=r.trim()),r},w.headerData=function(){var u=b.nickName||(i.Loc.lf?b.lastName||b.firstName:b.firstName||b.lastName),n,r;switch(b.idp){case t.MSA:n=u;break;case t.AAD:case t.MSA_FED:n=b.displayName||u}return n=n||b.memberName,r=p.headerHeight,r=typeof r=="number"?Math.max(l,Math.min(c,r)):0,{displayName:n,displayNameMobile:w.getDisplayName(b),nickName:b.nickName,tileUrl:w.getProfilePictureUrl(b),memberName:b.memberName||"",authenticatedState:b.authenticatedState,errorImgUrl:w.errorImgUrl,chevronImgUrl:w.imageUrl("Chevronpng.png"),height:r,mobileState:w.mobileState(),chevHtml:p.custom&&p.custom.chevHtml}},w.activeAccountData=function(){return{idp:b.idp,firstName:b.firstName||"",lastName:b.lastName||"",nickName:b.nickName||"",displayName:w.getDisplayName(b),orgName:b.orgName||"",memberName:b.memberName||"",tileUrl:w.getProfilePictureUrl(b),errorImgUrl:w.errorImgUrl}},w.getAccountItemData=function(n){return{tileUrl:w.getProfilePictureUrl(n),displayName:w.getDisplayName(n),authenticatedState:n.authenticatedState,memberName:n.memberName,errorImgUrl:w.errorImgUrl,enabled:k&&k.isIdpEnabled(n.idp),onSwitchUser:function(){w.switchToUser(n)},onSignOutUser:function(t,i){w.signOutUser(n,t,i)},removeImgUrl:et}},w.userData=function(){return b},w.rpData=function(){return d},w.userStateModel=function(n){return!k&&n&&(k=n,w.hasActiveUser()&&k.setActiveUser(b),k.getUserState(function(){})),k},w.extensibleLinks=function(n){var i,t;if(n){for(i=n instanceof Array,t=0;i&&t<n.length;t++)n[t].string&&n[t].onClick&&n[t].onClick instanceof Function||(i=!1);i&&(it=n),e.logQos("SetExtensibleLinks",i,0)}return it},w.dispose=function(){tt||(k&&k.dispose(),d=b=k=null,tt=!0)},w.signOut=function(){e.logEvent("SignOutAll",{userCount:k.currentState().length,currentUser:w.hasActiveUser()?b.idp:"none"}),d.msaInfo&&p.autoSignIn&&lt(),p.events.onBeforeSignOut&&p.events.onBeforeSignOut(b),u.location.href=k.getSignOutUrl(b)},w.signIn=function(){e.logEvent("SignIn",{userCount:k.currentState().length}),p.events.onSignIn?p.events.onSignIn():(d.msaInfo&&p.autoSignIn&&at(),u.location.href=r.appendContextParam(k.getSignInUrl()))},w.switchToUser=function(n){e.logEvent("SwitchUser",{userCount:k.currentState().length,idp:n&&n.idp,currentUser:w.hasActiveUser()?b.idp:"none"}),u.location.href=k.getSwitchToUrl(n)},w.signOutUser=function(n,t,i){e.logEvent("RemoveUser",{userCount:k.currentState().length,idp:n&&n.idp,currentUser:w.hasActiveUser()?b.idp:"none"}),k.signOutUser(n,t,i)},ot()}var u=window,i=u.MSA.MeControl,f=i.Strings,e=i.Log,r=i.Util,t=i.IDP,c,l;i.MobileState={Auto:-1,Full:0,ShortHeader:1,Mobile:2};var o="msame_asi",a="https://cid-{0}.users.storage.live{1}.com/users/0x{0}/myprofile/expressionprofile/profilephoto:Win8Static,UserTileMedium,UserTileStatic/MeControlXXLUserTile?ck={2}&ex=24",v={firstName:"",lastName:"",displayName:"",smallTileUrl:"",authenticatedState:""},y={msaInfo:{signInUrl:"",signOutUrl:"",accountSettingsUrl:"https://account.microsoft.com",switchUrl:"",meUrl:""},preferredIdp:t.MSA},h={},s={};h[t.MSA]="wreply",s[t.MSA]="checkda",c=100,l=44,i.MeControlModel=p}(window.MejQuery),function(n){function h(r){function it(){var u,f,r;y&&!v&&(u=c.mobileState===t.MobileState.Mobile,f=c.mobileState===t.MobileState.ShortHeader,h.toggleClass("msame_Mobile",u),h.toggleClass("msame_Short",f),h.toggleClass("msame_3row",!!c.nickName),rt(h),c.authenticatedState==t.AuthState.SignedIn&&(r=n(".msame_Header_name",h),r.show(),f?r.hide():u?(r.remove(),r.html(i.format(o,i.encodeHtml(c.displayNameMobile),c.nickName?i.encodeHtml(c.nickName):"",i.encodeHtml(c.memberName))),r.insertAfter(p),ot()):(r.remove(),r.text(c.displayName),r.insertBefore(p))),d())}function ot(){g||(c.chevHtml?w.append(c.chevHtml):w.append(i.format('<img src="{0}">',c.chevronImgUrl)),g=!0)}function rt(i){var e=c.mobileState===t.MobileState.Mobile,f="",u="";!e&&r.height>0&&(f=r.height-28+"px",u=r.height),n(".msame_Header_picframe, .msame_Header_picframe img",i).css({height:f,width:f}),n(".msame_Header_name",i).css("line-height",u?u+"px":""),i.css("height",u)}function d(){if(!v&&!h.is(":visible")){b||(b=!0,setTimeout(function(){b=!1,d()},500));return}var n;c.mobileState===t.MobileState.Mobile&&(n=h.outerWidth()-p.outerWidth()-w.outerWidth()-5),tt.css("max-width",n||"")}function ut(){h.css("outline-style","none")}function ft(t,i){t.preventDefault(),t.stopPropagation(),n(a).trigger("click",{isKeyboard:i})}function st(n){n&&(n.which===32||n.which===13)&&ft(n,!0)}function ht(){h.css("outline-style","")}var a=this,y=!1,v=!1,c=r,b=!1,g=!1,nt=c.authenticatedState==t.AuthState.SignedIn,l=null,h=null,p=null,tt=null,w=null,et=null,k=null;a.elements=function(){return{anchor:h}},a.setMobileState=function(n){c.mobileState!==n&&(c.mobileState=n,it())},a.setUserPicture=function(n){l&&l.reset(n)},a.render=function(){var o="",h=i.getString("signin"),l,u,f;return nt&&(l=t.PictureLoaderCache.isCached(c.tileUrl)?c.tileUrl:"",o=i.format(s,l),h=c.displayName),u=i.format(e,i.encodeHtml(h),o),r.height>0?(f=n("<div>").append(u),rt(n(".msame_Header",f)),f.html()):u},a.activate=function(){if(!y&&!v){y=!0,h=n(".msame_Header"),p=n(".msame_Header_pic",h),tt=n(".msame_Header_name",h),w=n(".msame_Header_chev",h),k=n(".msame_Header_pic img",h),et=n(".msame_Header_piccont",h);h.on("click",ft);h.on("keydown",st);h.on("blur",ht);h.on("mousedown",ut);h.on("touchstart",ut);h.toggleClass("msame_unauth",!nt);u.on("resize"+f,d);t.Browser.ie8&&h.addClass("msaie8"),l||(l=new t.PictureLoader(k,c.tileUrl,c.errorImgUrl)),c.mobileState!==t.MobileState.Full&&it(),setTimeout(l.activate,0)}},a.deactivate=function(){y&&!v&&(y=!1,u.off("resize"+f),h.off(),l&&l.deactivate())},a.dispose=function(){v||(a.deactivate(),l&&(l.dispose(),l=null),h.remove(),c=r=null,k=h=null,v=!0)}}var r=window,u=n(r);r.MSA=r.MSA||{};var t=r.MSA.MeControl=r.MSA.MeControl||{},i=t.Strings,e='<div class="msame_Header" tabIndex="0"><div class="msame_Header_name msame_TxtTrunc">{0}<\/div>{1}<div class="msame_Header_chev"><\/div><\/div>',o='<div class="msame_TxtTrunc msame_Header_fullName">{0}<\/div><div class="msame_TxtTrunc msame_Header_nickName">{1}<\/div><div class="msame_TxtTrunc msame_Header_email">{2}<\/div>',s='<div class="msame_Header_pic"><div class="msame_Header_piccont"><div class="msame_Header_picframe"><img role="presentation" src="{0}"><\/div><\/div><\/div>',f=".msameheader";t.MeHeaderControl=h}(window.MejQuery),function(n){function f(f){function rt(){if(s=new t.MeControlModel(p),y=s.mobileState(),!s.isValid()){i.logQos("modelValidate",!1,0,"MissingData");return}u.on("resize",it);setTimeout(function(){t.API.setController(l),i.logEvent("$MeControlReady",{duration:Date.now()-v.startTime})},0),g(),tt()}function k(){c&&(n(c).off(),c.dispose()),c=null}function d(){h&&(n(h).off(),h.dispose()),h=null}function g(){if(!c){c=new t.MeHeaderControl(s.headerData()),b.html(c.render()),c.activate();n(c).on("click",ut);i.logEvent("HeaderReady",{duration:Date.now()-v.startTime})}}function nt(){if(!t.MeDropdownControl){l.dispose(),v.showHeaderNoJs();return}if(!a&&!h&&c){t.IFrameControl.init(),s.userStateModel(new t.UserStateModel(s.rpData(),t.Config.aad,t.Config.pxy,p.isINT)),h=new t.MeDropdownControl(s,c.elements()),n("body").append(h.render()),h.activate();n(h).on("visible",ft);i.logEvent("DropdownReady",{duration:Date.now()-v.startTime})}}function tt(){var i=v.getJsUrl("meCore");if(t.MeDropdownControl)nt();else{if(w)return;w=!0,n(r.document).ready(function(){v.loadScript(i,"meCore",function(){w=!1,nt()},function(){})})}}function ut(n,t){if(!s.hasActiveUser()&&s.isReady()&&s.userStateModel().currentState().length===0){s.signIn();return}h&&h.toggle(t&&t.isKeyboard)}function ft(n,t){b.toggleClass("msame_open",t||t.visible)}function it(){if(!a){var n=s.mobileState();y!==n&&(y=n,c&&c.setMobileState(y),h&&h.setMobileState(y))}}var l=this,a=!1,v=t.Loader,y,p=f||v.getOptions(),s=null,c=null,h=null,w=!1,b=n("#"+p.containerId);l.setActiveUser=function(n){if(!a&&s){if(s.setActiveUser(n),!s.isValid()){i.logQos("SetActiveUser",!1,0,"MissingData");return}i.logQos("SetActiveUser",!0,0),k(),d(),g(),tt()}},l.setExtensibleLinks=function(n){!a&&s&&(s.extensibleLinks(n),h&&h.updateExtensibleLinks())},l.refreshUserPicture=function(){if(!a&&s){var n=s.getProfilePictureUrl(s.userData());l.setUserPicture(n)}},l.setUserPicture=function(n){!a&&n&&(c&&c.setUserPicture(n),h&&h.setUserPicture(n))},l.setMobileState=function(n){!a&&s&&(s.mobileState(n),it())},l.reinit=function(n){l.dispose(),o(n,p)},l.dispose=function(){a||(k(),d(),s&&s.dispose(),s=null,t.IFrameControl&&t.IFrameControl.dispose(),u.off(e),r.MSA.$MeControl=null,a=!0)},setTimeout(rt,0);u.on("unload"+e,l.dispose)}function o(u,e){t.Loader.startTime=Date.now(),u.events&&u.events.onEventLog&&i.setLogEvent(u.events.onEventLog),u.urlBase=e.urlBase,u=n.extend({},e,u),r.MSA.$MeControl=new f(u)}var r=window,u=n(r),t=r.MSA.MeControl,i=t.Log,e=".msame";t.MeController=f,r.MSA.$MeControl=new f}(window.MejQuery);window.MSA.MeControl.Loc={rtl:false,lf:false};window.MSA.MeControl.Strings.addStrings({
"signin":"Sign in",
"signout":"Sign out"});window.MSA.MeControl.Loader.scriptLoaded('meBoot');