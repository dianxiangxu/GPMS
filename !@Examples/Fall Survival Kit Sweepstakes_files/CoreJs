function dropdownFormatting(n){var t=n.element,i=$(t).data("imagesrc"),r=$(t).data("displayimage");return i&&r===!0?"<img src='"+i+"' alt='' />"+n.text:n.text}function Autofill(){return{require:"ngModel",link:function(n,t,i,r){n.$on("autofill:update",function(){r.$setViewValue(t.val())})}}}function BagQtyValidDirective(){return{require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){return/^[0-9]\d{0,1}$/.test(n)?(r.$setValidity("avonQtyValid",!0),n):(r.$setValidity("avonQtyValid",!1),undefined)})}}}function BagQtyChangeDirective(){return{restrict:"A",require:"ngModel",link:function($scope,n,t,i){n.bind("keyup input",function(){i.$modelValue!=null&&onBagChangeQtyThrottled($scope,n,t,i)})}}}function CaretFix(){return{restrict:"AC",link:function(n,t){var i=$(t);i.on("focus",function(){setTimeout(function(){var n=i[0],t;typeof n.selectionStart=="number"?n.selectionStart=n.selectionEnd=n.value.length:typeof n.createTextRange!="undefined"&&(n.focus(),t=n.createTextRange(),t.collapse(!1),t.select())},100)})}}}function CompileDirective(n){return function(t,i,r){t.$watch(function(n){return n.$eval(r.compile)},function(r){r&&(i.html(r),n(i.contents())(t))})}}function ConfirmFieldDirective(){return{restrict:"A",require:"ngModel",link:function($scope,n,t,i){$scope.$watch(t.ngModel,function(){var n=$scope.$eval(t.confirmField),r=$scope[n.form],u=r[n.matchWith].$viewValue,f=r[t.name].$viewValue;u!==f?i.$setValidity("fieldMatch",!1):i.$setValidity("fieldMatch",!0)})}}}function ExpandableDirective(){return{restrict:"A",link:function(n,t){var i=$(t);i.addClass("Expandable");i.on("click",function(n){var t=$(n.target);t.parents(".ExpandableContent").closest(".Expandable")[0]!=i[0]&&i.toggleClass("Expanded")});i.on("click",".ExpandableClose",function(){i.removeClass("Expanded")})}}}function FallbackSrcDirective(n){return{restrict:"A",link:function(t,i,r){i.on("load",function(){var r=i.attr("src"),t=new Image,u;if(t.src=r,t.width*t.height==1){i.trigger("error");return}u={element:i,src:r};n.$broadcast("FallbackSrc.ImageFound",u)});i.on("error",function(){var u,t;if(!n.IsPhantom&&(u=new Image,u.src=i.attr("src"),!(u.width*u.height>1))){t=angular.element(this);try{r.fallbackSrc.length>0?t.attr("src",r.fallbackSrc):(t.css("display","none"),t.attr("data-removed","1"),n.$broadcast("FallbackSrc.NoImageFound",t))}catch(f){t.css("display","none");t.attr("data-removed","1");n.$broadcast("FallbackSrc.NoImageFound",t)}finally{t.off("error")}}})}}}function input(){return{require:"?ngModel",priority:1,restrict:"E",link:function(n,t,i,r){if(r&&i.type==="email"){r.$parsers.pop();var u=function(n){var i=r.$name,t=!n||/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(n);return r.$setValidity("email",t),n};r.$parsers.push(u)}}}}function linenumberField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.linenumberField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var i=n.charCode||n.keyCode||0,r=!0,f=$(this),u;switch(i){case 8:case 9:case 13:case 46:case 37:case 39:r=!0;break;default:n.shiftKey===!0&&(r=!1);r&&(u=f.data("maxlength")||t.attr("maxlength"),$.isNumeric(u)&&u>0&&f.val().length>=u&&(r=!1));r&&(r=i>=48&&i<=57||i>=96&&i<=105||i===173||i===45||i===189||i===109);n.ctrlKey===!0&&(r=!0)}return r?!0:(n.preventDefault(),!1)})}}}function modal(n,t,i){return{restrict:"EAC",compile:function(){var n=function(n,t){var i=t.wrap('<div class="ModalContainer"><\/div>')},r=function(n,r){var u=$(r),f=u.closest(".ModalContainer"),h=$("#ModalBackground"),s=!0,e=!1;u.on("modal",function(r,h){if(!f.hasClass("Shown")){var l=u.attr("modal"),c;c=l?n.$eval(l):{};h&&h.UrlToLoad&&(c.UrlToLoad=h.UrlToLoad);h&&h.Model&&(AVON.TempModalModel=h.Model);h&&h.UseIFrame&&(c.UseIFrame=h.UseIFrame,c.IFrameWidth=h.IFrameWidth,c.IFrameHeight=h.IFrameHeight);c.KeepLoaded!==undefined&&(e=c.KeepLoaded);c.AllowExit!==undefined&&(s=c.AllowExit);h&&(s=h.AllowExit,e=h.KeepLoaded);c&&c.UrlToLoad&&!u.data("isLoaded")?c.UseIFrame?(u.data("isLoaded",!1),$('<iframe id="ModalIFrameContainer" src="'+c.UrlToLoad+'" style="width: '+c.IFrameWidth+"; height: "+c.IFrameHeight+';" width="'+c.IFrameWidth+'" height="'+c.IFrameHeight+'"  allowfullscreen />').appendTo(u),u.trigger("loaded")):(e&&u.data("isLoaded",!0),c.UrlToLoad?u.load(c.UrlToLoad,null,function(){t(u.contents())(n);u.trigger("loaded")}):u.trigger("loaded")):u.trigger("loaded");$(window).resize(function(){_.delay(function(){o()},50)});i.$broadcast("ModalShown")}});u.on("loaded",function(){n.HideLoading();l();c();f.addClass("Shown");$("body").addClass("ModalVisible");_.defer(function(){o()});_.delay(function(){o()},100);f.waitForImages(function(){o()})});u.on("close",function(n,t){f.hasClass("Shown")&&(e||t||f.children().html(""),f.removeClass("Shown"),$("body").removeClass("ModalVisible"),u.data("isLoaded",!1),i.$broadcast("ModalClosed"),i.$broadcast("Do.ResetPageIdleTime"))});h.on("click",function(n){u.parent().hasClass("Shown")&&($("#ModalIFrameContainer").remove(),u.trigger("close"),n.stopPropagation())});var c=function(){var n=$(".Close",u);n&&n.click(function(n){u.parent().hasClass("Shown")&&($("#ModalIFrameContainer").remove(),$("#select2-drop-mask").click(),u.trigger("close"),n.stopPropagation())})},l=function(){r.hasClass("Close")||(s?(f.find(".ModalCloseIcon").length==0&&f.children().prepend('<div class="ModalCloseIcon Close"><\/div>'),f.find(".Close").show(),c()):(f.find(".Close").hide(),h.off("click")))},o=function(){var s=$(document).height(),r=$(window).height(),u=f.height(),t=f.width(),i=$(window).scrollTop(),e=i,o=s-u,n;f.css("margin-left","-"+t+"px");t=f.width();n=i+r*.1;u>r&&(n=i+5);n<e?n=e:n>o&&(n=o);f.css("top",n+"px");f.css("margin-left","-"+t/2+"px")}};return{pre:n,post:r}}}}function numericField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.numericField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var r=n.charCode||n.keyCode||0,i=!0,f=$(this),u,e;switch(r){case 8:case 9:case 13:case 46:case 37:case 39:i=!0;break;default:n.shiftKey===!0&&(i=!1);i&&(u=f.data("maxlength")||t.attr("maxlength"),e=f.val().length-(t.get()[0].selectionEnd-t.get()[0].selectionStart),$.isNumeric(u)&&u>0&&e>=u&&(i=!1));i&&(i=r>=48&&r<=57||r>=96&&r<=105);n.ctrlKey===!0&&(i=!0);n.metaKey===!0&&(i=!0)}return i?!0:(n.preventDefault(),!1)})}}}function phonenumberField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.phonenumberField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var i=n.keyCode||n.which||0,r=!0,f=$(this),u;switch(i){case 8:case 9:case 13:case 46:case 37:case 39:r=!0;break;default:n.shiftKey===!0&&(r=!1);r&&(u=f.data("maxlength")||t.attr("maxlength"),$.isNumeric(u)&&u>0&&f.val().length>=u&&(r=!1));r=r&&f.val().length>0?i>=48&&i<=57||i>=96&&i<=105||n.which==40||n.which==41||i===173||i===45||i===189||i===109:i>=48&&i<=57||i>=96&&i<=105||n.which==40||n.which==41;n.ctrlKey===!0&&(r=!0)}return r?!0:(n.preventDefault(),!1)})}}}function SecondaryImageDirective(n){return{restrict:"A",link:function(t,i){i[0].onload=function(){var t=i.attr("src"),f=t.lastIndexOf("_"),e=t.lastIndexOf("."),r={element:i,src:t},o=t.substring(f+1,e),u=parseInt(o);isNaN(u)?n.$broadcast("SecondaryImage.ImageFound",r,0):n.$broadcast("SecondaryImage.ImageFound",r,u)};i.on("error",function(){var r=new Image,u;if(r.src=i.attr("src"),!(r.width*r.height>1)){u=angular.element(this);try{var t=r.src,e=t.lastIndexOf("_"),o=t.lastIndexOf("."),f=t.substring(e+1,o);parseInt(f)<10?(t=t.substring(0,e+1)+(parseInt(f)+1)+t.substring(o),u.attr("src",t)):parseInt(f)>=10&&n.$broadcast("SecondaryImage.NoImageFound",u)}catch(s){n.$broadcast("SecondaryImage.NoImageFound",u)}}})}}}function SelectRegularExpressionValidator(){return{restrict:"A",require:"ngModel",link:function($scope,n,t,i){$scope.$watch(t.ngModel,function(n){var r=$scope.$eval(t.ngPattern),u=new RegExp(r);u.test(n)?i.$setValidity("invalidValue",!0):i.$setValidity("invalidValue",!1)})}}}function SingleExpandableDirective(){return{restrict:"A",link:function(n,t){var i=$(t);i.addClass("SingleExpandable");$(document).on("click",function(){$(".SingleExpandable.Expanded").removeClass("Expanded")});i.on("click",function(n){n.stopPropagation();var t=$(n.target);t.hasClass("ExpandableClose")?i.removeClass("Expanded"):(t[0]==i[0]||t.parents(".SingleExpandable")[0]!=i[0])&&($(".SingleExpandable.Expanded").removeClass("Expanded"),i.toggleClass("Expanded"))})}}}function textareaMaxlength(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){function f(n){var i=$(t).parent().find(".CharsRemaining");i.length&&i.html((u-n).toString())}function e(n){if(n.length>u){var t=n.substring(0,u);r.$setViewValue(t);r.$render();n=t}return f(n.length),n}var u=Number(i.textareaMaxlength);$(t).attr("maxlength",u);_.defer(function(){f($(t).val().length)});r.$parsers.push(e)}}}function TinifyUrlDirective(){return{restrict:"A",link:function($scope,$element){$.get("https://api-ssl.bitly.com/v3/shorten?access_token=e6ff4db382335b2adf8d7806280b86e240101c26&longUrl="+encodeURI($element.attr("href")),function(n){$element.attr("href",n.data.url)}).fail(function(){})}}}function TinifyShareUrlDirective(){return{restrict:"A",link:function($scope,$element,n){$.get("https://api-ssl.bitly.com/v3/shorten?access_token=e6ff4db382335b2adf8d7806280b86e240101c26&longUrl="+n.tinifyShareUrl,function(t){$element.attr("href",$element.attr("href").replace(n.tinifyShareUrl,encodeURI(t.data.url)))}).fail(function(){})}}}function trackMenuClick(n){return{restrict:"EAC",link:function(t,i,r){i.on("click",function(t){var f=r.trackmenuClick,u={Value:f,Element:i[0],Type:TrackingEventType.MenuClick};if($("#moveFromVmoDiv").length>0){t.preventDefault();n.$broadcast("LeavingVmo",u);return}n.$broadcast("TrackClick",u)})}}}function ViewmoreDirective(){return{restrict:"E",link:function(n,t,i){var r=$(t),o=i.moretext||"More�",e=i.href,u=i.applyclass,f;u=u?" "+u:"";f=function(){var n=r.find(".ViewMoreContainer").height(),t=r.find(".ViewMoreContent").height();n>=t?r.addClass("FullyVisible"):r.removeClass("FullyVisible")};n.$watch(function(){r.hasClass("Expanded")||f()});r.addClass("ViewMore");r.wrapInner("<div class='ViewMoreContent'><\/div>");r.wrapInner("<div class='ViewMoreContainer"+u+"'><\/div>");r.append("<a class='ViewMoreButton'>"+o+"<\/a>");r.find(".ViewMoreButton").click(function(){e?n.RedirectToUrl(e,!0):(r.removeClass("FullyVisible"),r.addClass("Expanded"))});f()}}}function validateAddress(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^[\\0-9A-Za-zñÑáÁéÉíÍóÓúÚüÜ\\/\\.\\'\\,\\#\\ \\s\\-]+$/.test(n);return r.$setValidity("validateAddress",t),n})}}}function validateCity(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^[A-Za-zñÑáÁéÉíÍóÓúÚüÜ\.\-\ ]+$/.test(n);return r.$setValidity("validateCity",t),n})}}}function validateMustqqualto(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(t){var u=i.validateMustequalto,f=_.find(n,function(n){return n&&n[u]}),e=f[u].$viewValue,o=!t||t===e;return r.$setValidity("mustequalto",o),t})}}}function validateName(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^(-)?[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\\s\\ \\.]+(-)?[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\\s\\ \\.]*(-)?$/.test(n);return r.$setValidity("validateName",t),n})}}}function validatePhone(){return{restrict:"A",require:"ngModel",scope:{field:"@validatePhone",maxlength:"@maxlength"},link:function(n,t,i,r){r.$parsers.unshift(function(t){var f=r.$name,i,u;return i=!1,n.maxlength||(n.maxlength=3),u=new RegExp("^[0-9]{"+n.maxlength+"}$"),i=!t||u.test(t),r.$setValidity("format",i),t&&n.field==="Area"&&parseInt(t.substr(0,1))<2&&r.$setValidity("format",!1),t})}}}function validateRegex(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var f=r.$name,t=new RegExp(i.validateRegex),u=!n||t.test(n);return r.$setValidity("regex",u),n})}}}function validateZipcode(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^\d{5}|\d{9}$/.test(n);return r.$setValidity("validateZipcode",t),n})}}}function validateZipCodeRecognized(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.zipCodesValidated=[];var u=function(n){n=n.toString();var t=!0;return"Z"+n in r.zipCodesValidated?t=r.zipCodesValidated["Z"+n]:($.ajax({async:!1,cache:!0,type:"GET",url:"/api/validation/isrecognizedzipcode/"+n,dataType:"json",success:function(n){n.valid||(t=!1)},error:function(){return!0}}),r.zipCodesValidated["Z"+n]=t,t)};r.$parsers.unshift(function(n){var t=r.$name;return!n||n.length<5?(r.$setValidity("validateZipcodeRecognized",!0),n):(u(n)?r.$setValidity("validateZipcodeRecognized",!0):r.$setValidity("validateZipcodeRecognized",!1),n)})}}}function validateZipcodeRequired(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){var u=function(n){var u=r.$name,i=$(t).closest("form");i.hasClass("ZipCodeRequired")?n?r.$setValidity("zipcoderequired",!0):r.$setValidity("zipcoderequired",!1):r.$setValidity("zipcoderequired",!0)};r.$parsers.unshift(function(n){return u(n),n});r.$formatters.unshift(function(n){return u(n),n})}}}var AjaxError,BrandType,CanBuy,CreditCardDisplayMode,CreditCardType,DeliveryType,EmailSubscriptionSource,FindARepSearchType,ImageType,InterestType,Month,OrderStatus,OrderType,PaymentType,ShippingOptionCode,PromoConditionalRuleReason,TabToggleMode,VariantType,RestrictedAutoRepType,fbParsed,myErrIsThis,ApplyCouponType,BagServiceModule,SessionServiceModule,CdnServiceModule,UrlServiceModule,BaseAngularController,BaseAnimations,AddressModule,AllCategoryModule,EnglishMessages,SpanishMessages,ModalServiceModule,ResetPasswordModel,LoginServiceModule,SubscribeServiceModule,AvonModule,ContactModule,ProductServiceModule,CarouselModule,ProductModule,MiniSiteModule,NotifyMeModule,PageTimeoutWarningModule,ProductListServiceModule,ProductListControlModule,SimpleProductListModule,SubscribeModule,AccordionModule,HtmlEllipsisModule,AutoFocusModule,AvonFormModule,onBagChangeQtyThrottled,clearServerValidationModule,ImageAspectModule,StackGridModule,TooltipModule,ChangeRepServiceModule,ConfirmationServiceModule,ContactServiceModule,CustomerServiceModule,LpmContextMenuServiceModule,NavigationModule,NotifyMeSerivceModule,RegistrationServiceModule,StringExtensions,ArrayExtensions,Geocode,__extends,BreadcrumbsModule,ChangePasswordModule,ChangeRepModule,ContentModule,FooterModule,ForgotPasswordModule,GenericTabModule,GlossaryModule,LayoutLeftNavigationModule,LayoutTopNavigationModule,LayoutTopUtilityModule,LoginModule,LooksWeLoveModule,LpmContextMenuModule,PageNavigatorModule,ProductCarouselModule,ProductDetailModule,RegistrationModule,SearchModule,TipsModule;(function(n){n[n.None=0]="None";n[n.ValidationErrors=1]="ValidationErrors";n[n.Exception=500]="Exception";n[n.InvalidParameter=3]="InvalidParameter"})(AjaxError||(AjaxError={})),function(n){n[n.None=0]="None";n[n.Facet=1]="Facet";n[n.Minor=2]="Minor";n[n.Major=3]="Major";n[n.Mega=4]="Mega"}(BrandType||(BrandType={})),function(n){n[n.Unknown=999]="Unknown";n[n.NotForIndividualSale=0]="NotForIndividualSale";n[n.Available=1]="Available";n[n.NoLongerAvailable=2]="NoLongerAvailable";n[n.AvailableSoon=3]="AvailableSoon";n[n.ConditionalProduct=5]="ConditionalProduct";n[n.AutoReplenishmentOnly=7]="AutoReplenishmentOnly";n[n.NotAvailableOnTheOnlineStore=9]="NotAvailableOnTheOnlineStore"}(CanBuy||(CanBuy={})),function(n){n[n.Standard=0]="Standard";n[n.StoredCreditCardSelection=1]="StoredCreditCardSelection";n[n.StoredCreditCardAdd=2]="StoredCreditCardAdd";n[n.StoredCreditCardEdit=3]="StoredCreditCardEdit"}(CreditCardDisplayMode||(CreditCardDisplayMode={})),function(n){n[n.Unknown=0]="Unknown";n[n.Visa=1]="Visa";n[n.MasterCard=2]="MasterCard";n[n.Discover=3]="Discover";n[n.Amex=4]="Amex"}(CreditCardType||(CreditCardType={})),function(n){n[n.None=0]="None";n[n.RepOrDirect=1]="RepOrDirect";n[n.RepOnly=2]="RepOnly";n[n.DirectOnly=3]="DirectOnly"}(DeliveryType||(DeliveryType={})),function(n){n[n.None=-1]="None";n[n.RegistrationViaCheckout=0]="RegistrationViaCheckout";n[n.PaymentPageModal=1]="PaymentPageModal";n[n.AttachRep=2]="AttachRep";n[n.EmailSignUp=4]="EmailSignUp";n[n.Registration=6]="Registration";n[n.MyPreferencesPage=7]="MyPreferencesPage";n[n.ForcedAttachmentConfirmation=9]="ForcedAttachmentConfirmation";n[n.RegistrationViaSweepstakes=12]="RegistrationViaSweepstakes";n[n.RegistrationViaAffiliate=13]="RegistrationViaAffiliate";n[n.AndroidMobileAppCreateCustomer=23]="AndroidMobileAppCreateCustomer";n[n.ApplePhoneMobileAppCreateCustomer=24]="ApplePhoneMobileAppCreateCustomer";n[n.ContactMePage=25]="ContactMePage";n[n.SignUpPopup=36]="SignUpPopup";n[n.Unknown=37]="Unknown"}(EmailSubscriptionSource||(EmailSubscriptionSource={})),function(n){n[n.ByName=0]="ByName";n[n.ByAddress=1]="ByAddress"}(FindARepSearchType||(FindARepSearchType={})),function(n){n[n.Original=0]="Original";n[n.XtraLarge=700]="XtraLarge";n[n.Large=420]="Large";n[n.Medium=240]="Medium";n[n.Small=67]="Small";n[n.XtraSmall=50]="XtraSmall"}(ImageType||(ImageType={})),function(n){n[n.Interest=0]="Interest";n[n.Reason=1]="Reason"}(InterestType||(InterestType={})),function(n){n[n.Jan=1]="Jan";n[n.Feb=2]="Feb";n[n.Mar=3]="Mar";n[n.Apr=4]="Apr";n[n.May=5]="May";n[n.Jun=6]="Jun";n[n.Jul=7]="Jul";n[n.Aug=8]="Aug";n[n.Sep=9]="Sep";n[n.Oct=10]="Oct";n[n.Nov=11]="Nov";n[n.Dec=12]="Dec"}(Month||(Month={})),function(n){n[n.OrderProcessing=1]="OrderProcessing";n[n.OrderShipped=2]="OrderShipped";n[n.CreditCardDenied=3]="CreditCardDenied";n[n.NotAvailable=4]="NotAvailable";n[n.AuthorizingCreditCard=5]="AuthorizingCreditCard";n[n.ReferredToCustomerServices=6]="ReferredToCustomerServices";n[n.InvalidShippingAddress=7]="InvalidShippingAddress";n[n.Cancelled=8]="Cancelled";n[n.OrderReturn=9]="OrderReturn";n[n.OrderOnHold=10]="OrderOnHold";n[n.PartialCredit=11]="PartialCredit";n[n.PartialReturn=12]="PartialReturn"}(OrderStatus||(OrderStatus={})),function(n){n[n.Customer=0]="Customer";n[n.Representative=1]="Representative"}(OrderType||(OrderType={})),function(n){n[n.Unknown=0]="Unknown";n[n.CreditCard=1]="CreditCard";n[n.PayPal=2]="PayPal"}(PaymentType||(PaymentType={})),function(n){n[n.notyetspecified=0]="notyetspecified";n[n.shipping_method_1=1]="shipping_method_1";n[n.shipping_method_2=2]="shipping_method_2";n[n.shipping_method_3=3]="shipping_method_3";n[n.shipping_method_4=4]="shipping_method_4";n[n.shipping_method_10=10]="shipping_method_10";n[n.rep_delivery=11]="rep_delivery";n[n.shipping_method_sr=12]="shipping_method_sr"}(ShippingOptionCode||(ShippingOptionCode={})),function(n){n[n.NotApplicable=0]="NotApplicable";n[n.CannotBuy=1]="CannotBuy";n[n.CanBuyWhenXaddedToYourBag=2]="CanBuyWhenXaddedToYourBag";n[n.CanBuyWhenSpentX=3]="CanBuyWhenSpentX";n[n.CanBuyWhenXConditionsMet=4]="CanBuyWhenXConditionsMet"}(PromoConditionalRuleReason||(PromoConditionalRuleReason={})),function(n){n[n.OnTabClick=0]="OnTabClick";n[n.OnTabMouseEnter=1]="OnTabMouseEnter";n[n.OnTabMouseLeave=2]="OnTabMouseLeave"}(TabToggleMode||(TabToggleMode={})),function(n){n[n.Fragrance=0]="Fragrance";n[n.Shade=1]="Shade";n[n.Size=2]="Size";n[n.Spf=3]="Spf";n[n.Subscription=4]="Subscription";n[n.Version=5]="Version";n[n.None=6]="None"}(VariantType||(VariantType={})),function(n){n[n.None=0]="None";n[n.IslandState=1]="IslandState";n[n.AlaskaHawaiiNoHazmat=2]="AlaskaHawaiiNoHazmat";n[n.AlaskaHawaiiSomeHazmat=3]="AlaskaHawaiiSomeHazmat";n[n.AlaskaHawaiiAllHazmat=4]="AlaskaHawaiiAllHazmat"}(RestrictedAutoRepType||(RestrictedAutoRepType={}));"console"in window||(console={log:function(){}}),function(n){var r=function(){function n(){}return n.prototype.centerModal=function(){$(".ModalContainer").center()},n.prototype.redirectTo=function(n){var t=top.location.href==n;top.location.href=n;t&&top.location.hash&&($("html, body").animate({scrollTop:0},0),top.location.reload())},n.prototype.showModal=function(n,t,i){var u,f,e,r;u=$("#popupBackground");u.length===0&&($("body").append('<div id="popupBackground"><\/div>'),u=$("#popupBackground"));$("body").addClass("ModalVisible");u.show();f=t.toString()+"px";e=i.toString()+"px";r=$("#"+n);r.show();r.css("width",f);r.css("height",e);r.center()},n.prototype.hideModal=function(n){n!==""&&($("#popupBackground").hide(),$("#"+n).hide(),$("body").removeClass("ModalVisible"))},n.prototype.showContactPreferencesModal=function(){alert("ToDo: Implement showContactPreferencesModal")},n}(),t,i;n.Common=r;t=function(){function n(){this.buttonKeys={EnterKey:13}}return n.prototype.scrollToTop=function(n){var t=0;isMobile()&&(t=1);$("html, body").animate({scrollTop:t},400,"swing",function(){typeof n=="function"&&n.call(this)})},n.prototype.isQapEnvironment=function(){return location.href.indexOf("qap.shop.avon.com")>-1},n.prototype.rebindAjaxForm=function(n){this.setupFormElements(n);this.setDefaultFormAction(n)},n.prototype.setupFormElements=function(n){var t=$(n),i=$(".FormItem select",t);$("input.NumberInput").handleNumberInput()},n.prototype.setDefaultFormAction=function(n){var t=n.find(".DefaultButton").first();t.length>0&&(n.keypress(function(n){if(n.which===this.buttonKeys.EnterKey&&!$("body").hasClass("ShowLoading"))return $("input").blur(),t.focus(),t.click(),!1}),n.find(".SelectBoxed").live("enter",function(){$("body").hasClass("ShowLoading")||(t.focus(),t.click())}))},n}();n.CommonMvc=t;i=function(){function t(){this.setBreadcrumbs=!0;this.ShowProductList=null;this.IsDescendantMegaBrand=null;this.common=new n.Common;this.commonMvc=new n.CommonMvc}return t}();n.Avon=i}(AvonModule||(AvonModule={}));var AVON=new AvonModule.Avon,isMobile=function(){"use strict";return(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/)||navigator.userAgent.match(/Phone/i))!=null||window.IsMobile},AddBagItem=function(){function n(){}return n}();app=isMobile()?angular.module("avonShopApp",["ngAria","ngSanitize","hmTouchEvents"]):angular.module("avonShopApp",["ngAria","ngSanitize","hmTouchEvents","ui.select2"]);app.config(["$compileProvider",function(n){n.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel):/);n.debugInfoEnabled(!1)}]);app.config(["$ariaProvider",function(n){n.config({ariaHidden:!0,ariaChecked:!0,ariaDisabled:!0,ariaRequired:!0,ariaInvalid:!0,ariaMultiline:!0,ariaValue:!0,tabindex:!1,bindKeypress:!0})}]);app.preloadedSafeLoadImages=!1;app.safeLoadImages=function(n){var t=n.find("img[data-src]").not(".ImageNotFound").not(".ImageLoading"),i="/images/Responsive/Product/PhotoNotAvailable.png";t.length&&(app.preloadedSafeLoadImages||(app.preloadedSafeLoadImages=!0,app.preloadImage(i),app.preloadImage("/images/Responsive/Common/Loading.gif")),t.each(function(){var n=$(this),t=n.data("src");t!="loaded"&&(n.addClass("ImageLoading"),n.data("alt",n.attr("alt")),n.attr("alt"," "))}),t.each(function(){var n=$(this),t=n.data("src");if(t!="loaded"){n.on("load",function(){var t=$(this);t.hasClass("ImageNotFound")||(t.attr("alt",n.data("alt")),t.data("src","loaded"));t.removeClass("ImageLoading");t.data("alt","")});if(!AvonModule.AvonScope.IsPhantom)n.on("error",function(){var n=$(this);n.removeClass("ImageLoading");n.addClass("ImageNotFound");n.data("alt","");n.attr("alt","Image not found");n.attr("src",i);n.trigger("ImageNotFound")});n.attr("src",t)}}))};app.preloadImage=function(n){$("<img/>")[0].src=n};app.serializeDate=function(n){return n.toISOString()};app.parseDate=function(n){var t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(n);return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],0))};app.GetQuerystringParameterByName=function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))};String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})};String.prototype.formatUrlNugget=function(){return(this||"").toLowerCase().replace(/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,"a").replace(/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,"e").replace(/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,"i").replace(/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,"o").replace(/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,"u").replace(/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,"n").replace(/[^a-zA-Z0-9\/\\\+\s+-]/g,"").replace(/[\/\\\s+]/g,"-").replace("--","-").replace("--","-")};fbParsed=!1;$(function(){$(document).ajaxComplete(function(){try{window.FB&&window.FB.XFBML&&!fbParsed&&(fbParsed=!0,window.FB.XFBML.parse())}catch(t){}try{for(var n=0;$("div[fb-xfbml-state=parsed]").length>0&&n<5;)$("div[fb-xfbml-state=parsed]").removeAttr("fb-xfbml-state"),window.FB.XFBML.parse(),n++}catch(t){}})}),function(n){var t,i="facebook-jssdk",r;n.getElementById(i)||(t=n.createElement("script"),t.id=i,t.async=!0,r=$("html").hasClass("LangES")?"es_ES":"en_US",t.src="//connect.facebook.net/"+r+"/sdk.js",n&&n.getElementsByTagName("head")[0].appendChild(t))}(document);var fbInitDone=!1,fbAsyncInit=function(){fbInitDone||(fbInitDone=!0,window.FB.init({appId:"841975755828277",status:!0,cookie:!0,xfbml:!0,version:"v2.1"}))},BaseAvonService=function(){function n(t,i,r){n.rootScope=t;n.http=i;n.q=r}return n.prototype.RedirectToErrorPage=function(n){window.location.href="/error500.htm?id="+n},n.prototype.ProcessAvonResponse=function(t){var i=t,r;if(typeof i.responseJSON!="undefined"&&(i=i.responseJSON),typeof i.responseText!="undefined"&&(i=JSON.parse(i.responseText)),!i.Processed)if(i.Processed=!0,typeof i.AngularResponse=="undefined")n.rootScope.Redirecting||t.status!=200&&t.status!=304||typeof t.status!="undefined"&&t.status!==null&&t.status!==0&&this.RedirectToErrorPage("AjaxError:"+t.status);else switch(i.ErrorCode){case 0:i.IdToReplace?BaseAngularController.ProcessAjaxReplacement(i):i.RedirectUrl!==null&&i.RedirectUrl!==""?($("body").hasClass("ShowLoading")||n.rootScope.ShowLoading(AVON.messages.spinner_loading),AVON.common.redirectTo(i.RedirectUrl)):i.OpenModalId?(r={AllowExit:!1,Model:i.Data,KeepLoaded:!1,UrlToLoad:null},n.rootScope.ShowLoading(AVON.messages.spinner_loading),$("#"+i.OpenModalId).trigger("modal",r)):i.Processed=!1;break;case 1:i.Processed=!1;break;case 3:alert("ToDo: BaseAngularController - deal with InvalidParameter repsonse");break;case 500:this.RedirectToErrorPage(i.ErrorId);break;default:alert("ToDo: Angular processing of ajax response code "+i.ErrorCode+" for "+JSON.stringify(i))}},n.prototype.PostJson=function(t,i,r,u,f){var o,s,c,e,h;return r===void 0&&(r=null),u===void 0&&(u=!0),f===void 0&&(f=!0),f&&n.rootScope.$broadcast("Do.ResetPageIdleTime"),o={"Content-Type":"application/json; charset=utf-8","Avon-Post-Type":"angular","X-Requested-With":"XMLHttpRequest"},r&&(s=r.find('input[name="__RequestVerificationToken"]'),s.length&&(c=s.val(),o.__RequestVerificationToken=c)),e=n.http({url:t,cache:!1,dataType:"json",method:"POST",data:JSON.stringify(i),headers:o}),h=this,e.success(function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);_.delay(function(){h.ProcessAvonResponse(t)},10)}),e.error(function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);_.delay(function(){h.ProcessAvonResponse(t)},10)}),e},n.prototype.GetJson=function(t,i,r,u,f){i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!0);f===void 0&&(f=!0);f&&n.rootScope.$broadcast("Do.ResetPageIdleTime");var e=n.q.defer(),o=this;return $.ajax({async:i,cache:r,type:"GET",url:t,dataType:"json",beforeSend:function(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest")},success:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.resolve(t);_.delay(function(){o.ProcessAvonResponse(t)},10)},error:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.reject(t);_.delay(function(){o.ProcessAvonResponse(t)},10)}}),e.promise},n.prototype.GetHtml=function(t,i,r,u,f){i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!0);f===void 0&&(f=!0);f&&n.rootScope.$broadcast("Do.ResetPageIdleTime");var e=n.q.defer(),o=this;return $.ajax({async:i,cache:r,type:"GET",url:t,dataType:"html",success:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.resolve(t)},error:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.reject(t)}}),e.promise},n}(),TrackingEventType=function(){function n(){}return n.None="None",n.MenuClick="MenuClick",n.ItemsAddedToBag="ItemsAddedToBag",n.FindARepClick="FindARepClick",n.MobileMenuClick="MobileMenuClick",n.MobileCheckoutSteps="MobileCheckoutSteps",n.FindARepContactMe="FindARepContactMe",n.FindARepSelectARep="FindARepSelectARep",n.FindARepResults="FindARepResults",n.LeaveVMOClick="LeaveVMOClick",n.LoginModalDisplay="LoginModalDisplay",n.SendPasswordHint="acctsigninsendhint",n.SendPassword="acctsigninsendpass",n.BeenAWhile="beenawhile",n.NewCustomerRegistration="newcustregmodaldisplay",n.NewCustomerRegistrationOptIn="newcustregmodaloptin",n.NewCustomerRegistrationOptOut="newcustregmodaloptout",n.NewCustomerRegistrationFormError="newcustregformerror",n.ChangePasswordModel="changepassmodal",n.ChangePasswordSuccess="changepasssuccess",n.ChangeRepresentativeStay="staywithrep",n.ChangeRepresentativeChange="changetorep",n.QuickShopProductView="quickshopproductview",n.NotifyMeThankYouProddetails="notifymethankyouproddetails",n.FarLocateMyRep="farlocatemyrep",n.FarRecommendaRep="farrecommendarep",n.HowMayIAssistThankYou="howmayiassistthankyou",n.HowMayIAssist="howmayiassist",n.SearchResults="searchresults",n.SearchbarNoResults="searchbarnoresults",n.SearchbarResults="searchbarresults",n.ViewShoppingBagModal="viewshoppingbagmodal",n.SearchByProdResults="searchbyprodu:results",n.SearchByProdNoResults="searchbyprodu:noresults",n.ShopByProdError="shopbyproderror",n.ShopByProdNotAvailable="shopbyprodnotavailable",n.ShopbyAddtobag="shopbyaddtobag",n.EmailConfirmMsg="emailconfirmmsg",n.CouponCodeApplied="cart:couponcodeapplied",n.CouponCodeNotApplied="cartcouponcodenotapplied",n.CartSignIn="cart:signin",n.CartNewCustAcct="cart:newcustacct",n.CartContinueAsGuest="cart:continueasguest",n.CartCheckout1="cart:checkout-1",n.CartCheckout1AddShipping="cart:checkout-1-addshipping",n.CartCheckout2="cart:checkout-2",n.CartCheckOut2EditShippingModal="cart:checkout-2-editshippingmodal",n.CartCheckOut2EditBillingModal="cart:checkout-2-editbillingmodal",n.CartCheckOut2SaveGiftMessage="cart:checkout-2-savegiftmessage",n.CartCheckOut2CCUpdate="cart:checkout-2-ccupdate",n.CartCheckOut2CCAdded="cart:checkout-2-ccadded",n.CartConfirmation="cart:confirmation",n.CartViewShipRestrictions="cartviewshiprestrictions",n.NewCardAdded="newcardadded",n.ContactusFormThankyou="contactusformthankyou",n.EmailPopupServed="emailpopupserved",n.EmailPopupSubscribed="emailpopupsubscribed",n}(),__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},TrackingServiceModule;(function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);this.KeepAliveVmo=function(){};this.BazaarVoice=function(){};t.rootScope=i;t.http=r;t.q=u;this.window=f;this.skusInBag=[];var e=function(){var r=$('.Slide[data-module="Featured Shops:"]'),u,n,t,i;r.length>0&&_.each(r,function(n){var t=$(n),i=t.find("img");t.attr("data-module",t.attr("data-module")+i.prop("alt"))});u=$(".ContentModule.GenericGrid");u.each(function(n,t){var i=$(t),r=i.find("div.StackCell");r.each(function(n,t){var i=$(t);i.each(function(n,t){var r=$(t),u=r.find(".ProductItemContainer"),f=u.attr("data-productid");i.attr("data-module",i.attr("data-module")+f)})})});n=$('img[alt="Promotion Banner"]');n.length>0&&n.attr("data-module","promobar");t=$('a[title="Details &amp; Exclusions"]');t.length>0&&t.attr("data-nav","promodetails");i=$("#BeautyProfileContainer a");i.length>0&&i.attr("data-actions","vmo:tryitnow")},o=_.once(function(){e()});i.$on("AvonController.PageCompete",function(){o()})}return __extends(t,n),t.prototype.FindARepClick=function(){},t.prototype.FindARepContactMe=function(){},t.prototype.FindARepSelectARep=function(){},t.prototype.FinARepResults=function(){},t.prototype.MenuClick=function(){},t.prototype.MobileMenuClick=function(){},t.prototype.MobileCheckoutSteps=function(){},t.prototype.ItemsAddedToBag=function(){},t.prototype.LeaveVMOClick=function(){},t.prototype.UpdateProductDetailsSku=function(n){var i=this,t="";_.each(_.filter(n,function(n){return n.variant!==null&&n.variant.Sku!==i.window.AvonAnalyticsObjex.productPageDetails.Sku}),function(n){t=t+"|"+n.variant.Sku});t.length>0&&(this.window.AvonAnalyticsObjex.productPageDetails.Sku=this.window.AvonAnalyticsObjex.productPageDetails.Sku+t)},t.prototype.TrackEvent=function(n){n},t.prototype.TrackEventItem=function(n){var f,i,r,u,t;switch(n.Type){case TrackingEventType.ShopbyAddtobag:f=_.map(n.Data,function(n){return n.Sku});this.window.AvonAnalyticsObjex.productPageDetails.shopByProductList=f.join();this.track(n);break;case TrackingEventType.FarLocateMyRep:i={};r=n.Data.model;i.locateMyRep=r.FirstName+":"+r.LastName+":"+r.State;i.totalRepResults=n.Data.totalReps===0?"ZERO":n.Data.totalReps;this.window.AvonAnalyticsObjex.FindARep=i;this.track(n);break;case TrackingEventType.FarRecommendaRep:u={};t=n.Data.model;u.recommendARep=t.Address+":"+t.City+":"+t.State+":"+t.ZipCode;u.totalRepResults=n.Data.totalReps===0?"ZERO":n.Data.totalReps;this.window.AvonAnalyticsObjex.FindARep=u;this.track(n);break;case TrackingEventType.HowMayIAssistThankYou:this.window.howmayiassist=n.Data;this.track(n);break;case TrackingEventType.SearchResults:n.Data===0?(this.window.AvonAnalyticsObjex.productFinding.siteSearch.results="ZERO",n.Type=TrackingEventType.SearchbarNoResults,this.track(n)):(this.window.AvonAnalyticsObjex.productFinding.siteSearch.results=n.Data,n.Type=TrackingEventType.SearchbarResults,this.track(n));break;case TrackingEventType.SearchByProdNoResults:this.window.AvonAnalyticsObjex.productFinding.searchBy.campaign=n.Data.campaignNumber;this.window.AvonAnalyticsObjex.productFinding.searchBy.productName=n.Data.searchTerm;this.window.AvonAnalyticsObjex.productFinding.searchBy.results="Zero";this.track(n);break;case TrackingEventType.SearchByProdResults:this.window.AvonAnalyticsObjex.productFinding.searchBy.campaign=n.Data.campaignNumber;this.window.AvonAnalyticsObjex.productFinding.searchBy.productName=n.Data.searchTerm;this.window.AvonAnalyticsObjex.productFinding.searchBy.results=n.Data.resultsNo;this.track(n);break;case TrackingEventType.LoginModalDisplay:case TrackingEventType.SendPasswordHint:case TrackingEventType.SendPassword:case TrackingEventType.BeenAWhile:case TrackingEventType.NewCustomerRegistration:case TrackingEventType.NewCustomerRegistrationOptIn:this.track(n);break;case TrackingEventType.NewCustomerRegistrationOptOut:this.track(n);break;case TrackingEventType.NewCustomerRegistrationFormError:case TrackingEventType.ChangePasswordModel:case TrackingEventType.ChangePasswordSuccess:case TrackingEventType.ChangeRepresentativeStay:case TrackingEventType.ChangeRepresentativeChange:case TrackingEventType.QuickShopProductView:case TrackingEventType.EmailConfirmMsg:case TrackingEventType.EmailPopupServed:case TrackingEventType.EmailPopupSubscribed:case TrackingEventType.CartSignIn:case TrackingEventType.CartCheckout1:case TrackingEventType.CartCheckout1AddShipping:case TrackingEventType.CartCheckout2:case TrackingEventType.CartCheckOut2EditBillingModal:case TrackingEventType.CartCheckOut2EditShippingModal:case TrackingEventType.CartCheckOut2SaveGiftMessage:case TrackingEventType.CartConfirmation:case TrackingEventType.CartViewShipRestrictions:case TrackingEventType.HowMayIAssist:case TrackingEventType.ContactusFormThankyou:case TrackingEventType.ShopByProdError:case TrackingEventType.ShopByProdNotAvailable:case TrackingEventType.CartContinueAsGuest:this.track(n);break;case TrackingEventType.CartNewCustAcct:this.track(n)}},t.prototype.track=function(n){"_satellite"in window&&window._satellite.track(n.Type.toString())},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.TrackingService=t})(TrackingServiceModule||(TrackingServiceModule={}));app.service("trackingService",TrackingServiceModule.TrackingService);myErrIsThis=null;(typeof s=="undefined"||s==null)&&(s={}),function(n){n[n.Add=0]="Add";n[n.Remove=1]="Remove"}(ApplyCouponType||(ApplyCouponType={})),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,f);t.rootScope=i;t.http=r;t.q=f;t.trackingService=u}return __extends(t,n),t.prototype.update=function(n){this.PostJson("/api/bag/update",n).success(function(n){t.rootScope.$broadcast("BagService.Update",n)})},t.prototype.applyCoupon=function(n,i){this.PostJson("/api/bag/applycoupon",{couponCode:n,isPaymentPage:i}).success(function(n){var i=n.Data;i&&(i.Type=0,t.rootScope.$broadcast("BagService.ApplyCouponSuccess",n))})},t.prototype.removeCoupon=function(n,i){this.PostJson("/api/bag/removecoupon",{isPaymentPage:i}).success(function(n){var i=n.Data;i&&(i.Type=1,t.rootScope.$broadcast("BagService.ApplyCouponSuccess",n))})},t.prototype.setPromoCoupon=function(n){this.PostJson("/api/bag/setpromocoupon",{couponCode:n})},t.prototype.changeRepModal=function(n){this.PostJson("/api/bag/changerep",{returnUrl:n})},t.prototype.addItemToBag=function(n,i){this.PostJson("/api/bag/additemtobag",{bagItem:n,displayModal:i}).success(function(n){var i=n.Data,r,u,f;if(i&&i.ItemsAdded.length>0)t.rootScope.$broadcast("BagService.AddToBagSuccess",i),this.window.AvonAnalyticsObjex&&this.window.AvonAnalyticsObjex.shoppingCart&&this.window.AvonAnalyticsObjex.shoppingCart.orderSummary&&(this.window.AvonAnalyticsObjex.shoppingCart.orderSummary.subTotal=SessionServiceModule.SessionService.rootScope.Session.Cart.OrderDetails.SubTotal,this.window.AvonAnalyticsObjex.shoppingCart.orderSummary.total=SessionServiceModule.SessionService.rootScope.Session.Cart.OrderDetails.Total,this.window.AvonAnalyticsObjex.shoppingCart.quantity=SessionServiceModule.SessionService.rootScope.Session.Cart.OrderDetails.ItemCount),r={Type:TrackingEventType.ItemsAddedToBag,Data:i},t.trackingService.TrackEventItem(r);else for(u in i.ItemsFailed)for(f in i.ItemsFailed[u].ErrorMessages);}).error(function(){})},t.prototype.addMultipleItemsToBag=function(n,i){this.PostJson("/api/bag/addmultipleitemstobag",{bagItems:n,displayModal:i}).success(function(n){var i=n.Data,r,u,f;if(i&&i.ItemsAdded.length>0)t.rootScope.$broadcast("BagService.AddToBagSuccess",i),this.window.AvonAnalyticsObjex&&this.window.AvonAnalyticsObjex.shoppingCart&&this.window.AvonAnalyticsObjex.shoppingCart.orderSummary&&(this.window.AvonAnalyticsObjex.shoppingCart.orderSummary.subTotal=SessionServiceModule.SessionService.rootScope.Session.Cart.OrderDetails.SubTotal,this.window.AvonAnalyticsObjex.shoppingCart.orderSummary.total=SessionServiceModule.SessionService.rootScope.Session.Cart.OrderDetails.Total,this.window.AvonAnalyticsObjex.shoppingCart.quantity=SessionServiceModule.SessionService.rootScope.Session.Cart.OrderDetails.ItemCount),r={Type:TrackingEventType.ItemsAddedToBag,Data:i},t.trackingService.TrackEventItem(r);else for(u in i.ItemsFailed)for(f in i.ItemsFailed[u].ErrorMessages);}).error(function(){})},t.prototype.lineEntryAddSingleProductToBag=function(n){var i=[];i.push(n);this.PostJson("/api/bag/lineentryaddtobag",{bagItems:i,conditionalProducts:[]}).success(function(n){var i=n.Data;i&&t.rootScope.$broadcast("BagService.LineEntryAddSingleProductToBag",n)})},t.prototype.lineEntryAddProductsToBag=function(n){this.PostJson("/api/bag/lineentryaddtobag",{bagItems:n,conditionalProducts:[]},null,!1).success(function(n){var i=n.Data;i!==null&&t.rootScope.$broadcast("BagService.LineEntryAddProductsToBag",n)}).error(function(){})},t.prototype.addItemToWishlist=function(n){this.PostJson("/api/bag/additemtowishlist",{productId:n}).success(function(n){n&&t.rootScope.$broadcast("BagService.AddToWishlistSuccess",n)})},t.prototype.recalculateBag=function(n){this.PostJson("/api/bag/recalculate",{calculateShippingCosts:!0,removeUnavailableProducts:!0,shippingMethod:n}).success(function(n){t.rootScope.$broadcast("BagService.RecalculateSuccess",n)})},t.prototype.getBag=function(){this.GetJson("/api/bag/getbag",!0,!1).then(function(n){t.rootScope.$broadcast("BagService.GetBagSuccess",n)})},t.prototype.RunPreCheckoutTests=function(){this.PostJson("/api/bag/precheckouttests",{}).success(function(n){t.rootScope.$broadcast("BagService.RunPreCheckoutTests",n)})},t.$inject=["$rootScope","$http","trackingService","$q"],t}(BaseAvonService);n.BagService=t}(BagServiceModule||(BagServiceModule={}));app.service("bagService",BagServiceModule.BagService),function(n){var t=function(t){function i(n,r,u){t.call(this,n,r,u);this.blankSession={Customer:{Hash:0,FirstName:"",LastName:"",Email:"",Phone:"",PasswordHint:"",IsLoggedIn:!1,FacebookId:0,IsFacebookUser:!1,IsPasswordSet:!1,IsPayPalCustomerLoggedIn:!1,IsAttached:!1,IsEligibleForGuestCheckout:!1,DeliveryType:3,Campaign:AVON.campaign,CustomerId:0,ShopperId:"",BillingAddress:{Address1:"",Address2:"",City:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",Number:"",Prefix:""},State:"",Type:0,Zip:"",Name:""},ShippingAddress:{Address1:"",Address2:"",City:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",Number:"",Prefix:""},State:"",Type:0,Zip:"",Name:""},EmailSignUpLastShown:"",IsNewVisitor:!1},Rep:{Hash:0,Id:0,Name:"",ChatIsActive:!1,Address:"",ChatAwayMessage:"",ChatUrl:"",CityStateZip:"",HomepageUrl:"",Phone:"",WebUrl:""},LpmPreview:{Hash:0,IsPreviewMode:!1,PreviewAtDate:null},Cart:{Hash:0,GiftMessage:{IsSet:!1,To:"",From:"",Message:""},OrderDetails:{ItemCount:0,HasHazmatItems:!1,HasRepOnlyItems:!1,HasDirectOnlyItems:!1,HasAutoReplenishItems:!1,HasNonDiscountableItems:!1,RepDeliveryEnabled:!0,DirectDeliveryEnabled:!0,IsShippingOverriddenToFree:!0,Discount:"",EstimatedTax:0,MerchandiseTotal:0,Shipping:0,ShippingSurcharge:0,SubTotal:0,Total:0},ShowPayPalExpress:!1,Campaigns:[],ConditionalProducts:[],OutOfStockProducts:[],UnDeliverableProducts:[],Coupon:{Code:"",Discount:null,DiscountType:null,Message:"",ErrorMessage:""},FreeShippingDetails:{IsQualified:!1,ShortFall:"",IsAvailable:!1}},NewHashes:{CustomerHash:-1,CartHash:-1,RepHash:-1,LpmPreviewHash:-1,AutoReplenishmentSubscription:-1},ShopperSession:{BillingAddress:{Address1:"",Address2:"",City:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",Number:"",Prefix:""},State:"",Type:0,Zip:{Code:"",OptionalPostFix:""},Name:""},ShippingAddress:{Address1:"",Address2:"",City:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",Number:"",Prefix:""},State:"",Type:0,Zip:{Code:"",OptionalPostFix:""},Name:""}},AutoReplenishmentSubscription:[]};i.rootScope=n;i.http=r;i.q=u}return __extends(i,t),i.prototype.UpdateBreadcrumbsInSession=function(n){this.PostJson("/api/session/updatebreadcrumbs",{breadcrumbs:n},null,!1)},i.prototype.Initialize=function(){i.rootScope.SessionReady=!1;i.rootScope.Session={};i.rootScope.ExtendDeep(i.rootScope.Session,this.blankSession);var n=window.sessionStorage[i.sessionName];n?(i.rootScope.ExtendDeep(i.rootScope.Session,JSON.parse(n)),i.rootScope.SessionReady=!0,AVON.SessionHashes?(i.rootScope.Session.NewHashes=AVON.SessionHashes,this.UpdateIfOld(i.rootScope.Session.NewHashes)):this.UpdateFromServer()):this.UpdateFromServer()},i.prototype.UpdateIfOld=function(n){var r,t;return(r=i.rootScope.Session.Customer.Hash!=n.CustomerHash||i.rootScope.Session.Cart.Hash!=n.CartHash||i.rootScope.Session.Rep.Hash!=n.RepHash||i.rootScope.Session.LpmPreview.Hash!=n.LpmPreviewHash,r)?(i.rootScope.Session.NewHashes=n,window.sessionStorage[i.sessionName]=JSON.stringify(i.rootScope.Session),this.UpdateFromServer()):(t=$.Deferred(),t.resolve(),t.promise())},i.prototype.UpdateFromServer=function(){return i.waitingForServer||(i.rootScope.SessionReady=!1,i.waitingForServer=$.Deferred(),i.rootScope.Session.Customer.Hash!=i.rootScope.Session.NewHashes.CustomerHash,i.rootScope.Session.Cart.Hash!=i.rootScope.Session.NewHashes.CartHash,i.rootScope.Session.Rep.Hash!=i.rootScope.Session.NewHashes.RepHash,this.GetJson("/api/session/usersession",!0,!1,!1).then(function(t){t.ErrorCode===0?(i.rootScope.Session=t.Data,i.rootScope.Session.NewHashes=t.SessionHashes,window.sessionStorage[i.sessionName]=JSON.stringify(i.rootScope.Session),i.rootScope.SessionReady=!0,i.rootScope.SafeApply(),i.waitingForServer.resolve(i.rootScope.Session),i.rootScope.$broadcast("SessionService.SessionUpdated",i.rootScope.Session),this.window.AvonAnalyticsObjex&&this.window.AvonAnalyticsObjex.shoppingCart&&this.window.AvonAnalyticsObjex.shoppingCart.orderSummary&&(this.window.AvonAnalyticsObjex.shoppingCart.orderSummary.subTotal=n.SessionService.rootScope.Session.Cart.OrderDetails.SubTotal,this.window.AvonAnalyticsObjex.shoppingCart.orderSummary.total=n.SessionService.rootScope.Session.Cart.OrderDetails.Total,this.window.AvonAnalyticsObjex.shoppingCart.quantity=n.SessionService.rootScope.Session.Cart.OrderDetails.ItemCount)):i.waitingForServer.reject(i.rootScope.Session);i.waitingForServer=null})),i.waitingForServer.promise()},i.prototype.UpdateModel=function(n){i.rootScope.Session=n;i.rootScope.Session.NewHashes={CartHash:n.Cart.Hash,CustomerHash:n.Customer.Hash,RepHash:n.Rep.Hash,LpmPreviewHash:n.LpmPreview.Hash};window.sessionStorage[i.sessionName]=JSON.stringify(i.rootScope.Session);i.rootScope.SessionReady=!0;i.rootScope.SafeApply();i.rootScope.$broadcast("SessionService.SessionUpdated",i.rootScope.Session)},i.prototype.WhenReady=function(){if(i.waitingForServer)return i.waitingForServer.promise();var n=$.Deferred();return n.resolve(i.rootScope.Session),n.promise()},i.prototype.GetPwpLogInPixel=function(){this.GetJson("/api/session/pwploginpixel",!0,!1,!1).then(function(n){if(n.ErrorCode===0){var t=n.Data;t.DoLogin&&i.rootScope.$broadcast("SessionService.PwpLogInLogOutPixelReceived",t.PixelUrl)}})},i.prototype.GetPwpLogOutPixel=function(){this.GetJson("/api/session/pwplogoutpixel",!0,!1,!1).then(function(n){if(n.ErrorCode===0){var t=n.Data;t.DoLogout&&i.rootScope.$broadcast("SessionService.PwpLogInLogOutPixelReceived",t.PixelUrl)}})},i.prototype.KeepAlive=function(){this.GetJson("/api/session/keepalive",!0,!1,!1,!1).then(function(){})},i.prototype.SetLanguage=function(n,t){t=t.toLowerCase().replace(/setlang=((en)|(es)|(1)|(2))[\&]?/g,"");t=t.replace(/\?$/,"");i.rootScope.SetClientLanguage(n);i.rootScope.ShowLoading(AVON.messages.spinner_loading);this.PostJson("/api/session/setlanguage",{language:n,redirectUrl:t},null,!1)},i.prototype.SwitchView=function(n){var t=window.location.href;i.rootScope.ShowLoading(AVON.messages.spinner_loading);this.PostJson("/api/viewswitcher/switchview",{mobile:n,returnUrl:t},null,!1)},i.$inject=["$rootScope","$http","$q"],i.waitingForServer=null,i.sessionName="AvonShopSession",i}(BaseAvonService);n.SessionService=t}(SessionServiceModule||(SessionServiceModule={}));app.service("sessionService",SessionServiceModule.SessionService),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);this.generateHashCode=function(n){var t=0;try{t=n.split("").reduce(function(n,t){return n=(n<<5)-n+t.charCodeAt(0),n&n},0);t<0&&(t*=-1)}catch(i){t=0}return t};t.rootScope=i;t.http=r;t.q=u;t.SessionService=f;t.clientConfiguration=AVON.ClientConfiguration}return __extends(t,n),t.prototype.getHost=function(n){var i=this.generateHashCode(n),r=AVON.ClientConfiguration.CdnHostPaths.length;return"//"+t.clientConfiguration.CdnHostPaths[i%r]+"/"},t.prototype.mediaImage=function(n){if(!n)return null;var t=this.getHost(n);return n.substr(0,1)=="/"&&(n=n.substr(1)),t+n},t.prototype.productImage=function(n,i,r){var f=i>1?"_"+(i-1):"",u=this.getHost(n)+t.clientConfiguration.CdnPaths.Product.replace("[LANG]",AVON.LanguageCode)+"/prod_"+n+"_xl"+f+".jpg";return typeof r!="undefined"&&r!=null&&r!==0&&(u=u+"?w="+r),u},t.prototype.productImageXtraLarge=function(n,t){return this.productImage(n,t,700)},t.prototype.productImageLarge=function(n,t){return this.productImage(n,t,420)},t.prototype.productImageMedium=function(n,t){return this.productImage(n,t,240)},t.prototype.productImageSmall=function(n,t){return this.productImage(n,t,67)},t.prototype.productImageXtraSmall=function(n,t){return this.productImage(n,t,50)},t.prototype.promoImage=function(n){return this.getHost(n.toString())+t.clientConfiguration.CdnPaths.Promotion.replace("[LANG]",AVON.LanguageCode)+"/promo_"+n+".jpg"},t.prototype.variantImage=function(n){return this.getHost(n)+t.clientConfiguration.CdnPaths.Variant.replace("[LANG]",AVON.LanguageCode)+"/shade_"+n+".gif"},t.prototype.brochureImage=function(n){return this.getHost(n)+"catalog/"+AVON.campaign.toString().substring(0,4)+"/"+AVON.campaign.toString().substring(4,6)+"/"+AVON.LanguageCode+"/"+n},t.$inject=["$rootScope","$http","$q","sessionService"],t}(BaseAvonService);n.CdnService=t}(CdnServiceModule||(CdnServiceModule={}));app.service("cdnService",CdnServiceModule.CdnService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.Action=function(n,i){for(var f=[],e,u=2;u<arguments.length;u++)f[u-2]=arguments[u];n=n.toLowerCase();i=i.toLowerCase();var o=$("html").attr("lang").substr(0,2),r="",s=_.find(t.rootScope.ClientConfiguration.RouteTranslations,function(t){return t.Controller==i&&(t.Action==n||t.Action=="index"&&n=="")&&t.Language==o});if(s?r=s.Url:(r=o=="es"?"/es/":"/",r=n=="index"?r+i:r+i+"/"+n),r=r.replace(/{.*}/,""),r=r.replace(/\?.*/,""),r=r.replace(/\/*$/,""),f)for(e=0;e<f.length;e++)r+="/"+f[e];return r},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.UrlService=t}(UrlServiceModule||(UrlServiceModule={}));app.service("urlService",UrlServiceModule.UrlService);BaseAngularController=function(){function n(n){this.ConvertDateStringsToDates=function(n){var i,t,u,r;if(typeof n=="object")for(i in n)n.hasOwnProperty(i)&&(t=n[i],typeof t=="string"&&(u=t.match(this.regexIso8601))?(r=Date.parse(u[0]),isNaN(r)||(n[i]=new Date(r))):typeof t=="object"&&this.ConvertDateStringsToDates(t));return n};n.SafeApply=function(n){var t=this.$root.$$phase;t=="$apply"||t=="$digest"?n&&typeof n=="function"&&n():this.$apply(n)};n.HideLineNumber=function(n){return _.contains(["991-025","000-000"],n)};n.IsAutoReplenishmentSubscriptionActive=function(n){return[1,2,5].indexOf(n)>-1};n.IsAutoReplenishmentSubscriptionCancelled=function(n){return[0,3,4].indexOf(n)>-1};n.ExtendDeep=function(t){return angular.forEach(arguments,function(i){i!==t&&angular.forEach(i,function(i,r){t[r]&&t[r].constructor&&t[r].constructor===Object?n.ExtendDeep(t[r],i):t[r]=i})}),t};n.ShowLoading=function(t){t||(t=AVON.messages.spinner_loading);n.$emit("ShowLoading",t)};n.HideLoading=function(){n.$emit("HideLoading")};n.SecureHtml=function(t){return n.$sce.trustAsHtml(t)};n.RedirectToUrl=function(t,i){i&&n.ShowLoading(AVON.messages.spinner_loading);window.location.href=t};n.IsTouchDevice=function(){return $("html").hasClass("touch")};n.IsIE9=function(){return $("html").hasClass("ie9")};n.RefreshContextValues=function(n){$("input[ng-model]",n).each(function(){if(angular.element(this).attr("type")!=="checkbox"&&angular.element(this).attr("type")!=="radio"){var n=angular.element(this);n.controller("ngModel").$setViewValue($(this).val())}})};n.ScrollIntoView=function(n,t,i){var r;t==null&&(t=-90);r={duration:400,direction:"y",complete:null,offsetY:t};_.delay(function(){$(n).scrollintoview(i!=null?i:r)},100)};n.ScrollToTop=function(n,t){var i=0;n!=null&&(i=n.offset().top+-90);t?$("html, body").animate({scrollTop:i+"px"},"fast"):$("html, body").animate({scrollTop:i+"px"},0)};n.BroadcastToElement=function(n,t,i){for(var f=[],u,r=3;r<arguments.length;r++)f[r-3]=arguments[r];return u=[i],f&&(u=u.concat(f)),n.$broadcast.apply(this,u)};n.ProcessAjaxValidationErrors=function(t,i){i?i.ServerErrors=t.ValidationErrors:n.ServerErrors=t.ValidationErrors;t.ValidationErrors&&t.ValidationErrors.length&&(i?i.ShowValidation=!0:n.ShowValidation=!0)};n.CleanPrivacyPolicy=function(n){_.isUndefined(n)===!1&&_.delay(function(){n.registrationModel_PrivacyPolicy.$invalid=!0;var t=$("input[name="+n.registrationModel_PrivacyPolicy.$name+"]");t.closest(".FormError").removeClass("FormError")},500)};n.ClearServerErrorsForForm=function(n){angular.forEach(n,function(t,i){_.isUndefined(t)===!1&&_.isEmpty(t)===!1&&_.has(t,"$invalid")&&t.$invalid&&n[i].$setValidity("server",!0)})};var t="xxxxxxxxxxxx",i="xxxxxxxxxxx";n.AppendPlaceholderToCreditCardNumber=function(n){n.CardNumber=t+n.LastFourDigits;n.Type===4&&(n.CardNumber=i+n.LastFourDigits)};n.IsCreditCardNumberPlaceholderOnly=function(n){var r=n.CardNumber.indexOf(t)>=0;return n.Type==4&&(r=n.CardNumber.indexOf(i)>=0),r};n.SetLanguage=function(t,i){t.preventDefault();var r=$(angular.element(t.currentTarget)[0]).attr("href");r.indexOf("?")<0&&(r+=window.location.search);n.SessionService.SetLanguage(i,r)};n.IsEmailValid=function(n){return/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(n)}}return n.ProcessAjaxReplacement=function(n){var t,i=!1,r,u;n.IdToReplace==="(body)"?t=$("body"):n.IdToReplace==="(modal)"?($("#AjaxModal").closest(".ModalContainer").remove(),i=!0,$("#Modals").append("<div id='AjaxModal'><\/div>"),t=$("#AjaxModal")):t=$("#"+n.IdToReplace);AVON.TempModalModel=n.Data;r=angular.element(n.Html);u=AvonModule.AvonScope.compileService(r)(AvonModule.AvonScope,function(n){t.replaceWith(n)});i&&u.trigger("modal")},n.prototype.GetBaseUrl=function(){var n=window.location.host;return window.location.protocol+"//"+n},n.prototype.GetHostName=function(){return document.location.hostname},n.regexIso8601=/^(\d{4}|\+\d{6})(?:-(\d{2})(?:-(\d{2})(?:T(\d{2}):(\d{2}):(\d{2})\.(\d{1,})(Z|([\-+])(\d{2}):(\d{2}))?)?)?)?$/,n}();BaseAnimations=function(){function n(){}return n.prototype.enter=function(n,t,i,r){return r()},n.prototype.leave=function(n,t){return t()},n.prototype.move=function(n,t,i,r){return r()},n.prototype.beforeAddClass=function(n,t,i){i()},n.prototype.addClass=function(n,t,i){return i()},n.prototype.beforeRemoveClass=function(n,t,i){i()},n.prototype.removeClass=function(n,t,i){return i()},n.prototype.allowCancel=function(){return!0},n}(),function(n){"use strict";n.addressesScope;var t=function(t){function i($scope,i,r,u,f){function o(){return n.addressesScope.AutoReplenishmentExistsInAccount=!1,$.each(n.addressesScope.Session.AutoReplenishmentSubscription,function(t){n.addressesScope.IsAutoReplenishmentSubscriptionActive(n.addressesScope.Session.AutoReplenishmentSubscription[t].StatusCode)&&(n.addressesScope.AutoReplenishmentExistsInAccount=!0)}),n.addressesScope.AutoReplenishmentExistsInAccount}function s(){var t=[];return $.each(n.addressesScope.Session.Cart.Campaigns,function(i){$.each(n.addressesScope.Session.Cart.Campaigns[i].Items,function(r){n.addressesScope.Session.Cart.Campaigns[i].Items[r].AutoReplenishmentFrequency>0&&t.push(n.addressesScope.Session.Cart.Campaigns[i].Items[r])})}),t}function e(){return n.addressesScope.AutoReplenishmentExistsInCart=!1,$.each(n.addressesScope.Session.Cart.Campaigns,function(t){$.each(n.addressesScope.Session.Cart.Campaigns[t].Items,function(i){n.addressesScope.Session.Cart.Campaigns[t].Items[i].AutoReplenishmentFrequency>0&&(n.addressesScope.AutoReplenishmentExistsInCart=!0)})}),n.addressesScope.AutoReplenishmentExistsInCart}function h(){var t=[n.addressesScope.billingAddress];(n.addressesScope.SaveBillingAndShipping||n.addressesScope.shippingAddress.Address1)&&t.push(n.addressesScope.shippingAddress);n.addressesScope.ShowLoading(AVON.messages.spinner_saving);n.addressesScope.CustomerService.SaveMyAddresses(t,n.addressesScope.UpdateAvonAccountBilling,!1,!1)}function c(t,i,r){n.addressesScope.ShowLoadingModal=t?!1:!0;n.addressesScope.IsNotCheckout=i?!1:!0;n.addressesScope.IsFirstTime=r?!0:!1;a();n.addressesScope.ValidForm=n.addressesScope.billingAddressForm.$valid;n.addressesScope.ShippingSameAsBilling||(n.addressesScope.ValidForm=n.addressesScope.billingAddressForm.$valid&&n.addressesScope.shippingAddressForm.$valid);y();n.addressesScope.ShippingSameAsBilling||p();n.addressesScope.SaveBillingAndShipping=!0;(o()||e())&&$.each(AVON.RestrictedDevlieryStates,function(t,i){if(n.addressesScope.shippingAddress.State===i){n.addressesScope.ShowRestrictedStateModal=!0;n.addressesScope.SaveBillingAndShipping=!1;n.addressesScope.ModalOpened="IneligibleAutoReplenishment";$(".IneligibleAutoReplenishment.billingAddress").trigger("modal",{UrlToLoad:"",AllowExit:!0,KeepLoaded:!0,Model:null});n.addressesScope.AlaskaHawaiiAutoRepWarningShown=!0}})}function l(){n.addressesScope.ShowValidation=!0;n.addressesScope.RequiredInvalid=!0;n.addressesScope.SafeApply();n.addressesScope.billingAddressForm.$valid===!1&&n.addressesScope.TrackUserValidationErrors(n.addressesScope.billingAddressForm.$error);n.addressesScope.shippingAddressForm.$valid===!1&&n.addressesScope.TrackUserValidationErrors(n.addressesScope.shippingAddressForm.$error);i.$broadcast("AddressesScope.AddressValidation")}function a(){for(var i=!1,r=!1,t=0;t<n.addressesScope.BillingStates.length;t++)if(n.addressesScope.BillingStates[t].Code==n.addressesScope.billingAddress.State){i=!0;break}for(i||(n.addressesScope.billingAddress.State="",n.addressesScope.ValidForm=!1),t=0;t<n.addressesScope.ShippingStates.length;t++)if(n.addressesScope.ShippingStates[t].Code==n.addressesScope.shippingAddress.State){r=!0;break}r||(n.addressesScope.shippingAddress.State="",n.addressesScope.ValidForm=!1)}function v(){_.delay(function(){n.addressesScope.ShowLoading(n.addressesScope.ShowLoadingModal?AVON.messages.spinner_loading:AVON.messages.spinner_saving)},200);n.addressesScope.CustomerService.SaveMyAddresses([n.addressesScope.billingAddress,n.addressesScope.shippingAddress],n.addressesScope.ShowLoadingModal,n.addressesScope.IsNotCheckout,n.addressesScope.IsFirstTime)}function w(){n.addressesScope.shippingAddress=angular.copy(n.addressesScope.originalShippingAddress);n.addressesScope.ShowValidation=!1;n.addressesScope.RequiredInvalidBilling=!1;n.addressesScope.RequiredInvalidShipping=!1;n.addressesScope.SafeApply()}function y(){n.addressesScope.billingAddress.Zip.Code&&n.addressesScope.billingAddress.Zip.Code.length<5&&(n.addressesScope.billingAddressForm.Zip.$invalid=!0,n.addressesScope.billingAddressForm.Zip.$error.pattern=!0,n.addressesScope.ValidForm=!1)}function p(){n.addressesScope.shippingAddress.Zip.Code&&n.addressesScope.shippingAddress.Zip.Code.length<5&&(n.addressesScope.shippingAddressForm.Zip.$invalid=!0,n.addressesScope.shippingAddressForm.Zip.$error.pattern=!0,n.addressesScope.ValidForm=!1)}t.call(this,$scope);n.addressesScope=$scope;n.addressesScope.CustomerService=r;n.addressesScope.billingAddress=AVON.billingAddress;n.addressesScope.shippingAddress=AVON.shippingAddress;n.addressesScope.BillingStates=AVON.BillingStates;n.addressesScope.ShippingStates=AVON.ShippingStates;n.addressesScope.ShippingSameAsBilling=!0;n.addressesScope.ShowZipErrorMessage=!1;n.addressesScope.UpdateAvonAccountBilling=!1;n.addressesScope.UpdateAvonAccountShipping=!1;n.addressesScope.ShowRestrictedStateModal=!1;n.addressesScope.ShowRestrictedStateInline=!1;n.addressesScope.ActiveAutoReplenishment=!1;n.addressesScope.SaveBillingAndShipping=!1;n.addressesScope.ReloadPageAfterAction=!1;n.addressesScope.ModalOpened="";n.addressesScope.RegistrationFullPageForm=angular.element("#registrationFullPage").val()=="true";n.addressesScope.RestrictedAutoRepType=0;n.addressesScope.AlaskaHawaiiAutoRepWarningShown=!1;n.addressesScope.IsMyAccountPage=window.location.toString().indexOf("/orderinginfo")>-1?!0:!1;n.addressesScope.OrderInfoSaveBilling&&(n.addressesScope.UpdateAvonAccountBilling=n.addressesScope.OrderInfoSaveBilling);n.addressesScope.OrderInfoSaveShipping&&(n.addressesScope.UpdateAvonAccountShipping=n.addressesScope.OrderInfoSaveShipping);_.defer(function(){n.addressesScope.billingAddressForm.billingAddress_FirstName.$setViewValue(n.addressesScope.billingAddressForm.billingAddress_FirstName.$viewValue);n.addressesScope.billingAddressForm.billingAddress_LastName.$setViewValue(n.addressesScope.billingAddressForm.billingAddress_LastName.$viewValue);n.addressesScope.billingAddressForm.billingAddress_Address1.$setViewValue(n.addressesScope.billingAddressForm.billingAddress_Address1.$viewValue);n.addressesScope.billingAddressForm.billingAddress_Address2.$setViewValue(n.addressesScope.billingAddressForm.billingAddress_Address2.$viewValue);n.addressesScope.billingAddressForm.billingAddress_City.$setViewValue(n.addressesScope.billingAddressForm.billingAddress_City.$viewValue);n.addressesScope.billingAddressForm.Zip.$setViewValue(n.addressesScope.billingAddressForm.Zip.$viewValue);n.addressesScope.billingAddressForm.Area.$setViewValue(n.addressesScope.billingAddressForm.Area.$viewValue);n.addressesScope.billingAddressForm.Prefix.$setViewValue(n.addressesScope.billingAddressForm.Prefix.$viewValue);n.addressesScope.billingAddressForm.Number.$setViewValue(n.addressesScope.billingAddressForm.Number.$viewValue);n.addressesScope.shippingAddressForm.shippingAddress_FirstName.$setViewValue(n.addressesScope.shippingAddressForm.shippingAddress_FirstName.$viewValue);n.addressesScope.shippingAddressForm.shippingAddress_LastName.$setViewValue(n.addressesScope.shippingAddressForm.shippingAddress_LastName.$viewValue);n.addressesScope.shippingAddressForm.shippingAddress_Address1.$setViewValue(n.addressesScope.shippingAddressForm.shippingAddress_Address1.$viewValue);n.addressesScope.shippingAddressForm.shippingAddress_Address2.$setViewValue(n.addressesScope.shippingAddressForm.shippingAddress_Address2.$viewValue);n.addressesScope.shippingAddressForm.shippingAddress_City.$setViewValue(n.addressesScope.shippingAddressForm.shippingAddress_City.$viewValue);n.addressesScope.shippingAddressForm.Zip.$setViewValue(n.addressesScope.shippingAddressForm.Zip.$viewValue)},200);AvonModule.AvonScope.QueryString().invalidDetails==="1"&&n.addressesScope.billingAddress.Address1&&_.defer(function(){n.addressesScope.ShippingSameAsBilling=!1;a();n.addressesScope.billingAddress.State==""||n.addressesScope.shippingAddress.State==""?(n.addressesScope.ShowValidation=!0,n.addressesScope.RequiredInvalid=!0,n.addressesScope.SafeApply()):n.addressesScope.SaveBillingAndShippingAddresses(!0)},500);n.addressesScope.originalBillingAddress=angular.copy(n.addressesScope.billingAddress);n.addressesScope.originalShippingAddress=angular.copy(n.addressesScope.shippingAddress);n.addressesScope.TrackUserValidationErrors=function(t){if(n.addressesScope.IsMobile){var i=[];t&&$.each(t,function(n,t){t&&(i.push("err-"+n),$.each(t,function(n,t){i.push(t.$name)}))});n.addressesScope.TrackEvent(TrackingEventType.MobileCheckoutSteps,"AccountInformation_Continue_UserError_"+i.join("_"));i=null}};n.addressesScope.HasPhoneNumber=function(){var t=n.addressesScope.billingAddress.PhoneNumber;return t?!t.Area||t.Area.length!==3?!1:!t.Prefix||t.Prefix.length!==3?!1:!t.Number||t.Number.length!==4?!1:!0:!1};n.addressesScope.AllAutoRepSubscriptionsAreHazardous=function(){var t=_.filter(n.addressesScope.Session.AutoReplenishmentSubscription,function(t){return n.addressesScope.IsAutoReplenishmentSubscriptionActive(t.StatusCode)}),i=s(),r,u;return t.length===0&&i.length===0?!1:(r=_.filter(t,function(n){return n.Product.IsHazardous}),u=_.filter(i,function(n){return n.IsHazardous}),t.length==r.length&&i.length===u.length)};n.addressesScope.SomeAutoRepSubscriptionsAreHazardous=function(){var t=_.filter(n.addressesScope.Session.AutoReplenishmentSubscription,function(t){return n.addressesScope.IsAutoReplenishmentSubscriptionActive(t.StatusCode)&&t.Product.IsHazardous}),i=s(),r=_.filter(i,function(n){return n.IsHazardous});return t.length>0||r.length>0};n.addressesScope.TrackEvent=function(n,t){var i={Type:n,Value:t};u.TrackEventItem(i)};n.addressesScope.ZipIsValid=function(n){return n!==null&&n.length===5};n.addressesScope.ValidateRestrictedDeliveryState=function(t,i,r){n.addressesScope.ShowRestrictedStateModal=!1;n.addressesScope.ShowRestrictedStateInline=!1;n.addressesScope.ActiveAutoReplenishment=!1;n.addressesScope.ModalOpened="";n.addressesScope.SessionService.WhenReady().then(function(){if((i||n.addressesScope.UpdateAvonAccountShipping)&&(n.addressesScope.ActiveAutoReplenishment=o()),n.addressesScope.ActiveAutoReplenishment||(n.addressesScope.ActiveAutoReplenishment=e()||o()),n.addressesScope.ActiveAutoReplenishment&&(i||n.addressesScope.UpdateAvonAccountShipping)){var u=_.uniq(_.union(AVON.RestrictedDevlieryStates,AVON.SemiRestrictedDevlieryStates));$.each(u,function(i,u){if(n.addressesScope.shippingAddress.State===u)if(n.addressesScope.ShowRestrictedStateModal=!0,n.addressesScope.ModalOpened="IneligibleAutoReplenishment",n.addressesScope.RestrictedAutoRepType=_.contains(AVON.SemiRestrictedDevlieryStates,u)?n.addressesScope.SomeAutoRepSubscriptionsAreHazardous()?n.addressesScope.AllAutoRepSubscriptionsAreHazardous()?4:3:2:1,t){var f={UrlToLoad:"",AllowExit:!0,KeepLoaded:!0,Model:null};r?$(".IneligibleAutoReplenishment.billingAddress").trigger("modal",f):$(".IneligibleAutoReplenishment.shippingAddress").trigger("modal",f);n.addressesScope.AlaskaHawaiiAutoRepWarningShown=!0}else n.addressesScope.ShowRestrictedStateInline=!0,n.addressesScope.CustomerService.ShowRestrictedStateInline(n.addressesScope.ShowRestrictedStateInline)})}});n.addressesScope.ShowRestrictedStateModal||(r?h():n.addressesScope.SaveShippingAddress(),n.addressesScope.ShowRestrictedStateInline=!1,n.addressesScope.CustomerService.ShowRestrictedStateInline(n.addressesScope.ShowRestrictedStateInline))};n.addressesScope.InAlaskaHawaiiWithAutoRepInCart=function(){return e()&&_.contains(AVON.SemiRestrictedDevlieryStates,n.addressesScope.shippingAddress.State)};n.addressesScope.ShowIneligibleAutoRepModal=function(){n.addressesScope.DisplayShippingAddress=!0;n.addressesScope.RestrictedAutoRepType=_.contains(AVON.SemiRestrictedDevlieryStates,n.addressesScope.shippingAddress.State)?n.addressesScope.SomeAutoRepSubscriptionsAreHazardous()?n.addressesScope.AllAutoRepSubscriptionsAreHazardous()?4:3:2:1;n.addressesScope.ModalOpened="InAlaskaHawaiiWithAutoRepInCartModal";$(".InAlaskaHawaiiWithAutoRepInCartModal").trigger("modal",{UrlToLoad:"",AllowExit:!0,KeepLoaded:!0,Model:null});n.addressesScope.AlaskaHawaiiAutoRepWarningShown=!0};n.addressesScope.$on("ModalClosed",function(){n.addressesScope.ModalOpened==="IneligibleAutoReplenishment"&&(n.addressesScope.ShowRestrictedStateInline=!1,n.addressesScope.CustomerService.ShowRestrictedStateInline(n.addressesScope.ShowRestrictedStateInline),n.addressesScope.shippingAddress.State=n.addressesScope.originalShippingAddress.State)});n.addressesScope.UpdateAutoReplenishmentSubscriptions=function(t){n.addressesScope.ModalOpened="";var i=[];$.each(n.addressesScope.Session.Cart.Campaigns,function(r){$.each(n.addressesScope.Session.Cart.Campaigns[r].Items,function(u){if(n.addressesScope.Session.Cart.Campaigns[r].Items[u].AutoReplenishmentFrequency>0&&(!t||n.addressesScope.Session.Cart.Campaigns[r].Items[u].IsHazardous)){var f={CampaignNumber:n.addressesScope.Session.Cart.Campaigns[r].Number,Sku:n.addressesScope.Session.Cart.Campaigns[r].Items[u].Sku,Quantity:0,AutoReplenishmentFrequency:n.addressesScope.Session.Cart.Campaigns[r].Items[u].AutoReplenishmentFrequency};i.push(f)}})});n.addressesScope.DeactivateAutoReplenishmentSubscriptions(t);n.addressesScope.ShowLoading(AVON.messages.spinner_loading);i.length>0&&f.update(i)};n.addressesScope.DeactivateAutoReplenishmentSubscriptions=function(t){n.addressesScope.ShowLoading(AVON.messages.spinner_saving);t?n.addressesScope.CustomerService.DiscontinueHazmatAutoReplenishmentProducts():n.addressesScope.CustomerService.DiscontinueAllAutoReplenishmentProducts();n.addressesScope.ShowRestrictedStateInline=!1;n.addressesScope.CustomerService.ShowRestrictedStateInline(n.addressesScope.ShowRestrictedStateInline)};n.addressesScope.$on("MyAccountService.DiscontinueAllAutoReplenishmentProducts",function(){n.addressesScope.SaveDetails()});n.addressesScope.$on("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",function(){n.addressesScope.SaveDetails()});n.addressesScope.SaveDetails=function(){n.addressesScope.ShowLoading(AVON.messages.spinner_saving);n.addressesScope.SaveBillingAndShipping?(n.addressesScope.ShowLoadingModal=!0,n.addressesScope.IsNotCheckout=!1,n.addressesScope.IsFirstTime=!1,v()):n.addressesScope.SaveShippingAddress()};n.addressesScope.CloseIneligibleForm=function(){n.addressesScope.ShowRestrictedStateInline=!1;n.addressesScope.CustomerService.ShowRestrictedStateInline(n.addressesScope.ShowRestrictedStateInline);n.addressesScope.shippingAddress.State=n.addressesScope.originalShippingAddress.State;n.addressesScope.billingAddress.State=n.addressesScope.originalBillingAddress.State;n.addressesScope.ShippingSameAsBillingPaymentForm=!1};n.addressesScope.ToggleShowRestrictedStateInline=function(){if(n.addressesScope.ShippingSameAsBillingPaymentForm&&n.addressesScope.ShowRestrictedStateInline){var t=n.addressesScope.billingAddress.State;n.addressesScope.CloseIneligibleForm();n.addressesScope.billingAddress.State=t}};n.addressesScope.SaveBillingAddress=function(){n.addressesScope.ValidForm=n.addressesScope.billingAddressForm.$valid;y();n.addressesScope.ValidForm?n.addressesScope.ShippingSameAsBillingPaymentForm?(n.addressesScope.SaveBillingAndShipping=n.addressesScope.ShippingSameAsBillingPaymentForm,n.addressesScope.shippingAddress=angular.copy(n.addressesScope.billingAddress),n.addressesScope.shippingAddress.Type=1,n.addressesScope.ValidateRestrictedDeliveryState(n.addressesScope.IsMyAccountPage,!0,!0)):h():(n.addressesScope.ShowValidation=!0,n.addressesScope.RequiredInvalidBilling=!0,n.addressesScope.TrackUserValidationErrors(n.addressesScope.billingAddressForm.$error))};n.addressesScope.SaveShippingAddress=function(){if(n.addressesScope.ValidForm=n.addressesScope.shippingAddressForm.$valid,p(),n.addressesScope.ValidForm){var t=[];n.addressesScope.billingAddress.Address1&&t.push(n.addressesScope.billingAddress);t.push(n.addressesScope.shippingAddress);n.addressesScope.ShowLoading(AVON.messages.spinner_saving);n.addressesScope.CustomerService.SaveMyAddresses(t,n.addressesScope.UpdateAvonAccountShipping,!1,!1)}else n.addressesScope.ShowValidation=!0,n.addressesScope.RequiredInvalidShipping=!0,n.addressesScope.TrackUserValidationErrors(n.addressesScope.shippingAddressForm.$error)};n.addressesScope.SaveBillingAndShippingAddresses=function(t,i,r){c(t,i,r);n.addressesScope.ValidForm?(n.addressesScope.ShippingSameAsBilling?(n.addressesScope.shippingAddress=angular.copy(n.addressesScope.billingAddress),n.addressesScope.shippingAddress.Type=1):u.TrackEventItem({Type:TrackingEventType.CartCheckout1AddShipping}),n.addressesScope.SaveBillingAndShipping&&v()):l()};n.addressesScope.$on("AddressesScope.ValidateAddresses",function(t,r,u){n.addressesScope.ShowLoadingModal=u?!1:!0;c(n.addressesScope.ShowLoadingModal);n.addressesScope.ValidForm||l();r&&n.addressesScope.ValidForm&&i.$broadcast("RegistrationScope.SaveDetails")});n.addressesScope.$on("AddressesScope.SaveAddresses",function(){n.addressesScope.ShowLoadingModal=!0;n.addressesScope.SaveBillingAndShippingAddresses(!1)});n.addressesScope.$on("FormDirective.HidValidation",function(){n.addressesScope.billingAddressForm!=null&&(n.addressesScope.billingAddressForm.ServerErrors=[]);n.addressesScope.shippingAddressForm!=null&&(n.addressesScope.shippingAddressForm.ServerErrors=[]);n.addressesScope.ShowValidation&&(n.addressesScope.ShowValidation=!1)});n.addressesScope.HideShippingAddress=function(){$("#EditAddressModal").trigger("close");new w};n.addressesScope.GoToMyAccountHome=function(){location.href=n.addressesScope.Url.Action("Index","MyAccount")};n.addressesScope.requiredField=AVON.messages.validate_field_required;n.addressesScope.invalidEmailFormat=AVON.messages.validate_email_invalid;n.addressesScope.emailNotMatch=AVON.messages.validate_email_match;n.addressesScope.passwordInvalidFormat=AVON.messages.validate_password_invalid_format;n.addressesScope.passwordNotMatch=AVON.messages.validate_password_match;n.addressesScope.invalidNumber=AVON.messages.validate_invalid_number;n.addressesScope.invalidPhonenumber=AVON.messages.validate_invalid_phonenumber;n.addressesScope.$on("paymentController.RefreshWithPayPalAddress",function(t,i){i&&i.length==2&&(n.addressesScope.billingAddress=i[0],n.addressesScope.shippingAddress=i[1],n.addressesScope.originalBillingAddress=angular.copy(n.addressesScope.billingAddress),n.addressesScope.originalShippingAddress=angular.copy(n.addressesScope.shippingAddress),n.addressesScope.SafeApply())});n.addressesScope.$on("CustomerService.UpdateAddress",function(t,i){if(i.ErrorCode===1){n.addressesScope.RegistrationFullPageForm&&n.addressesScope.RedirectToUrl(n.addressesScope.Url.Action("BillingandShipping","Checkout"));n.addressesScope.ProcessAjaxValidationErrors(i);n.addressesScope.ShowValidation=!0;$.each(i.ValidationErrors,function(t,i){i.FieldName.indexOf("billingAddress")>-1&&(n.addressesScope.RequiredInvalidBilling=!0);i.FieldName.indexOf("shippingAddress")>-1&&(n.addressesScope.RequiredInvalidShipping=!0)});n.addressesScope.billingAddressForm.Zip.$invalid==!1&&(n.addressesScope.ShowZipErrorMessage=!0)}else n.addressesScope.RegistrationFullPageForm&&n.addressesScope.RedirectToUrl(n.addressesScope.Url.Action("Index","Checkout")),$(".IneligibleAutoReplenishment").trigger("close"),$("#EditAddressModal").trigger("close"),e()||(n.addressesScope.UpdateAvonAccountShipping=!1),n.addressesScope.UpdateAvonAccountBilling=!1,n.addressesScope.OrderInfoSaveBilling&&(n.addressesScope.UpdateAvonAccountBilling=n.addressesScope.OrderInfoSaveBilling),n.addressesScope.OrderInfoSaveShipping&&(n.addressesScope.UpdateAvonAccountShipping=n.addressesScope.OrderInfoSaveShipping),n.addressesScope.ShippingSameAsBillingPaymentForm=!1,n.addressesScope.ShowValidation=!1,n.addressesScope.RequiredInvalidBilling=!1,n.addressesScope.RequiredInvalidShipping=!1,n.addressesScope.originalBillingAddress=angular.copy(n.addressesScope.billingAddress),n.addressesScope.originalShippingAddress=angular.copy(n.addressesScope.shippingAddress),n.addressesScope.SafeApply()})}return __extends(i,t),i.$inject=["$scope","$rootScope","customerService","trackingService","bagService"],i}(BaseAngularController);n.AddressesCtrl=t}(AddressModule||(AddressModule={}));app.controller("AddressesController",AddressModule.AddressesCtrl),function(n){"use strict";n.allCategoryScope;var t=function(){function n(){this.Caption="";this.Title="";this.IconCode="";this.AlternativeText="";this.IconUrl="";this.IconColor="";this.Url="";this.Id=null;this.Target="";this.SortOrder=null;this.AdditionalLinks=null;this.GroupNames=null;this.GroupedChildren=null;this.Children=null;this.TopPromotionThumbnails=null;this.IncludeInTopNavigation=null;this.IncludeInTopBrandsNavigation=null;this.IncludeInAllBrandsPage=null;this.IncludeInLeftNavigation=null;this.AlphabetLetter=null;this.Type=""}return n}(),i=function(i){function r($scope,r){i.call(this,$scope);n.allCategoryScope=$scope;n.allCategoryScope.TopMenuItems=AVON.TopNavigation;n.allCategoryScope.AllBrands=[];r.GetFeaturedBrands();n.allCategoryScope.$on("NavigationService.MenuLoaded",function(i,r){var e,f,u,o;for(n.allCategoryScope.TopMenuItems=r.Data.TopMenuItems,angular.forEach(n.allCategoryScope.TopMenuItems,function(t){t.Type=="Brand"&&t.Caption&&t.Caption.length>0&&(t.IncludeInAllBrandsPage=t.IncludeInTopNavigation,t.AlphabetLetter=t.Caption.charAt(0).toUpperCase(),n.allCategoryScope.AllBrands.push(t));angular.forEach(t.GroupNames,function(i){(i.toLowerCase()=="brands"||i.toLowerCase()=="marcas")&&angular.forEach(t.GroupedChildren[i],function(t){t.IncludeInAllBrandsPage&&t.Caption&&t.Caption.length>0&&(t.AlphabetLetter=t.Caption.charAt(0).toUpperCase(),n.allCategoryScope.AllBrands.push(t))})})}),e=4,f=Math.ceil(n.allCategoryScope.AllBrands.length/4),n.allCategoryScope.AllBrands.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0}),n.allCategoryScope.AllBrandsColumnGrouped=[],u=0;u<e;u++)n.allCategoryScope.AllBrandsColumnGrouped[u]=n.allCategoryScope.AllBrands.slice(f*u,f*(u+1));o="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");angular.forEach(o,function(i){var u=_.where(n.allCategoryScope.AllBrands,{AlphabetLetter:i}).length,r;u===0&&(r=new t,r.AlphabetLetter=i,n.allCategoryScope.AllBrands.push(r))});n.allCategoryScope.AllBrandsAlphaGrouped=_.groupBy(n.allCategoryScope.AllBrands,"AlphabetLetter")})}return __extends(r,i),r.$inject=["$scope","NavigationService"],r}(BaseAngularController);n.AllCategoryController=i}(AllCategoryModule||(AllCategoryModule={}));app.controller("AllCategoryController",AllCategoryModule.AllCategoryController);EnglishMessages=function(){function n(){this.language="en";this.spinner_adding="Adding…";this.spinner_addingToBag="Adding item to bag…";this.spinner_addresses="Updating addresses…";this.spinner_coupon="Updating your Coupon Information…";this.spinner_facebook="Contacting Facebook";this.spinner_login="Signing In…";this.spinner_logout="Signing Out…";this.spinner_loading="Loading…";this.spinner_processing="Processing…";this.spinner_registering="Registering…";this.spinner_remove="Removing Item from bag…";this.spinner_saving="Saving…";this.spinner_searching="Searching…";this.spinner_subscribing="Subscribing…";this.spinner_updatingBag="Updating your bag…";this.spinner_vmo="Loading Virtual Makeover…";this.spinner_changingEmailAddress="Changing Email Address...";this.spinner_updatingEmailAddress="Updating Email Address...";this.spinner_unsubscribing="Unsubscribing...";this.notifyModal_enterValidEmail="Please enter a valid e-mail address";this.product_enterValidQty="You must specify a valid <b>quantity<\/b> of the product when adding to your bag";this.product_enterValidQtyMark="You must specify a valid <b>quantity<\/b> before adding to bag";this.productReviews_noReviewsAvailable="No reviews currently available";this.productTabs_readMore="Read More";this.productTabs_close="Close";this.commonscript_addedToBasketItemOne=" Item Added To Your Bag.";this.commonscript_addedToBasketItemsCount=" Items Added To Your Bag.";this.commonscript_shoppingCartLinkText="View Shopping Bag";this.commonscript_mustSpecifyVersionMsg="You must specify a version of the product when adding to your bag";this.shareemail_subject="Check out this AVON product";this.shareemail_body="[PRODUCTNAME]: [PRODUCTURL]";this.validate_email_required="Email address can not be blank";this.validate_email_invalid="Invalid email address";this.validate_password_required="Password can not be blank";this.validate_password_invalid_format="Password format is not valid";this.validate_password_match="The passwords do not match";this.validate_passwordhint_required="Password hint can not be blank";this.validate_field_required="The field is required";this.validate_email_match="The emails do not match";this.validate_invalid_number="Invalid number";this.validate_invalid_phonenumber="Please adjust your telephone number. Do not use dashes or other symbols, or start the area code with a 0 or 1.";this.English="English";this.Spanish="Spanish";this.coupon_no_change="Coupon Code is not applicable."}return n}();SpanishMessages=function(){function n(){this.language="es";this.spinner_adding="Carga…";this.spinner_addingToBag="Añadiendo a tu bolsa…";this.spinner_addresses="Actualizando direcciones…";this.spinner_coupon="Actualizando información del cupón";this.spinner_facebook="Contactando a Facebook";this.spinner_loading="Cargando…";this.spinner_processing="Procesando…";this.spinner_login="Iniciando sesión…";this.spinner_logout="Salir…";this.spinner_registering="Inscripción en proceso…";this.spinner_remove="Eliminación del artículo de cesta…";this.spinner_saving="Guardando…";this.spinner_searching="Búsqueda…";this.spinner_subscribing="Suscribirse…";this.spinner_updatingBag="Actualizando tu bolsa…";this.spinner_vmo="Cargando Maquillador Virtual…";this.spinner_changingEmailAddress="Cambiando correo electrónico...";this.spinner_updatingEmailAddress="Actualizando correo electrónico...";this.spinner_unsubscribing="Cancelando suscripción...";this.notifyModal_enterValidEmail="Por favor escribe un correo electrónico válido";this.product_enterValidQty="Debes especificar una <b>cantidad<\/b> válida del producto cuando agregas artículos a tu bolsa";this.product_enterValidQtyMark="You must specify a valid <b>quantity<\/b> before adding to bag";this.productReviews_noReviewsAvailable="No hay reseñas disponibles en este momento";this.productTabs_readMore="Seguir leyendo";this.productTabs_close="Contraer texto";this.commonscript_addedToBasketItemOne=" unidad añadida a tu bolsa.";this.commonscript_addedToBasketItemsCount=" unidades añadidas a tu bolsa.";this.commonscript_shoppingCartLinkText="¿Quieres pagar ahora?";this.commonscript_mustSpecifyVersionMsg="Debes especificar una versión válida del producto cuando lo añadas a tu bolsa";this.shareemail_subject="Mira este producto AVON";this.shareemail_body="[PRODUCTNAME]: [PRODUCTURL]";this.validate_email_required="Por favor, ingresa tu dirección de email";this.validate_email_invalid="Dirección de email no válida";this.validate_password_required="Por favor, ingresa tu contrasea tu contraseña";this.validate_password_invalid_format="Formato de password invalido";this.validate_password_match="Las contraseña no coincide";this.validate_passwordhint_required="La pista de contraseña no puede ser blanco";this.validate_field_required="El campo es obligatorio";this.validate_email_match="Los emails no coinciden";this.validate_invalid_number="Número invalido";this.validate_invalid_phonenumber="Ajuste por favor su número de teléfono. No use guiones u otros símbolos, o iniciar el código de área con un 1.";this.English="Inglés";this.Spanish="Español";this.coupon_no_change="El código de cupón no es aplicable."}return n}(),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.ShowModalUrl=function(n,t){t===void 0&&(t=!0);this.GetJson(n,!0,!1,!0,t).then(function(){})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ModalService=t}(ModalServiceModule||(ModalServiceModule={}));app.service("modalService",ModalServiceModule.ModalService);ResetPasswordModel=function(){function n(n,t,i,r,u,f){this.Id=n;this.SecurityToken=t;this.Email=i;this.Password=r;this.PasswordConfirm=u;this.PasswordHint=f}return n}(),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);this.displayForgotPassword=!1;this.forgotEmail="";t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.login=function(n,i,r){this.PostJson("/api/login/login",{loginModel:n},i).success(function(n){t.rootScope.$broadcast("LoginService.LoginResponse",n,r)}).error(function(n){t.rootScope.$broadcast("LoginService.LoginResponse",n,r)})},t.prototype.autoLogin=function(n,i){this.PostJson("/api/logIn/logIn",{loginModel:n},i).success(function(n){t.rootScope.$broadcast("LoginService.AutoLoginResponse",n)}).error(function(n){t.rootScope.$broadcast("LoginService.AutoLoginResponse",n)})},t.prototype.loginWIthFacebook=function(n,i,r){this.PostJson("/api/login/loginwithfacebook",{accessToken:n,password:i,returnUrl:r}).then(function(n){t.rootScope.$broadcast("LoginService.FacebookLoginResponse",n)})},t.prototype.registerWithFacebook=function(n,i,r){this.PostJson("/api/login/registerwithfacebook",{accessToken:n,notifySpecialOffers:i,returnUrl:r}).then(function(n){t.rootScope.$broadcast("LoginService.FacebookRegisterResponse",n)})},t.prototype.verifySingleSignOn=function(n){this.PostJson("/api/login/verifysinglesignon",{securityToken:n}).then(function(n){t.rootScope.$broadcast("LoginService.VerifySingleSignOnResponse",n)})},t.prototype.updatePrivacyPolicy=function(n){this.PostJson("/api/login/updateprivacypolicy",{privacyPolicyModel:n}).success(function(){}).error(function(){})},t.prototype.forgotPassword=function(n,i){this.PostJson("/api/login/forgotpassword",{email:i,returnUrl:n}).success(function(n){n!==null&&t.rootScope.$broadcast("LoginService.ForgotPasswordResponse",n)}).error(function(n){t.rootScope.$broadcast("LoginService.ForgotPasswordResponse",n)})},t.prototype.resetPassword=function(n,i){this.PostJson("/api/login/changepassword",{changePasswordModel:n},i).success(function(n){n!==null&&t.rootScope.$broadcast("LoginService.ResetPasswordResponse",n)}).error(function(n){t.rootScope.$broadcast("LoginService.ResetPasswordResponse",n)})},t.prototype.changePassword=function(n,i){this.PostJson("/api/login/changepassword",{changePasswordModel:n},i).success(function(n){n!==null&&t.rootScope.$broadcast("LoginService.ChangePasswordResponse",n)}).error(function(n){t.rootScope.$broadcast("LoginService.ChangePasswordResponse",n)})},t.prototype.sendNewPassword=function(n,i){this.PostJson("/api/login/sendnewpassword",{ForgotPasswordModel:{email:n}},i).success(function(n){n!==null&&t.rootScope.$broadcast("LoginService.SendNewPasswordResponse",n)}).error(function(n){t.rootScope.$broadcast("LoginService.SendNewPasswordResponse",n)})},t.prototype.sendPasswordHint=function(n,i){this.PostJson("/api/login/sendpasswordhint",{ForgotPasswordModel:{email:n}},i).success(function(n){n!==null&&t.rootScope.$broadcast("LoginService.SendPasswordHintResponse",n)}).error(function(n){t.rootScope.$broadcast("LoginService.SendPasswordHintResponse",n)})},t.prototype.logOut=function(n,t){t||(t="/");this.PostJson("/api/login/logout",{forgetCompletely:n,redirectUrl:t})},t.prototype.changeRepresentiveModal=function(n,i){this.PostJson("/api/login/changerep",{returnUrl:n,mode:"",cookieRepId:i}).success(function(n){n!==null&&t.rootScope.$broadcast("LoginService.ChangeRepModal",n)}).error(function(n){t.rootScope.$broadcast("LoginService.ChangeRepModal",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.LoginService=t}(LoginServiceModule||(LoginServiceModule={}));app.service("loginService",LoginServiceModule.LoginService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.getSubscribeMarkup=function(){this.GetHtml("/api/subscribe/getSubscribeMarkup",!0,!0,!1).then(function(n){t.rootScope.$broadcast("SubscribeService.SubscribeMarkupLoaded",n)})},t.prototype.setemailsignupcookie=function(){this.GetHtml("/api/subscribe/setemailsignupcookie",!0,!1,!1)},t.prototype.subscribeEmail=function(n,i){this.PostJson("/api/subscribe/subscribeemail",n,i).success(function(n){n!==null&&t.rootScope.$broadcast("SubscribeService.SubscribeResponse",n)}).error(function(n){t.rootScope.$broadcast("SubscribeService.SubscribeResponse",n)})},t.prototype.emailSignup=function(n,i){this.PostJson("/api/subscribe/emailsignup",n,i).success(function(n){n!==null&&t.rootScope.$broadcast("EmailSignupService.EmailSignupResponse",n)}).error(function(n){t.rootScope.$broadcast("EmailSignupService.EmailSignupResponse",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.SubscribeService=t}(SubscribeServiceModule||(SubscribeServiceModule={}));app.service("subscribeService",SubscribeServiceModule.SubscribeService),function(n){n.AvonScope;var t=function(t){function i(i,r,u,f,e,o,s,h,c,l,a,v){function b(){setTimeout(function(){n.AvonScope.OpenEmailSignupModal();a.EmailSignupModalDisplayed=!0},a.ShowEmailModalAfterSeconds*1e3)}function k(){var r=!1,t,i;if(n.AvonScope.QueryString().emailsignup==="0"||a.OdsIsDown||document.referrer.indexOf("avonrepresentative.com")>0||document.referrer.indexOf("youravon.com")>0||n.AvonScope.QueryString().c==="repPWP")return n.AvonScope.Session.Customer.IsNewVisitor&&!n.AvonScope.Session.Customer.EmailSignUpLastShown&&v.setemailsignupcookie(),!1;if(n.AvonScope.QueryString().emailsignup==="1"&&a.ShowEmailModalAfterSeconds>0)return!0;if(t=n.AvonScope.QueryString(),t.c&&(t.c.toUpperCase()==="EmailREP".toUpperCase()||t.c.toUpperCase()==="Email".toUpperCase()||t.c.toUpperCase()==="repPWP".toUpperCase())||t.otc&&t.otc.toUpperCase().indexOf("-retargeting".toUpperCase(),t.otc.length-t.otc.length)!==-1)return n.AvonScope.Session.Customer.IsNewVisitor&&!n.AvonScope.Session.Customer.EmailSignUpLastShown&&v.setemailsignupcookie(),!1;if(a.ShowEmailModalAfterSeconds>0&&n.AvonScope.Session.Customer.CustomerId===0)if(n.AvonScope.Session.Customer.IsNewVisitor&&!n.AvonScope.Session.Customer.EmailSignUpLastShown)r=!0;else if(n.AvonScope.Session.Customer.EmailSignUpLastShown){i=new Date;i.setDate(i.getDate()+a.HideEmailSignupModalForDays);var f=new Date(i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()).getTime(),e=/-?\d+/.exec(n.AvonScope.Session.Customer.EmailSignUpLastShown),u=new Date(parseInt(e[0])),o=new Date(u.getMonth()+1+"/"+u.getDate()+"/"+u.getFullYear()).getTime();o>=f&&(r=!0)}return r}var y,p,w;t.call(this,i);n.AvonScope=i;n.AvonScope.Redirecting=!1;n.AvonScope.bagService=r;n.AvonScope.LoginService=c;n.AvonScope.ModalService=l;n.AvonScope.$sce=f;n.AvonScope.campaign=AVON.campaign;n.AvonScope.messages=AVON.messages;n.AvonScope.ClientConfiguration=AVON.ClientConfiguration;n.AvonScope.cdn=o;n.AvonScope.SessionService=e;n.AvonScope.compileService=s;n.AvonScope.isPageComplete=!1;n.AvonScope.Url=h;n.AvonScope.IsPhantom=navigator.userAgent.match(/phantom/gi)!=null;n.AvonScope.PageTotalMinutes=0;n.AvonScope.PageIdleMinutes=0;n.AvonScope.SessionMinutes=0;n.AvonScope.YouTubeUrl="https://www.youtube.com/embed/";n.AvonScope.LoadOperationsCount=0;n.AvonScope.PaymentType=PaymentType;n.AvonScope.AjaxError=AjaxError;n.AvonScope.CanBuy=CanBuy;n.AvonScope.CreditCardDisplayMode=CreditCardDisplayMode;n.AvonScope.CreditCardType=CreditCardType;n.AvonScope.DeliveryType=DeliveryType;n.AvonScope.EmailSubscriptionSource=EmailSubscriptionSource;n.AvonScope.FindARepSearchType=FindARepSearchType;n.AvonScope.ImageType=ImageType;n.AvonScope.InterestType=InterestType;n.AvonScope.Month=Month;n.AvonScope.OrderStatus=OrderStatus;n.AvonScope.OrderType=OrderType;n.AvonScope.PaymentType=PaymentType;n.AvonScope.ShippingOptionCode=ShippingOptionCode;n.AvonScope.PromoConditionalRuleReason=PromoConditionalRuleReason;n.AvonScope.VariantType=VariantType;y=0;p=!1;$(document).ajaxSend(function(){y++});w=$('meta[name="viewport"]').attr("content");navigator.userAgent.match("CriOS")&&$('meta[name="viewport"]').attr("content",w+",initial-scale=1.0");$(document).ajaxComplete(function(){y>0&&(y--,y==0&&n.AvonScope.$broadcast("AvonController.AjaxCallsFinished"))});n.AvonScope.$on("AvonController.AjaxCallsFinished",function(){var t=$("#BodyContent");this.isMobile&&(t=$("#MainContainer"));t.waitForImages(function(){var t=window.location.hash.substring(1);!p&&window.location.hash.length>1&&$(t).length>0&&$(".LooksWeLoveModule .TipsModule").find(t).length==0&&_.delay(function(){p=!0;n.AvonScope.ScrollToTop($(t))},500);!p&&window.location.hash.length>1&&$(t).length>0&&$(".TipsModule").find(t).length>0&&_.delay(function(){p=!0;n.AvonScope.ScrollToTop($(t).closest(".TipsModule"))},500)},undefined,!0)});n.AvonScope.QueryString=function(){for(var i=window.location.search.substr(1).split("&"),r=[],t,n=0;n<i.length;++n)(t=i[n].split("="),t.length==2)&&(r[t[0]]=decodeURIComponent(t[1].replace(/\+/g," ")));return r};AVON.SessionModel?n.AvonScope.SessionService.UpdateModel(AVON.SessionModel):n.AvonScope.SessionService.Initialize();n.AvonScope.SetClientLanguage=function(t){t=="es"?(AVON.messages=new SpanishMessages,n.AvonScope.LanguageCode="es",AVON.LanguageCode="es"):(AVON.messages=new EnglishMessages,n.AvonScope.LanguageCode="en",AVON.LanguageCode="en")};$("html").hasClass("LangES")?n.AvonScope.SetClientLanguage("es"):n.AvonScope.SetClientLanguage("en");n.AvonScope.OpenYouTubeModal=function(t,i,r){var f=r||0,e=i?0:1,o="https://www.youtube.com/embed/"+t+"?autohide="+e+"&amp;start="+f+"&amp;rel=0&amp;wmode=transparent&autoplay=1",u=$("#MainContent").innerWidth()-160,s=u*.5625,h={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:o,UseIFrame:!0,IFrameWidth:u+"px",IFrameHeight:s+"px"};n.AvonScope.OpenDynamicModal("YouTubeModal",h)};n.AvonScope.OpenEmailSignupModal=function(){var t;n.AvonScope.OpenDynamicModal("EmailSignupModal",{AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/emailsignup"});t={Type:TrackingEventType.EmailPopupServed};u.TrackEventItem(t)};n.AvonScope.OpenDynamicModal=function(t,i,r){var u,f;$("#Modals #"+t).length==0&&(u=n.AvonScope,r&&(u=r),f=$("<div>",{id:t,modal:"{}"}),$("#Modals").append(f),s($("#"+t))(u));_.defer(function(){$("#"+t).trigger("modal",i)})};n.AvonScope.SessionService.WhenReady().then(function(){a.OnlyShowEmailSignupOnhomepage&&(top.location.pathname==="/es/"||top.location.pathname==="/")?k()&&new b:a.OnlyShowEmailSignupOnhomepage||k()&&new b});n.AvonScope.$on("ModalClosed",function(){a.EmailSignupModalDisplayed&&(v.setemailsignupcookie(),a.EmailSignupModalDisplayed=!1)});n.AvonScope.passwordRegularExpression=/(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{6,18})/;n.AvonScope.positiveIntegerRegularExpression=/^[1-9]\d*$/;n.AvonScope.mobileMenuClick=function(t,i){var r={Value:t,Element:i,Type:TrackingEventType.MobileMenuClick};n.AvonScope.$emit("TrackClick",r)};n.AvonScope.$on("ShowLoading",function(t,i){var r;if(n.AvonScope.loadingMessage=i,n.AvonScope.isLoading=!0,n.AvonScope.SafeApply(),$("body").addClass("ShowLoading"),$("#Loading #LoadingMessage").html(""),n.AvonScope.IsMobile==!1||n.AvonScope.IsMobile==undefined){r=$("#Loading > div");$("#Loading").height(Math.max($("body").height(),$(window).height()));var u=$(window).height(),f=$(window).scrollTop(),e=r.outerHeight(),o=Math.max(0,(u-e)/2+f)+"px";r.css("margin-top",o)}});n.AvonScope.$on("HideLoading",function(){n.AvonScope.isLoading=!1;n.AvonScope.SafeApply();$("body").removeClass("ShowLoading")});n.AvonScope.$on("Redirect",function(t,i){n.AvonScope.Redirecting=!0;_.defer(function(){AVON.common.redirectTo(i)})});n.AvonScope.$on("LoginService.VerifySingleSignOnResponse",function(t,i){i.Data===undefined&&(i=i.data);i.Data&&n.AvonScope.SessionService.GetPwpLogInPixel()});n.AvonScope.$on("BaseService.AjaxComplete",function(t,i){i&&(i.SessionModel?n.AvonScope.SessionService.UpdateModel(i.SessionModel):i.SessionHashes&&n.AvonScope.SessionService.UpdateIfOld(i.SessionHashes),(i.RedirectUrl==null||i.RedirectUrl=="")&&(i.HideLoading&&$("body").hasClass("ShowLoading")&&_.delay(function(){n.AvonScope.$broadcast("HideLoading")},50),_.defer(function(){return app.safeLoadImages($("body"))})))});n.AvonScope.$on("Confirmation.mobile.cshtml.TrackPayPalConfirmation",function(){if(n.AvonScope.IsMobile!==!1){var t={Type:TrackingEventType.MobileCheckoutSteps,Value:"CompletePurchase_Continue_PayPal_Success"};u.TrackEventItem(t)}});n.AvonScope.$on("TrackClick",function(n,t){u.TrackEventItem(t)});n.AvonScope.$on("LeavingVmo",function(n,t){var r,i;r=t.Value.toLowerCase();i=r.indexOf("english")>-1||r.indexOf("spanish")>-1;i?AVON.common.showModal("moveFromVmoDiv",400,100):AVON.common.showModal("moveFromVmoDiv",250,80);$("#moveFromVmo_ChangingLanguageMsg").css("display",i?"block":"none");$("#moveFromVmo_LeavingMsg").css("display",i?"none":"block");$("#moveFromVmoTargetUrl").text($(t.Element).attr("href"));$("#moveFromVmoOmnitureValue").text(t.Value)});n.AvonScope.ShowContactRepModal=function(t,i){var r,u;n.AvonScope.ShowLoading(AVON.messages.spinner_loading);AVON.ContactMeFormModel||(AVON.ContactMeFormModel={RepUrl:"",FirstName:"",LastName:"",EmailAddress:"",Phone:"",PhoneDay:"",PhoneEvening:"",Subject:"",Message:""});r="";t&&(AVON.ContactMeFormModel.RepUrl=t,r+="?repUrl="+t);i&&(AVON.ContactMeFormModel.Subject=i,r+=r.length>0?"&":"?",r+="subject="+i);u={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/contact/contactmeform"+r};n.AvonScope.OpenDynamicModal("ContactMeRepModal",u)};n.AvonScope.numberRange=function(n,t){return _.range(n,t+1)};n.AvonScope.$on("AvonController.ShowRepresentativeContactMeForm",function(t,i,r){n.AvonScope.ShowContactRepModal(i,r)});n.AvonScope.checkBoxKeyPress=function(n){var t=$(n.target).find("input");n.which==32?t.length>0&&(n.preventDefault(),t.attr("type")=="checkbox"&&_.defer(function(){t.trigger("click")})):n.which==13&&t.length>0&&(n.preventDefault(),_.defer(function(){t.parents("form").find(".HiddenSubmit").click()}))};n.AvonScope.ieSubmitKeyPress=function(n){var t=$(n.target);n.which==13&&$(".ie").length>0&&t.length>0&&(n.preventDefault(),_.defer(function(){t.parents("form").find(".HiddenSubmit").click()}))};n.AvonScope.ProcessPwpLogInLogOut=function(){parseInt(n.AvonScope.QueryString().dopwplogin)===1?n.AvonScope.SessionService.GetPwpLogInPixel():parseInt(n.AvonScope.QueryString().dopwplogout)===1&&n.AvonScope.SessionService.GetPwpLogOutPixel()};_.defer(function(){n.AvonScope.ProcessPwpLogInLogOut();var t=app.GetQuerystringParameterByName("videoId"),i=parseInt(app.GetQuerystringParameterByName("start"));t.length>0&&n.AvonScope.OpenYouTubeModal(t,!1,i)});n.AvonScope.$on("SessionService.PwpLogInLogOutPixelReceived",function(n,t){app.preloadImage(t)});n.AvonScope.$on("Do.ResetPageIdleTime",function(){n.AvonScope.PageIdleMinutes=0;n.AvonScope.SafeApply()});n.AvonScope.ExpandTooltipInfo=!1;n.AvonScope.CloseTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo=!1};n.AvonScope.OpenTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo=!0;n.AvonScope.ScrollIntoView($(".InfoPanel"))};n.AvonScope.ToggleTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo?n.AvonScope.CloseTooltipInfo():n.AvonScope.OpenTooltipInfo()};n.AvonScope.CenterModal=function(n){var i=$("#"+n).parent(),h=$(document).height(),f=$(window).height(),e=i.height(),r=i.width(),u=$(window).scrollTop(),o=u,s=h-e,t;i.css("margin-left","-"+r+"px");r=i.width();t=u+f*.1;e>f&&(t=u+5);t<o?t=o:t>s&&(t=s);i.css("top",t+"px");i.css("margin-left","-"+r/2+"px")};n.AvonScope.GetMaxHeight=function(n){var t=$(n).map(function(){var n=$(this).height();if(n>0)return n});return Math.max.apply(null,t)};n.AvonScope.ViewPrivacyPolicyUrl=function(t){n.AvonScope.IsMobile?n.AvonScope.RedirectToUrl(t):window.open(t,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};n.AvonScope.ViewConditionsOfUseUrl=function(t){n.AvonScope.IsMobile?n.AvonScope.RedirectToUrl(t):window.open(t,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};n.AvonScope.InitSizeAndOrientation=function(){var t=n.AvonScope.GetDevicePixelDensity();t>=2?$("html").addClass("HighDensity"):t>=1.5?$("html").addClass("MedDensity"):$("html").addClass("LowDensity");n.AvonScope.AdjustSize();window.addEventListener("resize",function(){_.throttle(n.AvonScope.AdjustSize(),100)});window.addEventListener("orientationchange",function(){n.AvonScope.OnPhoneOrientationChange()})};n.AvonScope.GetDevicePixelDensity=function(){var n=1;return window.devicePixelRatio!==undefined&&(n=window.devicePixelRatio),n};n.AvonScope.AdjustSize=function(){var n=$(window).width(),t=$(window).height(),i=Math.min(n,t),u=Math.max(n,t),r;i=Math.max(i,u*(9/16));r=(i/100*3).toFixed(2);$("html").css("font-size",r+"px");t>n?($("html").addClass("Portrait"),$("html").removeClass("Landscape")):($("html").addClass("Landscape"),$("html").removeClass("Portrait"))};n.AvonScope.OnPhoneOrientationChange=function(){var t=$(window);n.AvonScope.AdjustSize();n.AvonScope.$broadcast("AvonController.OrientationChange")};n.AvonScope.ModalCalled=!1;n.AvonScope.ShowImage=function(n,t){var i=$(n.currentTarget);i.prop("src",o.mediaImage(t))};this.initPage()}return __extends(i,t),i.prototype.initPage=function(){_.defer(function(){app.safeLoadImages($("body"))});$(function(){if(n.AvonScope.IsMobile=$("body").hasClass("Mobile"),n.AvonScope.IsMobile)$(document).on("focus","input",function(n){if($(n.currentTarget).prop("id")!="HeaderSearchInput"){if($(".CheckoutContainer").length){$(".CheckoutContainer").css("position","absolute");var t=-$(".CheckoutContainer").height()+$("#RepHeader").height();$(".CheckoutContainer").css("bottom",t)}$("html").hasClass("iphone")&&$("#FixedMenu").css("position","absolute")}}).on("blur","input",function(){$(".CheckoutContainer").length&&($(".CheckoutContainer").css("bottom",0),$(".CheckoutContainer").css("position","fixed"));$("html").hasClass("iphone")&&$("#FixedMenu").css("position","fixed")});if(typeof AVON.ShowOverlay=="string"&&AVON.ShowOverlay.length>0&&$("#"+AVON.ShowOverlay).trigger("modal"),n.AvonScope.IsMobile===!0){n.AvonScope.InitSizeAndOrientation();$("body").on("change","select",function(){$(this).blur()})}$("header").height($("#FixedMenu").height())});this.initTracking();_.delay(function(){n.AvonScope.isPageComplete=!0;n.AvonScope.$broadcast("AvonController.PageCompete")},2e3);setInterval(function(){if(n.AvonScope.PageTotalMinutes+=1,n.AvonScope.PageIdleMinutes+=1,n.AvonScope.SessionMinutes+=1,n.AvonScope.Session.Customer.IsLoggedIn){var t=n.AvonScope.ClientConfiguration.PageTimeout.PageTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes;window.location.toString().indexOf("/checkout")>-1&&(t=n.AvonScope.ClientConfiguration.PageTimeout.PaymentTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes);n.AvonScope.PageIdleMinutes==t&&($("#PageTimeoutWarningModal:visible").length!=0||n.AvonScope.Redirecting||n.AvonScope.ModalService.ShowModalUrl("/api/home/pagetimeoutwarningmodal",!1))}n.AvonScope.SessionMinutes>=n.AvonScope.ClientConfiguration.SessionTimeoutMinutes*.25&&(n.AvonScope.SessionMinutes=0,n.AvonScope.SessionService.KeepAlive());n.AvonScope.SafeApply()},6e4)},i.prototype.initTracking=function(){var t=this;_.defer(function(){t.initTrackingItem(AVON.trackingTop);t.initTrackingItem(AVON.trackingBottom);AVON.ComingFromPayPal&&n.AvonScope.$broadcast("Confirmation.mobile.cshtml.TrackPayPalConfirmation")})},i.prototype.initTrackingItem=function(n){n!=null&&(n.PageMarkup!=null&&$("body").append(n.PageMarkup),_.each(n.JavascriptFiles,function(n){var t=n;t=t.replace("~/","/");alert("Load script "+t);$.getScript(t)}),n.InlineJavascript!=null&&(alert("Load script "+n.InlineJavascript),$("body").append("<script>"+n.InlineJavascript+"<\/script")))},i.$inject=["$rootScope","bagService","trackingService","$sce","sessionService","cdnService","$compile","urlService","loginService","modalService","$window","subscribeService"],i}(BaseAngularController);n.AvonController=t}(AvonModule||(AvonModule={}));app.controller("AvonController",AvonModule.AvonController),function(n){"use strict";n.contactScope;var t=function(t){function i($scope,i,r){t.call(this,$scope);n.contactScope=$scope;n.contactScope.ContactMeFormModel=AVON.ContactMeFormModel;n.contactScope.invalidEmailFormat=AVON.messages.validate_email_invalid;n.contactScope.emailNotMatch=AVON.messages.validate_email_match;_.defer(function(){angular.element("#ContactMeFormModel_PhoneDayInput").placeholder();angular.element("#ContactMeFormModel_PhoneEveningInput").placeholder();$('textarea[name="Message"]').placeholder()},200);r.TrackEventItem({Type:TrackingEventType.HowMayIAssist});$scope.SendContactRequest=function(){n.contactScope.ContactMeForm.$valid?($scope.ShowLoading(""),i.SendContactRequest($scope.ContactMeFormModel)):n.contactScope.ShowValidation=!0};$scope.CloseThankYou=function(){$("#ContactMeThankYouModal").trigger("close")};$scope.$on("ContactService.ContactRequestResponse",function(){var t,i;$("#ContactMeRepModal").trigger("close");t={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/contact/contactmethankyou"};$scope.OpenDynamicModal("ContactMeThankYouModal",t,$scope);i={Type:TrackingEventType.HowMayIAssistThankYou,Data:n.contactScope.ContactMeFormModel.Subject};r.TrackEventItem(i)})}return __extends(i,t),i.$inject=["$scope","contactService","trackingService"],i}(BaseAngularController);n.ContactController=t}(ContactModule||(ContactModule={}));app.controller("ContactController",ContactModule.ContactController),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.notifyMe=function(n){this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&t.rootScope.$broadcast("ProductService.NotifyMeResponse",n)}).error(function(n){t.rootScope.$broadcast("ProductService.NotifyMeResponse",n)})},t.prototype.GetPromotionsWithIds=function(n){var i=this;n&&n.length>0?t.rootScope.SessionService.WhenReady().then(function(){for(var f,r,u=0;u<n.length;u+=25)f=n.slice(u,u+25),r="/api/promotions/getpromotions",r+="?language="+AVON.languageId,r+="&campaign="+AVON.campaign,r+="&attached="+t.rootScope.Session.Customer.IsAttached,r+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType,r+="&promotionIds="+f.join(","),i.GetJson(r,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductService.PromotionsLoaded",n)})}):t.rootScope.$broadcast("ProductService.PromotionsLoaded",null)},t.prototype.GetProductWithId=function(n){var i=this;n&&t.rootScope.SessionService.WhenReady().then(function(){var r="/api/products/getproduct";r+="?language="+AVON.languageId;r+="&campaign="+AVON.campaign;r+="&attached="+t.rootScope.Session.Customer.IsAttached;r+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;r+="&productId="+n;i.GetJson(r,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductService.ProductLoaded",n)})})},t.prototype.GetProductsWithIds=function(n){var i=this;n&&n.length>0?t.rootScope.SessionService.WhenReady().then(function(){for(var f,r,u=0;u<n.length;u+=25)f=n.slice(u,u+25),r="/api/products/getproducts",r+="?language="+AVON.languageId,r+="&campaign="+AVON.campaign,r+="&attached="+t.rootScope.Session.Customer.IsAttached,r+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType,r+="&productIds="+f.join(","),i.GetJson(r,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductService.ProductsLoaded",n)})}):t.rootScope.$broadcast("ProductService.ProductsLoaded",null)},t.prototype.GetProductLine=function(n,i){var r=this;n&&t.rootScope.SessionService.WhenReady().then(function(){var u="/api/products/getproductline";u+="?language="+AVON.languageId;u+="&campaign="+AVON.campaign;u+="&attached="+t.rootScope.Session.Customer.IsAttached;u+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;u+="&lineId="+n;u+="&takeAmount="+i;r.GetJson(u,!0,!0,!1).then(function(i){t.rootScope.$broadcast("ProductService.ProductLineLoaded",n,i)})})},t.prototype.GetProductLines=function(n){var f=this,i=[],u=[],r;for(r in n)i.push(r),u.push(n[r]);i.length>0&&t.rootScope.SessionService.WhenReady().then(function(){var n="/api/products/getproductlines";n+="?language="+AVON.languageId;n+="&campaign="+AVON.campaign;n+="&attached="+t.rootScope.Session.Customer.IsAttached;n+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;n+="&lineIds="+i.join(",");n+="&takeAmounts="+u.join(",");f.GetJson(n,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductService.ProductLinesLoaded",n)})})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ProductService=t}(ProductServiceModule||(ProductServiceModule={}));app.service("productService",ProductServiceModule.ProductService),function(n){var i=function(){function n(){return{require:"^carousel",restrict:"E",replace:!0,scope:!1,transclude:!0,link:function(n,t,i,r){var u=$(t);u.find("a[href],[ng-click],[data-ng-click],*").on("click",function(n){var t=r.$scope;t.clickEnabled||n.preventDefault()});_.defer(function(){r.update()});u.waitForImages(function(){r.$scope.slideLoaded();r.update()});n.$on("$destroy",function(){r.update()})},template:'<div class="Slide" ng-transclude><\/div>'}}return n}(),t;n.SlideDirective=i;t=function(){function n(n,t){return{restrict:"E",replace:!1,scope:!0,transclude:!0,controller:["$scope","$element",function($scope,$element){var o=this,r,u,i,f,e;this.$scope=$scope;$scope.container=$($element);$scope.isBrochure=!1;r=$scope.container.closest("div#brochure");r.length&&($scope.isBrochure=!0);$scope.isProductCarousel=!1;u=$scope.container.closest(".ProductCarousel");u.length&&($scope.isProductCarousel=!0);$scope.scrollClip=$scope.container.find(".ScrollClip");$scope.scrollContents=$scope.container.find(".ScrollContents");$scope.previousButton=$scope.container.find(".CarouselPrevious");$scope.nextButton=$scope.container.find(".CarouselNext");$scope.pageDots=$scope.container.find(".CarouselPages");$scope.wrapLeft=$scope.container.find(".WrapLeft");$scope.wrapRight=$scope.container.find(".WrapRight");$scope.animationSeconds=.3;$scope.currentIndex=0;$scope.clickEnabled=!0;$scope.slides=null;$scope.dragging=!1;$scope.hovered=!1;$scope.gutterSize=40;$scope.dragMultiply=+($scope.container.attr("drag-multiply")||1.4);$scope.scrollableSlideOffsetPercent=$scope.container.attr("scrollable-slide-offset-percent")||0;$scope.singleSlideAdvance=$scope.container.attr("single-slide-advance")==="true";$scope.snapEnabled=$scope.container.attr("snap")!=="false";$scope.autoAdvanceSeconds=+($scope.container.attr("auto-advance-seconds")||0);$scope.slidesVisibleRequested=+($scope.container.attr("slides-visible")||1);$scope.minSlideWidth=+($scope.container.attr("min-slide-width")||0);$scope.wrapRequested=($scope.container.attr("wrap")||"true")=="true";$scope.wrap=$scope.wrapRequested;$scope.imagesSlideLoaded=0;$scope.lastAccessedSlide=0;$scope.container.on("update",function(){$scope.update()});$scope.mouseEnter=function(){$scope.hovered=!0;$scope.stopAutoAdvanceTimer(!1)};$scope.mouseLeave=function(){$scope.hovered=!1;$scope.resetAutoAdvanceTimer()};$scope.onClick=function(){$scope.stopAutoAdvanceTimer(!0)};$scope.SafeApply=function(t){var i=n.$$phase;i=="$apply"||i=="$digest"?t&&typeof t=="function"&&t():$scope.$apply(t)};$scope.scrollTo=function(n,t,i){var u=$scope.gutterSize,f,e,r;$scope.slideCount<=$scope.slidesVisible&&(u=0);($scope.snapEnabled||i)&&(f=($scope.scrollContents.width()-2-$scope.slideWidth*$scope.slidesVisible+u)*-1,e=u,n<f?n=f:n>e&&(n=e));$scope.isBrochure&&(r=$($scope.scrollContents.find(".Slide")[$scope.GetSnapIndex()]).height(),$scope.lastAccessedSlide!=0&&$scope.lastAccessedSlide!=$scope.GetSnapIndex()&&(t&&$scope.scrollClip.animate({height:r}),$scope.scrollClip.height(r)),$scope.lastAccessedSlide=$scope.GetSnapIndex(),$scope.scrollClip.height()<r&&$scope.scrollClip.height(r));$scope.scrollContents.removeClass("Animate");t&&$scope.scrollContents.addClass("Animate");$scope.scrollContents.css("margin-left",n+"px");$scope.scrollX=n;_.delay(function(){$scope.animationComplete()},($scope.animationSeconds+.1)*1e3)};$scope.animationComplete=function(){$scope.snapEnabled?$scope.currentIndex<0&&$scope.currentIndex+$scope.slideCount<=$scope.maxIndex?$scope.showSlide($scope.currentIndex+$scope.slideCount,!1):$scope.currentIndex>$scope.maxIndex&&$scope.showSlide($scope.currentIndex-$scope.slideCount,!1):$scope.updateCarouselSlides()};$scope.showSlide=function(t,i,r){var u,f;r===void 0&&(r=!1);r&&$scope.stopAutoAdvanceTimer(!0);t=Math.min(t,$scope.maxIndex+$scope.wrapSlideCount);t=Math.max(t,0-$scope.wrapSlideCount);$scope.slideCount<=$scope.slidesVisible*2?i=i&&!0:$scope.currentIndex===0&&t===$scope.maxIndex?i=!1:$scope.currentIndex===$scope.maxIndex&&t===0?i=!1:$scope.currentIndex===t&&(i=!1);$scope.currentIndex=t;u=($scope.currentIndex+$scope.wrapSlideCount)*$scope.slideWidth*-1;u+=$scope.scrollableSlideOffsetPercent/100*$scope.slideWidth;$scope.scrollTo(u,i,!1);f=function(){t>0||$scope.wrap?$scope.previousButton.addClass("Active"):$scope.previousButton.removeClass("Active");t<$scope.maxIndex||$scope.wrap?$scope.nextButton.addClass("Active"):$scope.nextButton.removeClass("Active")};$scope.isProductCarousel&&$scope.imagesSlideLoaded>5?($scope.previousButton.addClass("Active"),$scope.nextButton.addClass("Active")):f();$scope.SafeApply();n.$broadcast("Carousel_SlideShown",$scope)};$scope.$on("Carousel_ShowSlide",function(n,t,i){$scope.showSlide(t,i)});$scope.$on("Carousel_ShowNext",function(){$scope.showNext()});$scope.$on("Carousel_ShowPrevious",function(){$scope.showPrevious()});$scope.$on("Carousel_Update",function(){$scope.update()});$scope.slideLoaded=function(){$scope.imagesSlideLoaded++};$scope.showNext=function(){var t=$scope.slidesVisible;$scope.singleSlideAdvance&&(t=1);var i=$scope.GetSnapIndex(),r=$scope.currentIndex+t,n=Math.max(i,r);n=Math.min(n,$scope.maxIndex+$scope.wrapSlideCount);$scope.showSlide(n,!0)};$scope.showPrevious=function(){var t=$scope.slidesVisible;$scope.singleSlideAdvance&&(t=1);var i=$scope.GetSnapIndex(),r=$scope.currentIndex-t,n=Math.min(i,r);n=Math.max(n,0-$scope.wrapSlideCount);$scope.showSlide(n,!0)};$scope.snapNearestSlide=function(){var n=$scope.GetSnapIndex();$scope.showSlide(n,!0)};$scope.updateCarouselSlides=function(){var t=$scope.scrollX;t<($scope.maxIndex+$scope.wrapSlideCount)*$scope.slideWidth*-1?(t=t+$scope.slideCount*$scope.slideWidth,$scope.scrollContents.css("margin-left",t+"px")):t>=$scope.gutterSize&&(t=t-$scope.slideCount*$scope.slideWidth,$scope.scrollContents.css("margin-left",t+"px"));$scope.scrollX=t;$scope.SafeApply();n.$broadcast("Carousel_SlideShown",$scope)};$scope.GetSnapIndex=function(){var n=$scope.scrollableSlideOffsetPercent/100*$scope.slideWidth;return Math.round(($scope.scrollX*-1+n)/$scope.slideWidth)-$scope.wrapSlideCount};$scope.clickEnable=function(n){n?_.delay(function(){$scope.clickEnabled=!0;$scope.container.addClass("ClickEnabled")},500):($scope.clickEnabled=!1,$scope.container.removeClass("ClickEnabled"))};$scope.handleHammer=function(n){var t,i,r,u,f;n.type=="tap"&&($scope.stopAutoAdvanceTimer(!0),t=$(n.target),i=t.closest("[ng-click],[data-ng-click],[onclick]",$scope.scrollContents[0]),i.length?i.trigger("click"):(r=t.closest("a[href]",$scope.scrollContents[0]),r.length&&$scope.RedirectToUrl(r.attr("href"),!0)));u=function(n,t){n.stopAutoAdvanceTimer(!0);n.clickEnable(!1);t?n.showNext():n.showPrevious();n.clickEnable(!0)};f=function(n,t){n.dragging!==!0&&(n.dragging=!0,n.dragStartX=n.scrollX,n.dragStartY=$(document).scrollTop(),n.clickEnable(!1),t&&n.stopAutoAdvanceTimer(t))};switch(n.type){case"panright":case"panleft":f($scope,!0);$scope.scrollTo($scope.dragStartX+n.deltaX*$scope.dragMultiply,!1,!0);break;case"panup":case"pandown":f($scope,!1);$(document).scrollTop($scope.dragStartY-n.deltaY);break;case"swipeleft":u($scope,!0);break;case"swiperight":u($scope,!1);break;case"panend":$scope.dragging&&($scope.dragging=!1,$scope.clickEnable(!0),$scope.snapEnabled?_.delay(function(){$scope.snapNearestSlide()},$scope.animationSeconds*1e3):$scope.updateCarouselSlides())}};$scope.stopAutoAdvanceTimer=function(n){$scope.autoAdvanceTimer&&clearInterval($scope.autoAdvanceTimer);n&&($scope.autoAdvanceSeconds=0)};$scope.resetAutoAdvanceTimer=function(){$scope.stopAutoAdvanceTimer(!1);$scope.autoAdvanceSeconds>0&&($scope.autoAdvanceTimer=setInterval(function(){var t=$("body");!t.hasClass("ModalVisible")&&!t.hasClass("ShowLoading")&&$scope.autoAdvanceSeconds>0&&$scope.dragging!==!0&&!n.Redirecting&&($scope.currentIndex<$scope.maxIndex||$scope.wrap?$scope.showNext():$scope.showSlide(0,!0))},$scope.autoAdvanceSeconds*1e3))};i=isMobile()?400:250;f=_.debounce(function(){$scope.stopAutoAdvanceTimer(!0);$scope.showPrevious()},i);$scope.previousClicked=function(){f()};e=_.debounce(function(){$scope.stopAutoAdvanceTimer(!0);$scope.showNext()},i);$scope.nextClicked=function(){e()};$scope.resetAutoAdvanceTimer();$scope.container.addClass("ClickEnabled");$scope.slideRange=function(){return $scope.maxIndex?_.range(0,$scope.maxIndex+1):[]};this.update=_.debounce(function(){var r,i,u,f;if($scope.slides=$scope.container.find(".Slides .Slide"),$scope.slideCount=$scope.slides.length,$scope.imagesSlideLoaded==$scope.slideCount&&($scope.imagesSlideLoaded=0,n.$broadcast("Carousel_ImagesLoaded",$scope)),$scope.scrollContents.hide(),$scope.container.css({visibility:"visible"}),$scope.carouselWidth=$scope.container.width(),!$scope.container.is(":Visible")||$scope.carouselWidth===0){_.delay(function(){o.update()},100);return}for($scope.slidesVisible=$scope.slidesVisibleRequested,$scope.slideWidth=$scope.carouselWidth/$scope.slidesVisible;$scope.slideWidth<$scope.minSlideWidth&&$scope.slidesVisible>1;)$scope.slidesVisible--,$scope.slideWidth=$scope.carouselWidth/$scope.slidesVisible;if($scope.slidesVisible>$scope.slideCount&&($scope.slidesVisible=$scope.slideCount,$scope.slideWidth=$scope.carouselWidth/$scope.slidesVisible),$scope.maxIndex=$scope.slideCount-$scope.slidesVisible,$scope.slideCount>$scope.slidesVisible?$scope.container.addClass("CanScroll"):$scope.container.removeClass("CanScroll"),$scope.isProductCarousel&&$scope.container.addClass("CanScroll"),$scope.slides.width($scope.slideWidth),$scope.wrapLeft.html(""),$scope.wrapRight.html(""),$scope.wrapSlideCount=0,$scope.wrap=$scope.wrapRequested&&$scope.slideCount>$scope.slidesVisible,$scope.wrap){for($scope.wrapSlideCount=$scope.slidesVisible+2,r=function(n,i){var r=$("<div class='Slide'>"+n+"<\/div>");r.find(".ng-scope").removeClass("ng-scope");t(r.find(".ProductSummaryName"))($scope);t(r.find(".ProductItemImage"))($scope);t(r.find(".OverlayContainer"))($scope);i?$scope.wrapRight.append(r):$scope.wrapLeft.append(r)},i=0;i<$scope.wrapSlideCount;i++)u=$scope.slides.eq($scope.slideCount-$scope.wrapSlideCount+i).html(),r(u,!1),f=$scope.slides.eq(i).html(),r(f,!0);$scope.wrapLeft.find(".Slide").width($scope.slideWidth);$scope.wrapRight.find(".Slide").width($scope.slideWidth)}$scope.scrollContents.width($scope.slideWidth*($scope.slideCount+$scope.wrapSlideCount*2)+2);$scope.scrollContents.show();$scope.showSlide($scope.currentIndex,!1);$scope.SafeApply();n.$broadcast("Carousel_Updated",$scope);$scope.container.addClass("Ready")},250,!1);$scope.update=this.update;$(window).resize(this.update)}],compile:function(){return{post:function(n,t){new Hammer(t[0],{}).on("tap panstart panmove panend panleft panright panup pandown swipeleft swiperight",n.handleHammer)}}},template:'<div class="ScrollClip" data-ng-mouseenter="mouseEnter()" data-ng-mouseleave="mouseLeave()" data-ng-click="onClick()">  <div class="ScrollContents">    <div class="WrapLeft"><\/div><div class="Slides" ng-transclude><\/div ><div class="WrapRight"><\/div>  <\/div> <\/div><div class="CarouselPrevious" data-ng-click="previousClicked()"><\/div><div class="CarouselNext" data-ng-click="nextClicked()"><\/div><nav data-ng-class="{CarouselPages:true, HasPages:(maxIndex > 0) }"><ol><li data-ng-repeat="slide in slideRange()" data-ng-click="showSlide($index, true, true)" data-ng-class="{Active:($index==currentIndex)}"><a><span>{{$index+1}}<\/span><\/a><li><\/ol><\/div><\/div>'}}return n}();n.CarouselDirective=t}(CarouselModule||(CarouselModule={}));app.directive("carousel",["$rootScope","$compile",CarouselModule.CarouselDirective]);app.directive("slide",CarouselModule.SlideDirective),function(n){"use strict";n.productScope;var t=function(t){function i($scope,i,r){var u,f;if(t.call(this,$scope),n.productScope=$scope,n.productScope.LoadedProducts={},n.productScope.LoadedProductLines={},n.productScope.LoadedPromotions={},n.productScope.StarCount=_.range(5),AVON.productList)for(u=0;u<AVON.productList.length;u++)n.productScope.LoadedProducts[AVON.productList[u].Id]=AVON.productList[u];n.productScope.$on("GlobalProductController.LoadPromotions",function(t,i){n.productScope.LoadPromotions(i)});n.productScope.LoadPromotions=function(n){_.defer(function(){i.GetPromotionsWithIds(n)})};n.productScope.$on("ProductService.PromotionsLoaded",function(t,i){var u,r;if(i&&i.Data){for(u=i.Data,r=0;r<u.length;r++)n.productScope.LoadedPromotions[u[r].PromotionId]=u[r],u[r].PromotionLinkProductId>0&&!n.productScope.LoadedProducts[u[r].PromotionLinkProductId]&&n.productScope.LoadProduct(u[r].PromotionLinkProductId);n.productScope.SafeApply()}});n.productScope.LoadProduct=function(t){t&&!n.productScope.LoadedProducts[t]&&_.defer(function(){i.GetProductWithId(t)})};n.productScope.$on("ProductService.ProductLoaded",function(t,i){i.Data&&(n.productScope.LoadedProducts[i.Data.Id]=i.Data,n.productScope.SafeApply())});n.productScope.LoadProducts=function(n){_.defer(function(){i.GetProductsWithIds(n)})};n.productScope.$on("ProductService.ProductsLoaded",function(t,i){var u,r;if(i&&i.Data){for(u=i.Data,r=0;r<u.length;r++)n.productScope.LoadedProducts[u[r].Id]=u[r];n.productScope.SafeApply()}});n.productScope.LoadProductLine=function(n,t){n&&n>0&&_.defer(function(){i.GetProductLine(n,t)})};n.productScope.$on("ProductService.ProductLineLoaded",function(t,i,r){var f,u;if(r.Data)for(f=r.Data,n.productScope.LoadedProductLines[i]=[],u=0;u<f.length;u++)n.productScope.LoadedProducts[f[u].Id]=f[u],n.productScope.LoadedProductLines[i].push(f[u].Id)});n.productScope.LoadProductLines=function(n){n&&i.GetProductLines(n)};n.productScope.$on("ProductService.ProductLinesLoaded",function(t,i){var u,e,r,o,f;if(i.Data){u=i.Data;for(e in u)if(r=parseInt(e),!n.productScope.LoadedProductLines[r]||!(n.productScope.LoadedProductLines[r].length>u[r].length)){n.productScope.LoadedProductLines[r]=[];for(o in u[r])f=u[r][parseInt(o)],n.productScope.LoadedProducts[f.Id]=f,n.productScope.LoadedProductLines[r].push(f.Id)}}});n.productScope.GetLoadedLineProduct=function(t,i){if(n.productScope.LoadedProductLines[t])return n.productScope.LoadedProducts[n.productScope.LoadedProductLines[t][i]]};n.productScope.GetLoadedLineProducts=function(t){var r=[],i;if(n.productScope.LoadedProductLines[t])for(i=0;i<n.productScope.LoadedProductLines[t].length;i++)r.push(n.productScope.LoadedProducts[n.productScope.LoadedProductLines[t][i]]);return n.productScope.TotalProducts=r.length,r};n.productScope.GetFullStarsFor=function(n){return new Array(Math.round(n.Rating))};n.productScope.GetEmptyStarsFor=function(n){return new Array(5-Math.round(n.Rating))};n.productScope.GetRatingArray=function(){return new Array(5)};n.productScope.GetProductPrice=function(n){return n.PriceModel?"$"+n.PriceModel.ListPrice.toFixed(2):""};n.productScope.GetProductSalePrice=function(n){return n.PriceModel?"$"+n.PriceModel.SalePrice.toFixed(2):""};n.productScope.ProductUrlFor=function(t){return n.productScope.Url.Action("Details","Product")+"/"+t.Id+"/"+t.SeoName};n.productScope.GoToProductPageFor=function(t){var i=n.productScope.ProductUrlFor(t);n.productScope.RedirectToUrl(i)};n.productScope.GoToProductPage=function(t,i){var r=n.productScope.Url.Action("Details","Product")+"/"+t;n.productScope.IsMobile||(r+="/"+i.trim().replace(" | AVON",""));$("carousel:not(.ClickEnabled)").length==0&&n.productScope.RedirectToUrl(r)};n.productScope.GoToPromotionLink=function(t){n.productScope.LoadedPromotions[t]?n.productScope.LoadedPromotions[t].PromotionLinkProductId>0?n.productScope.GoToProductPageFor(n.productScope.LoadedProducts[n.productScope.LoadedPromotions[t].PromotionLinkProductId]):n.productScope.LoadedPromotions[t].LandingPage.length>0?n.productScope.RedirectToUrl(n.productScope.LoadedPromotions[t].LandingPage):n.productScope.RedirectToUrl(n.productScope.Url.Action("Index","Promotions")+"/"+t):n.productScope.RedirectToUrl(n.productScope.Url.Action("Index","Promotions")+"/"+t)};n.productScope.ShowProductQuickView=function(t,i){var u,e,o;if($(".touch").length>0){n.productScope.RedirectToUrl(n.productScope.Url.Action("Details","Product")+"/"+t+"/"+i);return}u=n.productScope.Url.Action("quickshop","Product")+"/"+t+"/"+i;e={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:u};n.productScope.ShowLoading(AVON.messages.spinner_loading);n.productScope.OpenDynamicModal("QuickView",e);o={Type:TrackingEventType.QuickShopProductView};f===undefined&&(f=_.throttle(function(){_.delay(function(){return r.TrackEventItem(o)},1e3)},2e3,{leading:!1}));f()};$scope.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t,r;i.siblings("div").addClass("active");t=i.siblings(".Overlay.active");t.width(t.parent().width()-(t.outerWidth(!0)-t.width()));var u=$(".NavBar"),e=u.offset().left+u.innerWidth(),o=t.offset().left+t.innerWidth(),f=o-e;f>0&&t.css({"margin-left":-f});r=i.siblings(".RotatedCaret45.active");r.css({"margin-left":t.outerWidth(!0)/2-r.width()/2})};$scope.HidePromotionOverlay=function(n){var t=$(n.target);t.children(".active").removeClass("active");t.closest(".Expandable").removeClass("Expanded")};$scope.ShowNotifyOverlay=function(n){var t=$(n.target);t.parents(".OverlayContainer").find(".active").length>0?$scope.HideNotifyOverlay(n):(t.parents(".OverlayContainer").find("input").val($scope.Session.Customer.Email),$scope.ClearEmailValidation(n),$scope.ShowPromotionOverlay(n))};$scope.HideNotifyOverlay=function(n){var t=$(n.target);t.parents(".OverlayContainer").find(".active").removeClass("active");t.closest(".Expandable").removeClass("Expanded")};$scope.ClearEmailValidation=function(n){var t=$(n.target),i=t.parents(".NotifyMeOverlay.active");i.find(".NotifyMeOverlayForm .ErrorText").hide()};$scope.SendNotify=function(n,t){var u=$(n.target),r=u.parents(".NotifyMeOverlay.active"),f=u.parents(".NotifyMeOverlayForm").find("input").val(),o=/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(f),e;o?(e={Email:f,Fsc:"",ProductId:t.toString(),RepId:$scope.Session.Rep.Id},i.notifyMe(e),r.find(".NotifyMeOverlayForm").hide(),r.find(".NotifyMeOverlayThankYou").show(),_.delay(function(){$scope.HideNotifyOverlay(n)},3e3)):r.find(".NotifyMeOverlayForm .ErrorText").show()};$scope.GetVariantTypeText=function(n){return VariantType[n]};n.productScope.ShowProductSummaryPromotion=function(n){var t=$(n.target);t.hasClass("Expandable")&&(t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded"))};n.productScope.GoToPromotion=function(t){var i;n.productScope.ShowLoading(null);i=n.productScope.LoadedPromotions[t].PromotionLinkProductId>0?n.productScope.ProductUrlFor(n.productScope.LoadedProducts[n.productScope.LoadedPromotions[t].PromotionLinkProductId]):n.productScope.LoadedPromotions[t].LandingPage.length>0?n.productScope.LoadedPromotions[t].LandingPage:n.productScope.Url.Action("Index","Promotions",t);n.productScope.RedirectToUrl(i)};n.productScope.WriteAReview=function(t){t.preventDefault();n.productScope.ShowLoading(AVON.messages.spinner_loading);var i=$(t.currentTarget).attr("href");n.productScope.Session.Customer.IsLoggedIn?AVON.common.redirectTo(i):n.productScope.IsMobile?document.location.href="/signin?ReturnUrl="+encodeURIComponent(i):(AVON.RedirectToPowerReviews=!0,AVON.PowerReviewLink=i,$("#LoginModal").trigger("modal"))};n.productScope.$on("Carousel_SlideShown",function(n,t){t.container.find(".Expandable").removeClass("Expanded");t.container.find(".SingleExpandable").removeClass("Expanded")});_.defer(function(){var r=[],i,t;$("#MainContainer").find("[data-promotionid]:not([data-promotionid=''])").each(function(){var n=parseInt($(this).attr("data-promotionid"),10);n>0&&r.push(n)});$("#MainContainer").find("[data-promotionidlist]:not([data-promotionidlist=''])").each(function(){var n=$(this).attr("data-promotionidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);t>0&&r.push(t)})});n.productScope.LoadPromotions(r);i=[];$("#MainContainer").find("[data-productid]:not([data-productid=''])").each(function(){var n=parseInt($(this).attr("data-productid"),10);n>0&&i.push(n)});$("#MainContainer").find("[data-productidlist]:not([data-productidlist=''])").each(function(){var n=$(this).attr("data-productidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);t>0&&i.push(t)})});n.productScope.LoadProducts(i);t={};$("#MainContainer").find("[data-lineid]:not([data-lineid=''])").each(function(){var n=parseInt($(this).attr("data-lineid"),10),i;n>0&&($(this).attr("data-lineamount")?(i=parseInt($(this).attr("data-lineamount"),10),(t[n]==null||i===0||t[n]!==0&&t[n]<i)&&(t[n]=i)):t[n]=0)});n.productScope.LoadProductLines(t)})}return __extends(i,t),i.$inject=["$scope","productService","trackingService"],i}(BaseAngularController);n.GlobalProductController=t}(ProductModule||(ProductModule={}));app.controller("GlobalProductController",ProductModule.GlobalProductController),function(n){"use strict";var t=function(n){function t($scope,$element,t,i){n.call(this,$scope);var r=$scope,u=$($element);this.trackingService=t;this.bagService=i;r.HandleMessageRecieved=function(n){var t,i,u;if(n&&n.data){t=JSON.parse(n.data);i=t.action;i||(i="vmoaddtobag");switch(i.toLowerCase()){case"vmoaddtobag":r.HandleVmoAddToBag(t);break;case"getbag":r.HandleGetBag();break;case"showloading":r.HandleShowLoading(t.payload);break;case"hideloading":r.HideLoading();break;case"scroll":window.scrollTo(0,0);break;case"signin":u=t.securitykey;u&&r.LoginService.verifySingleSignOn(u)}}};r.HandleGetBag=function(){r.ShowLoading(AVON.messages.spinner_loading);r.bagService.getBag()};r.$on("BagService.GetBagSuccess",function(){r.HideLoading()});r.IsTabletDevice=function(){return r.IsTouchDevice()&&$(".no-iphone.no-ipad.no-android").length==0};r.HandleShowLoading=function(n){n||(n=AVON.messages.spinner_loading);r.ShowLoading(n)};r.HandleVmoAddToBag=function(n){r.ShowLoading(AVON.messages.spinner_addingToBag);var t=[];angular.forEach(n,function(n){var i=new AddBagItem;i.Quantity=n.Quantity===undefined?1:n.Quantity;i.Sku=n.sku;i.OrderType="VM";t.push(i)});r.bagService.addMultipleItemsToBag(t,!1)};$(function(){var n=document.createElement("a"),t,i;n.href=u.find("iframe").attr("src");t=n.protocol+"//"+n.hostname+"/proxy.html";i=new Porthole.WindowProxy(t,"iFrameContainer");i.addEventListener($scope.HandleMessageRecieved)})}return __extends(t,n),t.$inject=["$scope","$element","trackingService","bagService"],t}(BaseAngularController);n.MiniSiteController=t}(MiniSiteModule||(MiniSiteModule={}));app.controller("MiniSiteController",MiniSiteModule.MiniSiteController),function(n){var i=function(){function n(){}return n}(),t;n.ProductAddModel=i;n.notifyMeScope;t=function(t){function i($scope,i,r){t.call(this,$scope);n.notifyMeScope=$scope;n.notifyMeScope.NotifyMeModel={Email:"",Fsc:"",ProductId:"",RepId:0};n.notifyMeScope.product=AVON.product;n.notifyMeScope.SessionService.WhenReady().then(function(){n.notifyMeScope.NotifyMeModel.Email=n.notifyMeScope.Session.Customer.Email;$("#NotifyMeModel_EmailInput").val(n.notifyMeScope.NotifyMeModel.Email);n.notifyMeScope.SafeApply()});n.notifyMeScope.NotifyMeSubmit=function(t){n.notifyMeScope.NotifyMeForm.$valid?(n.notifyMeScope.ShowValidation=!1,n.notifyMeScope.ShowLoading(AVON.messages.spinner_saving),n.notifyMeScope.NotifyMeModel.Email=$("#NotifyMeModel_EmailInput").val(),n.notifyMeScope.NotifyMeModel.Fsc=$("#NotifyMeModel_Fsc").val(),n.notifyMeScope.NotifyMeModel.ProductId=$("#NotifyMeModel_ProductId").val(),n.notifyMeScope.NotifyMeModel.RepId=$("#NotifyMeModel_RepId").val(),t?i.notifyMeQuickShop(n.notifyMeScope.NotifyMeModel,$("form[name=NotifyMeForm]")):i.notifyMe(n.notifyMeScope.NotifyMeModel,$("form[name=NotifyMeForm]"))):(n.notifyMeScope.ShowValidation=!0,n.notifyMeScope.TrackUserValidationErrors(n.notifyMeScope.NotifyMeForm.$error))};n.notifyMeScope.TrackUserValidationErrors=function(t){if(n.notifyMeScope.IsMobile!==!1){var i=[];t&&$.each(t,function(n,t){t&&(i.push("err-"+n),$.each(t,function(n,t){i.push(t.$name)}))});i=null}};n.notifyMeScope.NotifyMeThanksSubmit=function(){$("#NotifyMeSuccessModal").trigger("close")};n.notifyMeScope.$on("NotifyMeService.NotifyMeResponse",function(t,i){if(i.ErrorCode===1&&n.notifyMeScope.ProcessAjaxValidationErrors(i),i.ErrorCode===0){$("#ContentModal").trigger("close");$("#NotifyMeModal").trigger("close");n.notifyMeScope.ShowLoading(AVON.messages.spinner_loading);$("#NotifyMeSuccessModal").trigger("modal");var u={Type:TrackingEventType.NotifyMeThankYouProddetails};r.TrackEventItem(u)}});n.notifyMeScope.$on("NotifyMeService.NotifyMeQuickShopResponse",function(t,i){i.ErrorCode===1?(n.notifyMeScope.ProcessAjaxValidationErrors(i),n.notifyMeScope.HideLoading(),n.notifyMeScope.ShowValidation=!0,n.notifyMeScope.NotifyMeForm.$invalid=!0):($("#NotifyMeContainer").hide(),$(".NotifyMeQuickShopForm .NotAvailableMessage").hide(),$("#NotifyMeSuccessQuickViewContainer").show(),setTimeout(function(){$(".NotifyMeQuickShopForm").hide();$("#NotifyMeSuccessQuickViewContainer").hide();n.notifyMeScope.product.Availability===1?($(".NotifyMeContainer").hide(),$(".NotifyMeQuickShopForm .NotAvailableMessage").show(),$(".AddToBagContainer").show()):($(".AddToBagContainer").hide(),$(".NotifyMeContainer").show(),$(".NotAvailableMessage").show(),$(".NotifyMeButton").show());$scope.SafeApply()},4e3))})}return __extends(i,t),i.$inject=["$scope","NotifyMeService","trackingService"],i}(BaseAngularController);n.NotifyMeController=t}(NotifyMeModule||(NotifyMeModule={}));app.controller("NotifyMeController",NotifyMeModule.NotifyMeController),function(n){"use strict";n.PageTimeoutWarningScope;var t=function(t){function i(i,$scope,r,u,f){t.call(this,$scope);n.PageTimeoutWarningScope=$scope;n.PageTimeoutWarningScope.SecondsRemaining=$scope.ClientConfiguration.PageTimeout.WarningMinutes*60;n.PageTimeoutWarningScope.LoginService=f;n.PageTimeoutWarningScope.RedirectUrl="/?overlay=PageTimeout";window.location.toString().indexOf("checkout")>-1&&(n.PageTimeoutWarningScope.RedirectUrl=n.PageTimeoutWarningScope.IsMobile?$scope.Url.Action("Index","Login")+"?mode=checkout&overlay=PageTimeout":$scope.Url.Action("SignIn","Checkout")+"?overlay=PageTimeout");$scope.ContinueClicked=function(){clearInterval(n.PageTimeoutWarningScope.countdownTimer);$("#PageTimeoutWarningModal").remove();$("#AjaxModal").trigger("close");i.$broadcast("Do.ResetPageIdleTime")};n.PageTimeoutWarningScope.Countdown=function(){n.PageTimeoutWarningScope.SecondsRemaining=n.PageTimeoutWarningScope.SecondsRemaining-1;n.PageTimeoutWarningScope.SafeApply();n.PageTimeoutWarningScope.SecondsRemaining<1?(clearInterval(n.PageTimeoutWarningScope.countdownTimer),n.PageTimeoutWarningScope.Redirecting||n.PageTimeoutWarningScope.LoginService.logOut(!1,n.PageTimeoutWarningScope.RedirectUrl)):n.PageTimeoutWarningScope.countdownTimer=setTimeout(n.PageTimeoutWarningScope.Countdown,1e3)};n.PageTimeoutWarningScope.countdownTimer=setTimeout(n.PageTimeoutWarningScope.Countdown,1e3)}return __extends(i,t),i.$inject=["$rootScope","$scope","contactService","trackingService","loginService"],i}(BaseAngularController);n.PageTimeoutWarningController=t}(PageTimeoutWarningModule||(PageTimeoutWarningModule={}));app.controller("PageTimeoutWarningController",PageTimeoutWarningModule.PageTimeoutWarningController),function(n){n.productAddedToBagScope;var t=function(t){function i($scope,i,r){function u(t){for(var i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[i].Number===t)return i}t.call(this,$scope);n.productAddedToBagScope=$scope;n.productAddedToBagScope.product=AVON.product;n.productAddedToBagScope.AddToBagResult=AVON.TempModalModel;n.productAddedToBagScope.CampaignIndexInCart=u(n.productAddedToBagScope.Session.Customer.Campaign);r.TrackEventItem({Type:TrackingEventType.ViewShoppingBagModal});var f=0;$scope.$on("ProductService.ProductsLoaded",function(n,t){t.Data.forEach(function(n){angular.element("#ProductAddedToBag .CrossSellContent .ProductItemContainer").each(function(){if(angular.element(this).attr("data-productid")==n.Id)return f++,!0})});f===0&&angular.element("#ProductAddedToBag .CrossSellSection").hide()});n.productAddedToBagScope.VariantName=function(t){var r,i;try{for(r=u(n.productAddedToBagScope.Session.Customer.Campaign),i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns[r].Items.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].Fsc===t&&n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName)return n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName.replace("Shade: ","")}catch(f){}return""};n.productAddedToBagScope.VariantType=function(t){var r,i;try{for(r=u(n.productAddedToBagScope.Session.Customer.Campaign),i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns[r].Items.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].Fsc===t&&n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName)return n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantType}catch(f){}return""};n.productAddedToBagScope.TotalQuantity=function(){for(var i=0,t=0;t<n.productAddedToBagScope.AddToBagResult.ItemsAdded.length;t++)i+=n.productAddedToBagScope.AddToBagResult.ItemsAdded[t].Quantity;return i};n.productAddedToBagScope.PayWithPal=function(){$("#AjaxModal").trigger("close");n.productAddedToBagScope.ShowLoading(AVON.messages.spinner_loading);n.productAddedToBagScope.OpenDynamicModal("PayPalExpressModal",{AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/paypal/confirm"})};n.productAddedToBagScope.ShowPromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]),i,r;t.siblings("div").addClass("active");i=t.siblings(".Overlay.active");i.width(t.width()-(i.outerWidth(!0)-i.width()));r=t.siblings(".RotatedCaret45.active");r.css({"margin-left":t.width()/2-r.width()/2})};n.productAddedToBagScope.HidePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")};n.productAddedToBagScope.$on("ModalClosed",function(){i.$broadcast("ProductAddedToBagModalClosed")});n.productAddedToBagScope.PromotionActive=function(){var i=!1,r=0,t;if(n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart])for(t=0;t<n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items.length;t++)n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items[t].PfId===n.productAddedToBagScope.product.Id&&(r+=n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items[t].Quantity);return n.productAddedToBagScope.AddToBagResult.ProductPromotions.length>0&&r>=n.productAddedToBagScope.AddToBagResult.ProductPromotions[0].ConditionMinAmount&&(i=!0),i}}return __extends(i,t),i.$inject=["$scope","$rootScope","trackingService"],i}(BaseAngularController);n.ProductAddedToBagController=t}(ProductDetailModule||(ProductDetailModule={}));app.controller("ProductAddedToBagController",ProductDetailModule.ProductAddedToBagController),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.LoadCategoryHeroSpot=function(n,i,r){var u="/api/content/category";u+="?language="+AVON.languageId;u+="&campaignNumber="+AVON.campaign;u+="&level2="+n.formatUrlNugget();u+="&level3="+i.formatUrlNugget();u+="&level4="+r.formatUrlNugget();this.GetHtml(u,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductListService.HeroSpotLoaded",n)})},t.prototype.LoadCategoryPromoSpots=function(n,i,r){if(n.length>0&&i.length>0){var u="/api/content/category/json";u+="?language="+AVON.languageId;u+="&campaignNumber="+AVON.campaign;u+="&level2="+n.formatUrlNugget();u+="&level3="+i.formatUrlNugget();u+="&level4="+r.formatUrlNugget();this.GetJson(u,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductListService.ProductSpotsLoaded",n.Data)})}},t.prototype.GetProductsInCategory=function(n){var i=this;n&&t.rootScope.SessionService.WhenReady().then(function(){var r="/api/products/getproductsincategory";r+="?language="+AVON.languageId;r+="&campaign="+AVON.campaign;r+="&attached="+t.rootScope.Session.Customer.IsAttached;r+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;r+="&catId="+n;i.GetJson(r,!0,!0,!1).then(function(n){t.rootScope.$broadcast("ProductListService.ProductCategoryLoaded",n.Data)})})},t.prototype.GetProductsBySearch=function(n){var i="/api/search/getproductsbysearch/"+n;n.trim().length===0&&(i="/api/search/getproductsforemptysearch/");this.GetJson(i,!0,!1,!1).then(function(n){n.Data.RedirectionUrl!==undefined&&n.Data.RedirectionUrl!==null?t.rootScope.$broadcast("ProductListService.ProductSearchRedirection",n.Data.RedirectionUrl):t.rootScope.$broadcast("ProductListService.ProductSearchLoaded",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ProductListService=t}(ProductListServiceModule||(ProductListServiceModule={}));app.service("productListService",ProductListServiceModule.ProductListService),function(n){var t=function(n){function t(t,$scope,i,r,u){function o(){var n=$("#model-values");return{showMoreProductsAfter:n.data("showMoreProductsAfter"),loadHowManyProducts:n.data("loadHowManyProducts"),productsLookup:n.data("productsLookup"),categoriesLookup:n.data("categoriesLookup"),productLineId:n.data("productLineId"),displaySortControl:n.data("displaySortControl")}}function e(n,t){if(t===void 0&&(t=!1),n){var i;i=t===!0?n.Products:n.Data;i.forEach(function(n){$scope.products.push(n)})}}n.call(this,$scope);$scope.products=[];$scope.promoSpots=[];AVON.LeftNavigation&&AVON.LeftNavigation.MenuItems&&AVON.LeftNavigation.MenuItems[0]&&($scope.promoSpots=AVON.LeftNavigation.MenuItems[0].ProductPromotionSpots);var f=o();$scope.showMoreProductsAfter=f.showMoreProductsAfter;$scope.loadHowManyProducts=f.loadHowManyProducts;$scope.productsLookup=f.productsLookup;$scope.categoriesLookup=f.categoriesLookup;$scope.productLineId=f.productLineId;$scope.displaySortControl=f.displaySortControl;r.GetProductLine($scope.productLineId,0);u.GetProductsInCategory($scope.categoriesLookup[$scope.categoriesLookup.length-1]);$scope.$on("ProductService.ProductsLoaded",function(n,t){t.Data.forEach(function(n){var t=$.inArray(n.Id,$scope.productsLookup);t>=0&&($scope.products.push(n),$scope.productsLookup.splice(t,1))})});$scope.$on("ProductService.ProductLineLoaded",function(n,t,i){e(i)});$scope.$on("ProductListService.ProductCategoryLoaded",function(n,t){e(t,!0)});$scope.isSortControlShown=function(){return $scope.products.length===0?!1:$scope.displaySortControl};$scope.showMoreButton=function(){return $scope.products.length>$scope.showMoreProductsAfter};$scope.ExpandedAddToBagId=null;angular.forEach($scope.products,function(n){n.Name=$scope.SecureHtml(n.Name)});$scope.IncreaseShowProductCount=function(){$scope.showMoreProductsAfter+=$scope.loadHowManyProducts;$scope.SafeApply()};$scope.getSortingCriteria=function(){switch($scope.sortingCriteria){case"Price":return["-IsAvailable","PriceModel.ListPrice","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Rating":return["-IsAvailable","-HasRating","-Rating","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Name":return["-IsAvailable","Name","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];default:return["-IsAvailable","ListIndex","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"]}};$scope.GoToProductPage=function(n,t){$scope.RedirectToUrl($scope.Url.Action("Details","Product")+"/"+n+"/"+t)};$scope.GetSimplePromoSpot=function(n,t){for(var i=0;i<$scope.promoSpots.length;i++)if($scope.promoSpots[i].IndexLocation==n||t&&$scope.promoSpots[i].IndexLocation>=n)return $scope.promoSpots[i];return null};$scope.AddToBag=function(n,t){var u=n.Sku,r;n.SelectedVariantSku&&(u=n.SelectedVariantSku);r=new AddBagItem;r.Quantity=t||1;r.Sku=u;r.Id=n.Id;AVON.product=n;$scope.ShowLoading(AVON.messages.spinner_adding);i.addItemToBag(r,!0)};$scope.ToggleAddToBag=function(n){$scope.ExpandedAddToBagId=$scope.ExpandedAddToBagId==n?null:n};$scope.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t=$(i).parents(".ProductSummary").find(".Expandable");t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded")};$scope.SortChanged=function(){$scope.SafeApply()};_.defer(function(){$scope.$watch("products",function(){_.defer(function(){app.safeLoadImages($(".SimpleProductList"))})},!0)})}return __extends(t,n),t.$inject=["$rootScope","$scope","bagService","productService","productListService"],t}(BaseAngularController);n.ProductListModuleController=t}(ProductListControlModule||(ProductListControlModule={}));app.controller("ProductListModuleController",ProductListControlModule.ProductListModuleController),function(n){var t=function(n){function t(t,$scope,$element,i){n.call(this,$scope);$scope.products=[];$scope.mySimpleProductList=[];$scope.promoSpots=[];AVON.LeftNavigation&&AVON.LeftNavigation.MenuItems&&AVON.LeftNavigation.MenuItems[0]&&($scope.promoSpots=AVON.LeftNavigation.MenuItems[0].ProductPromotionSpots);$scope.ExpandedAddToBagId=null;$scope.AddToBagClientSideValidationError=!1;angular.forEach($scope.products,function(n){n.Name=$scope.SecureHtml(n.Name)});$scope.showProductCount=20;$scope.SessionService.WhenReady().then(function(){$scope.showProductCount=$scope.ClientConfiguration.ProductListPageSize;$scope.SafeApply()});$scope.IncreaseShowProductCount=function(){$scope.showProductCount+=$scope.ClientConfiguration.ProductListPageSize;$scope.SafeApply()};$scope.getSortingCriteria=function(){switch($scope.sortingCriteria){case"Price":return["-IsAvailable","PriceModel.ListPrice","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Rating":return["-IsAvailable","-HasRating","-Rating","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Name":return["-IsAvailable","Name","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];default:return["-IsAvailable","-IsNew","ListIndex","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"]}};$scope.GoToProductPage=function(n,t){if($(".ie").length>0){var i=[];$("div[data-product-summary-id]").each(function(){var n=parseInt($(this).attr("data-product-summary-id"),10);n>0&&i.push(n)});window.sessionStorage.ListedProductsIdsOrder=JSON.stringify(i)}$scope.RedirectToUrl($scope.Url.Action("Details","Product")+"/"+n+"/"+t)};$scope.GetSimplePromoSpot=function(n,t){for(var i=0;i<$scope.promoSpots.length;i++)if($scope.promoSpots[i].IndexLocation==n||t&&$scope.promoSpots[i].IndexLocation>=n)return $scope.promoSpots[i];return null};$scope.AddToBag=function(n,t){var u,r;if(!n.SelectedVariantSku){$scope.AddToBagClientSideValidationError=!0;return}$scope.AddToBagClientSideValidationError=!1;u=n.Sku;n.SelectedVariantSku&&(u=n.SelectedVariantSku);r=new AddBagItem;r.Quantity=t||1;r.Sku=u;r.Id=n.Id;AVON.product=n;$scope.ShowLoading(AVON.messages.spinner_adding);i.addItemToBag(r,!0)};$scope.ShadeChanged=function(){_.defer(function(){$scope.AddToBagClientSideValidationError=!1;$scope.SafeApply()})};$scope.ToggleAddToBag=function(n){$scope.ExpandedAddToBagId==n?($scope.ExpandedAddToBagId=null,$scope.ShadeChanged()):$scope.ExpandedAddToBagId=n};$scope.ShowPromotionOverlay=function(n){var f,i,r,t,u;if($scope.IsMobile){f=$(angular.element(n.currentTarget)[0]);i=$(f).parents(".ProductSummary").find(".Expandable");i.hasClass("Expanded")?i.removeClass("Expanded"):i.addClass("Expanded");return}r=$(angular.element(n.currentTarget)[0]);r.siblings("div").addClass("active");t=r.siblings(".Overlay.active");t.width(t.parent().width()-(t.outerWidth(!0)-t.width()));u=r.siblings(".RotatedCaret45.active");u.css({"margin-left":t.outerWidth(!0)/2-u.width()/2})};$scope.HidePromotionOverlay=function(n){var t,i;if($scope.IsMobile){t=$(angular.element(n.currentTarget)[0]);$(t).parents(".Expandable.Expanded").removeClass("Expanded");return}i=$(angular.element(n.currentTarget)[0]);i.children(".active").removeClass("active")};$($element[0]).find("[data-productidlist]:not([data-productidlist=''])").each(function(){var n=$(this).attr("data-productidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);$scope.mySimpleProductList.push(t)})});$scope.$on("ProductService.ProductsLoaded",function(n,t){var i=t.Data;i.forEach(function(n){var t=$.inArray(n.Id,$scope.mySimpleProductList);t>=0&&($scope.products.push(n),$scope.mySimpleProductList.splice(t,1))})});$scope.SortChanged=function(){$scope.SafeApply()};_.defer(function(){$scope.$watch("products",function(){_.defer(function(){app.safeLoadImages($(".SimpleProductList"))})},!0)})}return __extends(t,n),t.$inject=["$rootScope","$scope","$element","bagService"],t}(BaseAngularController);n.SimpleProductListCtrl=t}(SimpleProductListModule||(SimpleProductListModule={}));app.controller("SimpleProductListController",SimpleProductListModule.SimpleProductListCtrl),function(n){n.subscribeScope;var t=function(t){function i($scope,i,r){t.call(this,$scope);n.subscribeScope=$scope;n.subscribeScope.subscribeService=i;n.subscribeScope.SubscribeModel={Email:"",Source:37};n.subscribeScope.ResponseCalled=!1;n.subscribeScope.DisplayEmailError=!1;n.subscribeScope.InputFocus=function(){n.subscribeScope.DisplayEmailError=!1};n.subscribeScope.subscribeSubmit=function(t){t===void 0&&(t=37);n.subscribeScope.SubscribeForm.$valid?(n.subscribeScope.ShowValidation=!1,n.subscribeScope.SubscribeModel.Source=t,n.subscribeScope.ShowLoading(AVON.messages.spinner_subscribing),i.subscribeEmail(n.subscribeScope.SubscribeModel,$("form[name=SubscribeForm]"))):n.subscribeScope.ShowValidation=!0};n.subscribeScope.$on("SubscribeService.SubscribeResponse",function(t,i){if(!n.subscribeScope.ResponseCalled){i.ErrorCode===1&&(n.subscribeScope.ProcessAjaxValidationErrors(i),n.subscribeScope.ShowValidation=!0);var u={Type:TrackingEventType.EmailConfirmMsg};r.TrackEventItem(u);n.subscribeScope.ResponseCalled=!0}});n.subscribeScope.EmailSignupSubmit=function(t){t===void 0&&(t=37);n.subscribeScope.DisplayEmailError=!1;var r=n.subscribeScope.IsEmailValid(n.subscribeScope.SubscribeModel.Email);if(n.subscribeScope.EmailSignupForm.$valid){if(!r){n.subscribeScope.ShowValidation=!0;n.subscribeScope.EmailSignupForm.SubscribeModel_Email.$invalid=!0;n.subscribeScope.DisplayEmailError=!0;return}n.subscribeScope.ShowValidation=!1;n.subscribeScope.SubscribeModel.Source=t;n.subscribeScope.ShowLoading(AVON.messages.spinner_subscribing);i.emailSignup(n.subscribeScope.SubscribeModel,$("form[name=EmailSignupForm]"))}else n.subscribeScope.ShowValidation=!0};n.subscribeScope.$on("EmailSignupService.EmailSignupResponse",function(t,i){if(!n.subscribeScope.ResponseCalled){n.subscribeScope.CenterModal("EmailSignupModal");i.ErrorCode===1&&(n.subscribeScope.ProcessAjaxValidationErrors(i),n.subscribeScope.ShowValidation=!0,n.subscribeScope.IsEmailValid(n.subscribeScope.SubscribeModel.Email)||(n.subscribeScope.DisplayEmailError=!0));var u={Type:TrackingEventType.EmailPopupSubscribed};r.TrackEventItem(u);n.subscribeScope.ResponseCalled=!0}})}return __extends(i,t),i.$inject=["$scope","subscribeService","trackingService"],i}(BaseAngularController);n.SubscribeController=t}(SubscribeModule||(SubscribeModule={}));app.controller("SubscribeController",SubscribeModule.SubscribeController),function(n){var t=function(){function n(n){var t=function(t){var r={accordion:this,menuItem:t},i="";t.hasClass("MenuSelected")?(t.removeClass("MenuSelected"),t.children("ul,div").slideUp({duration:400}),i="Accordion.ItemClosed"):(t.siblings("li.MenuSelected").each(function(n,t){var i=$(t);i.removeClass("MenuSelected");i.children("ul,div").slideUp({duration:400})}),t.children().length>1&&t.addClass("MenuSelected"),t.children("ul,div").slideDown({duration:400}),i="Accordion.ItemSelected");n.$broadcast(i,r)};return{restrict:"A",link:function($scope,n){var i=$(n),u,r;i.addClass("Accordion");u=i.find("li > a,li > button");u.on("click",function(n){var i=$(n.currentTarget).closest("li");i.hasClass("Disabled")===!1&&t(i)});r=i.children(".DefaultSelected").first();r.length&&t(r)}}}return n.$inject=["$rootScope"],n}();n.AccordionDirective=t}(AccordionModule||(AccordionModule={}));app.directive("accordion",["$rootScope",AccordionModule.AccordionDirective]),function(n){var t=function(){function n(n,t,i){return{restrict:"A",link:function($scope,n){_.defer(function(){angular.element(n).ellipsis();angular.element(n).html().indexOf("...")<0&&angular.element(n).parent().find(".ReadMoreLink").hide();angular.element(n).html().indexOf("...")>-1&&angular.element(n).html(angular.element(n).html().replace("...",""));i.$broadcast("EllipsisComplete")})}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.HtmlEllipsisDirective=t}(HtmlEllipsisModule||(HtmlEllipsisModule={}));app.directive("htmlEllipsis",["$sce","$timeout","$rootScope",HtmlEllipsisModule.HtmlEllipsisDirective]);app.directive("autofill",Autofill),function(n){var t=function(){function n(){this.restrict="A";this.link=function($scope,$element){$($element).focus();$("body").on("FocusReady",function(){$($element).focus()})}}return n.instance=function(){return new n},n}();n.AutoFocusDirective=t}(AutoFocusModule||(AutoFocusModule={}));app.directive("autofocus",AutoFocusModule.AutoFocusDirective.instance),function(n){var t=function(){function n(n,t,i){return{restrict:"A",priority:10,link:function($scope,r){var u=$(r),o=$scope.innerForm?!0:!1,f=$scope,s,h,e,c;o&&(f=$scope.innerForm);r.prop("method","POST");u.attr("autocomplete")?u.attr("autocomplete")=="on"&&(this.watchAutoComplete=function(){$("input[ng-model],input[data-ng-model]",u).not("input[type=hidden],input[type=checkbox]").each(function(){if(angular.element(this).attr("type")!=="checkbox"){var n=$(this).val(),t=angular.element(this).controller("ngModel");t.$viewValue!=n&&t.$setViewValue(n)}});t(this.watchAutoComplete,350)},t(this.watchAutoComplete,100)):(u.attr("autocomplete","off"),u.find("input").attr("autocomplete","off"));r.on("submit",function(){$("input[ng-model]",u).each(function(){angular.element(this).attr("type")!=="checkbox"&&angular.element(this).controller("ngModel").$setViewValue($(this).val())})});u.attr("novalidate","novalidate");s=function(){f.ShowValidation=!1;f.ServerInvalid=!1;f.ServerErrors&&(f.ServerErrors=[]);o&&(f.innerForm.ShowValidation&&(f.innerForm.ShowValidation=!1),f.innerForm.ServerInvalid&&(f.innerForm.ServerInvalid=!1),f.innerForm.ServerErrors&&(f.innerForm.ServerErrors=[]));var n=r.inheritedData("$formController");angular.forEach(n,function(n,t){_.isUndefined(n)===!1&&_.isEmpty(n)===!1&&_.has(n,"$invalid")&&n.$invalid&&e[t].$setValidity("server",!0)});$scope.SafeApply();i.$broadcast("FormDirective.HidValidation",f)};u.on("focus","input,select,textarea",function(){$(this).is(":input[type=button], :input[type=submit], :input[type=reset]")||s()});u.on("click",".InputContainer_checkbox",function(){s()});u.on("change","select",function(){s()});u.on("keydown",function(n){var i=n.charCode||n.keyCode||0,t;i==13&&$(n.target).is("select")&&(t=u.find("input[type='submit']"),t.length&&(t.focus(),t.trigger("click")))});h=o?"innerForm.ShowValidation":"ShowValidation";$scope.$watch(h,function(n){n?(u.addClass("ShowValidation"),_.delay(function(){var n=$(".ValidationError:Visible").first();n.length&&n.scrollintoview({duration:400,direction:"both",complete:null,offsetY:-80})},50)):u.removeClass("ShowValidation");var t=u.find(".ValidationType_required").length;$scope.RequiredInvalid=t>0});e=r.inheritedData("$formController");e.ServerErrors={};e&&(c=o?"innerForm.ServerErrors":"ServerErrors",$scope.$watch(c,function(t){_.isUndefined(t)||t.length==0||(f.ServerInvalid=t.length>0,angular.forEach(t,function(t){var i=t.FieldName,r;i=i.replaceAll(".","_");r=t.Problem.trim();r&&(r=n.trustAsHtml(r),o?f.ServerErrors[i]={$invalid:!0,message:r,FieldName:null,Problem:null}:e.ServerErrors[i]={$invalid:!0,message:r},e[i]&&e[i].$setValidity("server",!1))}))}))}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.AvonFormDirective=t}(AvonFormModule||(AvonFormModule={}));app.directive("avonForm",["$sce","$timeout","$rootScope",AvonFormModule.AvonFormDirective]);onBagChangeQtyThrottled=_.throttle(function($scope,n,t,i){var f=i.$dirty,e=i.$valid,r,u;f&&e&&(r=$.parseJSON(t.campaign),u=$.parseJSON(t.item),$scope.ChangeQty(r,u),$scope.SafeApply(),$(n).is(":focus")&&$(n).blur())},1e3,{leading:!1});app.directive("bagQtyValid",BagQtyValidDirective);app.directive("bagQtyChange",BagQtyChangeDirective);app.directive("caretFix",CaretFix),function(n){var t=function(){function n(n){return{restrict:"EAC",priority:20,link:function(t,i,r){var u=$(i),f=u.attr("data-ng-click")||u.attr("ng-click");f&&alert("clearServerValidation should not be used with an ng-click event. The click event needs to be deferred. Use clear-server-validation-click instead of ng-click");u.on("click",function(){var i,f,e;t.ServerErrors=[];t.ServerInvalid&&(t.ServerInvalid=!1);t.innerForm&&(t.innerForm.ShowValidation=!1,t.innerForm.ServerErrors=[],t.innerForm.ServerInvalid&&(t.innerForm.ServerInvalid=!1));i=r.clearServerValidation;i||(f=u.closest("form"),f.length&&(i=f.attr("name")));i&&t[i].$setDirty();e=u.attr("clear-server-validation-click");e&&n(function(){n(function(){t.$eval(e)},10)},10)})}}}return n.$inject=["$timeout"],n}();n.clearServerValidation=t}(clearServerValidationModule||(clearServerValidationModule={}));app.directive("clearServerValidation",["$timeout",clearServerValidationModule.clearServerValidation]);app.directive("compile",["$compile",CompileDirective]);app.directive("confirmField",ConfirmFieldDirective);app.directive("ngEnter",function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.SafeApply(function(){n.$eval(i.ngEnter)}),t.preventDefault())})}});app.directive("expandable",ExpandableDirective);app.directive("fallbackSrc",["$rootScope",FallbackSrcDirective]),function(n){var t=function(){function n(){return{restrict:"A",scope:!1,link:function(n,t,i){var r,o,u,f,e,s,h,c;(r=$(t),r.closest(".DisableImageAspect").length)||(s=i.imageaspect,s!=""&&s!="0")&&(r.is("img")?(o=r,r.wrap("<div class='ImageAspect' />"),r=r.parent()):(r.addClass("ImageAspect"),o=r.find("image").first()),h=r.css("position"),h!="absolute"&&h!="fixed"&&h!="relative"&&r.css("position","relative"),c=s.split("/"),c.length==2?(u=c[0],f=c[1],e=u/f,r.data("width",u),r.data("height",f)):e=parseFloat(s),r.data("aspect",e),r.css("padding-bottom",100/e+"%"),r.waitForImages(function(){r=$(this);o=r.find("img");u=o[0].naturalWidth;f=o[0].naturalHeight;var n=r.data("width"),t=r.data("height");u!=0&&f!=0&&(u!=n||f!=t)&&(e=u/f,e!=r.data("aspect")&&r.css("padding-bottom",100/e+"%"))}))}}}return n.$inject=[],n}();n.ImageAspect=t}(ImageAspectModule||(ImageAspectModule={}));app.directive("imageaspect",[ImageAspectModule.ImageAspect]);app.directive("input",input);app.directive("linenumberField",linenumberField);app.directive("modal",["$sce","$compile","$rootScope",modal]);$(document).ready(function(){var n=app.GetQuerystringParameterByName("overlay");n.length>0&&(n=="ForgottenPassword"?($("#LoginModal").trigger("modal"),_.delay(function(){$("#ForgotPasswordButton").click()},3e3)):$("#"+n).trigger("modal"))});app.directive("numericField",numericField);app.directive("phonenumberField",phonenumberField);app.directive("secondaryImage",["$rootScope",SecondaryImageDirective]);app.directive("selectRegularExpressionValidator",SelectRegularExpressionValidator);app.directive("singleexpandable",SingleExpandableDirective),function(n){var i=function(){function n(){this.restrict="E";this.link=function($scope,$element){$element.attr("gridheight")&&$element.css("height",$element.attr("gridheight")+"px")}}return n.instance=function(){return new n},n}(),t;n.StackGridDirective=i;t=function(){function n(){this.restrict="E";this.require="^stackgrid";this.replace=!0;this.scope=!0;this.transclude=!0;this.template='<div class="StackCell" ng-attr-style="height:{{cellHeight}}%; width:{{cellWidth}}%; top:{{cellTop}}%; left:{{cellLeft}}%;" ng-transclude><\/div>';this.controller=function($scope,$element){$scope.container=$($element);$scope.parentgrid=$($element).parent("stackgrid");var n=100/parseInt($scope.parentgrid.attr("rowcount")),t=100/parseInt($scope.parentgrid.attr("colcount"));$scope.cellTop=Math.abs(n*parseInt($scope.container.attr("row")));$scope.cellLeft=Math.abs(t*parseInt($scope.container.attr("col")));$scope.cellHeight=Math.abs(n*parseInt($scope.container.attr("rowspan")));$scope.cellWidth=Math.abs(t*parseInt($scope.container.attr("colspan")))}}return n.instance=function(){return new n},n}();n.StackCellDirective=t}(StackGridModule||(StackGridModule={}));app.directive("stackgrid",StackGridModule.StackGridDirective.instance);app.directive("stackcell",StackGridModule.StackCellDirective.instance);app.directive("textareaMaxlength",textareaMaxlength);app.directive("tinifyUrl",TinifyUrlDirective);app.directive("tinifyShareUrl",TinifyShareUrlDirective),function(n){var i=function(){function n($scope,n,$element,$transclude){this.$scope=$scope;this.$rootScope=n;this.$element=$element;this.$transclude=$transclude;$scope.CloseTooltipInfo=function(){$scope.ExpandTooltipInfo=!1};$scope.OpenTooltipInfo=function(){$scope.ExpandTooltipInfo=!0;n.ScrollIntoView($element)};$scope.ToggleTooltipInfo=function(){$scope.ExpandTooltipInfo?$scope.CloseTooltipInfo():$scope.OpenTooltipInfo()};$transclude(function(n){$scope.content=angular.element("<div>").append(n).html()})}return n.$inject=["$scope","$rootScope","$element","$transclude"],n}(),t;n.TooltipController=i;t=function(){function t(){this.scope={};this.template="<i class='{{className}}' data-ng-click='ToggleTooltipInfo()' data-ng-class='{Expanded: ExpandTooltipInfo}' data-ng-mouseenter='OpenTooltipInfo()' data-ng-mouseleave='CloseTooltipInfo()'><span>i<\/span><div class='InfoPanel'><div class='RotatedCaret45'><\/div><div data-ng-bind-html='content'><\/div><\/div><\/i>";this.restrict="E";this.replace=!1;this.transclude=!0;this.controller=n.TooltipController;this.link=function($scope,$element,n){$scope.className=n.classname}}return t.instance=function(){return function(){return new t}},t}();n.TooltipDirective=t}(TooltipModule||(TooltipModule={}));app.directive("tooltip",TooltipModule.TooltipDirective.instance());app.directive("trackmenuClick",["$rootScope",trackMenuClick]);app.directive("viewmore",[ViewmoreDirective]);app.filter("noFractionCurrency",["$filter","$locale",function(n,t){var i=n("currency"),r=t.NUMBER_FORMATS;return function(n,t){var u=i(n,t),f=u.indexOf(r.DECIMAL_SEP);return n>=0?u.substring(0,f):u.substring(0,f)+")"}}]);app.filter("dayrange",function(){return function(n,t){var u=isNaN(t)?1:parseInt(t),r=31,i;switch(u){case 2:r=29;break;case 4:case 6:case 9:case 11:r=30}for(i=1;i<=r;i++)n.push(i);return n}}),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.ChangeRepDesktop=function(n,i,r){this.PostJson("/api/login/changerepdesktop",{repId:n,returnUrl:i,redirect:r}).success(function(n){n&&t.rootScope.$broadcast("ChangeRepService.ChangeRepDesktop",n)})},t.prototype.ChangeRepMobile=function(n,i){this.PostJson("/api/login/changerepmobile",{useDbRep:!1,repId:n,returnUrl:i}).success(function(n){n&&t.rootScope.$broadcast("ChangeRepService.ChangeRepMobile",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ChangeRepService=t}(ChangeRepServiceModule||(ChangeRepServiceModule={}));app.service("changeRepService",ChangeRepServiceModule.ChangeRepService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.register=function(n,i){this.PostJson("/api/login/registerguestshopper",n,i).success(function(n){n!==null&&t.rootScope.$broadcast("ConfirmationService.RegisterResponse",n)}).error(function(n){t.rootScope.$broadcast("ConfirmationService.RegisterResponse",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ConfirmationService=t}(ConfirmationServiceModule||(ConfirmationServiceModule={}));app.service("confirmationService",ConfirmationServiceModule.ConfirmationService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.SendContactRequest=function(n){this.PostJson("/api/contact/contactmeform",n).then(function(n){n!==null&&t.rootScope.$broadcast("ContactService.ContactRequestResponse",n)})},t.prototype.SaveContactPreferences=function(n,i){n.Source=i;this.PostJson("/api/contact/customercontactpreferencessave",n).success(function(n){n!==null&&(AVON.customerContactPreferences=n.Data,t.rootScope.$broadcast("ContactService.PreferencesUpdated",n))})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ContactService=t}(ContactServiceModule||(ContactServiceModule={}));app.service("contactService",ContactServiceModule.ContactService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.SaveMyAddresses=function(n,i,r,u){this.PostJson("/api/customer/updatemyaddresses",{addresses:n,saveInDatabase:i,isRequestFromBillingAndShippingPage:r,isFirstTime:u}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.UpdateAddress",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.UpdateAddress",n)})},t.prototype.RefreshAddressFromPayPal=function(){this.PostJson("/api/customer/refreshcustomerpaypaladdress",{}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.RefreshPayPalAddress",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.RefreshPayPalAddress",n)})},t.prototype.DiscontinueAllAutoReplenishmentProducts=function(){this.PostJson("/api/myaccount/autoreplenishmentdiscontinueall",{}).success(function(n){n!==null&&t.rootScope.$broadcast("MyAccountService.DiscontinueAllAutoReplenishmentProducts",n)}).error(function(n){t.rootScope.$broadcast("MyAccountService.DiscontinueAllAutoReplenishmentProducts",n)})},t.prototype.DiscontinueHazmatAutoReplenishmentProducts=function(){this.PostJson("/api/myaccount/autoreplenishmentdiscontinuehazmats",{}).success(function(n){n!==null&&t.rootScope.$broadcast("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",n)}).error(function(n){t.rootScope.$broadcast("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",n)})},t.prototype.ShowRestrictedStateInline=function(n){t.rootScope.$broadcast("MyAccountService.ShowRestrictedStateInline",n)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.CustomerService=t}(CustomerServiceModule||(CustomerServiceModule={}));app.service("customerService",CustomerServiceModule.CustomerService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.GetActiveCampaigns=function(){this.GetJson("/api/getactivecampaigns",!0,!1,!1).then(function(n){n.ErrorCode===0&&t.rootScope.$broadcast("LpmContextMenuService.ActiveCampaignsReceived",n)})},t.prototype.GetActiveLookup=function(){this.GetJson("/api/lookups",!0,!1,!1).then(function(n){n.ErrorCode===0&&t.rootScope.$broadcast("LpmContextMenuService.ActiveLookupReceived",n)})},t.prototype.GetEnvironmentInfo=function(){this.GetJson("/api/environmentInfo",!0,!1,!1).then(function(n){n.ErrorCode===0&&t.rootScope.$broadcast("LpmContextMenuService.EnvironmentInfoReceived",n)})},t.prototype.SetCampaign=function(n,t){this.PostJson("/debug/campaign/",{id:n,redirectUrl:t})},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.LpmContextMenuService=t}(LpmContextMenuServiceModule||(LpmContextMenuServiceModule={}));app.service("LpmContextMenuService",LpmContextMenuServiceModule.LpmContextMenuService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.GetMobileTopNavigationItems=function(){var n=this;t.rootScope.SessionService.WhenReady().then(function(){var i="/api/category/topmenuitemsmobile";i+="?language="+AVON.languageId;i+="&campaign="+AVON.campaign;i+="&attached="+t.rootScope.Session.Customer.IsAttached;i+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;n.GetJson(i,!0,!0,!1).then(function(n){t.rootScope.$broadcast("NavigationService.MobileMenuLoaded",n)})})},t.prototype.GetTopNavigationCategories=function(){var n=this;t.rootScope.SessionService.WhenReady().then(function(){var i="/api/category/topmenuitems";i+="?language="+AVON.languageId;i+="&campaign="+AVON.campaign;i+="&attached="+t.rootScope.Session.Customer.IsAttached;i+="&deliverytype="+t.rootScope.Session.Customer.DeliveryType;n.GetJson(i,!0,!0,!1).then(function(n){t.rootScope.$broadcast("NavigationService.MenuLoaded",n)})})},t.prototype.GetFeaturedBrands=function(){var n=this;t.rootScope.SessionService.WhenReady().then(function(){n.GetJson("/api/category/featuredBrands",!0,!0,!1).then(function(){})})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.NavigationService=t}(NavigationModule||(NavigationModule={}));app.service("NavigationService",NavigationModule.NavigationService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.notifyMe=function(n){this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&t.rootScope.$broadcast("NotifyMeService.NotifyMeResponse",n)}).error(function(n){t.rootScope.$broadcast("NotifyMeService.NotifyMeResponse",n)})},t.prototype.notifyMeQuickShop=function(n){this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&t.rootScope.$broadcast("NotifyMeService.NotifyMeQuickShopResponse",n)}).error(function(n){t.rootScope.$broadcast("NotifyMeService.NotifyMeQuickShopResponse",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.NotifyMeService=t}(NotifyMeSerivceModule||(NotifyMeSerivceModule={}));app.service("NotifyMeService",NotifyMeSerivceModule.NotifyMeService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ProductDetailService=t}(ProductDetailModule||(ProductDetailModule={}));app.service("ProductDetailService",ProductDetailModule.ProductDetailService),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u;t.trackingService=f}return __extends(t,n),t.prototype.register=function(n,i){this.PostJson("/api/login/register",n,i).success(function(i){i!==null&&(n.IsGuestShopper||t.trackingService.TrackEventItem({Type:n.NotifySpecialOffers?TrackingEventType.NewCustomerRegistrationOptIn:TrackingEventType.NewCustomerRegistrationOptOut}),t.rootScope.$broadcast("RegistrationService.RegisterResponse",i))}).error(function(n){t.rootScope.$broadcast("RegistrationService.RegisterResponse",n)})},t.$inject=["$rootScope","$http","$q","trackingService"],t}(BaseAvonService);n.RegistrationService=t}(RegistrationServiceModule||(RegistrationServiceModule={}));app.service("registrationService",RegistrationServiceModule.RegistrationService),function(){String.prototype.isNullOrEmpty=function(){return this==null||this.length===0};String.prototype.startsWith=function(n){return this.match("^"+n)===n};String.prototype.endsWith=function(n,t){"use strict";return t!==undefined&&t?n===this.substring(this.length-n.length):n.toLowerCase()===this.substring(this.length-n.length).toLowerCase()};String.prototype.replaceAll=function(n,t){for(var i=this,r=i.indexOf(n);r!==-1;)i=i.replace(n,t),r=i.indexOf(n);return i.toString()};String.prototype.removeLastOccurence=function(n){var t=this,i=t.lastIndexOf(n);return i>-1?t.substring(0,i):t};String.prototype.capitalize=function(n){return(n?this.toLowerCase():this).replace(/(?:^|\s)\S/g,function(n){return n.toUpperCase()})};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(StringExtensions||(StringExtensions={})),function(){Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var u=t||window,i=0,r=this.length;i<r;i+=1)n.call!==null&&n.call(u,this[i],i,this)})}(ArrayExtensions||(ArrayExtensions={})),function(n){var t=function(){function n(n,t,i){this.status=n;this.lat=t;this.lng=i}return n}(),i;n.GeocodeResult=t;i=function(){function n(){}return n.prototype.geocodeAddress=function(i,r,u,f,e){if(AVON.commonMvc.isQapEnvironment()){e(new t("OK",40.7121669,-73.9676956));return}AVON.Maps.loadGoogleMapsApi().done(function(){var o=[];i&&o.push(i);r&&o.push(r);u&&(u=u.toUpperCase(),o.push(u));f&&o.push(f);var s=o.join(","),h={region:"US",address:s+",US"},c=new google.maps.Geocoder;c.geocode(h,function(o,s){var h,v,y,p,w;if(s==google.maps.GeocoderStatus.OK){var c=o[0],l=!1,a=!1;_.each(c.address_components,function(n){n.short_name==u?l=!0:n.short_name==f&&(a=!0)});h=!1;l&&a||(i&&r&&u&&f?(r=null,h=!0):i&&!r&&u&&f&&(i=null,h=!0));h?(v=new n,v.geocodeAddress(i,r,u,f,e)):(y=c.geometry.location.lat(),p=c.geometry.location.lng(),e(new t("OK",y,p)))}else w="Error: "+s,e(new t(w,0,0))})})},n}();n.GoogleGeocoder=i}(Geocode||(Geocode={}));app.directive("validateAddress",validateAddress);app.directive("validateCity",validateCity);app.directive("validateMustequalto",validateMustqqualto);app.directive("validateName",validateName);app.directive("validatePhone",validatePhone);app.directive("validateRegex",validateRegex);app.directive("validateZipcode",validateZipcode);app.directive("validateZipcodeRecognized",validateZipCodeRecognized);app.directive("validateZipcodeRequired",validateZipcodeRequired);__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){"use strict";n.breadcrumbsScope;var t=function(t){function i($scope){if(t.call(this,$scope),n.breadcrumbsScope=$scope,n.breadcrumbsScope.Breadcrumbs=[{Url:" / ",Text:"Home",CrumbType:1,HasUrl:!0}],n.breadcrumbsScope.HideCategoryBreadcrumbsBeforeBrands=function(){n.breadcrumbsScope.HiddenBreadcrumbs=0;for(var t=0;t<n.breadcrumbsScope.Breadcrumbs.length-1;t++)n.breadcrumbsScope.Breadcrumbs[t].CrumbType==2&&n.breadcrumbsScope.Breadcrumbs[t+1].CrumbType==6&&(n.breadcrumbsScope.HiddenBreadcrumbs+=1)},n.breadcrumbsScope.VerifyProductAlternatives=function(){var t,i;if(AVON.AltBreadcrumbs){if(n.breadcrumbsScope.Breadcrumbs.length>2&&n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text=="Search"&&AVON.LanguageCode=="es"){n.breadcrumbsScope.Breadcrumbs[0].Text="Inicio";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text="Búsqueda";return}if(n.breadcrumbsScope.Breadcrumbs.length>2&&n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text=="Búsqueda"&&AVON.LanguageCode=="en"){n.breadcrumbsScope.Breadcrumbs[0].Text="Home";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text="Search";return}if(n.breadcrumbsScope.Breadcrumbs.length>2&&n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].CrumbType==5)return;if(n.breadcrumbsScope.Breadcrumbs.length>4&&n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text.toLowerCase()=="order details"&&AVON.LanguageCode=="es"){n.breadcrumbsScope.Breadcrumbs[0].Text="Inicio";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-4].Text="Mi Cuenta";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-3].Text="Historial De Pedidos";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text="Detalles Del Pedido";return}if(n.breadcrumbsScope.Breadcrumbs.length>4&&n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text.toLowerCase()=="detalles del pedido"&&AVON.LanguageCode=="en"){n.breadcrumbsScope.Breadcrumbs[0].Text="Home";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-4].Text="My Account";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-3].Text="Order History";n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text="Order Details";return}if(n.breadcrumbsScope.Breadcrumbs.length>2&&n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text.toLowerCase()=="order details"||n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Text.toLowerCase()=="detalles del pedido")return;if(n.breadcrumbsScope.Breadcrumbs.length>2&&n.breadcrumbsScope.Breadcrumbs[1].Text=="Sale"&&AVON.LanguageCode=="es"){n.breadcrumbsScope.Breadcrumbs[0].Text="Inicio";n.breadcrumbsScope.Breadcrumbs[1].Text="Promociones";return}if(n.breadcrumbsScope.Breadcrumbs.length>2&&n.breadcrumbsScope.Breadcrumbs[1].Text=="Promociones"&&AVON.LanguageCode=="en"){n.breadcrumbsScope.Breadcrumbs[0].Text="Home";n.breadcrumbsScope.Breadcrumbs[1].Text="Sale";return}if(n.breadcrumbsScope.Breadcrumbs.length>2&&(n.breadcrumbsScope.Breadcrumbs[1].Text=="Sale"||n.breadcrumbsScope.Breadcrumbs[1].Text=="Promociones"))return;if(t=-1,n.breadcrumbsScope.Breadcrumbs.length>1)for(i=0;i<AVON.AltBreadcrumbs.length&&t<0;i++)n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-2].Url.replace(/^\/es\//,"/")==AVON.AltBreadcrumbs[i][AVON.AltBreadcrumbs[i].length-2].Url.replace(/^\/es\//,"/")&&(t=i);t<0&&(t=0);n.breadcrumbsScope.Breadcrumbs=AVON.AltBreadcrumbs[t]}},window.sessionStorage.AvonBreadcrumbs)for(n.breadcrumbsScope.Breadcrumbs=JSON.parse(window.sessionStorage.AvonBreadcrumbs),n.breadcrumbsScope.ArrivedFromProduct=n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-1].CrumbType==7;!n.breadcrumbsScope.Breadcrumbs[n.breadcrumbsScope.Breadcrumbs.length-1].HasUrl;)n.breadcrumbsScope.Breadcrumbs.pop();if(AVON.setBreadcrumbs&&AVON.breadcrumbs&&AVON.breadcrumbs.length>0)n.breadcrumbsScope.Breadcrumbs=AVON.breadcrumbs;else for(var i=1;i<AVON.breadcrumbs.length;i++)n.breadcrumbsScope.Breadcrumbs.push(AVON.breadcrumbs[i]);if(n.breadcrumbsScope.HideCategoryBreadcrumbsBeforeBrands(),n.breadcrumbsScope.VerifyProductAlternatives(),n.breadcrumbsScope.Breadcrumbs)try{window.sessionStorage.AvonBreadcrumbs=JSON.stringify(n.breadcrumbsScope.Breadcrumbs)}catch(r){}n.breadcrumbsScope.Breadcrumbs&&n.breadcrumbsScope.Breadcrumbs.length-n.breadcrumbsScope.HiddenBreadcrumbs>2&&$("#MainContainer").addClass("ShowBreadcrumb");n.breadcrumbsScope.UpdateBreadcrumbs=function(t,i,r){for(var f,u=n.breadcrumbsScope.Breadcrumbs.length;u>t;u--);f=3;n.breadcrumbsScope.HiddenBreadcrumbs>0&&t==3&&(f=6);n.breadcrumbsScope.Breadcrumbs[t-1]={Text:i,Url:r,CrumbType:f,HasUrl:r!==""&&r!==undefined};n.breadcrumbsScope.HideCategoryBreadcrumbsBeforeBrands();try{window.sessionStorage.AvonBreadcrumbs=JSON.stringify(n.breadcrumbsScope.Breadcrumbs)}catch(e){}n.breadcrumbsScope.SafeApply()};n.breadcrumbsScope.$on("breadcrumbsScope.UpdateBreadcrumbs",function(t,i,r,u){n.breadcrumbsScope.UpdateBreadcrumbs(i,r,u)})}return __extends(i,t),i.$inject=["$scope"],i}(BaseAngularController);n.BreadcrumbsController=t}(BreadcrumbsModule||(BreadcrumbsModule={}));app.controller("BreadcrumbsController",BreadcrumbsModule.BreadcrumbsController),function(n){"use strict";n.changePasswordScope;var t=function(t){function i($scope,i,r){t.call(this,$scope);n.changePasswordScope=$scope;n.changePasswordScope.DisplayPasswordInstructions=!0;n.changePasswordScope.changePasswordModel=AVON.ChangePasswordModel;r.TrackEventItem({Type:TrackingEventType.ChangePasswordModel});_.defer(function(){$("#changePasswordModel_PasswordInput").placeholder();$("#changePasswordModel_PasswordConfirmInput").placeholder()});n.changePasswordScope.ChangePassword=function(){n.changePasswordScope.ChangePasswordForm.$valid?(n.changePasswordScope.ShowValidation=!1,n.changePasswordScope.ShowLoading(AVON.messages.spinner_processing),i.changePassword(n.changePasswordScope.changePasswordModel,$("form[name=ChangePasswordForm]"))):(n.changePasswordScope.ChangePasswordForm.changePasswordModel_Password.$invalid&&(n.changePasswordScope.DisplayPasswordInstructions=!1),n.changePasswordScope.ShowValidation=!0)};n.changePasswordScope.InputFocus=function(){n.changePasswordScope.DisplayPasswordInstructions=!0};n.changePasswordScope.$on("LoginService.ChangePasswordResponse",function(t,i){i.ErrorCode===1&&n.changePasswordScope.ProcessAjaxValidationErrors(i);i.ErrorCode===0&&i.Data.Email!==null&&$("#ChangePasswordModal").trigger("close")})}return __extends(i,t),i.$inject=["$scope","loginService","trackingService"],i}(BaseAngularController);n.ChangePasswordCtrl=t}(ChangePasswordModule||(ChangePasswordModule={}));app.controller("ChangePasswordController",ChangePasswordModule.ChangePasswordCtrl),function(n){"use strict";n.changeRepScope;var t=function(t){function i($scope,i,r,u){t.call(this,$scope);n.changeRepScope=$scope;n.changeRepScope.ChangeRepModel=AVON.TempModalModel;$("#ModalBackground").addClass("Shown");$("#ModalBackground").removeAttr("style");n.changeRepScope.$on("ChangeRepService.ChangeRepDesktop",function(t,i){$("#ChangeRepContainer").trigger("close");i.ErrorCode===1&&n.changeRepScope.ProcessAjaxValidationErrors(i);$("input").css("cursor","default")});n.changeRepScope.ChangeRepDesktop=function(n,t,r,f){$("input").css("cursor","progress");u.TrackEventItem({Type:r?TrackingEventType.ChangeRepresentativeChange:TrackingEventType.ChangeRepresentativeStay});i.ChangeRepDesktop(n,t,f)}}return __extends(i,t),i.$inject=["$scope","changeRepService","$http","trackingService"],i}(BaseAngularController);n.ChangeRepCtrl=t}(ChangeRepModule||(ChangeRepModule={}));app.controller("ChangeRepController",ChangeRepModule.ChangeRepCtrl),function(n){n.contentScope;var t=function(t){function i($scope,i){t.call(this,$scope);n.contentScope=$scope;n.contentScope.ShowContent=AVON.ShowContent;n.contentScope.CategoryPageMainContentLeftMargin=59;n.contentScope.CarouselButtonWidth=27;n.contentScope.ContentWidth=960;n.contentScope.LeftNavWidth=202;n.contentScope.carouselWidth=100+(n.contentScope.CategoryPageMainContentLeftMargin+n.contentScope.CarouselButtonWidth)/(n.contentScope.ContentWidth-n.contentScope.LeftNavWidth)*100;n.contentScope.$on("productListScope.UpdateMultipleSelectedFacets",function(n,t,i,r,u){AVON.ShowContent=(u.indexOf("All ")!=-1||u.indexOf("Todo ")!=-1)&&AVON.IsDescendantMegaBrand?!1:!0});n.contentScope.ContentWithOverlayDisplay=function(t){var i=$(angular.element(t.currentTarget)[0]),r=$(angular.element(t.target)[0]),u;if((t.type=="click"||t.type=="tap")&&angular.element(t.target).is("a")&&t.preventDefault(),i.children("div.Overlay.active").length>0&&r.parents(".Overlay").length==0){n.contentScope.ContentWithOverlayHide(t);return}if(i.find(".OverlayButton").length>0){if(r=$(angular.element(t.target)[0]),r.parents(".OverlayButton").length===0&&!r.hasClass("OverlayButton"))return;i.children("div.RotatedCaret45").addClass("active");i.children("div.Overlay").addClass("active");u=i.find(".OverlayButton").last();$(".Overlay.active").attr("style").indexOf("width")<0&&$(".Overlay.active").css({width:u.outerWidth(!0)});$(".Overlay.active").css({left:u[0].offsetLeft});$(".RotatedCaret45.active").css({left:u[0].offsetLeft});$(".RotatedCaret45.active").css({"margin-left":u.outerWidth(!0)/2})}else i.children("div.RotatedCaret45").addClass("active"),i.children("div.Overlay").addClass("active"),$(".RotatedCaret45.active").css({"margin-left":$(".Overlay.active").outerWidth(!0)/2-$(".RotatedCaret45.active").width()/2});var e=$("#TopUtilityBarContainer").offset().left+$("#TopUtilityBarContainer").innerWidth(),o=$(".Overlay.active").offset().left+$(".Overlay.active").innerWidth(),f=o-e;f>0&&!$(".Overlay.active").attr("style")&&$(".Overlay.active").css({"margin-left":-f})};n.contentScope.ContentWithOverlayHide=function(n){$(".active").removeClass("active");n.stopPropagation()};n.contentScope.ContentWithModalDisplay=function(n){var t=angular.element(n.currentTarget),i=$(t[0]);i.find("div.ContentModal").trigger("modal")};n.contentScope.HeroModuleAsideClick=function(n,t){t.length&&$scope.RedirectToUrl(t,!0)};n.contentScope.$on("Carousel_Updated",function(){var n=$(".BrandModule");n.waitForImages(function(){var n=AvonModule.AvonScope.GetMaxHeight(".BrandModule carousel div.Slide"),t=AvonModule.AvonScope.GetMaxHeight(".BrandModule carousel div.Slide div.Caption");$(".BrandModule carousel div.Slide").each(function(){var i=$(this).find("div.ContentRow"),r=$(this).find("div.Caption");i.height(n);r.height(t)})})});angular.element(document).ready(function(){var n=$("#MainContainer div.ContentModule");n.length==1&&n.css("margin-bottom","0")});n.contentScope.GoToPage=function(n,t){t===void 0&&(t="_self");n!==undefined&&i.open(n,t)}}return __extends(i,t),i.$inject=["$scope","$window"],i}(BaseAngularController);n.ContentCtrl=t}(ContentModule||(ContentModule={}));app.controller("ContentController",ContentModule.ContentCtrl),function(n){n.footerScope;var t=function(t){function i($scope,i){t.call(this,$scope);n.footerScope=$scope;n.footerScope.FooterClassName=n.footerScope.Session.Customer.IsAttached?"NoSubscribePanel":"HasSubscribePanel";n.footerScope.GetTopSectionId=function(){return n.footerScope.Session.Customer.IsAttached?"NavAndSocial":"SubscribeAndSocial"};n.footerScope.subscribeService=i;n.footerScope.SessionService.WhenReady().then(function(t){t.Customer.IsAttached||n.footerScope.subscribeService.getSubscribeMarkup()});n.footerScope.$on("SubscribeService.SubscribeMarkupLoaded",function(t,i){n.footerScope.subscribeDiv=i});n.footerScope.SwitchView=function(t){t.preventDefault();n.footerScope.SessionService.SwitchView(!0)}}return __extends(i,t),i.$inject=["$scope","subscribeService"],i}(BaseAngularController);n.FooterController=t}(FooterModule||(FooterModule={}));app.controller("FooterController",FooterModule.FooterController),function(n){"use strict";n.forgotPasswordscope;var t=function(t){function i($scope,i,r,u,$element){var f,e;t.call(this,$scope);n.forgotPasswordscope=$scope;n.forgotPasswordscope.ForgotPasswordModel=AVON.ForgotPasswordModel;f=$("[id=LoginModel_EmailInput]");f.keyup(function(){$("[id=forgotPasswordModel_EmailInput]").val(f.val()).change()});n.forgotPasswordscope.ForgotPasswordSubmit=function(t){t||(t=$("[id=forgotPasswordModel_EmailInput]").val());n.forgotPasswordscope.ShowLoading(AVON.messages.spinner_processing);n.forgotPasswordscope.SubmitButtonClicked=="SendNewPasswordButton"?(i.sendNewPassword(t,$("form[name=ForgotPasswordForm]")),r.TrackEventItem({Type:TrackingEventType.SendPasswordHint})):(i.sendPasswordHint(t,$("form[name=ForgotPasswordForm]")),n.forgotPasswordscope.ForgotPasswordForm.ServerErrors.Summary!==undefined&&(n.forgotPasswordscope.ForgotPasswordForm.ServerErrors.Summary.$invalid=!1),r.TrackEventItem({Type:TrackingEventType.SendPassword}))};e=function(t){n.forgotPasswordscope.ForgotPasswordForm.ServerErrors.Summary!==undefined&&(n.forgotPasswordscope.ForgotPasswordForm.ServerErrors.Summary.$invalid=!1);t.ErrorCode===1&&(n.forgotPasswordscope.ProcessAjaxValidationErrors(t),_.defer(function(){var t=$("[id=forgotPasswordModel_EmailInput]").val();AVON.TempModalModel!==undefined?AVON.TempModalModel.Email=t:AVON.TempModalModel={Email:t};u($element.find(".ErrorSummaryContainer .ValidationSummaryServer span a"))(n.forgotPasswordscope)}))};n.forgotPasswordscope.SubmitForm=function(t){n.forgotPasswordscope.SubmitButtonClicked=t;n.forgotPasswordscope.ForgotPasswordSubmit($("[id=forgotPasswordModel_EmailInput]").val())};n.forgotPasswordscope.$on("LoginService.SendNewPasswordResponse",function(n,t){e(t)});n.forgotPasswordscope.$on("LoginService.SendPasswordHintResponse",function(n,t){e(t)})}return __extends(i,t),i.$inject=["$scope","loginService","trackingService","$compile","$element"],i}(BaseAngularController);n.ForgotPasswordCtrl=t}(ForgotPasswordModule||(ForgotPasswordModule={}));app.controller("ForgotPasswordController",ForgotPasswordModule.ForgotPasswordCtrl),function(n){var t=function(n){function t($scope,$element){n.call(this,$scope);var i;i=$scope;$($element).find("ul li").length>0&&(i.activeTabId=$($element).find("ul li")[0].id);i.OnTabClick=function(n,r,u){i.IsTouchDevice()||t.prototype.ToggleTabActive(i,n,r,u)};i.OnTabTap=function(n,r,u){i.IsTouchDevice()&&t.prototype.ToggleTabActive(i,n,r,u)};i.OnTabMouseEnter=function(n,r,u){i.IsTouchDevice()||t.prototype.ToggleTabState(i,n,r,u,1)};i.OnTabMouseLeave=function(n,r,u){i.IsTouchDevice()||t.prototype.ToggleTabState(i,n,r,u,2)};i.$on("ProductService.ProductsLoaded",function(){$element.find(window.location.hash).length>0&&(i.LoadOperationsCount+=1,i.LoadOperationsCount>=2&&_.delay(function(){i.ScrollToTop($element,!1)},1e3))});i.$on("ProductService.PromotionsLoaded",function(){$element.find(window.location.hash).length>0&&(i.LoadOperationsCount+=1,i.LoadOperationsCount>=2&&_.delay(function(){i.ScrollToTop($element,!1)},1e3))});_.defer(function(){$element.find(window.location.hash.substring(1)).length>0&&$element.find(window.location.hash.substring(1))[0].click()})}return __extends(t,n),t.prototype.ToggleTabActive=function(n,t,i,r){var e=n.activeTabId,u,f;n.activeTabId="";this.ToggleTabStateById(n,t,e,r,i,0);this.ToggleTabState(n,t,i,r,0);u=angular.element(t.currentTarget);$(t.target).closest("#GenericTabs").find("ul li").removeClass("Selected");u.addClass("Selected");f=u.attr("id");n.activeTabId=f},t.prototype.ToggleTabState=function(n,t,i,r,u){var f=angular.element(t.currentTarget);this.ToggleTabStateById(n,t,f.attr("id"),i,r,u)},t.prototype.ToggleTabStateById=function(n,t,i,r,u,f){var e=$("#"+i),o=e.attr("id");n.activeTabId!=o&&($(t.target).closest("#GenericTabs").find("ul li").removeClass("Hover"),f==1&&e.addClass("Hover"),e.css("background-color",r),e.css("color",u))},t.$inject=["$scope","$element"],t}(BaseAngularController);n.GenericTabModuleController=t}(GenericTabModule||(GenericTabModule={}));app.controller("GenericTabModuleController",GenericTabModule.GenericTabModuleController),function(n){var t=function(n){function t($scope){var t=this,i;n.call(this,$scope);i=$scope;angular.element(document).ready(function(){var n=$(".main-letter"),i=$(".glossary-letter");n.on("click",function(){var r=$(t),u=$("#"+r.attr("id")+"-content");n.removeClass("pink");r.addClass("pink");i.addClass("hide");u.removeClass("hide");u.addClass("show")})})}return __extends(t,n),t.$inject=["$scope"],t}(BaseAngularController);n.GlossaryModuleController=t}(GlossaryModule||(GlossaryModule={}));app.controller("GlossaryModuleController",GlossaryModule.GlossaryModuleController),function(n){"use strict";n.layoutLeftNavigationScope;var t=function(t){function i($scope,i,r){t.call(this,$scope);n.layoutLeftNavigationScope=$scope;AVON.LeftNavigation&&(n.layoutLeftNavigationScope.MenuItems=AVON.LeftNavigation.MenuItems,n.layoutLeftNavigationScope.SubCategoryId=AVON.LeftNavigation.SubCategoryId,n.layoutLeftNavigationScope.TopLevelCategoryName=AVON.LeftNavigation.TopLevelCategoryName,n.layoutLeftNavigationScope.DeptType=AVON.LeftNavigation.DeptType,n.layoutLeftNavigationScope.ShowFacets=AVON.LeftNavigation.ShowFacets);n.layoutLeftNavigationScope.trustHtmlModel=function(n){return r.trustAsHtml(n)};n.layoutLeftNavigationScope.PrimeFacets=[];n.layoutLeftNavigationScope.Ratings=[];_.delay(function(){AVON.ShowProductList&&$(".BrandItem a").addClass("ExclusiveBrandLink");var n=$("a:contains('Outlet')");n.hasClass("active")&&n.addClass("SelectedCategory");n.find("i").remove()});n.layoutLeftNavigationScope.SelectedCategoryId=AVON.SelectedCategoryId;_.delay(function(){var n=$("ul.Categories");$("li",n).length==1&&n.parent().hide()},1e3);n.layoutLeftNavigationScope.DeptType=="B"&&n.layoutLeftNavigationScope.MenuItems[0]&&(n.layoutLeftNavigationScope.MenuItems[0].GroupNames.indexOf("Brands")>-1?(n.layoutLeftNavigationScope.MenuItems[0].GroupNames.splice(n.layoutLeftNavigationScope.MenuItems[0].GroupNames.indexOf("Brands")),n.layoutLeftNavigationScope.MenuItems[0].GroupNames.unshift("Brands")):n.layoutLeftNavigationScope.MenuItems[0].GroupNames.indexOf("Marcas")>-1&&(n.layoutLeftNavigationScope.MenuItems[0].GroupNames.splice(n.layoutLeftNavigationScope.MenuItems[0].GroupNames.indexOf("Marcas")),n.layoutLeftNavigationScope.MenuItems[0].GroupNames.unshift("Marcas")));n.layoutLeftNavigationScope.UpdateRatings=function(t,r){t.target.checked?n.layoutLeftNavigationScope.Ratings.push(r):n.layoutLeftNavigationScope.Ratings=_.filter(n.layoutLeftNavigationScope.Ratings,function(n){return n!=r});i.$broadcast("productListScope.UpdateRatings",n.layoutLeftNavigationScope.Ratings)};n.layoutLeftNavigationScope.ClearRatings=function(){$(".LeftNavGroupItem .ratingCheckbox").prop("checked",!1);n.layoutLeftNavigationScope.Ratings=[];i.$broadcast("productListScope.UpdateRatings",n.layoutLeftNavigationScope.Ratings)};n.layoutLeftNavigationScope.ShowSubBrands=function(){return $(".subNav").length>0};n.layoutLeftNavigationScope.ShowStarRatings=function(){return AVON.ShowProductList&&(n.layoutLeftNavigationScope.DeptType=="S"||n.layoutLeftNavigationScope.SubCategoryId>0)};n.layoutLeftNavigationScope.$on("productListScope.UpdateMultipleSelectedFacets",function(){AVON.ShowProductList=!0});n.layoutLeftNavigationScope.ToggleGroupSection=function(n){var t=angular.element(n.currentTarget);t.find("i").hasClass("fa-chevron-circle-down")?(t.parent().parent().find("ul").addClass("Hidden"),t.find("i").removeClass("fa-chevron-circle-down"),t.find("i").addClass("fa-chevron-circle-right")):(t.parent().parent().find("ul").removeClass("Hidden"),t.find("i").removeClass("fa-chevron-circle-right"),t.find("i").addClass("fa-chevron-circle-down"))};n.layoutLeftNavigationScope.IsCategoryWhatsNew=function(n){return n.Url.indexOf("whats-new")>-1||n.Url.indexOf("que-hay-de-nuevo")>-1};n.layoutLeftNavigationScope.ClearGroupSection=function(n,t,r){for(var f=[],e,u=0;u<r.length;u++)f.push(r[u].Id),$("#LeftNavCheckbox-"+r[u].Id).prop("checked",!1);e=angular.element(n.currentTarget);e.removeClass("Active");i.$broadcast("productListScope.UpdateMultipleSelectedFacets",t,f,!1)};n.layoutLeftNavigationScope.UpdateSelectedCategory=function(t,r,u,f){var v=$(angular.element(t.currentTarget)[0]).text(),c,b,y,s,p,h,k,o,a;if(v.indexOf("All")>-1&&r.Id==n.layoutLeftNavigationScope.SelectedCategoryId&&AVON.ShowProductList)return!1;v.indexOf("All")>-1&&$(".BrandItem a").addClass("ExclusiveBrandLink");for(c in n.layoutLeftNavigationScope.MenuItems)for(b in n.layoutLeftNavigationScope.MenuItems[c].GroupNames)if(y=n.layoutLeftNavigationScope.MenuItems[c].GroupNames[b],s=n.layoutLeftNavigationScope.MenuItems[c].GroupedChildren[y],s){for(p=[],h=0;h<s.length;h++)p.push(s[h].Id),$("#LeftNavCheckbox-"+s[h].Id).prop("checked",!1);i.$broadcast("productListScope.UpdateMultipleSelectedFacets",y,p,!1,v)}if(n.layoutLeftNavigationScope.ClearRatings(),window.history.pushState)if(k=window.location.search,f<4||n.layoutLeftNavigationScope.DeptType!="B")window.history.pushState({category:r,setSubCategory:u},"",r.Url);else{var w=r.Url.replace(/^\//i,"").replace(/\/$/,"").split("/"),l=w[w.length-1],e=document.location.pathname.replace(/^\//i,"").replace(/\/$/,"").split("/");for(n.layoutLeftNavigationScope.LanguageCode=="en"?e.length==4?e[3]=l:e.push(l):e.length==5?e[4]=l:e.push(l),o="/",a=0;a<e.length;a++)o+=e[a]+"/";o+=k;window.history.pushState({category:r,setSubCategory:u},"",o);w[0]!="es"?($("#LanguageToggle li a[hreflang=en]").attr("href",o),$("#LanguageToggle li a[hreflang=es]").attr("href","/es"+o)):($("#LanguageToggle li a[hreflang=en]").attr("href",o.replace("/es/","/")),$("#LanguageToggle li a[hreflang=es]").attr("href",o))}n.layoutLeftNavigationScope.ShowFacets=!n.layoutLeftNavigationScope.IsCategoryWhatsNew(r);n.layoutLeftNavigationScope.SafeApply();u&&(n.layoutLeftNavigationScope.SubCategoryId=r.Id,n.layoutLeftNavigationScope.SafeApply());n.layoutLeftNavigationScope.SelectedCategoryId=r.Id;i.$broadcast("breadcrumbsScope.UpdateBreadcrumbs",f,r.Caption,r.Url);i.$broadcast("productListScope.UpdateSelectedCategory",n.layoutLeftNavigationScope.TopLevelCategoryName,r.Id,r.Caption,u)};n.layoutLeftNavigationScope.UpdateSelectedFacets=function(n,t,r){i.$broadcast("productListScope.UpdateSelectedFacets",t,r,n.target.checked);var u=$("#LeftNavCheckbox-"+r);u.parents(".LeftNavGroupItem").find("input:checked").length>0?u.parents(".LeftNavGroupItem").find(".LeftNavClearItem").addClass("Active"):u.parents(".LeftNavGroupItem").find(".LeftNavClearItem").removeClass("Active")};n.layoutLeftNavigationScope.SetExclusiveFacet=function(t,r,u){n.layoutLeftNavigationScope.SelectedCategoryId=u;i.$broadcast("productListScope.SetExclusiveFacet",r,u)};n.layoutLeftNavigationScope.ShowFacet=function(){var t=this.facet||this.childCategory;return t!==null&&_.indexOf(n.layoutLeftNavigationScope.PrimeFacets,t.Id)>0};n.layoutLeftNavigationScope.ShowFacetGroup=function(){var i=this.menuItem,t=this.groupName,r;if(n.layoutLeftNavigationScope.DeptType=="S"||n.layoutLeftNavigationScope.DeptType=="B"&&t!="Brands"&&t!="Marcas"||n.layoutLeftNavigationScope.DeptType=="C"&&t!="Categories"&&t!="Categorías"&&t!="Outlet"&&t!="Category"&&t!="Categoría"){for(r in i.GroupedChildren[t])if(_.contains(n.layoutLeftNavigationScope.PrimeFacets,i.GroupedChildren[t][r].Id))return!0;return!1}return!0};n.layoutLeftNavigationScope.$on("layoutLeftNavigationScope.UpdatePrimeFacets",function(t,i){(n.layoutLeftNavigationScope.PrimeFacets.length==0||n.layoutLeftNavigationScope.DeptType!="B"||n.layoutLeftNavigationScope.SelectedCategoryId==n.layoutLeftNavigationScope.SubCategoryId)&&(n.layoutLeftNavigationScope.PrimeFacets=i)});n.layoutLeftNavigationScope.$on("ProductListService.ProductSearchLoaded",function(t,i){var r=i.Data.leftNavigationModel;n.layoutLeftNavigationScope.MenuItems=r.MenuItems;n.layoutLeftNavigationScope.SubCategoryId=r.SubCategoryId;n.layoutLeftNavigationScope.TopLevelCategoryName=r.TopLevelCategoryName;n.layoutLeftNavigationScope.DeptType=r.DeptType;n.layoutLeftNavigationScope.ShowFacets=r.ShowFacets;AVON.ShowProductList=!0;n.layoutLeftNavigationScope.ShowStarRatings();n.layoutLeftNavigationScope.SafeApply()});n.layoutLeftNavigationScope.$on("ProductListService.ProductSpotsLoaded",function(t,i){n.layoutLeftNavigationScope.MenuItems[0].LeftBottomPromotionThumbnails=i.LeftBottomPromotionThumbnails;n.layoutLeftNavigationScope.MenuItems[0].LeftTopPromotionThumbnails=i.LeftTopPromotionThumbnails;n.layoutLeftNavigationScope.SafeApply();$(".LeftNavPromotionSpot.BottomSpot").removeClass("Hidden")})}return __extends(i,t),i.$inject=["$scope","$rootScope","$sce"],i}(BaseAngularController);n.LayoutLeftNavigationController=t}(LayoutLeftNavigationModule||(LayoutLeftNavigationModule={}));app.controller("LayoutLeftNavigationController",LayoutLeftNavigationModule.LayoutLeftNavigationController),function(n){"use strict";n.layoutTopNavigationScope;var t=function(t){function i($scope,i){t.call(this,$scope);n.layoutTopNavigationScope=$scope;n.layoutTopNavigationScope.TopMenuItems=AVON.TopNavigation;n.layoutTopNavigationScope.TopMenuBrandItems=[];n.layoutTopNavigationScope.TopSelectedCategoryId=AVON.TopSelectedCategoryId;n.layoutTopNavigationScope.IsSalePage=$("body").hasClass("Controller_Promotions");n.layoutTopNavigationScope.IsAllCategoriesPage=$("body").hasClass("Action_AllCategories");n.layoutTopNavigationScope.IsAllBrandsPage=$("body").hasClass("Action_AllBrands");n.layoutTopNavigationScope.SearchMenuVanishingScroll=20;n.layoutTopNavigationScope.TopMenuNumBrandItems=3;n.layoutTopNavigationScope.BrandItemGaps=[];n.layoutTopNavigationScope.ShowImageOverlay=!1;n.layoutTopNavigationScope.$on("NavigationService.MenuLoaded",function(t,i){if(n.layoutTopNavigationScope.TopMenuItems=i.Data.TopMenuItems,n.layoutTopNavigationScope.TopMenuSaleItems=i.Data.SaleMenuItems,n.layoutTopNavigationScope.ProcessMenuItemCaptions(),n.layoutTopNavigationScope.CalculateTopMenuMoreItems(),i.Data.BrandMenuItems&&(n.layoutTopNavigationScope.TopMenuBrandItems=i.Data.BrandMenuItems),n.layoutTopNavigationScope.TopMenuBrandItems.length!=0){n.layoutTopNavigationScope.TopMenuBrandItems.length>3&&(n.layoutTopNavigationScope.TopMenuNumBrandItems=n.layoutTopNavigationScope.TopMenuBrandItems.length>6?9:6);for(var r=0;r<n.layoutTopNavigationScope.TopMenuNumBrandItems;r++)n.layoutTopNavigationScope.BrandItemGaps.push(r);n.layoutTopNavigationScope.ShowImageOverlay=!0}else angular.forEach(n.layoutTopNavigationScope.TopMenuItems,function(t){t.Type=="Brand"&&(t.IncludeInTopBrandsNavigation=t.IncludeInTopNavigation,n.layoutTopNavigationScope.TopMenuBrandItems.push(t));angular.forEach(t.GroupNames,function(i){(i.toLowerCase()=="brands"||i.toLowerCase()=="marcas")&&angular.forEach(t.GroupedChildren[i],function(t){n.layoutTopNavigationScope.TopMenuBrandItems.push(t)})})});n.layoutTopNavigationScope.SafeApply()});n.layoutTopNavigationScope.RenderCaption=function(n){var t,i=n.Caption,r;return n.AlternativeText&&(i=n.AlternativeText),n.IconCode&&(r=$(document.createElement("span")).html(n.IconCode+i).css({color:n.IconColor}),t=r[0].outerHTML),n.IconUrl&&(t='<img src="'+$scope.cdn.mediaImage(n.IconUrl)+'"> '+i),t===undefined&&(t=i),$scope.$sce.trustAsHtml(t)};n.layoutTopNavigationScope.ShowWithSubMenuItems=function(n,t){var i;if(!n.IncludeInTopNavigation)return!1;if(t&&t.length>0){for(i in n.GroupedChildren[t])if(n.GroupedChildren[t][i].IncludeInTopNavigation)return!0;return!1}for(i in n.Children)if(n.Children[i].IncludeInTopNavigation)return!0;return!1};n.layoutTopNavigationScope.CalculateTopMenuMoreItems=function(){var i,t;for(n.layoutTopNavigationScope.TopMenuMoreItems=[],n.layoutTopNavigationScope.TopMenuNormalItems=[],i=n.layoutTopNavigationScope.ClientConfiguration.TopNavigationVisibleItemsSize,t=0;t<n.layoutTopNavigationScope.TopMenuItems.length;t++)n.layoutTopNavigationScope.TopMenuItems[t].IncludeInTopNavigation&&(i>0?(n.layoutTopNavigationScope.TopMenuNormalItems.push(n.layoutTopNavigationScope.TopMenuItems[t]),i-=1):n.layoutTopNavigationScope.TopMenuMoreItems.push(n.layoutTopNavigationScope.TopMenuItems[t]));_.defer(function(){var n=$(".NavBar");n.width()>1200?n.addClass("SmallestNavBar"):n.width()>1100?n.addClass("SmallerNavBar"):n.width()>980&&n.addClass("SmallNavBar")})};n.layoutTopNavigationScope.ProcessMenuItemCaptions=function(){for(var i=0;i<n.layoutTopNavigationScope.TopMenuItems.length;i++){var t=n.layoutTopNavigationScope.TopMenuItems[i],r={Caption:t.Caption,IconCode:t.IconCode,AlternativeText:t.AlternativeText,IconUrl:t.IconUrl,IconColor:t.IconColor},u=n.layoutTopNavigationScope.RenderCaption(r);t.Caption=u}};n.layoutTopNavigationScope.ProcessMenuItemCaptions();n.layoutTopNavigationScope.CalculateTopMenuMoreItems();$(window).scroll(function(){var i=$("#HeadLogoSection").outerHeight(),t;$(window).scrollTop()>=1200?$("#BackToTopContainer").addClass("Active"):$("#BackToTopContainer").removeClass("Active");t=!1;AVON.IsTabletDevice&&(t=$(window).width()>$(window).height());$(window).scrollTop()>i&&!1===(AVON.IsTabletDevice&&t)?($("#HeadLogoSubSectionLogo a").removeAttr("style"),$("#BodyContent").addClass("Sticky")):($("#BodyContent").removeClass("Sticky"),$("#HeadLogoSubSectionLogo a").css("margin-top",Math.max(35-$(window).scrollTop(),10)),35-$(window).scrollTop()<10&&$("#HeadLogoSubSectionLogo a").css("height",Math.max(85-$(window).scrollTop(),30)));$(window).scrollTop()>=n.layoutTopNavigationScope.SearchMenuVanishingScroll?($("#BodyContent").addClass("ScrollFadeOut"),$("#divSuggestionsHeaderSearchInput").addClass("ScrollFadeOut"),$("#HeaderSearchInput").prop("readonly",!0)):($("#BodyContent").removeClass("ScrollFadeOut"),$("#divSuggestionsHeaderSearchInput").removeClass("ScrollFadeOut"),$("#HeaderSearchInput").prop("readonly",!1))});$(window).resize(function(){navigator.userAgent.lastIndexOf("Chrome/")>0&&($("#TopNavigationRefresher").attr("style")?($("#TopNavigationRefresher").removeAttr("style"),$("#TopUtilityBarRefresher").removeAttr("style")):($("#TopNavigationRefresher").css("display","none"),$("#TopUtilityBarRefresher").css("display","none")))});n.layoutTopNavigationScope.ToggleTopMenuItem=function(t){t.hasClass("active")?n.layoutTopNavigationScope.CloseTopMenuItem():n.layoutTopNavigationScope.OpenTopMenuItem(t)};n.layoutTopNavigationScope.OpenTopMenuItem=function(t){var r,u,f,e;if(n.layoutTopNavigationScope.CloseTopMenuItem(),!(t.find("li").length<=2)){var i=t.find(".Overlay"),o=t.find(".RotatedCaret45"),s=t.find(".Level2MenuItem");t.addClass("active");r=s.outerWidth(!0)/10;t.is(":first-child")?r=r*-1:t.is(":last-child")||(r=0);o.css({"margin-left":s.outerWidth(!0)/2-o.width()/2+r});u=0;t.find("li.DropDownPromotionBanners").each(function(){u+=$(this).outerHeight()});t.find("li.ContentLoadedMenuItem").each(function(){u+=$(this).outerHeight()});f=i.find("> ul.FeaturedSubMenuItems").first().height()-u;e=t.find("li.DropDownPromotionBanners").first();f>0&&!t.find("li.DropDownPromotionBanners").attr("style")&&(f+=parseInt(e.first().css("margin-top"),10),e.first().css("margin-top",f));var h=$(".NavBar"),l=h.offset().left+h.innerWidth(),a=i.offset().left+i.innerWidth()+20,c=a-l;c>0&&!i.attr("style")&&i.css({"margin-left":-c})}};n.layoutTopNavigationScope.CloseTopMenuItem=function(){$("#TopNavigationContainer .active").removeClass("active")};n.layoutTopNavigationScope.OnMenuEnter=function(t){if(!n.layoutTopNavigationScope.IsTouchDevice()){var i=$(t.currentTarget).parent();n.layoutTopNavigationScope.OpenTopMenuItem(i)}};n.layoutTopNavigationScope.OnMenuLeave=function(t){(!n.layoutTopNavigationScope.IsTouchDevice()||$(t.target).parent(".active").length>0)&&n.layoutTopNavigationScope.CloseTopMenuItem()};n.layoutTopNavigationScope.OnMenuTap=function(t){if(n.layoutTopNavigationScope.IsTouchDevice()){var i=t.currentTarget||t.target;n.layoutTopNavigationScope.ToggleTopMenuItem($(i).closest(".OverlayContainer"))}};n.layoutTopNavigationScope.OnMenuClick=function(t){n.layoutTopNavigationScope.IsTouchDevice()&&t.preventDefault()};$scope.$on("ShowLoading",function(){n.layoutTopNavigationScope.CloseTopMenuItem()});$(document).ready(function(){$(".ScrollableMenu").mCustomScrollbar()});i.GetTopNavigationCategories()}return __extends(i,t),i.$inject=["$scope","NavigationService"],i}(BaseAngularController);n.LayoutTopNavigationController=t}(LayoutTopNavigationModule||(LayoutTopNavigationModule={}));app.controller("LayoutTopNavigationController",LayoutTopNavigationModule.LayoutTopNavigationController),function(n){"use strict";n.layoutTopUtilityScope;var t=function(t){function i($scope,i,r){t.call(this,$scope);n.layoutTopUtilityScope=$scope;n.layoutTopUtilityScope.OnCustomerMenuEnter=function(n){var i=angular.element(n.currentTarget);i.parent().children("div").addClass("active");$(".RotatedCaret45.active").css({"margin-left":$(".TopAccountBarUserOverlay").parent().outerWidth(!1)/2-$(".RotatedCaret45.active").width()/2});$(".TopAccountBarUserOverlay").innerWidth($(".TopAccountBarUserOverlay").parent().width());var r=$("#TopUtilityBarContainer").offset().left+$("#TopUtilityBarContainer").innerWidth(),u=$(".Overlay.active").offset().left+$(".Overlay.active").innerWidth(),t=u-r;t>0&&!$(".Overlay.active").attr("style")&&$(".Overlay.active").css({"margin-left":-t})};n.layoutTopUtilityScope.OnCustomerMenuLeave=function(){$(".active").removeClass("active")};n.layoutTopUtilityScope.OnRepMenuEnter=function(t){var r,u;if(n.layoutTopUtilityScope.Session.Rep.HomepageUrl&&n.layoutTopUtilityScope.Session.Rep.HomepageUrl.length!=0){r=angular.element(t.currentTarget);r.parent().children("div").children("div").addClass("active");u=$(".TopAccountBarRepName").width()/3;$(".RotatedCaret45.active").css({"margin-left":u});var e=$("#TopUtilityBarContainer").offset().left+$("#TopUtilityBarContainer").innerWidth(),i=$(".Overlay.active"),o=i.length>0?i.offset().left+i.innerWidth():0,f=o-e;f>0&&!i.attr("style")&&i.css({"margin-left":-f})}};n.layoutTopUtilityScope.OnRepMenuLeave=function(){$(".active").removeClass("active")};n.layoutTopUtilityScope.RepChatModal=function(){var t=$(window).width()/2,i=$(window).height()/2,r=window.open(""+n.layoutTopUtilityScope.Session.Rep.ChatUrl+"","popup","width=425, height=475, top="+i+", left="+t)};n.layoutTopUtilityScope.LoginModal=function(){FB.getLoginStatus(function(){angular.element("#ViewBagPage").length&&(AVON.TempModalModel={Mode:"FullRegistration"});angular.element("#FullRegistrationForm").length&&(AVON.TempModalModel={Mode:"HideCreateAccount"});n.layoutTopUtilityScope.ShowLoading(AVON.messages.spinner_loading);AVON.RedirectToPowerReviews=!1;$("#LoginModal").trigger("modal")},!0)};n.layoutTopUtilityScope.ContactMeRepModal=function(){i.$broadcast("AvonController.ShowRepresentativeContactMeForm",null,"become_a_rep")};n.layoutTopUtilityScope.LogOut=function(n){r.logOut(!1,n)};n.layoutTopUtilityScope.ForgetMe=function(n){r.logOut(!0,n)}}return __extends(i,t),i.$inject=["$scope","$rootScope","loginService"],i}(BaseAngularController);n.LayoutTopUtilityController=t}(LayoutTopUtilityModule||(LayoutTopUtilityModule={}));app.controller("LayoutTopUtilityController",LayoutTopUtilityModule.LayoutTopUtilityController),function(n){var t=function(n){function t(t,i,r,u,f){function e(){t.LoginModel=AVON.LoginModel;t.LoginModel={Email:"",Password:"",Mode:"",ReturnUrl:""};t.displayProperties=t.displayProperties||{showForgotPasswordForm:!1};_.defer(function(){angular.element("[id=FacebookLoginButton]").focus();angular.element("[id=LoginModel_EmailInput]").placeholder();angular.element("[id=LoginModel_PasswordInput]").placeholder();angular.element("[id=firstTimeFacebookUser_PasswordInput]").val("");angular.element("[id=firstTimeFacebookUser_PasswordInput]").placeholder()},200);t.ShowValidation=!1;t.RequiredInvalid=!1}if(n.call(this,t),new e,i.displayForgotPassword){var o=i.forgotEmail;t.displayProperties.showForgotPasswordForm=!0;_.defer(function(){angular.element("[id=forgotPasswordModel_EmailInput]").val(o)},200);i.displayForgotPassword=!1;i.forgotEmail=""}t.LoginModel.Mode==="Standard"&&u.TrackEventItem({Type:TrackingEventType.LoginModalDisplay});t.privacyUrl=$("#privacyPolicyUrl").val();t.conditionsOfUseUrl=$("#conditionsOfUseUrl").val();t.privacyPolicyModalModel=AVON.privacyPolicyModalModel||{NotifySpecialOffers:!0};t.firstTimeFacebookUser=AVON.firstTimeFacebookUser||{AccessToken:"",FacebookId:0,CustomerEmail:"",Password:""};AVON.TempModalModel!==undefined&&(AVON.TempModalModel.Mode==="FullRegistration"&&(t.ShowFullPageRegistrationButton=!0),AVON.TempModalModel.Mode==="HideCreateAccount"&&(t.HideCreateAccountOption=!0));$(document).on("click","#DisplayRegistrationModal",function(n){var i,r;n.preventDefault();i=ForgotPasswordModule.forgotPasswordscope.ForgotPasswordForm.forgotPasswordModel_Email.$modelValue;$("#LoginModal").trigger("close");t.ShowLoading(AVON.messages.spinner_loading);r={UrlToLoad:"/Login/RegistrationOverlay",AllowExit:!0,KeepLoaded:!1,Model:{Email:i}};$("#RegistrationModal").trigger("modal",r)});t.Login=function(){if(t.$broadcast("autofill:update"),t.LoginForm.$valid){AVON.TempModalModel!==undefined?AVON.TempModalModel.Email=t.LoginModel.Email:AVON.TempModalModel={Email:t.LoginModel.Email};t.ShowValidation=!1;t.ShowLoading(AVON.messages.spinner_login);var n=$("#ReturnUrl").val();t.LoginModel.ReturnUrl=n;i.login(t.LoginModel,$("form[name=LoginForm]"),t)}else t.LoginForm.ServerErrors.Summary===undefined||t.ShowValidation||(t.LoginForm.ServerErrors.Summary.$invalid=!1),t.ShowValidation=!0,ForgotPasswordModule.forgotPasswordscope&&(ForgotPasswordModule.forgotPasswordscope.ShowValidation=!1)};t.CreateNewAccountModal=function(){t.ShowLoading(AVON.messages.spinner_loading);$("#LoginModal").trigger("close");$("#RegistrationModal").trigger("modal")};t.UpdatePrivacyPolicy=function(){var r=AVON.TempModalModel.FacebookAccessToken,u=t.UpdatePrivacyPolicyForm.privacyPolicyModalModel_NotifySpecialOffers.$viewValue,n;t.UpdatePrivacyPolicyForm.$valid?(t.ShowValidation=!1,$("#AjaxModal").trigger("close"),n=$("#ReturnUrl").val(),t.ShowLoading(AVON.messages.spinner_login),i.registerWithFacebook(r,u,n)):t.ShowValidation=!0};t.FacebookLogin=function(){t.ShowLoading(AVON.messages.spinner_facebook);$("html.ff").length===0?FB.login(t.FacebookLoginCallback,{scope:"email"}):_.delay(function(){FB.login(t.FacebookLoginCallback,{scope:"email"})},100)};t.FacebookLoginCallback=function(n){if(n.authResponse){var r=$("#ReturnUrl").val();t.HideLoading();t.ShowLoading(AVON.messages.spinner_login);i.loginWIthFacebook(n.authResponse.accessToken,"",r)}else t.HideLoading()};t.FirstTimeFacebookUserLogin=function(){if(t.FirstTimeFacebookUserPasswordForm.$valid){var n=t.FirstTimeFacebookUserPasswordForm.firstTimeFacebookUser_Password.$modelValue,r=$("[name=firstTimeFacebookUser_Password]").attr("accesstoken"),u=$("#ReturnUrl").val();t.ShowLoading(AVON.messages.spinner_login);i.loginWIthFacebook(r,n,u)}else t.ShowValidation=!0};t.ViewPrivacyPolicy=function(){window.open(t.privacyUrl,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};t.ViewConditionsOfUse=function(){window.open(t.conditionsOfUseUrl,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};t.$on("ModalClosed",function(){new e});t.$on("LoginService.LoginResponse",function(n,i,r){ForgotPasswordModule.forgotPasswordscope&&(ForgotPasswordModule.forgotPasswordscope.ShowValidation=!1);i.ErrorCode===1?r==t&&(t.HideLoading(),t.ShowValidation=!0,t.ProcessAjaxValidationErrors(i),_.defer(function(){$.each(i.ValidationErrors,function(n,i){t.LoginForm[i.FieldName]!==undefined&&(t.LoginForm[i.FieldName].$invalid=!0);var u=$(".ErrorSummaryContainer .ValidationSummaryServer span a");f(u)(r)})})):i.OpenModalId||i.IdToReplace?$("#LoginModal").trigger("close"):AVON.RedirectToPowerReviews&&AVON.PowerReviewLink&&(i.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AVON.common.redirectTo(AVON.PowerReviewLink)},250))});t.$on("LoginService.AutoLoginResponse",function(n,t){t.ErrorCode===0&&AvonModule.AvonScope.postLoginAction&&AVON.RedirectToBazaarVoice&&(t.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AvonModule.AvonScope.postLoginAction()},250))});t.$on("LoginService.FacebookLoginResponse",function(n,i){t.HideLoading();$("#LoginModal").trigger("close");i.status===200&&i.data.Data==""?($("#FirstTimeFacebookUserModal").trigger("close"),AVON.RedirectToPowerReviews&&AVON.PowerReviewLink?(i.data.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AVON.common.redirectTo(AVON.PowerReviewLink)},250)):AvonModule.AvonScope.postLoginAction?(i.data.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AvonModule.AvonScope.postLoginAction()},250)):i.data.RedirectUrl&&top.location.replace(i.data.RedirectUrl)):i.data.Data==2&&$("#PasswordError").show()});t.$on("LoginService.FacebookRegisterResponse",function(n,t){t.status===200&&(AVON.RedirectToPowerReviews&&AVON.PowerReviewLink?(t.data.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AVON.common.redirectTo(AVON.PowerReviewLink)},250)):AvonModule.AvonScope.postLoginAction&&(t.data.Processed=!0,setTimeout(function(){AvonModule.AvonScope.postLoginAction()},250)))})}return __extends(t,n),t.$inject=["$scope","loginService","$http","trackingService","$compile"],t}(BaseAngularController);n.LoginCtrl=t}(LoginModule||(LoginModule={}));app.controller("LoginController",LoginModule.LoginCtrl),function(n){n.looksWeLoveScope;var t=function(t){function i($scope,$element){t.call(this,$scope);n.looksWeLoveScope=$scope;n.looksWeLoveScope.ShowLooksWeLoveOverlay=function(t){if(!n.looksWeLoveScope.IsTouchDevice()){var i=angular.element(t.currentTarget),r=i.attr("id");n.looksWeLoveScope.ShowLooksWeLoveImageId=r}};n.looksWeLoveScope.HideLooksWeLoveOverlay=function(){n.looksWeLoveScope.IsTouchDevice()||(n.looksWeLoveScope.ShowLooksWeLoveImageId=n.looksWeLoveScope.CurrentShowLooksWeLoveImageId)};n.looksWeLoveScope.ShowLooksWeLoveImageContent=function(t){var r=angular.element(t.currentTarget),i=r.attr("id");n.looksWeLoveScope.ShowLooksWeLoveImageContentId="Content-"+i;n.looksWeLoveScope.ShowLooksWeLoveImageId=i;n.looksWeLoveScope.CurrentShowLooksWeLoveImageId=n.looksWeLoveScope.ShowLooksWeLoveImageId};n.looksWeLoveScope.ShowLooksWeLoveImageContentTap=function(t){n.looksWeLoveScope.IsTouchDevice()&&n.looksWeLoveScope.ShowLooksWeLoveImageContent(t)};n.looksWeLoveScope.ShowLooksWeLoveImageContentClick=function(t){n.looksWeLoveScope.IsTouchDevice()||n.looksWeLoveScope.ShowLooksWeLoveImageContent(t)};n.looksWeLoveScope.$on("ProductService.ProductsLoaded",function(){if($element.find(window.location.hash).length>0&&(n.looksWeLoveScope.LoadOperationsCount+=1,n.looksWeLoveScope.LoadOperationsCount>=2)){var t=$(window.location.hash)[0].id;n.looksWeLoveScope.ShowLooksWeLoveImageContentId="Content-"+t;n.looksWeLoveScope.ShowLooksWeLoveImageId=t;n.looksWeLoveScope.CurrentShowLooksWeLoveImageId=n.looksWeLoveScope.ShowLooksWeLoveImageId;_.delay(function(){n.looksWeLoveScope.ScrollToTop($element,!1)},1e3)}});n.looksWeLoveScope.$on("ProductService.PromotionsLoaded",function(){if($element.find(window.location.hash).length>0&&(n.looksWeLoveScope.LoadOperationsCount+=1,n.looksWeLoveScope.LoadOperationsCount>=2)){var t=$(window.location.hash)[0].id;n.looksWeLoveScope.ShowLooksWeLoveImageContentId="Content-"+t;n.looksWeLoveScope.ShowLooksWeLoveImageId=t;n.looksWeLoveScope.CurrentShowLooksWeLoveImageId=n.looksWeLoveScope.ShowLooksWeLoveImageId;_.delay(function(){n.looksWeLoveScope.ScrollToTop($element,!1)},1e3)}});_.defer(function(){n.looksWeLoveScope.ShowLooksWeLoveImageId=$element.find(".ImageRowWrapper > div")[0].id;n.looksWeLoveScope.ShowLooksWeLoveImageContentId="Content-"+n.looksWeLoveScope.ShowLooksWeLoveImageId;n.looksWeLoveScope.CurrentShowLooksWeLoveImageId=n.looksWeLoveScope.ShowLooksWeLoveImageId})}return __extends(i,t),i.$inject=["$scope","$element"],i}(BaseAngularController);n.LooksWeLoveController=t}(LooksWeLoveModule||(LooksWeLoveModule={}));app.controller("LooksWeLoveController",LooksWeLoveModule.LooksWeLoveController),function(n){"use strict";n.lpmContextMenuScope;var t=function(t){function i($scope,i){t.call(this,$scope);n.lpmContextMenuScope=$scope;n.lpmContextMenuScope.ShowLpmmenu=!1;n.lpmContextMenuScope.Options=[];n.lpmContextMenuScope.SessionService.WhenReady().then(function(t){n.lpmContextMenuScope.CampaignNumber=t.Customer.Campaign;n.lpmContextMenuScope.PreviewAtDate=t.LpmPreview.PreviewAtDate});n.lpmContextMenuScope.GetActiveCampaigns=function(){i.GetActiveCampaigns()};n.lpmContextMenuScope.GetActiveLookup=function(){i.GetActiveLookup()};n.lpmContextMenuScope.GetEnvironmentInfo=function(){i.GetEnvironmentInfo()};n.lpmContextMenuScope.GetActiveCampaigns();n.lpmContextMenuScope.GetActiveLookup();n.lpmContextMenuScope.GetEnvironmentInfo();n.lpmContextMenuScope.UpdateCampaign=function(){n.lpmContextMenuScope.ShowLoading(AVON.messages.spinner_processing);var t=document.location.pathname+document.location.search;i.SetCampaign(n.lpmContextMenuScope.CampaignNumber,t)};n.lpmContextMenuScope.GetPreviewByDate=function(){var t=n.lpmContextMenuScope.PreviewAtDate,i="/content/togglepreview/true/previewAtDate/"+t;n.lpmContextMenuScope.RedirectToUrl(i)};n.lpmContextMenuScope.UpdateCampaignAndPreviewDate=function(){n.lpmContextMenuScope.ShowLoading(AVON.messages.spinner_processing);i.SetCampaign(n.lpmContextMenuScope.CampaignNumber,null);_.delay(function(){if(n.lpmContextMenuScope.ShowLoading(AVON.messages.spinner_processing),n.lpmContextMenuScope.PreviewAtDate!=""){var t=n.lpmContextMenuScope.PreviewAtDate,i="/content/togglepreview/true/previewAtDate/"+t;n.lpmContextMenuScope.RedirectToUrl(i)}else window.location.reload(!0)},500)};n.lpmContextMenuScope.$on("LpmContextMenuService.ActiveCampaignsReceived",function(t,i){var r=i.Data;_.each(r,function(t){n.lpmContextMenuScope.Options.push({text:t.CampaignNumber,value:t.CampaignNumber})})});n.lpmContextMenuScope.$on("LpmContextMenuService.ActiveLookupReceived",function(t,i){var r=i.Data;n.lpmContextMenuScope.Lookup=r});n.lpmContextMenuScope.$on("LpmContextMenuService.EnvironmentInfoReceived",function(t,i){var r=i.Data;n.lpmContextMenuScope.Environment=r.Environment.toTitleCase();n.lpmContextMenuScope.BuildVersion=r.BuildVersion});n.lpmContextMenuScope.LpmMenuSlide=function(){return(this.tog=!this.tog)?n.lpmContextMenuScope.OpenLpmMenu():n.lpmContextMenuScope.CloseLpmMenu()};n.lpmContextMenuScope.OpenLpmMenu=function(){n.lpmContextMenuScope.ShowLpmmenu=!0;$("#LpmContextMenu").css("visibility","visible");$("#LpmContextMenu").animate({top:"+=134px"},"slow");$("#LpmContext").animate({top:"+=134px"},"slow")};n.lpmContextMenuScope.CloseLpmMenu=function(){n.lpmContextMenuScope.ShowLpmmenu=!1;$("#LpmContextMenu").animate({top:"-=134px"},"slow");$("#LpmContext").animate({top:"-=134px"},"slow",function(){$("#LpmContextMenu").css("visibility","hidden")})};$(document).ready(function(){$("#LpmContextMenu").css("top","-134px");$("#LpmContextMenu").css("visibility","hidden")})}return __extends(i,t),i.$inject=["$scope","LpmContextMenuService"],i}(BaseAngularController);n.LpmContextMenuController=t}(LpmContextMenuModule||(LpmContextMenuModule={}));app.controller("LpmContextMenuController",LpmContextMenuModule.LpmContextMenuController),function(n){"use strict";n.pageNavigatorScope;var t=function(t){function i($scope){t.call(this,$scope);n.pageNavigatorScope=$scope;n.pageNavigatorScope.isActiveLink=!1;n.pageNavigatorScope.SetLinkActiveState=function(){n.pageNavigatorScope.isActiveLink=!0}}return __extends(i,t),i.$inject=["$scope"],i}(BaseAngularController);n.PageNavigatorModuleController=t}(PageNavigatorModule||(PageNavigatorModule={}));app.controller("PageNavigatorModuleController",PageNavigatorModule.PageNavigatorModuleController);$(document).ready(function(){location.hash?$("a[href$='"+location.hash+"']").addClass("active"):$("a[href='"+location.pathname+"']").addClass("active");$(".PageNavigatorModule #PageNavigator a").click(function(){$("#PageNavigator a").removeClass("active");$(this).addClass("active")})}),function(n){n.productCarouselScope;var t=function(t){function i($scope){t.call(this,$scope);n.productCarouselScope=$scope;n.productCarouselScope.starRange=_.range(5);n.productCarouselScope.products=AVON.productCarouselProducts;n.productCarouselScope.MaxProductNameAllowed=55;n.productCarouselScope.GetFilledStars=function(n){return{width:n*20-3+"%"}};n.productCarouselScope.GetProductName=function(t){return t.length>n.productCarouselScope.MaxProductNameAllowed?t.substring(0,n.productCarouselScope.MaxProductNameAllowed)+"<span>...<\/span>":t}}return __extends(i,t),i.$inject=["$scope"],i}(BaseAngularController);n.ProductCarouselController=t}(ProductCarouselModule||(ProductCarouselModule={}));app.controller("ProductCarouselController",ProductCarouselModule.ProductCarouselController),function(n){var i=function(){function n(){}return n}(),t;n.BagItem=i;t=function(n){function t($scope,t,i,r,u,f,e){function g(){$(document).find("#BVRRDisplayContentNoReviewsID").length===0&&(o.DisplayProductReviews=!0,o.SafeApply())}function nt(n,t){var i=n.toLowerCase(),r=t.toLowerCase();return i<r?-1:i>r?1:0}var v,o,y,h,p,d,w,b,k,l;n.call(this,$scope);v=function(){return{qty:null,selectedValue:"",variant:null,AutoReplenishmentFrequency:0}};o=$scope;o.bagService=t;o.starRange=_.range(5);o.product=AVON.product;o.IngredientsContentsOriginal=o.SecureHtml(this.formatIngredients(AVON.product.Ingredients));o.productIngredientsFormatted=o.IngredientsContentsOriginal;o.product.Description=o.SecureHtml(o.product.Description);o.DescriptionContentsOriginal=o.product.Description;o.TempShoppingBag=[];o.TempShoppingBag.push(v());o.activeTab="DetailTab_Description";o.NotifyMeShadeItem=null;o.products=AVON.productList;o.DisplayProductReviews=!1;o.DisplayProductReviews=!1;o.DisplayThumbnailCarousel=!0;o.IsVariantAvailbleSoonMessage=!1;o.AddToBagClientSideValidationError=!1;o.ImagesIndexLoaded=[];o.SmallImages=[];o.AutoReplenishmentOptionModel=o.product.Availability==7?"AutoReplenishment":"OneTime";o.AutoReplenishmentFrequency=0;o.HasProductSubscriptionForAutoReplenishment=!1;o.AutoReplenishmentButton=0;o.ProductHasAutoReplenishmentPurchaseOption=!1;o.AutoReplenishmentVariantSubscriptions=[];o.AutoReplenishmentFrequencyList=[];o.AutoReplenishmentQuantityLimit=1;o.FrequencySelectError=!1;o.IsAutoReplenishmentProductJustAdded=!1;o.SessionService.WhenReady().then(function(){o.ProductHasAutoReplenishmentPurchaseOption=o.product.PriceModel.AutoReplenishmentPrice>0;o.AutoReplenishmentFrequencyList=o.product.AutoReplenishmentFrequencyList;var n=AvonModule.AvonScope.Session.AutoReplenishmentSubscription;$.each(n,function(n,t){$.each(o.product.VariantGroups,function(n,i){$.each(i.Variants,function(n,i){i.Sku===t.Sku&&o.IsAutoReplenishmentSubscriptionActive(t.StatusCode)&&o.AutoReplenishmentVariantSubscriptions.push(i.Sku)})})});o.AutoReplenishmentVariantSubscriptions.length>=1&&(o.HasProductSubscriptionForAutoReplenishment=!0,o.product.IsMultiVariantProduct||(o.AutoReplenishmentButton=1));_.defer(function(){o.HasAutoReplenishmentSingleVariantItemInBag()&&(o.AutoReplenishmentButton=2,o.SafeApply(),$("select.FrequencySelect").prop("disabled",!0))})});o.HasAutoReplenishmentSubscription=function(n){var i=AvonModule.AvonScope.Session.AutoReplenishmentSubscription,t=!1;return o.AutoReplenishmentOptionModel==="AutoReplenishment"&&n.hasOwnProperty("variant")&&n.variant!==null&&n.variant.hasOwnProperty("Sku")&&$.each(i,function(i,r){n.variant.Sku===r.Sku&&o.IsAutoReplenishmentSubscriptionActive(r.StatusCode)&&(t=!0)}),o.CheckForAutoReplenishmentAlreadySubscribed(),t};o.HasAutoReplenishmentSingleVariantItemInBag=function(){var n=!1;return o.product.IsMultiVariantProduct&&(o.product.Availability!==7||o.product.IsMultiVariantProduct)||$.each(AvonModule.AvonScope.Session.Cart.Campaigns,function(t,i){$.each(i.Items,function(t,i){if(i.Sku===o.product.VariantGroups[0].Variants[0].Sku&&i.AutoReplenishmentFrequency>0){var r=o.AutoReplenishmentFrequencyList.indexOf(i.AutoReplenishmentFrequency);o.AutoReplenishmentFrequency=o.AutoReplenishmentFrequencyList[r];n=!0}})}),n};o.HasAutoReplenishmentVariantItemInBag=function(n){var t=!1;return o.AutoReplenishmentOptionModel==="AutoReplenishment"&&n.hasOwnProperty("variant")&&n.variant!==null&&n.variant.hasOwnProperty("Sku")&&$.each(AvonModule.AvonScope.Session.Cart.Campaigns,function(i,r){$.each(r.Items,function(i,r){r.Sku===n.variant.Sku&&r.AutoReplenishmentFrequency>0&&(o.AutoReplenishmentButton=2,t=!0)})}),t};o.CheckForAutoReplenishmentAlreadySubscribed=function(){var n=[],t;n.length=0;t=AvonModule.AvonScope.Session.AutoReplenishmentSubscription;$.each(o.TempShoppingBag,function(t,i){$.each(o.AutoReplenishmentVariantSubscriptions,function(t,r){i.hasOwnProperty("variant")&&i.variant!==null&&i.variant.hasOwnProperty("Sku")&&r===i.variant.Sku&&n.push(r)})});o.HasProductSubscriptionForAutoReplenishment=n.length!==0&&n.length===o.TempShoppingBag.length-1?!0:!1};y=$("#ContentModal");$("#ProductQuickShopContainer").addClass("Ready");$(".ClickToEnlarge").hide();h=$(".NotifyMeQuickShopForm").length?$("#QuickView").find(".Columns_2"):$(document).find(".Columns_2");_.defer(function(){h.find(".VariantSelect").off("select2-opening");h.find(".VariantSelect").on("select2-opening",function(){l()})},200);setTimeout(function(){g()},4e3);window.location.href.indexOf("#ExclusiveOffersContent")!=-1&&(o.activeTab="DetailTab_ExclusiveOffers");o.IsShadeSelected=function(n){return o.GetVariantFromTempShoppingBag(n.Sku)!=null};o.DisplayBothAutoReplenishmentAndNormalPurchaseOptions=function(n){return n!==7&&n!==0&&n!==2&&n!==3&&n!==9};o.RemoveItemFromTempShoppingBag=function(n){var t=o.TempShoppingBag.indexOf(n);o.TempShoppingBag.splice(t,1);p();o.CheckForAutoReplenishmentAlreadyAddedOrSubscribed()};p=function(){if(o.TempShoppingBag.length>0){var n=o.TempShoppingBag[o.TempShoppingBag.length-1];(n.qty!=null||n.selectedValue!=""||n.variant!=null)&&o.TempShoppingBag.push(v())}else o.TempShoppingBag.push(v())};o.ShowAddToBag=function(){if(o.ConditionalProductCheck()&&(o.product.Availability=o.ConditionProductRemainingQuantityAllowedToBuy>0?1:5),o.product.Availability!=1&&o.product.Availability!=7)return!1;if(!o.product.IsMultiVariantProduct)return!0;var n=!1;return $.each(o.TempShoppingBag,function(t,i){if(i.variant==null||i.variant.Availability==1)return n=!0,!1}),n};o.ShowNotifyMeButton=function(){return o.product.Availability==3?!0:!o.product.IsShadeVariant&&o.TempShoppingBag.length==1&&o.TempShoppingBag[0].variant!=null&&o.TempShoppingBag[0].variant.Availability==3?!0:!1};o.IsOptionDisabled=function(n,t){if(o.AutoReplenishmentOptionModel!=="OneTime")for(var i=0;i<o.TempShoppingBag.length;i++)if((!t||t!=n.Sku)&&o.TempShoppingBag[i]&&o.TempShoppingBag[i].variant&&o.TempShoppingBag[i].variant.Sku==n.Sku)return!0;return n==null||n.Availability==1||n.Availability==3||n.Availability==7?!1:!0};o.GetVariantFromTempShoppingBag=function(n){var t=null;return $.each(o.TempShoppingBag,function(i,r){if(r.variant!=null&&r.variant.Sku==n)return t=r,!1}),t};d=function(){var n,t;o.TempShoppingBag.length>0&&(n=o.TempShoppingBag[o.TempShoppingBag.length-1],n.qty==null&&n.selectedValue==""&&n.variant==null&&(t=o.TempShoppingBag.indexOf(n),o.TempShoppingBag.splice(t,1)))};o.ShadeChanged=function(n){var i,r,t;if(l(),n.selectedValue.length==0){o.RemoveItemFromTempShoppingBag(n);return}for(i=o.TempShoppingBag.indexOf(n),n.qty=null,n.variant=o.GetVariantFromProduct(n.selectedValue),r=!1,t=0;t<o.TempShoppingBag.length-1;t++)if(o.TempShoppingBag[t].variant==n.variant&&t!=i){n.variant.Availability==1&&n.qty==null&&(n.qty=1);r=!0;break}n.variant.Availability==1&&(n.qty=1);p();o.CheckForAutoReplenishmentAlreadyAddedOrSubscribed()};o.NonShadeVariantChanged=function(){l();var n=o.TempShoppingBag[0];if(n.selectedValue.length==0){n.qty=null;n.variant=null;return}n.qty=null;n.variant=o.GetVariantFromProduct(n.selectedValue);n.variant.Availability==1&&(n.qty=1)};o.ShadeSwatchClicked=function(n){l();d();var t=o.GetVariantFromTempShoppingBag(n.Sku);t==null?(n.Availability==1||n.Availability==3||n.Availability==7)&&o.TempShoppingBag.push({qty:n.Availability==1||n.Availability==7?1:null,selectedValue:n.Sku,variant:n,AutoReplenishmentFrequency:0}):(t.variant.Availability==1||t.variant.Availability==7)&&o.AutoReplenishmentOptionModel!=="AutoReplenishment"&&(t.qty=parseInt(t.qty+"")+1);p();o.CheckForAutoReplenishmentAlreadyAddedOrSubscribed()};o.CheckForAutoReplenishmentAlreadyAddedOrSubscribed=function(){var t=[],n=[];t.length=0;n.length=0;$.each(o.TempShoppingBag,function(n,i){$.each(AvonModule.AvonScope.Session.Cart.Campaigns,function(n,r){$.each(r.Items,function(n,r){i.variant!==null&&r.Sku===i.variant.Sku&&i.AutoReplenishmentFrequency>0&&t.push(r.Sku)})})});$.each(o.TempShoppingBag,function(t,i){$.each(o.AutoReplenishmentVariantSubscriptions,function(t,r){i.hasOwnProperty("variant")&&i.variant!==null&&i.variant.hasOwnProperty("Sku")&&r===i.variant.Sku&&n.push(r)})});o.AutoReplenishmentButton=t.length+n.length!==0&&t.length+n.length===o.TempShoppingBag.length-1?n.length!==0&&n.length===o.TempShoppingBag.length-1?1:2:0};o.GetVariantFromProduct=function(n){var t=null;return $.each(o.product.VariantGroups,function(i,r){if(t!=null)return!1;$.each(r.Variants,function(i,r){if(r.Sku==n)return t=r,!1})}),t};w=function(n){var i="/product/NotifyMeModal?pfid="+o.product.Id.toString()+"&fsc="+n,t;o.ShowLoading(AVON.messages.spinner_loading);t={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:i};y.trigger("modal",t)};o.OpenNotifyMeForShade=function(n,t,i){o.NotifyMeShadeItem=n;t?(h.find(".NotifyMeQuickShopForm"+i).show(),h.find(".NotifyFormContainer"+i).load("/product/notifymemodal?pfid="+o.product.Id.toString()+"&fsc="+n.variant.Fsc+"&quickshop=true",null,function(){u($(".NotifyFormContainer"+i).contents())($scope);h.find("#NotifyMeSuccessQuickViewContainer").hide()})):w(n.variant.Fsc)};o.OpenNotifyMe=function(n){var t="";o.product.IsMultiVariantProduct&&!o.product.IsShadeVariant&&(t=o.TempShoppingBag[0].variant!==null?o.TempShoppingBag[0].variant.Fsc:o.product.VariantGroups[0].Variants[0].Fsc);n?(h.find(".NotifyMeQuickShopForm").show(),h.find(".NotifyFormContainer").load("/product/notifymemodal?pfid="+o.product.Id.toString()+"&fsc="+t+"&quickshop=true",null,function(){u($(".NotifyFormContainer").contents())($scope);h.find("#NotifyMeSuccessQuickViewContainer").hide();h.find(".NotifyMeButton").hide()})):w(t)};o.OnShadeEnter=function(n){var i=$(angular.element(n.currentTarget).parents(".VariantImage")[0]),t,r;i.siblings("div").addClass("active");t=i.siblings(".Overlay.active");t.width(t.parent().width()-(t.outerWidth(!0)-t.width()));r=i.siblings(".RotatedCaret45.active");t.css("margin-top",function(){return"-"+(t.height()+18)+"px"})};o.OnShadeLeave=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")};o.ExclusiveOffersLink=function(n,t,i){t?window.location.href=i+"#ExclusiveOffersContent":o.showDetailTab(n,"DetailTab_ExclusiveOffers")};o.ShowShadeRemoveButton=function(n){var t=o.TempShoppingBag.length;return t==1?!1:n+1==t?!1:!0};b=function(n){if(!$.isNumeric(n))return 1;var t=parseInt(n);return t>0&&t<100?t:1};o.GetBagItems=function(){var n=o.product,t=o.TempShoppingBag;return n.IsMultiVariantProduct||n.Availability!=1&&n.Availability!=7||(t[0].variant=n.VariantGroups[0].Variants[0]),o.ShoppingBag=[],$.each(t,function(n,t){var r,i,u;t.variant!=null&&(t.variant.Availability==1||t.variant.Availability==7)&&(r=o.FindVariantInBag(t.variant.Sku),r===null?(i=new AddBagItem,i.Quantity=b(t.qty),i.Sku=t.variant.Sku,i.OrderType="Customer",i.AutoReplenishmentFrequency=t.AutoReplenishmentFrequency,o.ShoppingBag.push(i)):n>0&&t.qty.toString()!=""&&t.qty>0&&t.qty<99&&(u=parseInt(o.ShoppingBag[r].Quantity+"")+parseInt(b(t.qty)+""),o.ShoppingBag[r].Quantity=u))}),t};o.addToBag=function(n,t){if(o.IsAutoReplenishmentProductJustAdded=!1,!($(".AddToBagQuickshop.Button2").length>0)){l();o.AddButtonClicked=$(n.target);var i=o.GetBagItems();if(o.ShoppingBag.length===0){o.AddToBagClientSideValidationError=!0;return}o.ShowLoading(AVON.messages.spinner_adding);o.TempShoppingBag[0].variant!==null&&f.UpdateProductDetailsSku(i);AVON.product=o.product;o.bagService.addMultipleItemsToBag(o.ShoppingBag,t)}};o.addAutoReplenishmentToBag=function(n,t){if(o.AddButtonClicked=$(n.target),!o.AutoReplenishmentFrequency||o.AutoReplenishmentFrequency<1)o.FrequencySelectError=!0,$(".FrequencySelect").addClass("FormError"),o.GetBagItems(),o.ShoppingBag.length===0&&(o.AddToBagClientSideValidationError=!0);else{o.FrequencySelectError=!1;var r=o.TempShoppingBag,i=[];$.each(r,function(n,t){$.each(o.AutoReplenishmentVariantSubscriptions,function(n,r){t.hasOwnProperty("variant")&&t.variant!==null&&t.variant.hasOwnProperty("Sku")&&r===t.variant.Sku&&i.push(t)});$.each(AvonModule.AvonScope.Session.Cart.Campaigns,function(n,r){$.each(r.Items,function(n,r){t.hasOwnProperty("variant")&&t.variant!==null&&t.variant.hasOwnProperty("Sku")&&r.Sku===t.variant.Sku&&r.AutoReplenishmentFrequency>0&&i.push(t)})});t.hasOwnProperty("qty")&&t.qty>o.AutoReplenishmentQuantityLimit&&(t.qty=o.AutoReplenishmentQuantityLimit);t.AutoReplenishmentFrequency=o.AutoReplenishmentFrequency});i.length>0&&$.each(i,function(n,t){var i=r.indexOf(t);r.splice(i,1)});o.addToBag(n,t)}};o.AutoReplenishmentFrequencyChanged=function(){l()};o.AutoReplenishmentOptionChange=function(){var n,t;if(o.AddToBagClientSideValidationError=!1,o.FrequencySelectError=!1,o.AutoReplenishmentOptionModel==="AutoReplenishment")for(n=0;n<o.TempShoppingBag.length;n++)for(o.TempShoppingBag[n].qty>1&&(o.TempShoppingBag[n].qty=1),t=n+1;t<o.TempShoppingBag.length;t++)o.TempShoppingBag[t].variant&&o.TempShoppingBag[n].variant&&o.TempShoppingBag[t].variant.Sku==o.TempShoppingBag[n].variant.Sku&&(o.TempShoppingBag.splice(t,1),t--);o.SafeApply()};o.$on("BagService.AddToBagSuccess",function(n,t){var f=t,e=o.TempShoppingBag[0].AutoReplenishmentFrequency>0,r,u,i;o.IsAutoReplenishmentProductJustAdded=f.ItemsAdded&&f.ItemsAdded.length>0?f.ItemsAdded[0].AutoReplenishmentFrequency>0:!1;o.TempShoppingBag=[];o.TempShoppingBag.push(v());o.ShowAddToBag();r=".QuickShopSuccessMsg";u=".QuickShopAutoReplenishmentSuccessMsg";o.AutoReplenishmentOptionModel!=="OneTime"&&(r=".ReOccurring.Selected ".concat(r),u=".ReOccurring.Selected ".concat(u));$(r).show();$(u).css({display:"block"});i=o.AddButtonClicked;i.prop("value",i.attr("data-added-msg"));i.html(i.attr("data-added-msg"));i.prop("disabled",!0);i.removeClass("Button").addClass("Button2");o.AutoReplenishmentFrequency=0;setTimeout(function(){$(".QuickShopSuccessMsg").hide();i.prop("value",i.attr("data-add-msg"));i.html(i.attr("data-add-msg"));i.removeClass("Button2").addClass("Button");i.prop("disabled",!1)},5e3)});o.CloseModal=function(){$("#QuickView").trigger("close")};o.$on("ProductAddedToBagModalClosed",function(){o.ShowAddToBag();_.defer(function(){o.HasAutoReplenishmentSingleVariantItemInBag()&&(o.SafeApply(),$("select.FrequencySelect").prop("disabled",!0))})});o.ConditionalProductCheck=function(){var t=!1,n;if(o.Session.Cart.ConditionalProducts)for(n=0;n<o.Session.Cart.ConditionalProducts.length;n++)o.Session.Cart.ConditionalProducts[n].PfId===o.product.Id&&o.Session.Cart.ConditionalProducts[n].Campaign===o.Session.Customer.Campaign&&(o.ConditionProductRemainingQuantityAllowedToBuy=o.Session.Cart.ConditionalProducts[n].QuantityAllowedToBuy,t=!0,$(".QuantityAllowedToBuy").text(o.ConditionProductRemainingQuantityAllowedToBuy));return t};o.$on("NotifyMeService.NotifyMeQuickShopResponse",function(n,t){setTimeout(function(){k(t)},4e3)});o.$on("NotifyMeService.NotifyMeResponse",function(n,t){k(t)});k=function(n){n.ErrorCode===0&&(o.product.IsShadeVariant&&o.NotifyMeShadeItem!=null&&o.RemoveItemFromTempShoppingBag(o.NotifyMeShadeItem),o.product.IsMultiVariantProduct&&!o.product.IsShadeVariant&&(o.TempShoppingBag[0]=v()))};o.OpenVideoModal=function(n){o.OpenYouTubeModal(n.VideoId,!0,0)};o.VideoImageUrl=function(n){var t=n.indexOf("?")>0?n.indexOf("?"):n.length;return n=n.substring(0,t),"https://i1.ytimg.com/vi/"+n+"/sddefault.jpg"};l=function(){o.AddToBagClientSideValidationError=!1;o.FrequencySelectError=!1;o.SafeApply();$(".FrequencySelect").removeClass("FormError")};o.FindVariantInBag=function(n){for(var t=0,i=o.ShoppingBag.length;t<i;t++)if(o.ShoppingBag[t].Sku===n)return t;return null};o.IsVariantAvailable=function(n){return n.Availability==1||n.Availability==7};o.IsVariantAvailableSoon=function(n){return n.Availability==3};o.DisplayVariantLineNumber=function(n,t){return!n.LineNumber||n.LineNumber=="000000"||n.LineNumber=="991025"||n.LineNumber.length<=3?"":(t?" - ":"")+n.LineNumber.substr(0,3)+"-"+n.LineNumber.substr(n.LineNumber.length-3)};o.IsVariantShade=function(n){return n===1?!0:!1};o.showDetailTab=function(n,t){$("#DetailTabs li").removeClass("Selected");$(this).parent("li").addClass("Selected");$("#DetailTabs div").removeClass("Selected");$("#"+t).addClass("Selected");o.activeTab=t};r.$on("EllipsisComplete",function(){});o.DisplayChartSize=function(n){if(AVON.IsTabletDevice||$(".android").length>0){e.open(n,"_blank");return}_.defer(function(){var t={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:""+n+"",UseIFrame:!0,IFrameWidth:"750px",IFrameHeight:"750px"};y.trigger("modal",t)})};o.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t,r;i.siblings("div").addClass("active");t=i.siblings(".Overlay.active");t.width(i.width()-(t.outerWidth(!0)-t.width()));var u=$(".NavBar"),e=u.offset().left+u.innerWidth(),o=t.offset().left+t.innerWidth(),f=o-e;f>0&&t.css({"margin-left":-f});r=i.siblings(".RotatedCaret45.active");r.css({"margin-left":i.width()/2-r.width()/2})};o.HidePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")};var s=[],c=0,a=0;o.$on("FallbackSrc.ImageFound",function(n,t){var i=t.element;i.parent(".SmallImage")&&i.attr("data-zoom-image")!==undefined&&$.inArray(i.attr("data-zoom-image"),s)===-1&&(c++,a++,s.push(i.attr("data-zoom-image")),c===o.product.NumberProductImages&&o.$broadcast("BuildImageCarousel"))});o.$on("FallbackSrc.NoImageFound",function(n,t){t.parent(".SmallImage")&&t.attr("data-zoom-image")!==undefined&&$.inArray(t.attr("data-zoom-image"),s)===-1&&(c++,t.parent().remove(),c===o.product.NumberProductImages&&o.$broadcast("BuildImageCarousel"))});o.$on("SecondaryImage.ImageFound",function(n,t,i){var u=t.element,e,f,l;if(u.parent(".SmallImage")&&u.attr("data-zoom-image")!==undefined&&$.inArray(u.attr("data-zoom-image"),s)===-1){if(o.ImagesIndexLoaded.indexOf(i)<0)e=u.attr("data-zoom-image"),f=u.attr("src"),f=f.substring(0,f.lastIndexOf("?"))+e.substring(e.lastIndexOf("?")),u.attr("data-zoom-image",f),o.ImagesIndexLoaded.push(i),c++,a++,l=u.parent(".SmallImage").index(),s[l]=u.attr("data-zoom-image"),o.SmallImages.push(u.parent(".SmallImage")),u.parent(".SmallImage").data("index",i);else{var f=u.attr("src"),v=f.lastIndexOf("_"),y=f.lastIndexOf("."),h=f.substring(v+1,y);parseInt(h)<10?(f=f.substring(0,v+1)+(parseInt(h)+1)+f.substring(y),u.attr("src",f)):parseInt(h)>=10&&(u.css("display","none"),u.attr("data-removed","1"),u.off("error"),r.$broadcast("FallbackSrc.NoImageFound",u))}c===o.product.NumberProductImages&&(o.SortSmallImages(),o.$broadcast("BuildImageCarousel"))}});o.$on("SecondaryImage.NoImageFound",function(n,t){t.parent(".SmallImage")&&t.attr("data-zoom-image")!==undefined&&$.inArray(t.attr("data-zoom-image"),s)===-1?(c++,t.parent().remove(),c===o.product.NumberProductImages&&o.$broadcast("BuildImageCarousel")):t.hasClass("ProductImage")&&(t.attr("src","/images/Responsive/Product/PhotoNotAvailable.png"),r.$broadcast("FallbackSrc.NoImageFound",t))});o.SortSmallImages=function(){var n=$("#ProductSmallImageCarousel .Slides");o.SmallImages.sort(function(n,t){return-$(n).data("index")+$(t).data("index")}).forEach(function(t,i){t.data("index",c-i);n.prepend(t)})};o.$on("BuildImageCarousel",function(){var i,t,n,r;for(s=s.sort(nt),i=$(".DefaultImageArea"),t="",n=0;n<s.length;n++)n===0&&(t+="<carousel id='ProductImageCarousel' min-slide-width='150' class='PageButtons_Hero' slides-visible='1' wrap='false'>"),t+="<slide>\n<img data-ng-elevate-zoom class='ProductImage "+(c===1?"ProductImageActive":"")+"' alt='' src='"+s[n]+"' secondary-image='' data-zoom-image='"+s[n]+"' data-ng-click='DisplayImageModal($event)' itemprop='image' />\n<\/slide>\n",n===s.length-1&&(t+="<\/carousel>");i.append(t);u(i.contents())($scope);setTimeout(function(){$scope.$broadcast("Carousel_Update")},750);a===0?($(".DefaultImageArea").hide(),$(".ProductImageIcons").hide(),$(".ThumbnailButtons").hide(),o.NoImagePlaceholder=!0):(r=o.product.MediaAssociation.length>0,r&&a++,a<6&&($(".ThumbnailButtons").hide(),$(".SmallImages").css("width",a*85+"px")),a!==1||r||(o.DisplayThumbnailCarousel=!1))});o.$on("Carousel_Updated",function(){$scope.$broadcast("Zoom_Update")});o.ShowProductImage=function(n){var t=$(n.currentTarget).parent(".SmallImage").data("index"),r=$("#ProductImageCarousel").find(".Slide").children().removeClass("ProductImageActive"),u=$("#ProductImageCarousel").find(".Slide:nth-child("+t+")").children().addClass("ProductImageActive"),i=t-1;$scope.BroadcastToElement(o,"#ProductImageCarousel","Carousel_ShowSlide",i,!0);$scope.$broadcast("Zoom_Update")};o.ThumbnailNextClicked=function(){$(".CarouselNext").trigger("click")};o.ThumbnailPreviousClicked=function(){$(".CarouselPrevious").trigger("click")};o.starWidthStyle=function(){return{width:o.product.Rating*20+"%"}};$scope.$on("Carousel_SlideShown",function(n,t){var i,r;t.container.attr("id")=="ProductImageCarousel"&&(i=t.container.find(".Slide").children(),i.removeClass("ProductImageActive"),r=t.container.find(".Slide:nth-child("+(t.currentIndex+1)+")").children(),r.addClass("ProductImageActive"))});o.DisplayImageModal=function(n){var u=$(n.currentTarget),i=u.clone(),r,t;y.html("");r=$(i).attr("data-zoom-image");t=i.removeAttr("data-ng-elevate-zoom").removeAttr("data-zoom-image").removeAttr("data-zoom-max-width").removeAttr("data-zoom-max-height").removeClass("ProductImageActive");t=$(t).attr("src",r);t.appendTo(y);y.trigger("modal")}}return __extends(t,n),t.prototype.formatIngredients=function(n){return n?n.replaceAll(",","<br />"):""},t.$inject=["$scope","bagService","ProductDetailService","$rootScope","$compile","trackingService","$window"],t}(BaseAngularController);n.ProductQuickShopController=t}(ProductDetailModule||(ProductDetailModule={}));app.controller("ProductQuickShopController",ProductDetailModule.ProductQuickShopController),function(n){var t=function(n){function t(t,i,r,u,f,e){function p(n){n.attr("id")==="registrationModel_LoginInfo_FirstNameInput"&&$("#billingAddress_FirstNameInput").val(n.val()).removeClass("placeholder").change();n.attr("id")==="registrationModel_LoginInfo_LastNameInput"&&$("#billingAddress_LastNameInput").val(n.val()).removeClass("placeholder").change()}function w(n){angular.element("#registrationModel_LoginInfo_PasswordInput").val()!=""||angular.element("#registrationModel_LoginInfo_PasswordConfirmInput").val()!=""||angular.element("#registrationModel_LoginInfo_PasswordHintInput").val()!=""||t.RequireFullAccount?(i.$broadcast("RegistrationScope.DisplayPrivacyPolicy",!0),c(!0,n)):(i.$broadcast("RegistrationScope.DisplayPrivacyPolicy",!1),c(!1,n))}function a(){t.registrationModel=AVON.registrationModel||{NotifySpecialOffers:!0};t.showAcceptedPrivacyPolicyError=!1;t.registrationModel.LoginInfo={FirstName:"",LastName:"",Email:"",EmailConfirm:"",Password:"",PasswordConfirm:"",PasswordHint:""};t.DisplayPasswordInstructions=!0;this.isModalDisplay=!1;t.ShowValidation=!1;t.RegistrationFullPageForm=angular.element("#registrationFullPage").val()=="true";t.CreateAnAccount=angular.element("#RegistrationModal").html().length>0?!0:!1;t.RequireFullAccount=AVON.RequireFullAccount;t.RegistrationFullPageForm&&c(!1);angular.element("#registrationModel_LoginInfo_FirstNameInput").placeholder();angular.element("#registrationModel_LoginInfo_LastNameInput").placeholder();angular.element("#registrationModel_LoginInfo_EmailInput").placeholder();angular.element("#registrationModel_LoginInfo_PasswordInput").placeholder();angular.element("#registrationModel_LoginInfo_PasswordConfirmInput").placeholder();angular.element("#registrationModel_LoginInfo_PasswordHintInput").placeholder();t.RegistrationFullPageForm&&angular.element("#registrationModel_LoginInfo_FirstNameInput").focus()}function b(){t.registrationModel.IsGuestShopper=!1}function k(){var n=Math.floor(Math.random()*10),i;t.registrationModel.ReturnUrl=$("#registrationModel_ReturnUrl").val();t.registrationModel.PrivacyPolicy=!0;t.registrationModel.LoginInfo.Password="password"+n;t.registrationModel.LoginInfo.PasswordConfirm="password"+n;t.registrationModel.LoginInfo.PasswordHint="GuestShopper";t.registrationModel.NotifySpecialOffers=!1;t.registrationModel.IsGuestShopper=!0;i=t.IsEmailValid(t.registrationModel.LoginInfo.Email);i||(t.RegistrationForm.registrationModel_LoginInfo_Email.$invalid=!0);t.RegistrationForm.registrationModel_LoginInfo_FirstName.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_LastName.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_Email.$invalid===!1&&(t.RegistrationForm.$valid=!0)}function h(){!t.CreateAnAccount&&t.RegistrationFullPageForm&&(t.registrationModel.LoginInfo.Password="",t.registrationModel.LoginInfo.PasswordConfirm="",t.registrationModel.LoginInfo.PasswordHint="",t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid=!1,t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid=!1,t.RegistrationForm.registrationModel_LoginInfo_PasswordHint.$invalid=!1,$(".ValidationError.ValidationSummaryServer").html().length&&t.RequiredInvalid&&$(".ValidationError.ValidationSummaryRequired").hide(),_.delay(function(){$("#registrationModel_LoginInfo_Password").removeClass("FormError");$("#registrationModel_LoginInfo_PasswordConfirm").removeClass("FormError");$("#registrationModel_LoginInfo_PasswordHint").removeClass("FormError")}))}function v(){var r,n,i;t.HideLoading();t.DisplayEmailError=!1;t.PasswordsEmpty=!1;t.PasswordsDontMatch=!1;t.registrationModel.PrivacyPolicy===!1&&(t.showAcceptedPrivacyPolicyError=!0);t.RegistrationForm.ServerErrors.Summary===undefined||t.ShowValidation||(t.RegistrationForm.ServerErrors.Summary.$invalid=!1);o(t.registrationModel.LoginInfo.Password)||(t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid=!0);o(t.registrationModel.LoginInfo.PasswordConfirm)||(t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid=!0);r=t.IsEmailValid(t.registrationModel.LoginInfo.Email);r||(t.RegistrationForm.registrationModel_LoginInfo_Email.$invalid=!0,t.DisplayEmailError=!0);(t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid||t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid)&&(n=t.registrationModel.LoginInfo.Password,i=t.registrationModel.LoginInfo.PasswordConfirm,t.DisplayPasswordInstructions=!1,t.ValidationErrorStyle=!1,n===""&&i===""&&(t.PasswordsEmpty=!0,t.ValidationErrorStyle=!0),n!==i&&(t.PasswordsDontMatch=!0,t.ValidationErrorStyle=!0),!$("html").hasClass("ie9")||o(t.registrationModel.LoginInfo.Password)&&o(t.registrationModel.LoginInfo.PasswordConfirm)||(t.PasswordsEmpty=!0,t.ValidationErrorStyle=!0),_.delay(function(){$("#registrationModel_LoginInfo_Password").addClass("FormError");$("#registrationModel_LoginInfo_PasswordConfirm").addClass("FormError")}));h();t.ShowValidation=!0;t.RequiredInvalid=!0;t.TrackUserValidationErrors(t.RegistrationForm.$error)}function o(n){return n.match(/^(?=.*[0-9])([a-zA-Z0-9]{7,16})$/)!=null}function y(){t.registrationModel.LoginInfo.Password=$("#registrationModel_LoginInfo_PasswordInput").val();t.registrationModel.LoginInfo.PasswordConfirm=$("#registrationModel_LoginInfo_PasswordConfirmInput").val();t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid=!1;t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid=!1}function c(n,i){var r=$("[id=registrationModel_LoginInfo_PasswordInput]").attr("placeholder").replace("*",""),u=$("[id=registrationModel_LoginInfo_PasswordConfirmInput]").attr("placeholder").replace("*",""),f=$("[id=registrationModel_LoginInfo_PasswordHintInput]").attr("placeholder").replace("*","");n||t.RequireFullAccount?(angular.element("[id=registrationModel_LoginInfo_PasswordInput]").attr("placeholder",r+"*").placeholder(),angular.element("[id=registrationModel_LoginInfo_PasswordConfirmInput]").attr("placeholder",u+"*").placeholder(),angular.element("[id=registrationModel_LoginInfo_PasswordHintInput]").attr("placeholder",f+"*").placeholder(),t.HideGuestCheckoutMessage=!0):(angular.element("[id=registrationModel_LoginInfo_PasswordInput]").attr("placeholder",r).placeholder(),angular.element("[id=registrationModel_LoginInfo_PasswordConfirmInput]").attr("placeholder",u).placeholder(),angular.element("[id=registrationModel_LoginInfo_PasswordHintInput]").attr("placeholder",f).placeholder(),t.HideGuestCheckoutMessage=!1);i==="#registrationModel_LoginInfo_PasswordHintInput-clone"?($("#registrationModel_LoginInfo_PasswordHintInput").focus(),$("#registrationModel_LoginInfo_PasswordHintInput").removeClass("placeholder")):$(i).focus();t.SafeApply()}var s,l;n.call(this,t);a();t.SessionService.WhenReady().then(function(){$.each(AvonModule.AvonScope.Session.Cart.Campaigns,function(n,t){$.each(t.Items,function(n,t){var i=t.AutoReplenishmentFrequency>0;i&&(AvonModule.AvonScope.Session.Customer.IsEligibleForGuestCheckout=!1)})});t.Session.Customer.IsEligibleForGuestCheckout===!1&&(t.CreateAnAccount=!0,t.HideCreateAnAccount=!0)});AVON.TempModalModel&&(t.registrationModel.LoginInfo.Email=AVON.TempModalModel.Email);s=$("#mode");s.length>0&&s.val()==="Standard"&&(t.IsModal=!0,this.isModalDisplay=!0,u.TrackEventItem({Type:TrackingEventType.NewCustomerRegistration}));t.InputFocus=function(n){t.DisplayPasswordInstructions=!0;t.DisplayEmailError=!1;t.ValidationErrorStyle=!1;t.ShowValidation=!1;var i=$(angular.element(n.currentTarget)[0]).attr("id");_.delay(function(){$("#registrationModel_LoginInfo_Password").removeClass("FormError");$("#registrationModel_LoginInfo_PasswordConfirm").removeClass("FormError")});i==="registrationModel_LoginInfo_PasswordHintInput"&&($("#registrationModel_LoginInfo_PasswordHintInput").val().indexOf("Create a Password Hint")>-1||$("#registrationModel_LoginInfo_PasswordHintInput").val().indexOf("Pista de la contrase")>-1)&&$("#registrationModel_LoginInfo_PasswordHintInput").val("")};$("[id=registrationModel_LoginInfo_PasswordInput], [id=registrationModel_LoginInfo_PasswordConfirmInput], #registrationModel_LoginInfo_PasswordHintInput").keyup(function(){if(t.RegistrationFullPageForm){var n=$(this).attr("id");w("#"+n+"-clone")}});$("#registrationModel_LoginInfo_FirstNameInput, #registrationModel_LoginInfo_LastNameInput").keyup(function(){t.RegistrationFullPageForm&&p($(this))});t.privacyUrl=$("#privacyPolicyUrl").val();t.conditionsOfUseUrl=$("#conditionsOfUseUrl").val();$("#LoginModel_EmailInput, #LoginModel_PasswordInput").on("click",function(){t.ShowValidation=!1});t.Register=function(){y();t.RegistrationForm.$valid&&t.PreValidationRules()?(t.CreateAnAccount&&(b(),t.ShowLoading(AVON.messages.spinner_registering),t.registrationModel.ReturnUrl=$("#registrationModel_ReturnUrl").val()),r.register(t.registrationModel,$("form[name=RegistrationForm]"))):v()};t.PreValidationRules=function(){t.showAcceptedPrivacyPolicyError=!1;t.PasswordsEmpty=!1;t.PasswordsDontMatch=!1;t.DisplayEmailError=!1;t.DisplayPasswordInstructions=!0;t.ValidationErrorStyle=!1;t.ShowValidation=!1;t.registrationModel.LoginInfo.EmailConfirm=t.registrationModel.LoginInfo.Email;var n=t.IsEmailValid(t.registrationModel.LoginInfo.Email);if(n||(t.RegistrationForm.$valid=!1),t.CreateAnAccount){if(t.RegistrationFullPageForm&&(t.registrationModel.PrivacyPolicy=t.PrivacyPolicyFromFullPage),t.registrationModel.PrivacyPolicy===!1)return t.showAcceptedPrivacyPolicyError=!0,t.RegistrationForm.$valid=!1,!1;if(y(),t.registrationModel.LoginInfo.Password!==t.registrationModel.LoginInfo.PasswordConfirm)return t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid=!0,t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid=!0,!1;if(!o(t.registrationModel.LoginInfo.Password))return t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid=!0,!1;if(!o(t.registrationModel.LoginInfo.PasswordConfirm))return t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid=!0,!1;t.RegistrationForm.registrationModel_LoginInfo_FirstName.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_LastName.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_Email.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_Password.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_PasswordConfirm.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_PasswordHint.$invalid===!1&&(t.RegistrationForm.$valid=!0)}else k();return!0};t.$on("AddressesScope.AddressValidation",function(){t.ShowValidation=!0;t.registrationModel.PrivacyPolicy=!1;t.RegistrationForm.ServerErrors.Summary!==undefined||(t.RegistrationForm.ServerErrors.Summary=[]);t.RegistrationForm.ServerErrors.Summary.$invalid=!0;h();t.RegistrationForm.registrationModel_LoginInfo_FirstName.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_LastName.$invalid===!1&&t.RegistrationForm.registrationModel_LoginInfo_Email.$invalid===!1&&(t.RegistrationForm.$valid=!0);t.HideLoading()});t.SubmitFullForm=function(){t.registrationModel.PrivacyPolicy=!1;t.registrationModel.LoginInfo.Password="";t.registrationModel.LoginInfo.PasswordConfirm="";t.registrationModel.LoginInfo.PasswordHint="";t.registrationModel.IsGuestShopper=!1};t.NewCustomerRegister=function(){t.showAcceptedPrivacyPolicyError=!1;t.CreateAnAccount?t.Register():(t.PreValidationRules(),t.RegistrationForm.$valid?(t.ShowLoading(AVON.messages.spinner_loading),r.register(t.registrationModel,$("form[name=RegistrationForm]"))):(t.ShowValidation=!0,t.TrackUserValidationErrors(t.RegistrationForm.$error),t.SafeApply()))};t.PrivacyCheckBoxClick=function(){t.showAcceptedPrivacyPolicyError=!1};t.TrackUserValidationErrors=function(n){if(t.IsMobile!==!1){var i=[];n&&$.each(n,function(n,t){t&&(i.push("err-"+n),$.each(t,function(n,t){i.push(t.$name)}))});t.TrackEvent(TrackingEventType.MobileCheckoutSteps,"AccountInformation_Continue_UserError_"+i.join("_"));i=null}};t.ViewPrivacyPolicy=function(){window.open(t.privacyUrl,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};t.ViewConditionsOfUse=function(){window.open(t.conditionsOfUseUrl,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};l=this;t.$on("RegistrationService.RegisterResponse",function(n,r){var o,f;if(r.ErrorCode===0&&r.Data==="RegisterDuplicateFacebookUser"&&($("#RegistrationModal").trigger("close"),o={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/login/facebookuserresetpassword"},t.OpenDynamicModal("FacebookUserPasswordResetModal",o)),r.ErrorCode===1&&(t.ProcessAjaxValidationErrors(r),$.each(r.ValidationErrors,function(n,i){var r="registrationModel_"+i.FieldName.replace(".","_"),u;t.RegistrationForm!=undefined&&t.RegistrationForm[r]!=undefined&&(t.RegistrationForm[r].$invalid=!0,r=="registrationModel_LoginInfo_Email"&&(t.DisplayEmailError=!0,t.ValidationErrorStyle=!0));u=$(".ErrorSummaryContainer .ValidationSummaryServer span a");e(u)(t)}),t.CreateAnAccount||t.CleanPrivacyPolicy(t.RegistrationForm),u.TrackEventItem({Type:TrackingEventType.NewCustomerRegistrationFormError})),r.ErrorCode!=0&&(t.registrationModel.PrivacyPolicy=!1),r.ErrorCode===0&&(l.isModalDisplay===!1||t.RegistrationFullPageForm)){if(t.RegistrationFullPageForm){t.ShowLoading(AVON.messages.spinner_loading);i.$broadcast("AddressesScope.SaveAddresses",t.CreateAnAccount);return}t.CreateAnAccount?(AvonModule.AvonScope.postLoginAction&&AVON.RedirectToBazaarVoice&&(r.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AvonModule.AvonScope.postLoginAction()},750)),u.TrackEventItem({Type:TrackingEventType.CartNewCustAcct})):(AvonModule.AvonScope.postLoginAction&&AVON.RedirectToBazaarVoice&&(r.Processed=!0,setTimeout(function(){AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);AvonModule.AvonScope.postLoginAction()},750)),u.TrackEventItem({Type:TrackingEventType.CartContinueAsGuest}))}else h();if(t.IsMobile)switch(r.ErrorCode){case 0:t.TrackEvent(TrackingEventType.MobileCheckoutSteps,"AccountInformation_Continue_Success");break;case 1:f=[];$.each(r.ValidationErrors,function(n,t){f.push(t.FieldName+"-"+t.Problem)});t.TrackEvent(TrackingEventType.MobileCheckoutSteps,"AccountInformation_Continue_ServerErrorValidation_"+f.join(""));break;case 500:t.TrackEvent(TrackingEventType.MobileCheckoutSteps,"AccountInformation_Continue_ServerError");break;default:t.TrackEvent(TrackingEventType.MobileCheckoutSteps,"AccountInformation_Continue_Error_"+r.ErrorCode)}});t.TrackEvent=function(n,t){var i={Type:n,Value:t};u.TrackEventItem(i)};t.$on("ModalClosed",function(){a()});t.$on("RegistrationScope.ValidatePersonalInfo",function(n,r,u){t.CreateAnAccount=r;t.PrivacyPolicyFromFullPage=u;t.PreValidationRules();t.RegistrationForm.$valid||(v(),t.registrationModel.PrivacyPolicy=!1,i.$broadcast("RegistrationScope.RegistrationValidation"));i.$broadcast("AddressesScope.ValidateAddresses",t.RegistrationForm.$valid)});t.$on("RegistrationScope.SaveDetails",function(){t.PreValidationRules();t.NewCustomerRegister()});t.$on("RegistrationScopeFullPage.UpdateNotifySpecialOffers",function(n,i){t.registrationModel.NotifySpecialOffers=i});t.$on("FormDirective.HidValidation",function(){t.RegistrationForm!=null&&(t.RegistrationForm.ServerErrors=[]);t.ShowValidation&&(t.ShowValidation=!1)});$(document).ready(function(){$(document).off("click","#DisplayLoginModal");$(document).on("click","#DisplayLoginModal",function(n){n.preventDefault();$("#RegistrationModal").trigger("close");t.ShowLoading(AVON.messages.spinner_loading);$("#LoginModal").trigger("modal")});$(document).off("click","#DisplayForgotPassword");$(document).on("click","#DisplayForgotPassword",function(n){n.preventDefault();f.displayForgotPassword=!0;f.forgotEmail=t.registrationModel.LoginInfo.Email;$("#RegistrationModal").trigger("close");AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading);$("#LoginModal").trigger("modal")});var n=!1;$(document).off("keydown","#Registration");$(document).on("keydown","#Registration",function(i){var r=i.keyCode||i.which;if(r===9&&t.registrationModel.LoginInfo.FirstName===""&&!n)return angular.element("[id=registrationModel_LoginInfo_FirstNameInput]").focus(),n=!0,!1})})}return __extends(t,n),t.$inject=["$scope","$rootScope","registrationService","trackingService","loginService","$compile"],t}(BaseAngularController);n.RegistrationController=t}(RegistrationModule||(RegistrationModule={}));app.controller("RegistrationController",RegistrationModule.RegistrationController),function(n){n.searchScope;var t=function(t){function i($scope){var i=this;t.call(this,$scope);n.searchScope=$scope;n.searchScope.searchUrl=this.GetBaseUrl()+n.searchScope.Url.Action("Index","Search");$scope.isSearchResultsPage=window.location.href.indexOf("search")!=-1;n.searchScope.isSearchResultsPage&&AVON.LeftNavigation&&(n.searchScope.Refinements=AVON.LeftNavigation.MenuItems);n.searchScope.DoSearch=function(){var i=$("#HeaderSearchInput");if(i.length){var r=n.searchScope.SanitizeSearchString(i.val()).trim(),t=r,u=n.searchScope.searchUrl+"/"+t+"?cel_id="+t.substring(0,1)+"|T_"+t;n.searchScope.ShowLoading(AVON.messages.spinner_searching);n.searchScope.RedirectToUrl(u)}};n.searchScope.SanitizeSearchString=function(n){return(n||"").replace(/[^\\0-9A-Za-z��������������\\'\\,\\#\\ \\s\\-]/g,"").toLowerCase()};_.delay(function(){return i.InitAutoComplete()},500);n.searchScope.$on("ProductListService.ProductSearchLoaded",function(t,i){var r=i.Data.leftNavigationModel;n.searchScope.Refinements=r.MenuItems;n.searchScope.SafeApply()});n.searchScope.UpdateSelectedFacets=function(){}}return __extends(i,t),i.prototype.InitAutoComplete=function(){if($(window).resize(function(){$(".yui-ac-content").hide()}),$("#HeaderSearchInput").length){var t=$(".yui-ac-content");t.is(":hidden")&&t.show();n.searchScope.SessionService.WhenReady().then(function(){CelebrosAutoComplete(n.searchScope.Session.Customer.Campaign,"HeaderSearchInput",function(t){n.searchScope.autoCompleteRedirectUrl=t.SelectedURL&&t.IsAutoComplete?t.SelectedURL.replace("shop.avon.com",this.GetHostName())+"&cel_id="+t.EnteredQuery+"|P_"+t.SelectedQuery.replace(/[^A-Za-z0-9]/g,"_"):n.searchScope.searchUrl+"/"+t.SelectedQuery.replace(/[^A-Za-z0-9]/g,"_")+"?cel_id="+t.EnteredQuery+"|T_"+t.SelectedQuery.replace(/[^A-Za-z0-9]/g,"_");n.searchScope.RedirectToUrl(n.searchScope.autoCompleteRedirectUrl)})})}},i.$inject=["$scope"],i}(BaseAngularController);n.SearchCtrl=t}(SearchModule||(SearchModule={}));app.controller("SearchController",SearchModule.SearchCtrl);$(document).ready(function(){$(".Controller_Search #LeftNavigationContainer ul li:first").css("border","none")}),function(n){var t=function(n){function t($scope,$element){n.call(this,$scope);var i;i=$scope;angular.element(document).ready(function(){$($element).find("#TabsContainer ul li span").length>0&&($($($element).find("#TabsContainer ul li span")[0]).trigger("click"),$($element).find("#TabsContainer ul li span").first().addClass("Selected"),i.activeTabId=$($element).find("#TabsContainer ul li span")[0].id,i.activeRolloverTabImage=i.activeTabId)});i.TabClick=function(n){i.IsTouchDevice()||t.prototype.ToggleTabActive(i,n)};i.TabTap=function(n){i.IsTouchDevice()&&t.prototype.ToggleTabActive(i,n)};i.TabMouseEnter=function(n){if(!i.IsTouchDevice()){$("#"+i.activeTabId).removeClass("Selected");t.prototype.ToggleTabState(i,n,1);var r=angular.element(n.currentTarget);i.activeRolloverTabImage=r.attr("id")}};i.TabMouseLeave=function(n){i.IsTouchDevice()||(t.prototype.ToggleTabState(i,n,2),i.activeRolloverTabImage=i.activeTabId,$("#"+i.activeTabId).addClass("Selected"))};i.$on("ProductService.ProductsLoaded",function(){$element.find(window.location.hash).length>0&&(i.LoadOperationsCount+=1,i.LoadOperationsCount>=2&&_.delay(function(){i.ScrollToTop($element,!1)},1e3))});i.$on("ProductService.PromotionsLoaded",function(){$element.find(window.location.hash).length>0&&(i.LoadOperationsCount+=1,i.LoadOperationsCount>=2&&_.delay(function(){i.ScrollToTop($element,!1)},1e3))});_.defer(function(){$element.find(window.location.hash.substring(1)).length>0&&$element.find(window.location.hash.substring(1))[0].click()})}return __extends(t,n),t.prototype.ToggleTabActive=function(n,t){var u=n.activeTabId,i,r;n.activeTabId="";this.ToggleTabStateById(n,t,u,0);this.ToggleTabState(n,t,0);i=angular.element(t.currentTarget);$(t.target).closest("#TabsContainer").find("ul li span").removeClass("Selected");i.addClass("Selected");r=i.attr("id");n.activeTabId=r;n.activeRolloverTabImage=n.activeTabId},t.prototype.ToggleTabState=function(n,t,i){var r=angular.element(t.currentTarget);this.ToggleTabStateById(n,t,r.attr("id"),i)},t.prototype.ToggleTabStateById=function(n,t,i,r){var u=$("#"+i),f=u.attr("id");n.activeTabId!=f&&($(t.target).closest("#TabsContainer").find("ul li span").removeClass("Hover"),r==1&&u.addClass("Hover"))},t.$inject=["$scope","$element"],t}(BaseAngularController);n.TipsModuleController=t}(TipsModule||(TipsModule={}));app.controller("TipsModuleController",TipsModule.TipsModuleController);angular.module("ui.select2",[]).value("uiSelect2Config",{}).directive("uiSelect2",["uiSelect2Config","$timeout",function(n,t){$(".touch").length>0&&(n.minimumResultsForSearch=-1);n.width="resolve";n.formatResult=dropdownFormatting;n.formatSelection=dropdownFormatting;n.selectOnBlur=!0;n.openOnEnter=!1;n.escapeMarkup=function(n){return n};n.matcher=function(n,t){return t.toUpperCase().indexOf(n.toUpperCase())>=0};n.sortResults=function(n,t,i){return i.term?(i.term=i.term.toUpperCase(),n.sort(function(n,t){var r=n&&n.text&&n.text.toUpperCase().indexOf(i.term)===0,u=t&&t.text&&t.text.toUpperCase().indexOf(i.term)===0;return r&&!u?-1:!r&&u?1:0})):n};var i={};return n&&angular.extend(i,n),{require:"ngModel",priority:1,compile:function(n,r){var e,u,o,f=n.is("select"),s=angular.isDefined(r.multiple);return n.is("select")&&(u=n.find("optgroup[ng-repeat], optgroup[data-ng-repeat], option[ng-repeat], option[data-ng-repeat]"),u.length&&(o=u.attr("ng-repeat")||u.attr("data-ng-repeat"),e=jQuery.trim(o.split("|")[0]).split(" ").pop())),function(n,u,o,h){var c=angular.extend({},i,n.$eval(o.uiSelect2)),l=function(n){var t;return c.simple_tags?(t=[],angular.forEach(n,function(n){t.push(n.id)})):t=n,t},v=function(n){var t=[];return n?(c.simple_tags?(t=[],angular.forEach(n,function(n){t.push({id:n,text:n})})):t=n,t):t},a;f?(delete c.multiple,delete c.initSelection):s&&(c.multiple=!0);h&&(n.$watch(r.ngModel,function(n,t){n&&n!==t&&h.$render()},!0),h.$render=function(){if(f)u.select2("val",h.$viewValue);else if(c.multiple){var n=h.$viewValue;angular.isString(n)&&(n=n.split(","));u.select2("data",v(n))}else angular.isObject(h.$viewValue)?u.select2("data",h.$viewValue):h.$viewValue?u.select2("val",h.$viewValue):u.select2("data",null)},e&&n.$watch(e,function(n,i){angular.equals(n,i)||t(function(){u.select2("val",h.$viewValue);u.trigger("change");n&&!i&&h.$setPristine&&h.$setPristine(!0)})}),h.$parsers.push(function(n){var t=u.prev();return t.toggleClass("ng-invalid",!h.$valid).toggleClass("ng-valid",h.$valid).toggleClass("ng-invalid-required",!h.$valid).toggleClass("ng-valid-required",h.$valid).toggleClass("ng-dirty",h.$dirty).toggleClass("ng-pristine",h.$pristine),n}),f||(u.bind("change",function(t){(t.stopImmediatePropagation(),n.$$phase||n.$root.$$phase)||n.SafeApply(function(){h.$setViewValue(l(u.select2("data")))})}),c.initSelection&&(a=c.initSelection,c.initSelection=function(n,t){a(n,function(n){var i=h.$pristine;h.$setViewValue(l(n));t(n);i&&h.$setPristine();u.prev().toggleClass("ng-pristine",h.$pristine)})})));u.bind("$destroy",function(){u.select2("destroy")});o.$observe("disabled",function(n){u.select2("enable",!n)});o.$observe("readonly",function(n){u.select2("readonly",!!n)});o.ngMultiple&&n.$watch(o.ngMultiple,function(n){o.$set("multiple",!!n);u.select2(c)});t(function(){if(u.select2(c),u.select2("data",h.$modelValue),h.$render(),!c.initSelection&&!f){var n=h.$pristine;h.$setViewValue(l(u.select2("data")));n&&h.$setPristine();u.prev().toggleClass("ng-pristine",h.$pristine)}})}}}}]);$(document).off("select2-loaded");$(document).on("select2-loaded","select",function(){$(".select2-results").mCustomScrollbar({scrollInertia:0,mouseWheel:!0,keyboard:!0,advanced:{updateOnContentResize:!0,updateOnBrowserResize:!0}})});$(document).off("select2-close");$(document).on("select2-close","select",function(){_.defer(function(){$(".select2-results").mCustomScrollbar("destroy")},200)});(function(n,t,i){function h(n){for(var i=n.attributes,r={},t=0;t<i.length;t++)i[t].specified&&!/^jQuery\d+/.test(i[t].name)&&(r[i[t].name]=i[t].value);return r}function o(){var t=n(this),i;if(t.is(":password")){u=!0;t.val()==""&&t.val("");t.removeClass("placeholder");return}t.data("password")?(i=t.next().show().focus(),n("label[for="+t.attr("id")+"]").attr("for",i.attr("id")),t.remove()):t.realVal()==t.attr("placeholder")&&(u=!0,t.val(""),t.removeClass("placeholder"))}function s(){var t=n(this),r,i,u=t.attr("placeholder");n.trim(t.val()).length>0||(t.is(":password")?(i=t.attr("id")+"-clone",r=n("<input/>").attr(n.extend(h(this),{type:"text",value:u,"data-password":1,id:i})).addClass("placeholder"),t.before(r).hide(),n("label[for="+t.attr("id")+"]").attr("for",i)):(t.val(u),t.addClass("placeholder")))}var f="placeholder"in t.createElement("input"),e="placeholder"in t.createElement("textarea"),r=":input[placeholder]",u=!1;if(n.placeholder={input:f,textarea:e},!i&&f&&e){n.fn.placeholder=function(){};return}i||!f||e||(r="textarea[placeholder]");n.fn.realVal=n.fn.val;n.fn.val=function(){var $element=n(this),t,i;return(i=$element.attr("placeholder"),arguments.length>0)?(arguments[0]!==""&&arguments[0]!==null||u||(arguments[0]=i),u=!1,$element.realVal.apply(this,arguments)):(t=$element.realVal(),t==i?"":t)};n.fn.placeholder=function(){return this.filter(r).each(s),this};n(function(n){var i=n(t);i.on("focus",r,o);i.on("blur",r,s);n(r).placeholder()})})(jQuery,document,window.debug)