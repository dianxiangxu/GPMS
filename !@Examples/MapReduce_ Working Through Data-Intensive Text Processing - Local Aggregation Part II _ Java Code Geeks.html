<!DOCTYPE html>
<!-- saved from url=(0160)http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer -->
<html lang="en-US" prefix="og: http://ogp.me/ns#"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" type="text/css" href="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/single.include.9cb930.css" media="all"><script async="" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/analytics.js"></script><script async="" type="text/javascript" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/gpt.js"></script><script type="text/javascript" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/default.include.cb9bcd.js"></script><style type="text/css"></style><meta charset="UTF-8"><title>MapReduce: Working Through Data-Intensive Text Processing - Local Aggregation Part II | Java Code Geeks</title><link rel="profile" href="http://gmpg.org/xfn/11"><link rel="pingback" href="http://www.javacodegeeks.com/xmlrpc.php"><script type="text/javascript">var googletag=googletag||{};googletag.cmd=googletag.cmd||[];(function(){var gads=document.createElement('script');gads.async=true;gads.type='text/javascript';var useSSL='https:'==document.location.protocol;gads.src=(useSSL?'https:':'http:')+'//www.googletagservices.com/tag/js/gpt.js';var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(gads,node);})();</script><script type="text/javascript">googletag.cmd.push(function(){googletag.defineSlot('/70432299/JCG_Header',[728,90],'div-gpt-ad-1415445260332-0').addService(googletag.pubads());googletag.defineSlot('/70432299/JCG_In-post',[300,250],'div-gpt-ad-1415445260332-2').addService(googletag.pubads());googletag.defineSlot('/70432299/JCG_Side',[300,250],'div-gpt-ad-1415445260332-3').addService(googletag.pubads());googletag.defineSlot('/70432299/JCG_Side_1',[300,250],'div-gpt-ad-1415445260332-4').addService(googletag.pubads());googletag.defineSlot('/70432299/JCG_Under-post',[300,250],'div-gpt-ad-1415445260332-5').addService(googletag.pubads());googletag.defineSlot('/70432299/JCG_Side_2',[300,600],'div-gpt-ad-1415445260332-6').addService(googletag.pubads());googletag.defineSlot('/70432299/JCG_NotifBar',[1220,50],'div-gpt-ad-1431445244472-0').addService(googletag.pubads());googletag.pubads().setTargeting("PostID","2045");googletag.pubads().setTargeting("PostCAT","8");googletag.pubads().enableSingleRequest();googletag.enableServices();});</script><link rel="canonical" href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html"><link rel="publisher" href="https://plus.google.com/+JavaCodeGeeks/"><meta name="twitter:card" content="summary"><meta name="twitter:description" content="This post continues with the series on implementing algorithms found in the Data Intensive Processing with MapReduce book. Part one can be found here. In the previous post, we discussed using the technique of local aggregation as a means of reducing the amount of data shuffled and transferred across the network. Reducing the amount of ..."><meta name="twitter:title" content="MapReduce: Working Through Data-Intensive Text Processing - Local Aggregation Part II | Java Code Geeks"><meta name="twitter:site" content="@javacodegeeks"><meta name="twitter:domain" content="Java Code Geeks"><meta name="twitter:image:src" content="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/2012/10/apache-hadoop-mapreduce-logo.jpg"><meta name="twitter:creator" content="@javacodegeeks"><link rel="alternate" type="application/rss+xml" title="Java Code Geeks » Feed" href="http://www.javacodegeeks.com/feed/"><link rel="alternate" type="application/rss+xml" title="Java Code Geeks » Comments Feed" href="http://www.javacodegeeks.com/comments/feed/"><link rel="alternate" type="application/rss+xml" title="Java Code Geeks » MapReduce: Working Through Data-Intensive Text Processing – Local Aggregation Part II Comments Feed" href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html/feed/"><script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.javacodegeeks.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.4"}};!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><script src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/wp-emoji-release.min.js" type="text/javascript"></script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link rel="stylesheet" id="snp_styles_newtheme7-css" href="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/newtheme7.css" type="text/css" media="all"><link rel="stylesheet" id="Oswald-css" href="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/css" type="text/css" media="all"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.javacodegeeks.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-includes/wlwmanifest.xml"><meta name="generator" content="WordPress 4.2.4"><link rel="shortlink" href="http://www.javacodegeeks.com/?p=2045"><link rel="shortcut icon" href="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/2012/12/JavaCodeGeeks-favIcon.png" title="Favicon"><meta property="og:title" content="MapReduce: Working Through Data-Intensive Text Processing – Local Aggregation Part II"><meta property="og:type" content="article"><meta property="og:description" content="This post continues with the series on implementing algorithms found in the Data Intensive Processin..."><meta property="og:url" content="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html"><meta property="og:site_name" content="Java Code Geeks"><meta property="og:image" content="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/2012/10/apache-hadoop-mapreduce-logo.jpg"> <!--[if IE]><script type="text/javascript">jQuery(document).ready(function(){jQuery(".menu-item").has("ul").children("a").attr("aria-haspopup","true");});</script><![endif]--> <!--[if lt IE 9]><script src="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/themes/jarida/js/html5.js"></script><script src="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/themes/jarida/js/selectivizr-min.js"></script><![endif]--> <!--[if IE 8]><link rel="stylesheet" type="text/css" media="all" href="http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/themes/jarida/css/ie8.css" /> <![endif]--><script type="text/javascript">var tievar={'go_to':'Go to...'};var tie={"ajaxurl":"http://www.javacodegeeks.com/wp-admin/admin-ajax.php","your_rating":"Your Rating:"};</script><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><style type="text/css" media="screen">body{background-image:url(http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/themes/jarida/images/patterns/body-bg1.png);background-position:top center}body.single .entry, body.page
.entry{font-size:15px !important}#main-nav ul li.current-menu-item a,
#main-nav ul li.current-menu-item a:hover,
#main-nav ul li.current-menu-parent a,
#main-nav ul li.current-menu-parent a:hover,
#main-nav ul li.current-page-ancestor a,
#main-nav ul li.current-page-ancestor a:hover,
.pagination span.current,
.ei-slider-thumbs li.ei-slider-element,
.breaking-news span,
.ei-title h2,h2.cat-box-title,
a.more-link,.scroll-nav a,
.flex-direction-nav a,
.tagcloud a:hover,
#tabbed-widget ul.tabs li.active a,
.slider-caption h2, .full-width .content .slider-caption h2,
.review-percentage .review-item span span,.review-final-score,
.woocommerce span.onsale, .woocommerce-page span.onsale ,
.woocommerce .widget_price_filter .ui-slider .ui-slider-handle, .woocommerce-page .widget_price_filter .ui-slider .ui-slider-handle,
.button,a.button,#main-content input[type="submit"],#main-content input[type="submit"]:focus,span.onsale{background-color:#326693 !important}::-webkit-scrollbar-thumb{background-color:#326693 !important}#main-nav,.top-nav{border-bottom-color:#326693}.cat-box , .footer-bottom
.container{border-top-color:#326693}body.single .post .entry a, body.page .post .entry
a{color:#326693}body.single .post .entry a:hover, body.page .post .entry a:hover{color:#478cc4;text-decoration:underline}#main-nav ul
li{text-transform:none}.toc
dl{display:block}.toc
dt{display:block}.toc
dd{display:block;-webkit-margin-start:20px;-moz-margin-start:20px}.toc{line-height:1.4;font-size:90%;border-bottom:1px solid #eee;padding:20px;border:1px
solid #e1e1e1;background:#f1f1f1;border-radius:9px;-moz-border-radius:9px;-webkit-border-radius:9px;width:80%;display:inline-block;margin:20px
0}code{display:inline}.tip{background:url(http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/sprites.png) -201px -72px no-repeat;padding:10px
20px 25px 80px;margin:2.5em 1em;border-color:#dedede #d8d8d8 #d3d3d3;text-shadow:0 1px 0 #fff;-webkit-box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;-moz-box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;background-color:#FAFAFA;color:#555;border:1px
solid #DEDEDE;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.download{background:url(http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/sprites.png) -266px 0px no-repeat;padding:10px
20px 25px 80px;margin:2.5em 1em;border-color:#dedede #d8d8d8 #d3d3d3;text-shadow:0 1px 0 #fff;-webkit-box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;-moz-box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;background-color:#FAFAFA;color:#555;border:1px
solid #DEDEDE;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.nlbox{background:#E2ECFA;margin:15px
0px 15px;padding:10px;-webkit-border-radius:3px;-mozilla-border-radius:3px;-o-border-radius:3px;border-radius:3px;-moz-box-shadow:0px 2px 2px 1px #d7e1eb;-webkit-box-shadow:0px 2px 2px 1px #d7e1eb;box-shadow:0px 2px 2px 1px #d7e1eb;border:solid 1px #D8D8D8;display:inline-block}.nlbox1{background:#E2ECFA;margin:-10px 0 25px;width:auto;max-width:798px;padding:10px;-webkit-border-radius:3px;-mozilla-border-radius:3px;-o-border-radius:3px;border-radius:3px;-moz-box-shadow:0px 2px 2px 1px #d7e1eb;-webkit-box-shadow:0px 2px 2px 1px #d7e1eb;box-shadow:0px 2px 2px 1px #d7e1eb;border:solid 1px #D8D8D8}.button-gw{border-top:1px solid #96d1f8;background:#65a9d7;background:-webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));background:-webkit-linear-gradient(top, #3e779d, #65a9d7);background:-moz-linear-gradient(top, #3e779d, #65a9d7);background:-ms-linear-gradient(top, #3e779d, #65a9d7);background:-o-linear-gradient(top, #3e779d, #65a9d7);padding:20px
40px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;-webkit-box-shadow:rgba(0,0,0,1) 0 1px 0;-moz-box-shadow:rgba(0,0,0,1) 0 1px 0;box-shadow:rgba(0,0,0,1) 0 1px 0;text-shadow:rgba(0,0,0,.4) 0 1px 0;color:white;font-size:34px;font-family:Georgia,Serif;text-decoration:none !important;vertical-align:middle}.button-gw:hover{border-top-color:#28597a;background:#28597a;color:#ccc}.button-gw:active{border-top-color:#1b435e;background:#1b435e}.widget_wpjb-recent-jobs .wpjb-grid-compact{margin-left:5%;margin-right:5%}.attribution{border-color:#dedede #d8d8d8 #d3d3d3;text-shadow:0 1px 0 #fff;-webkit-box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;-moz-box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;box-shadow:0 1px 1px #eaeaea, inset 0 1px 0 #fbfbfb;background:#fff;background:-moz-linear-gradient(top, #fff 0%, #f6f6f6 47%, #ededed 100%);background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(47%,#f6f6f6), color-stop(100%,#ededed));background:-webkit-linear-gradient(top, #fff 0%,#f6f6f6 47%,#ededed 100%);background:-o-linear-gradient(top, #fff 0%,#f6f6f6 47%,#ededed 100%);background:-ms-linear-gradient(top, #fff 0%,#f6f6f6 47%,#ededed 100%);background:linear-gradient(top, #fff 0%,#f6f6f6 47%,#ededed 100%);padding:3px
8px;line-height:20px;color:#555;border:1px
solid #DEDEDE;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;margin-top:20px;display:inline-block}.attribution
.reference{font-weight:bold}.attribution
table{border:none;background-color:inherit}.attribution table
td{vertical-align:top;padding:0px
5px;border-bottom:none;font-size:inherit}a.TPbutton_w_cnd01lb:hover{background-color:#fc0;background:url(http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/sprites.png) 0 -102px;color:#fff;text-decoration:none;transition:none}a.TPbutton_w_cnd01lb{-webkit-border-radius:7px;-mozilla-border-radius:7px;-o-border-radius:7px;border-radius:7px;text-decoration:none;color:#fff;font-family:'lucida sans','lucida grande',arial,helvetica,sans-serif;letter-spacing:-1px;font-weight:bold;background-color:#f90;background:url(http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/sprites.png) 0 -73px;padding:4px
10px 4px 10px;font-size:16px;-moz-box-shadow:0px 3px 3px 2px #d7e1eb;-webkit-box-shadow:0px 3px 3px 2px #d7e1eb;box-shadow:0px 3px 3px 2px #d7e1eb;border:solid 2px #fff;width:200px;height:56px;transition:none}.TPbutton_w_cnd01lb_arrow{position:relative;display:inline-block;overflow:hidden;vertical-align:bottom;width:30px;height:20px;background:url(http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/sprites.png) -146px 0px}#commentform
input{width:inherit}#author-box .post-listing{margin-bottom:0px}#author-box .block-head
h3{text-transform:none}header#theme-header{margin:0
0 0}blockquote{display:inline-block;margin:20px
0 10px 40px;font-size:14px}blockquote:before{font-size:25px;line-height:inherit}.syntaxhighlighter{display:inline-block}@media (max-width: 767px){#div-gpt-ad-1415445260332-0{display:none}}@media (max-width: 479px){#div-gpt-ad-1415445260332-3{margin-left:-10px}#div-gpt-ad-1415445260332-4{margin-left:-10px}#div-gpt-ad-1415445260332-6{margin-left:-10px}}.wpjb div, body .wpjb p, body .wpjb ul, body .wpjb li, body .wpjb ol, body .wpjb span, body .wpjb img, body .wpjb form, body .wpjb fieldset, body .wpjb label, body .wpjb table, body .wpjb thead, body .wpjb tfoot, body .wpjb tbody, body .wpjb tr, body .wpjb td, body .wpjb strong, body .wpjb b, body .wpjb em, body .wpjb i, body .wpjb
center{margin:0;padding:0;border:0;box-shadow:none;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;list-style-type:none}.wpjb .wpjb-grid{margin:0% 0% 0% 0%}.wpjb-grid .wpjb-grid-row{clear:both;overflow:hidden;padding:0.75em 0 0.75em 0;margin:0
0 0 0;border-bottom:1px solid whitesmoke}.wpjb-grid .wpjb-grid-row>div{padding:0
1% 0 1%}.wpjb-grid .wpjb-grid-col-right{text-align:right}.wpjb .wpjb-grid .wpjb-sub{display:block;margin:0
0 0 0;padding:2px
0 0 0;line-height:1.3em;font-size:0.95em}.wpjb-col-title{width:40%}[class*='wpjb-col-']{float:left}#wpjb-top-search{margin:0
0 15px 0;padding:8px
2% 2px 2%;clear:both;overflow:hidden}.wpjb .wpjb-layer-inside{border:1px
solid whitesmoke;border-radius:2px;background-color:#fcfcfc;box-shadow:0 1px 1px rgba(0,0,0,.04)}#wpjb-top-search input[type=text]{width:49%;display:inline}.wpjb select, .wpjb textarea, .wpjb input[type=password], .wpjb input[type=text]{margin:2px;padding:6px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}#wpjb-top-search ul
li{display:inline-block;line-height:1.2em;margin:2% 1% 1% 1%;float:left}.wpjb input[type=checkbox], .wpjb input[type=radio]{display:inline;margin:0;padding:0;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}#wpjb-top-search
label{display:inline !important;width:auto;float:none}#wpjb-top-search .wpjb-top-search-submit{float:right;margin:4px
0 4px 0}</style><script type="text/javascript">window.cookieconsent_options={"message":"This website uses cookies to ensure you get the best experience on our website. By using our website, you agree to our use of cookies.","dismiss":"Got it!","learnMore":"More info","link":"http://www.javacodegeeks.com/about/privacy-policy/","theme":"light-floating"};</script><script type="text/javascript" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/cookieconsent.latest.min.js"></script><style type="text/css">.mc4wp-form input[name="_mc4wp_required_but_not_really"]{display:none !important}</style><script src="http://partner.googleadservices.com/gpt/pubads_impl_69r.js" async=""></script><link rel="stylesheet" type="text/css" href="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/light-floating.css"></head><body id="top" class="single single-post postid-2045 single-format-standard"><div class="cc_banner-wrapper "><div class="cc_banner cc_container cc_container--open"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#null" data-cc-event="click:dismiss" class="cc_btn cc_btn_accept_all">Got it!</a><p class="cc_message">This website uses cookies to ensure you get the best experience on our website. By using our website, you agree to our use of cookies. <a data-cc-if="options.link" class="cc_more_info" href="http://www.javacodegeeks.com/about/privacy-policy/">More info</a></p><a class="cc_logo" target="_blank" href="http://silktide.com/cookieconsent">Cookie Consent plugin for the EU cookie law</a></div></div><div class="x-white foobar-wrapper shadow fb-top" style="height: 58px; bottom: auto; top: 0px;"><table cellpadding="0" cellspacing="0" class="foobar-container" style="border-style: none none solid; border-bottom-width: 3px; border-bottom-color: rgb(255, 255, 255); height: 50px; display: table; background-color: rgb(50, 102, 147);"><tbody><tr class="foobar-container-row"><td class="foobar-container-left" style="height: 50px; width: 0px;"><div class="foobar-container-inner" style="max-height: 50px;"></div></td><td class="foobar-close-button-spacer" style="width: 80px;"></td><td class="foobar-container-center" style="height: 50px; width: 0px;"><div class="foobar-container-inner" style="max-height: 50px;"><div class="foobar-message" style="opacity: 100;"></div><div class="x-white foobar-prev-button" style="height: 50px; margin-top: -25px; display: block; background-color: rgb(50, 102, 147);"></div><div class="x-white foobar-next-button" style="height: 50px; margin-top: -25px; display: block; background-color: rgb(50, 102, 147);"></div></div></td><td class="foobar-container-right" style="height: 50px; width: auto;"><div class="foobar-container-inner" style="max-height: 50px;"><!-- /70432299/JCG_NotifBar --><div id="div-gpt-ad-1431445244472-0" style="height:50px; width:1220px; margin-left: auto; margin-right: auto;"><script src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/fbDFP.js"></script></div></div></td><td class="foobar-close-button-container" style="width: 80px;"><span class="foobar-close-button" style="height: 50px;"></span></td></tr></tbody></table><div class="foobar-shadow"></div><div class="foobar-open-button-container hidden" style="height: 0px; bottom: auto; top: 0px; width: 80px; left: auto; right: 0px; display: block;"><span class="foobar-open-button" style="border-style: none solid solid; border-right-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-color: rgb(255, 255, 255); border-bottom-color: rgb(255, 255, 255); border-left-color: rgb(255, 255, 255); height: 0px; margin-left: -17px; display: none; background-color: rgb(50, 102, 147);"></span></div></div><div class="background-cover"></div><div class="wrapper"><div class="top-nav fade-in animated1 head_menu"><div class="container"><div class="search-block"><form method="get" id="searchform" action="http://www.javacodegeeks.com/"> <button class="search-button" type="submit" value="Search"></button> <input type="text" id="s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}"></form></div><div class="social-icons icon_flat"> <a class="tooldown ext-link" href="http://feeds.feedburner.com/JavaCodeGeeks" rel="external nofollow" data-wpel-target="_blank" original-title="Rss"><i class="tieicon-rss"></i></a><a class="tooldown ext-link" href="https://plus.google.com/+JavaCodeGeeks/" rel="external nofollow" data-wpel-target="_blank" original-title="Google+"><i class="tieicon-gplus"></i></a><a class="tooldown ext-link" href="https://www.facebook.com/javacodegeeks" rel="external nofollow" data-wpel-target="_blank" original-title="Facebook"><i class="tieicon-facebook"></i></a><a class="tooldown ext-link" href="https://twitter.com/javacodegeeks" rel="external nofollow" data-wpel-target="_blank" original-title="Twitter"><i class="tieicon-twitter"></i></a><a class="tooldown ext-link" href="https://www.linkedin.com/groups/Java-Code-Geeks-3810709" rel="external nofollow" data-wpel-target="_blank" original-title="LinkedIn"><i class="tieicon-linkedin"></i></a></div><div class="top-menu"><ul id="menu-pages" class="menu"><li id="menu-item-38541" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-has-children menu-item-38541 parent-list"><a href="http://www.javacodegeeks.com/#">Knowledge Base <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38217" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38217 parent-list"><a href="http://www.javacodegeeks.com/tutorials/">Tutorials <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38218" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38218 parent-list"><a href="http://www.javacodegeeks.com/tutorials/java-tutorials/">Java Tutorials <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38219" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38219"><a href="http://www.javacodegeeks.com/tutorials/java-tutorials/core-java-tutorials/">Core Java Tutorials</a></li><li id="menu-item-38220" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38220 parent-list"><a href="http://www.javacodegeeks.com/tutorials/java-tutorials/enterprise-java-tutorials/">Enterprise Java Tutorials <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38221" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38221"><a href="http://www.javacodegeeks.com/tutorials/java-tutorials/enterprise-java-tutorials/spring-tutorials/">Spring Tutorials</a></li></ul></li><li id="menu-item-38222" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38222"><a href="http://www.javacodegeeks.com/tutorials/java-tutorials/desktop-java-tutorials/">Desktop Java Tutorials</a></li></ul></li><li id="menu-item-38223" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38223 parent-list"><a href="http://www.javacodegeeks.com/tutorials/android-tutorials/">Android Tutorials <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38224" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38224"><a href="http://www.javacodegeeks.com/tutorials/android-tutorials/android-core-tutorials/">Android Core Tutorials</a></li><li id="menu-item-38225" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38225"><a href="http://www.javacodegeeks.com/tutorials/android-tutorials/android-game-tutorials/">Android Game Tutorials</a></li></ul></li><li id="menu-item-38226" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38226"><a href="http://www.javacodegeeks.com/tutorials/scala-tutorials/">Scala Tutorials</a></li><li id="menu-item-38227" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38227"><a href="http://www.javacodegeeks.com/tutorials/devops-tutorials/">DevOps Tutorials</a></li><li id="menu-item-38228" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38228"><a href="http://www.javacodegeeks.com/tutorials/nosql-tutorials/">NoSQL Tutorials</a></li><li id="menu-item-38229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38229"><a href="http://www.javacodegeeks.com/tutorials/groovy-grails-tutorials/">Groovy/Grails Tutorials</a></li></ul></li><li id="menu-item-38243" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38243 parent-list"><a href="http://www.javacodegeeks.com/resources/">Resources <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38244"><a href="http://www.javacodegeeks.com/resources/software/">Software</a></li><li id="menu-item-38245" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38245"><a href="http://www.javacodegeeks.com/resources/our-projects/">Our Projects</a></li></ul></li><li id="menu-item-38273" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-38273"><a href="http://examples.javacodegeeks.com/" data-wpel-ignored="true">Examples</a></li><li id="menu-item-38275" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-38275"><a href="http://academy.javacodegeeks.com/" data-wpel-ignored="true">Academy</a></li><li id="menu-item-38274" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-38274"><a href="http://www.javacodegeeks.com/whitepaper/">Whitepapers</a></li><li id="menu-item-38276" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-38276"><a href="http://library.javacodegeeks.com/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Library</a></li></ul></li><li id="menu-item-38240" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38240 parent-list"><a href="http://www.javacodegeeks.com/job-board/">Job Board <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38241" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38241"><a href="http://www.javacodegeeks.com/job-board/jobs/">Jobs</a></li></ul></li><li id="menu-item-38230" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38230 parent-list"><a href="http://www.javacodegeeks.com/join-us/">Join Us <span class="sub-indicator"></span></a><ul class="sub-menu" style="overflow: hidden; height: 1px; padding-top: 0px; margin-top: 0px; padding-bottom: 0px; margin-bottom: 0px; display: none;"><li id="menu-item-38231" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38231"><a href="http://www.javacodegeeks.com/join-us/jcg/">JCG</a></li><li id="menu-item-38232" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38232 parent-list"><a href="http://www.javacodegeeks.com/join-us/w4g/">W4G <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38233" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38233"><a href="http://www.javacodegeeks.com/join-us/w4g/submission-guidelines/">Submission Guidelines</a></li><li id="menu-item-38234" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38234"><a href="http://www.javacodegeeks.com/join-us/w4g/terms-conditions/">Terms &amp; Conditions</a></li></ul></li></ul></li><li id="menu-item-38235" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-38235 parent-list"><a href="http://www.javacodegeeks.com/about/">About <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38236" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38236"><a href="http://www.javacodegeeks.com/about/about-jcgs/">About JCGs</a></li><li id="menu-item-38237" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38237"><a href="http://www.javacodegeeks.com/about/advertising/">Advertising</a></li><li id="menu-item-38238" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38238"><a href="http://www.javacodegeeks.com/about/terms-of-use/">Terms of Use</a></li><li id="menu-item-38239" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38239"><a href="http://www.javacodegeeks.com/about/privacy-policy/">Privacy Policy</a></li></ul></li></ul><select id="top-menu-mob"><option value="#">Go to...</option><option value="http://www.javacodegeeks.com/#">&nbsp;Knowledge Base </option><option value="http://www.javacodegeeks.com/tutorials/">&nbsp; &nbsp; –&nbsp;Tutorials </option><option value="http://www.javacodegeeks.com/tutorials/java-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Java Tutorials </option><option value="http://www.javacodegeeks.com/tutorials/java-tutorials/core-java-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Core Java Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/java-tutorials/enterprise-java-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Enterprise Java Tutorials </option><option value="http://www.javacodegeeks.com/tutorials/java-tutorials/enterprise-java-tutorials/spring-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Spring Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/java-tutorials/desktop-java-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Desktop Java Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/android-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Android Tutorials </option><option value="http://www.javacodegeeks.com/tutorials/android-tutorials/android-core-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Android Core Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/android-tutorials/android-game-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Android Game Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/scala-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Scala Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/devops-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;DevOps Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/nosql-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;NoSQL Tutorials</option><option value="http://www.javacodegeeks.com/tutorials/groovy-grails-tutorials/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Groovy/Grails Tutorials</option><option value="http://www.javacodegeeks.com/resources/">&nbsp; &nbsp; –&nbsp;Resources </option><option value="http://www.javacodegeeks.com/resources/software/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Software</option><option value="http://www.javacodegeeks.com/resources/our-projects/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Our Projects</option><option value="http://examples.javacodegeeks.com/">&nbsp; &nbsp; –&nbsp;Examples</option><option value="http://academy.javacodegeeks.com/">&nbsp; &nbsp; –&nbsp;Academy</option><option value="http://www.javacodegeeks.com/whitepaper/">&nbsp; &nbsp; –&nbsp;Whitepapers</option><option value="http://library.javacodegeeks.com/">&nbsp; &nbsp; –&nbsp;Library</option><option value="http://www.javacodegeeks.com/job-board/">&nbsp;Job Board </option><option value="http://www.javacodegeeks.com/job-board/jobs/">&nbsp; &nbsp; –&nbsp;Jobs</option><option value="http://www.javacodegeeks.com/join-us/">&nbsp;Join Us </option><option value="http://www.javacodegeeks.com/join-us/jcg/">&nbsp; &nbsp; –&nbsp;JCG</option><option value="http://www.javacodegeeks.com/join-us/w4g/">&nbsp; &nbsp; –&nbsp;W4G </option><option value="http://www.javacodegeeks.com/join-us/w4g/submission-guidelines/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Submission Guidelines</option><option value="http://www.javacodegeeks.com/join-us/w4g/terms-conditions/">&nbsp; &nbsp; –&nbsp; &nbsp; –&nbsp;Terms &amp; Conditions</option><option value="http://www.javacodegeeks.com/about/">&nbsp;About </option><option value="http://www.javacodegeeks.com/about/about-jcgs/">&nbsp; &nbsp; –&nbsp;About JCGs</option><option value="http://www.javacodegeeks.com/about/advertising/">&nbsp; &nbsp; –&nbsp;Advertising</option><option value="http://www.javacodegeeks.com/about/terms-of-use/">&nbsp; &nbsp; –&nbsp;Terms of Use</option><option value="http://www.javacodegeeks.com/about/privacy-policy/">&nbsp; &nbsp; –&nbsp;Privacy Policy</option></select></div></div></div><div class="container"> <header id="theme-header"><div class="header-content fade-in animated1"><div class="logo"><h2> <a title="Java Code Geeks" href="http://www.javacodegeeks.com/"> <img src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/JavaCodeGeeks-logo.png" alt="Java Code Geeks"><strong>Java Code Geeks Java 2 Java Developers Resource Center</strong> </a></h2></div><div class="ads-top"><div id="div-gpt-ad-1415445260332-0" style="width:728px; height:90px;"><script type="text/javascript">googletag.cmd.push(function(){googletag.display('div-gpt-ad-1415445260332-0');});</script></div></div><div class="clear"></div></div> <nav id="main-nav" class="fade-in animated2"><div class="container"><div class="main-menu"><ul id="menu-categories" class="menu"><li id="menu-item-38251" class="menu-item  menu-item-type-taxonomy  menu-item-object-category  menu-item-has-children parent-list"><a href="http://www.javacodegeeks.com/category/android/">Android <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38252" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/android/android-core/">Android Core</a></li><li id="menu-item-38253" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/android/android-games/">Android Games</a></li></ul></li><li id="menu-item-38257" class="menu-item  menu-item-type-taxonomy  menu-item-object-category  current-post-ancestor  menu-item-has-children parent-list"><a href="http://www.javacodegeeks.com/category/java/">Java <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38258" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/java/core-java/">Core Java</a></li><li id="menu-item-38259" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/java/desktop-java/">Desktop Java</a></li><li id="menu-item-38260" class="menu-item  menu-item-type-taxonomy  menu-item-object-category  current-post-ancestor  current-menu-parent  current-post-parent"><a href="http://www.javacodegeeks.com/category/java/enterprise-java/">Enterprise Java</a></li></ul></li><li id="menu-item-38261" class="menu-item  menu-item-type-taxonomy  menu-item-object-category  menu-item-has-children parent-list"><a href="http://www.javacodegeeks.com/category/jvm-languages/">JVM Languages <span class="sub-indicator"></span></a><ul class="sub-menu" style="overflow: hidden; height: 1px; padding-top: 0px; margin-top: 0px; padding-bottom: 0px; margin-bottom: 0px; display: none;"><li id="menu-item-38262" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/jvm-languages/ceylon/">Ceylon</a></li><li id="menu-item-38263" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/jvm-languages/clojure/">Clojure</a></li><li id="menu-item-38264" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/jvm-languages/groovy/">Groovy</a></li><li id="menu-item-38265" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/jvm-languages/jruby/">JRuby</a></li><li id="menu-item-38266" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/jvm-languages/kotlin/">Kotlin</a></li><li id="menu-item-38267" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/jvm-languages/scala/">Scala</a></li></ul></li><li id="menu-item-38271" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/software-development/">Software Development</a></li><li id="menu-item-38250" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/agile/">Agile</a></li><li id="menu-item-38254" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/career/">Career</a></li><li id="menu-item-38255" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/communications/">Communications</a></li><li id="menu-item-38256" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/devops/">DevOps</a></li><li id="menu-item-38268" class="menu-item  menu-item-type-taxonomy  menu-item-object-category  menu-item-has-children parent-list"><a href="http://www.javacodegeeks.com/category/meta-jcg/">Meta JCG <span class="sub-indicator"></span></a><ul class="sub-menu"><li id="menu-item-38269" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/meta-jcg/best-of-the-week/">Best Of The Week</a></li><li id="menu-item-38270" class="menu-item  menu-item-type-taxonomy  menu-item-object-category"><a href="http://www.javacodegeeks.com/category/misc/">Misc</a></li></ul></li></ul><select id="main-menu-mob"><option value="#">Go to...</option><option value="http://www.javacodegeeks.com/category/android/">&nbsp;Android </option><option value="http://www.javacodegeeks.com/category/android/android-core/">&nbsp; &nbsp; –&nbsp;Android Core</option><option value="http://www.javacodegeeks.com/category/android/android-games/">&nbsp; &nbsp; –&nbsp;Android Games</option><option value="http://www.javacodegeeks.com/category/java/">&nbsp;Java </option><option value="http://www.javacodegeeks.com/category/java/core-java/">&nbsp; &nbsp; –&nbsp;Core Java</option><option value="http://www.javacodegeeks.com/category/java/desktop-java/">&nbsp; &nbsp; –&nbsp;Desktop Java</option><option value="http://www.javacodegeeks.com/category/java/enterprise-java/">&nbsp; &nbsp; –&nbsp;Enterprise Java</option><option value="http://www.javacodegeeks.com/category/jvm-languages/">&nbsp;JVM Languages </option><option value="http://www.javacodegeeks.com/category/jvm-languages/ceylon/">&nbsp; &nbsp; –&nbsp;Ceylon</option><option value="http://www.javacodegeeks.com/category/jvm-languages/clojure/">&nbsp; &nbsp; –&nbsp;Clojure</option><option value="http://www.javacodegeeks.com/category/jvm-languages/groovy/">&nbsp; &nbsp; –&nbsp;Groovy</option><option value="http://www.javacodegeeks.com/category/jvm-languages/jruby/">&nbsp; &nbsp; –&nbsp;JRuby</option><option value="http://www.javacodegeeks.com/category/jvm-languages/kotlin/">&nbsp; &nbsp; –&nbsp;Kotlin</option><option value="http://www.javacodegeeks.com/category/jvm-languages/scala/">&nbsp; &nbsp; –&nbsp;Scala</option><option value="http://www.javacodegeeks.com/category/software-development/">&nbsp;Software Development</option><option value="http://www.javacodegeeks.com/category/agile/">&nbsp;Agile</option><option value="http://www.javacodegeeks.com/category/career/">&nbsp;Career</option><option value="http://www.javacodegeeks.com/category/communications/">&nbsp;Communications</option><option value="http://www.javacodegeeks.com/category/devops/">&nbsp;DevOps</option><option value="http://www.javacodegeeks.com/category/meta-jcg/">&nbsp;Meta JCG </option><option value="http://www.javacodegeeks.com/category/meta-jcg/best-of-the-week/">&nbsp; &nbsp; –&nbsp;Best Of The Week</option><option value="http://www.javacodegeeks.com/category/misc/">&nbsp; &nbsp; –&nbsp;Misc</option></select></div></div> </nav> </header><div id="main-content" class="container fade-in animated3 sidebar-narrow-left"><div class="content-wrap-wide"><div class="content"><div xmlns:v="http://rdf.data-vocabulary.org/#" id="crumbs"><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" class="crumbs-home" href="http://www.javacodegeeks.com/"><i class="tieicon-home"></i>Home</a></span> » <span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://www.javacodegeeks.com/category/java/">Java</a></span> » <span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://www.javacodegeeks.com/category/java/enterprise-java/">Enterprise Java</a></span> » <span class="current">MapReduce: Working Through Data-Intensive Text Processing – Local Aggregation Part II</span></div> <section id="author-box"><div class="block-head"><h3>About Bill Bejeck</h3></div><div class="post-listing"><div class="author-avatar"> <img alt="" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/f8a609f32c3be5cf0278799799fe58eb" srcset="http://0.gravatar.com/avatar/f8a609f32c3be5cf0278799799fe58eb?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></div><div class="author-description"> Husband, father of 3, passionate about software development.</div><div class="author-social"> <a class="ttip ext-link" href="http://codingjunkie.net/" rel="external nofollow" data-wpel-target="_blank" original-title="Bill Bejeck &#39;s site"><img src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/author_site.png" width="18" height="18" alt=""></a></div><div class="clear"></div></div> </section> <article class="post-listing post-2045 post type-post status-publish format-standard has-post-thumbnail hentry category-enterprise-java tag-apache-hadoop tag-big-data tag-mapreduce"><div class="post-inner"><h1 class="name post-title entry-title" itemprop="itemReviewed" itemscope="" itemtype="http://schema.org/Thing"><span itemprop="name">MapReduce: Working Through Data-Intensive Text Processing – Local Aggregation Part II</span></h1><p class="post-meta"> <span class="post-meta-author">Posted by: <a href="http://www.javacodegeeks.com/author/Bill-Bejeck/" title="">Bill Bejeck </a></span> <span class="post-cats">in <a href="http://www.javacodegeeks.com/category/java/enterprise-java/" rel="category tag">Enterprise Java</a></span> <span class="tie-date">October 17th, 2012</span></p><div class="clear"></div><div class="entry"><div class="ads-post"><div id="div-gpt-ad-1415445260332-2" style="width:300px; height:250px;float:left; margin-right:20px;"><script type="text/javascript">googletag.cmd.push(function(){googletag.display('div-gpt-ad-1415445260332-2');});</script></div></div><div dir="ltr" style="text-align: left">This post continues with the series on implementing algorithms found in the <a href="http://www.amazon.com/Data-Intensive-Processing-MapReduce-Synthesis-Technologies/dp/1608453421" title="Working Through Data-Intensive Text Processing with MapReduce" rel="external nofollow" class="ext-link" data-wpel-target="_blank">Data Intensive Processing with MapReduce</a> book. Part one can be found <a href="http://www.javacodegeeks.com/2012/09/mapreduce-working-through-data.html" target="_blank" title="Working Through Data-Intensive Text Processing with MapReduce">here</a>. In the previous post, we discussed using the technique of local aggregation as a means of reducing the amount of data shuffled and transferred across the network. Reducing the amount of data transferred is one of the top ways to improve the efficiency of a MapReduce job. A word-count MapReduce job was used to demonstrate local aggregation. Since the results only require a total count, we could re-use the same reducer for our combiner as changing the order or groupings of the addends will not affect the sum.<p></p><p>But what if you wanted an <i>average</i>? Then the same approach would not work because calculating an average of averages is not equal to the average of the original set of numbers. With a little bit of insight though, we can still use local aggregation. For these examples we will be using a sample of the <a href="https://github.com/tomwhite/hadoop-book/tree/master/input/ncdc/all" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">NCDC weather dataset</a> used in <a href="http://www.amazon.com/Hadoop-Definitive-Guide-Tom-White/dp/1449311520" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Hadoop the Definitive Guide</a> book. We will calculate the average temperature for each month in the year 1901. The averages algorithm for the combiner and the in-mapper combining option can be found in chapter 3.1.3 of Data-Intensive Processing with MapReduce.</p><p><strong>One Size Does Not Fit All</strong></p><p>Last time we described two approaches for reducing data in a MapReduce job, Hadoop Combiners and the in-mapper combining approach. Combiners are considered an optimization by the Hadoop framework and there are no guarantees on how many times they will be called, if at all. As a result, mappers must emit data in the form expected by the reducers so if combiners aren’t involved, the final result is not changed. To adjust for calculating averages, we need to go back to the mapper and change it’s output.<br> <strong><br> </strong><strong>Mapper Changes</strong></p><p>In the word-count example, the non-optimized mapper simply emitted the word and the count of 1. The combiner and in-mapper combining mapper optimized this output by keeping each word as a key in a hash map with the total count as the value. Each time a word was seen the count was incremented by 1. With this setup, if the combiner was not called, the reducer would receive the word as a key and a long list of 1?s to add together, resulting in the same output (of course using the in-mapper combining mapper avoided this issue because it’s guaranteed to combine results as it’s part of the mapper code). To compute an average, we will have our base mapper emit a string key (the year and month of the weather observation concatenated together) and a <a href="http://hadoop.apache.org/docs/r0.20.2/api/org/apache/hadoop/io/Writable.html" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">custom writable</a> object, called TemperatureAveragingPair. The <a href="https://github.com/bbejeck/hadoop-algorithms/blob/master/src/bbejeck/mapred/aggregation/TemperatureAveragingPair.java" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">TemperatureAveragingPair</a> object will contain two numbers (IntWritables), the temperature taken and a count of one. We will take the MaximumTemperatureMapper from Hadoop: The Definitive Guide and use it as inspiration for creating an AverageTemperatureMapper:</p><div id="highlighter_811341" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword">public</code> <code class="keyword">class</code> <code class="plain">AverageTemperatureMapper </code><code class="keyword">extends</code> <code class="plain">Mapper&lt;LongWritable, Text, Text, TemperatureAveragingPair&gt; {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="comments">//sample line of weather data</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="comments">//0029029070999991901010106004+64333+023450FM-12+000599999V0202701N015919999999N0000001N9-00781+99999102001ADDGF10899199999999999</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="plain">Text outText = </code><code class="keyword">new</code> <code class="plain">Text();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="plain">TemperatureAveragingPair pair = </code><code class="keyword">new</code> <code class="plain">TemperatureAveragingPair();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="keyword">static</code> <code class="keyword">final</code> <code class="keyword">int</code> <code class="plain">MISSING = </code><code class="value">9999</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1">@Override</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">protected</code> <code class="keyword">void</code> <code class="plain">map(LongWritable key, Text value, Context context) </code><code class="keyword">throws</code> <code class="plain">IOException, InterruptedException {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">String line = value.toString();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">String yearMonth = line.substring(</code><code class="value">15</code><code class="plain">, </code><code class="value">21</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">tempStartPosition = </code><code class="value">87</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(line.charAt(tempStartPosition) == </code><code class="string">'+'</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">tempStartPosition += </code><code class="value">1</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">temp = Integer.parseInt(line.substring(tempStartPosition, </code><code class="value">92</code><code class="plain">));</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(temp != MISSING) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">outText.set(yearMonth);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pair.set(temp, </code><code class="value">1</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">context.write(outText, pair);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><p>By having the mapper output a key and TemperatureAveragingPair object our MapReduce program is guaranteed to have the correct results regardless if the combiner is called.<br> <strong><br> </strong><strong>Combiner</strong></p><p>We need to reduce the amount of data sent, so we will sum the temperatures, and sum the counts and store them separately. By doing so we will reduce data sent, but preserve the format needed for calculating correct averages. If/when the combiner is called, it will take all the TemperatureAveragingPair objects passed in and emit a single TemperatureAveragingPair object for the same key, containing the summed temperatures and counts. Here is the code for the combiner:</p><div id="highlighter_559905" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">class</code> <code class="plain">AverageTemperatureCombiner </code><code class="keyword">extends</code> <code class="plain">Reducer&lt;Text,TemperatureAveragingPair,Text,TemperatureAveragingPair&gt; {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="plain">TemperatureAveragingPair pair = </code><code class="keyword">new</code> <code class="plain">TemperatureAveragingPair();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1">@Override</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">protected</code> <code class="keyword">void</code> <code class="plain">reduce(Text key, Iterable&lt;TemperatureAveragingPair&gt; values, Context context) </code><code class="keyword">throws</code> <code class="plain">IOException, InterruptedException {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">temp = </code><code class="value">0</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">count = </code><code class="value">0</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(TemperatureAveragingPair value : values) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">temp += value.getTemp().get();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">count += value.getCount().get();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pair.set(temp,count);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">context.write(key,pair);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><p>But we are really interested in being guaranteed we have reduced the amount of data sent to the reducers, so we’ll have a look at how to achieve that next.<br> <strong><br> </strong><strong>In Mapper Combining Averages</strong></p><p>Similar to the word-count example, for calculating averages, the in-mapper-combining mapper will use a hash map with the concatenated year+month as a key and a TemperatureAveragingPair as the value. Each time we get the same year+month combination, we’ll take the pair object out of the map, add the temperature and increase the count by by one. Once the cleanup method is called we’ll and emit all pairs with their respective key:</p><div id="highlighter_53377" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword">public</code> <code class="keyword">class</code> <code class="plain">AverageTemperatureCombiningMapper </code><code class="keyword">extends</code> <code class="plain">Mapper&lt;LongWritable, Text, Text, TemperatureAveragingPair&gt; {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="comments">//sample line of weather data</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="comments">//0029029070999991901010106004+64333+023450FM-12+000599999V0202701N015919999999N0000001N9-00781+99999102001ADDGF10899199999999999</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="keyword">static</code> <code class="keyword">final</code> <code class="keyword">int</code> <code class="plain">MISSING = </code><code class="value">9999</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="plain">Map&lt;String,TemperatureAveragingPair&gt; pairMap = </code><code class="keyword">new</code> <code class="plain">HashMap&lt;String,TemperatureAveragingPair&gt;();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1">@Override</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">protected</code> <code class="keyword">void</code> <code class="plain">map(LongWritable key, Text value, Context context) </code><code class="keyword">throws</code> <code class="plain">IOException, InterruptedException {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">String line = value.toString();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">String yearMonth = line.substring(</code><code class="value">15</code><code class="plain">, </code><code class="value">21</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">tempStartPosition = </code><code class="value">87</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(line.charAt(tempStartPosition) == </code><code class="string">'+'</code><code class="plain">) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">tempStartPosition += </code><code class="value">1</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">temp = Integer.parseInt(line.substring(tempStartPosition, </code><code class="value">92</code><code class="plain">));</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">(temp != MISSING) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">TemperatureAveragingPair pair = pairMap.get(yearMonth);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code><code class="plain">(pair == </code><code class="keyword">null</code><code class="plain">){</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pair = </code><code class="keyword">new</code> <code class="plain">TemperatureAveragingPair();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pairMap.put(yearMonth,pair);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">temps = pair.getTemp().get() + temp;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">count = pair.getCount().get() + </code><code class="value">1</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pair.set(temps,count);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1">@Override</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">protected</code> <code class="keyword">void</code> <code class="plain">cleanup(Context context) </code><code class="keyword">throws</code> <code class="plain">IOException, InterruptedException {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Set&lt;String&gt; keys = pairMap.keySet();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">Text keyText = </code><code class="keyword">new</code> <code class="plain">Text();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(String key : keys) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">keyText.set(key);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">context.write(keyText,pairMap.get(key));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><p>By following the same pattern of keeping track of data between map calls, we can achieve reliable data reduction by implementing an in-mapper combining strategy. The same caveats apply for keeping state across all calls to the mapper, but looking at the gains that can be made in processing efficiency, using this approach merits some consideration.<br> <strong><br> </strong><strong>Reducer</strong></p><p>At this point, writing our reducer is easy, take a list of pairs for each key, sum all the temperatures and counts then divide the sum of the temperatures by the sum of the counts.</p><div id="highlighter_509702" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword">public</code> <code class="keyword">class</code> <code class="plain">AverageTemperatureReducer </code><code class="keyword">extends</code> <code class="plain">Reducer&lt;Text, TemperatureAveragingPair, Text, IntWritable&gt; {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="plain">IntWritable average = </code><code class="keyword">new</code> <code class="plain">IntWritable();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1">@Override</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">protected</code> <code class="keyword">void</code> <code class="plain">reduce(Text key, Iterable&lt;TemperatureAveragingPair&gt; values, Context context) </code><code class="keyword">throws</code> <code class="plain">IOException, InterruptedException {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">temp = </code><code class="value">0</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">int</code> <code class="plain">count = </code><code class="value">0</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">for</code> <code class="plain">(TemperatureAveragingPair pair : values) {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">temp += pair.getTemp().get();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">count += pair.getCount().get();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">average.set(temp / count);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">context.write(key, average);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><p><strong><br> </strong><strong>Results</strong></p><p>The results are predictable with the combiner and in-mapper-combining mapper options showing substantially reduced data output.<br> Non-Optimized Mapper Option:</p><div id="highlighter_713318" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce input groups=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Combine output records=</code><code class="value">0</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map input records=</code><code class="value">6565</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce shuffle bytes=</code><code class="value">111594</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce output records=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Spilled Records=</code><code class="value">13128</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map output bytes=</code><code class="value">98460</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Total committed heap usage (bytes)=</code><code class="value">269619200</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Combine input records=</code><code class="value">0</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map output records=</code><code class="value">6564</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; SPLIT_RAW_BYTES=</code><code class="value">108</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">05</code><code class="plain">:</code><code class="value">28</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce input records=</code><code class="value">6564</code></td></tr></tbody></table></div></div></div><p>Combiner Option:</p><div id="highlighter_261429" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce input groups=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Combine output records=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map input records=</code><code class="value">6565</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce shuffle bytes=</code><code class="value">210</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce output records=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Spilled Records=</code><code class="value">24</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map output bytes=</code><code class="value">98460</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Total committed heap usage (bytes)=</code><code class="value">269619200</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Combine input records=</code><code class="value">6564</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map output records=</code><code class="value">6564</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; SPLIT_RAW_BYTES=</code><code class="value">108</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">07</code><code class="plain">:</code><code class="value">19</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce input records=</code><code class="value">12</code></td></tr></tbody></table></div></div></div><p>In-Mapper-Combining Option:</p><div id="highlighter_758114" class="syntaxhighlighter  "><div class="bar"><div class="toolbar"><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#viewSource" title="view source" class="item viewSource" style="width: 16px; height: 16px;">view source</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#printSource" title="print" class="item printSource" style="width: 16px; height: 16px;">print</a><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#about" title="?" class="item about" style="width: 16px; height: 16px;">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce input groups=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Combine output records=</code><code class="value">0</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map input records=</code><code class="value">6565</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce shuffle bytes=</code><code class="value">210</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce output records=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Spilled Records=</code><code class="value">24</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map output bytes=</code><code class="value">180</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Total committed heap usage (bytes)=</code><code class="value">269619200</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Combine input records=</code><code class="value">0</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Map output records=</code><code class="value">12</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; SPLIT_RAW_BYTES=</code><code class="value">108</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="value">12</code><code class="plain">/</code><code class="value">10</code><code class="plain">/</code><code class="value">10</code> <code class="value">23</code><code class="plain">:</code><code class="value">09</code><code class="plain">:</code><code class="value">09</code> <code class="plain">INFO mapred.JobClient:&nbsp;&nbsp;&nbsp;&nbsp; Reduce input records=</code><code class="value">12</code></td></tr></tbody></table></div></div></div><p>Calculated Results:<br> (NOTE: the temperatures in the sample file are in Celsius * 10)</p><table border="1" cellpadding="5" cellspacing="5"><tbody><tr><td>Non-Optimized</td><td>Combiner</td><td>In-Mapper-Combiner Mapper</td></tr><tr><td>190101 -25<br> 190102 -91<br> 190103 -49<br> 190104 22<br> 190105 76<br> 190106 146<br> 190107 192<br> 190108 170<br> 190109 114<br> 190110 86<br> 190111 -16<br> 190112 -77</td><td>190101 -25<br> 190102 -91<br> 190103 -49<br> 190104 22<br> 190105 76<br> 190106 146<br> 190107 192<br> 190108 170<br> 190109 114<br> 190110 86<br> 190111 -16<br> 190112 -77</td><td>190101 -25<br> 190102 -91<br> 190103 -49<br> 190104 22<br> 190105 76<br> 190106 146<br> 190107 192<br> 190108 170<br> 190109 114<br> 190110 86<br> 190111 -16<br> 190112 -77</td></tr></tbody></table><p><strong><br> </strong><strong>Conclusion</strong></p><p>We have covered local aggregation for both the simple case where one could reuse the reducer as a combiner and a more complicated case where some insight on how to structure the data while still gaining the benefits of locally aggregating data for increase processing efficiency.<br> <strong><br> Further Reading</strong><br> <strong><br> </strong></p><ul><li> <a href="http://www.amazon.com/Data-Intensive-Processing-MapReduce-Synthesis-Technologies/dp/1608453421" title="Data-Intensive Text Processing with MapReduce" rel="external nofollow" class="ext-link" data-wpel-target="_blank">Data-Intensive Processing with MapReduce</a> by Jimmy Lin and Chris Dyer</li><li><a href="http://www.amazon.com/Hadoop-Definitive-Guide-Tom-White/dp/1449311520/ref=tmm_pap_title_0?ie=UTF8&qid=1347589052&sr=1-1" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Hadoop: The Definitive Guide</a> by Tom White</li><li><a href="https://github.com/bbejeck/hadoop-algorithms" title="Source Code" rel="external nofollow" class="ext-link" data-wpel-target="_blank">Source Code</a> from blog</li><li><a href="http://hadoop.apache.org/docs/r0.20.2/api/index.html" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Hadoop API</a></li><li><a href="http://mrunit.apache.org/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">MRUnit</a> for unit testing Apache Hadoop map reduce jobs</li><li><a href="http://www.gutenberg.org/" title="Project Gutenberg" rel="external nofollow" class="ext-link" data-wpel-target="_blank">Project Gutenberg</a> a great source of books in plain text format, great for testing Hadoop jobs locally.</li></ul><p><strong><i>Reference: </i></strong><a href="http://codingjunkie.net/text-processing-with-mapreduce-part-2/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Working Through Data-Intensive Text Processing with MapReduce – Local Aggregation Part II</a> from our <a href="http://www.javacodegeeks.com/p/jcg.html">JCG partner</a> Bill Bejeck at the <a href="http://codingjunkie.net/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Random Thoughts On Coding</a> blog.</p></div></div> <span style="display:none"><a href="http://www.javacodegeeks.com/tag/apache-hadoop/" rel="tag">Apache Hadoop</a> <a href="http://www.javacodegeeks.com/tag/big-data/" rel="tag">Big Data</a> <a href="http://www.javacodegeeks.com/tag/mapreduce/" rel="tag">MapReduce</a></span> <span style="display:none" class="updated">2012-10-17</span><div style="display:none" class="vcard author" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="http://www.javacodegeeks.com/author/Bill-Bejeck/" title="Posts by Bill Bejeck" rel="author">Bill Bejeck</a></strong></div></div> </article><p class="post-tag">Tagged with: <a href="http://www.javacodegeeks.com/tag/apache-hadoop/" rel="tag">Apache Hadoop</a> <a href="http://www.javacodegeeks.com/tag/big-data/" rel="tag">Big Data</a> <a href="http://www.javacodegeeks.com/tag/mapreduce/" rel="tag">MapReduce</a></p><div id="mc4wp-form-1" class="form mc4wp-form mc4wp-form-29380 mc4wp-ajax"><form method="post" role="form"><div class="nlbox1"><h1>Do you want to know how to develop your skillset to become a <span style="color: #CAB43D; text-shadow: 1px 1px #835D5D;">Java Rockstar?</span></h1><div style="background: url(&#39;http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/2015/01/books_promo.png&#39;) no-repeat; float:left; padding: 75px 145px 310px 170px; margin-top: -10px; margin-left: -35px;"></div><table style="margin-top: 20px; padding-left: 20px;"><tbody><tr><td style="vertical-align:top;"><h2>Subscribe to our newsletter to start Rocking <span style="text-decoration: underline;">right now!</span></h2><h3>To get you started we give you our best selling eBooks for <span style="color:#e01404; text-shadow: 1px 1px #C99924; font-size: 20px; line-height: 25px;">FREE!</span></h3><p></p><h3><strong>1.</strong> JPA Mini Book</h3><h3><strong>2.</strong> JVM Troubleshooting Guide</h3><h3><strong>3.</strong> JUnit Tutorial for Unit Testing</h3><h3><strong>4.</strong> Java Annotations Tutorial<!--3--></h3><h3><strong>5.</strong> Java Interview Questions</h3><h3><strong>6.</strong> Spring Interview Questions</h3><h3><strong>7.</strong> Android UI Design</h3><p></p><h3>and many more ....</h3><p>&nbsp;</p><p></p><p> <label for="mc4wp_email"><span style="font-weight: bold; font-size: 13pt;">Email address: </span></label> <input type="email" id="mc4wp_email" name="EMAIL" required="" placeholder="Your email address"></p> <input type="submit" value="Sign up"></td></tr></tbody></table></div><span class="mc4wp-ajax-loader" style="display: none;"></span><input type="hidden" name="_mc4wp_required_but_not_really" value="" style="display: none;"><input type="hidden" name="_mc4wp_timestamp" value="1439749514"><input type="hidden" name="_mc4wp_form_id" value="29380"><input type="hidden" name="_mc4wp_form_element_id" value="mc4wp-form-1"><input type="hidden" name="_mc4wp_form_submit" value="1"><input type="hidden" name="_mc4wp_form_nonce" value="53608d0033"></form><div class="mc4wp-response"></div></div><div class="ads-post"><div id="div-gpt-ad-1415445260332-5" style="width:300px; height:250px;"><script type="text/javascript">googletag.cmd.push(function(){googletag.display('div-gpt-ad-1415445260332-5');});</script></div></div><div id="comments"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#respond" style="display:none;">Cancel reply</a></small></h3><form action="http://www.javacodegeeks.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p><p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required="true" required="true"></p><p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required="true" required="true"></p><p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30"></p><p class="cptch_block"><br> <input type="hidden" name="cptch_result" value="tfQ="> <input type="hidden" name="cptch_time" value="1439749511"> <input type="hidden" value="Version: 4.1.3"> <input id="cptch_input" class="cptch_input" type="text" autocomplete="off" name="cptch_number" value="" maxlength="2" size="2" aria-required="true" required="required" style="margin-bottom:0;display:inline;font-size: 12px;width: 40px;"> − 3 =  five</p><p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-describedby="form-allowed-tags" aria-required="true" required="required"></textarea></p><p class="form-allowed-tags" id="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes: <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; </code></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="2045" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3da91a7b6c"></p><p class="comment-form-subscriptions"><label for="subscribe-reloaded"><input type="checkbox" name="subscribe-reloaded" id="subscribe-reloaded" value="yes"> Notify me of followup comments via e-mail. You can also <a href="http://www.javacodegeeks.com/comment-subscriptions/?srp=2045&srk=&sra=s">subscribe</a> without commenting.</label></p><p id="mc4wp-checkbox" class="mc4wp-checkbox-comment_form"><label><input type="checkbox" name="_mc4wp_subscribe_comment_form" value="1" checked=""> Sign me up for the newsletter!</label></p><textarea name="_mc4wp_required_but_not_really" style="display: none !important;"></textarea><p style="display: none;"></p><input type="hidden" id="ak_js" name="ak_js" value="1439749507795"></form></div></div></div></div> <aside class="sidebar"><div id="text-12" class="widget widget_text"><div class="widget-top"><h4></h4><div class="stripe-line"></div></div><div class="widget-container"><div class="textwidget"><div id="div-gpt-ad-1415445260332-3" style="width:300px; height:250px;"><script type="text/javascript">googletag.cmd.push(function(){googletag.display('div-gpt-ad-1415445260332-3');});</script></div></div></div></div><div id="text-13" class="widget widget_text"><div class="widget-top"><h4></h4><div class="stripe-line"></div></div><div class="widget-container"><div class="textwidget"><div id="div-gpt-ad-1415445260332-4" style="width:300px; height:250px;"><script type="text/javascript">googletag.cmd.push(function(){googletag.display('div-gpt-ad-1415445260332-4');});</script></div></div></div></div><div id="mc4wp_widget-3" class="widget widget_mc4wp_widget"><div class="widget-top"><h4>Newsletter</h4><div class="stripe-line"></div></div><div class="widget-container"><div id="mc4wp-form-2" class="form mc4wp-form mc4wp-form-28645 mc4wp-ajax"><form method="post" role="form"><div style="padding: 15px 15px 15px; background: url(&#39;http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/2014/11/newsletter-bg.jpg&#39;) no-repeat; background-color: rgb(252, 252, 252);"><span style="text-shadow: 1px 1px #D0D0D0; font-weight: bold; font-size: 14pt; display: inline;">113223</span> insiders are already enjoying weekly updates and complimentary whitepapers!<p> <span style="text-shadow: 1px 1px #D0D0D0; font-weight: bold; font-size: 14pt; display: inline;">Join them now</span> to gain <span style="text-decoration: underline;  font-size: 14pt;">exclusive access</span> to the latest news in the Java world, as well as insights about Android, Scala, Groovy and other related technologies.</p><p> <label for="mc4wp_email"><span style="font-weight: bold; font-size: 13pt;">Email address: </span></label> <input type="email" id="mc4wp_email" name="EMAIL" required="" placeholder="Your email address"></p> <input type="submit" value="Sign up"></div><span class="mc4wp-ajax-loader" style="display: none;"></span><input type="hidden" name="_mc4wp_required_but_not_really" value="" style="display: none;"><input type="hidden" name="_mc4wp_timestamp" value="1439749514"><input type="hidden" name="_mc4wp_form_id" value="28645"><input type="hidden" name="_mc4wp_form_element_id" value="mc4wp-form-2"><input type="hidden" name="_mc4wp_form_submit" value="1"><input type="hidden" name="_mc4wp_form_nonce" value="53608d0033"></form><div class="mc4wp-response"></div></div></div></div><div id="text-6" class="widget widget_text"><div class="widget-top"><h4>Join Us</h4><div class="stripe-line"></div></div><div class="widget-container"><div class="textwidget"><div style="width:150px; height:150px; float:left; margin-top:-10px; margin-left:-10px;"> <img title="Join Us" alt="Join Us" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/w4g-badge-150x150.png" width="150" height="150"></div> With <label style="border:1px solid #D8D8D8;background:#F0F0F0;border-radius:3px;-moz-border-radius:3px;text-shadow: 1px 1px #D0D0D0;text-align:center;font-weight:bold;padding-left:3px;padding-right:3px">1,240,600</label> monthly unique visitors and over <label style="border:1px solid #D8D8D8;background:#F0F0F0;border-radius:3px;-moz-border-radius:3px;text-shadow: 1px 1px #D0D0D0;text-align:center;font-weight:bold;padding-left:3px;padding-right:3px">500</label> authors we are placed among the top Java related sites around. Constantly being on the lookout for partners; we encourage you to join us. So If you have a blog with unique and interesting content then you should check out our <strong><a href="http://www.javacodegeeks.com/join-us/jcg">JCG</a></strong> partners program. You can also be a <strong><a href="http://www.javacodegeeks.com/join-us/w4g">guest writer</a></strong> for Java Code Geeks and hone your writing skills!</div></div></div><div id="text-14" class="widget widget_text"><div class="widget-top"><h4></h4><div class="stripe-line"></div></div><div class="widget-container"><div class="textwidget"><div id="div-gpt-ad-1415445260332-6" style="width:300px; height:600px;"><script type="text/javascript">googletag.cmd.push(function(){googletag.display('div-gpt-ad-1415445260332-6');});</script></div></div></div></div><div id="text-15" class="widget widget_text"><div class="widget-top"><h4>Career Opportunities</h4><div class="stripe-line"></div></div><div class="widget-container"><div class="textwidget"><style type="text/css">#indJobContent{line-height:18px;padding:0
10px 10px;background:-webkit-linear-gradient(#E0EAF6, #F6FBFE, #FCFCFC);background:-o-linear-gradient(#E0EAF6, #F6FBFE, #FCFCFC);background:-moz-linear-gradient(#E0EAF6, #F6FBFE, #FCFCFC);background:linear-gradient(#E0EAF6, #F6FBFE, #FCFCFC);max-width:280px}#indJobContent
a{color:#00c}#indJobContent
.company_location{font-size:11px;overflow:hidden;display:block}#pagination{clear:both;margin-top:10px}</style><script type="text/javascript">var ind_pub='4110899194707815';var ind_el='indJobContent';var ind_pf='';var ind_q='java';var ind_l='';var ind_chnl='Jobroll-JCG';var ind_n=10;var ind_d='http://www.indeed.com';var ind_t=40;var ind_c=30;var ind_pgn=1;var ind_pgnCnt=10;</script><script type="text/javascript" src="http://www.indeed.com/ads/jobroll-widget-v3.js"></script><div id="indJobContent" class=""></div><form style="background: url(&quot;http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/2015/07/career-opportunities.jpg&quot;) no-repeat;" action="http://www.javacodegeeks.com/job-board/jobs/" method="GET"><table width="100%" cellspacing="5" style="font-family: arial"><tbody><tr><td style="font-size: 16px; color: #F60"><b>what</b></td></tr><tr><td><input style="border-style: solid; border-width: 1px; border-color: #e0e0e0;" name="query" value="" placeholder="job title, keywords" size="30"></td></tr><tr><td style="font-size: 16px; color:#F60"><b>where</b></td></tr><tr><td><input style="border-style: solid; border-width: 1px; border-color: #e0e0e0;" name="location" value="" placeholder="city, state, zip" size="30"></td></tr><tr><td style="font-size: 16px; color:#F60"><b>country</b></td></tr><tr><td><select name="country"><option value="us">United States</option><option value="ar">Argentina</option><option value="au">Australia</option><option value="at">Austria</option><option value="bh">Bahrain</option><option value="be">Belgium</option><option value="br">Brazil</option><option value="ca">Canada</option><option value="cl">Chile</option><option value="cn">China</option><option value="co">Colombia</option><option value="cz">Czech Republic</option><option value="dk">Denmark</option><option value="fi">Finland</option><option value="fr">France</option><option value="de">Germany</option><option value="gr">Greece</option><option value="hk">Hong Kong</option><option value="hu">Hungary</option><option value="in">India</option><option value="id">Indonesia</option><option value="ie">Ireland</option><option value="il">Israel</option><option value="it">Italy</option><option value="jp">Japan</option><option value="kr">Korea</option><option value="kw">Kuwait</option><option value="lu">Luxembourg</option><option value="my">Malaysia</option><option value="mx">Mexico</option><option value="nl">Netherlands</option><option value="nz">New Zealand</option><option value="no">Norway</option><option value="om">Oman</option><option value="pk">Pakistan</option><option value="pe">Peru</option><option value="ph">Philippines</option><option value="pl">Poland</option><option value="pt">Portugal</option><option value="qa">Qatar</option><option value="ro">Romania</option><option value="ru">Russia</option><option value="sa">Saudi Arabia</option><option value="sg">Singapore</option><option value="za">South Africa</option><option value="es">Spain</option><option value="se">Sweden</option><option value="ch">Switzerland</option><option value="tw">Taiwan</option><option value="tr">Turkey</option><option value="ae">United Arab Emirates</option><option value="gb">United Kingdom</option><option value="ve">Venezuela</option> </select></td></tr><tr><td style="padding-top: 10px;"><input type="submit" value="Find Jobs"></td></tr><tr><td style="font-size: 13px; float: right; padding-top: 20px;"> <span id="indeed_at"> <a href="http://www.indeed.com/?indpubnum=4110899194707815" style="text-decoration: none; color: #000" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">jobs by</a> <a href="http://www.indeed.com/?indpubnum=4110899194707815" title="Job" search="" rel="external nofollow" class="ext-link" data-wpel-target="_blank"> <img src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/jobsearch.gif" style="border: 0; vertical-align: middle" alt="job search"> </a> </span></td></tr></tbody></table></form></div></div></div></aside><div class="clear"></div><div class="clear"></div></div></div><footer class="fade-in animated4"><div id="footer-widget-area" class="wide-right-3c container"><div id="footer-first" class="footer-widgets-box"><div id="linkcat-4" class="footer-widget widget_links"><div class="footer-widget-top"><h4>Knowledge Base</h4></div><div class="footer-widget-container"><ul class="xoxo blogroll"><li><a href="http://academy.javacodegeeks.com/" data-wpel-ignored="true">Academy</a></li><li><a href="http://examples.javacodegeeks.com/" target="_blank" data-wpel-ignored="true">Examples</a></li><li><a href="http://library.javacodegeeks.com/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Library</a></li><li><a href="http://www.javacodegeeks.com/p/resources.html" target="_blank">Resources</a></li><li><a href="http://www.javacodegeeks.com/tutorials/" target="_blank">Tutorials</a></li><li><a href="http://www.javacodegeeks.com/whitepaper/" target="_blank">Whitepapers</a></li></ul></div></div><div id="linkcat-3" class="footer-widget widget_links"><div class="footer-widget-top"><h4>Partners</h4></div><div class="footer-widget-container"><ul class="xoxo blogroll"><li><a href="http://www.mkyong.com/" target="_blank" data-wpel-ignored="true">Mkyong</a></li></ul></div></div><div id="linkcat-5" class="footer-widget widget_links"><div class="footer-widget-top"><h4>The Code Geeks Network</h4></div><div class="footer-widget-container"><ul class="xoxo blogroll"><li><a href="http://www.dotnetcodegeeks.com/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">.NET Code Geeks</a></li><li><a href="http://www.javacodegeeks.com/" target="_blank">Java Code Geeks</a></li><li><a href="http://www.webcodegeeks.com/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Web Code Geeks</a></li></ul></div></div></div><div id="footer-second" class="footer-widgets-box"><div id="linkcat-652" class="footer-widget widget_links"><div class="footer-widget-top"><h4>Hall Of Fame</h4></div><div class="footer-widget-container"><ul class="xoxo blogroll"><li><a href="http://www.javacodegeeks.com/2010/10/android-full-application-tutorial.html" target="_blank">“Android Full Application Tutorial” series</a></li><li><a href="http://www.javacodegeeks.com/2013/01/15-online-learning-websites-that-you-should-check-out.html" target="_blank">11 Online Learning websites that you should check out</a></li><li><a href="http://www.javacodegeeks.com/2013/04/advantages-and-disadvantages-of-cloud-computing-cloud-computing-pros-and-cons.html" target="_blank">Advantages and Disadvantages of Cloud Computing – Cloud computing pros and cons</a></li><li><a href="http://www.javacodegeeks.com/2011/02/android-google-maps-tutorial.html" target="_blank">Android Google Maps Tutorial</a></li><li><a href="http://www.javacodegeeks.com/2011/01/android-json-parsing-gson-tutorial.html" target="_blank">Android JSON Parsing with Gson Tutorial</a></li><li><a href="http://www.javacodegeeks.com/2010/09/android-location-based-services.html" target="_blank">Android Location Based Services Application – GPS location</a></li><li><a href="http://www.javacodegeeks.com/2011/01/android-quick-preferences-tutorial.html" target="_blank">Android Quick Preferences Tutorial</a></li><li><a href="http://www.javacodegeeks.com/2013/03/difference-between-comparator-and-comparable-in-java.html" target="_blank">Difference between Comparator and Comparable in Java</a></li><li><a href="http://www.javacodegeeks.com/2010/05/gwt-2-spring-3-jpa-2-hibernate-35-2.html" target="_blank">GWT 2 Spring 3 JPA 2 Hibernate 3.5 Tutorial</a></li><li><a href="http://www.javacodegeeks.com/2010/08/java-best-practices-vector-arraylist.html" target="_blank">Java Best Practices – Vector vs ArrayList vs HashSet</a></li></ul></div></div></div><div id="footer-third" class="footer-widgets-box"><div id="text-16" class="footer-widget widget_text"><div class="footer-widget-top"><h4>About Java Code Geeks</h4></div><div class="footer-widget-container"><div class="textwidget">JCGs (Java Code Geeks) is an independent online community focused on creating the ultimate Java to Java developers resource center; targeted at the technical architect, technical team lead (senior developer), project manager and junior developers alike. JCGs serve the Java, SOA, Agile and Telecom communities with daily news written by domain experts, articles, tutorials, reviews, announcements, code snippets and open source projects.</div></div></div><div id="text-17" class="footer-widget widget_text"><div class="footer-widget-top"><h4>Disclaimer</h4></div><div class="footer-widget-container"><div class="textwidget">All trademarks and registered trademarks appearing on Examples Java Code Geeks are the property of their respective owners. Java is a trademark or registered trademark of Oracle Corporation in the United States and other countries. Examples Java Code Geeks is not connected to Oracle Corporation and is not sponsored by Oracle Corporation.</div></div></div></div></div><div class="clear"></div> </footer><div class="clear"></div><div class="footer-bottom fade-in animated4"><div class="container"><div class="social-icons icon_flat"> <a class="ttip ext-link" href="http://feeds.feedburner.com/JavaCodeGeeks" rel="external nofollow" data-wpel-target="_blank" original-title="Rss"><i class="tieicon-rss"></i></a><a class="ttip ext-link" href="https://plus.google.com/+JavaCodeGeeks/" rel="external nofollow" data-wpel-target="_blank" original-title="Google+"><i class="tieicon-gplus"></i></a><a class="ttip ext-link" href="https://www.facebook.com/javacodegeeks" rel="external nofollow" data-wpel-target="_blank" original-title="Facebook"><i class="tieicon-facebook"></i></a><a class="ttip ext-link" href="https://twitter.com/javacodegeeks" rel="external nofollow" data-wpel-target="_blank" original-title="Twitter"><i class="tieicon-twitter"></i></a><a class="ttip ext-link" href="https://www.linkedin.com/groups/Java-Code-Geeks-3810709" rel="external nofollow" data-wpel-target="_blank" original-title="LinkedIn"><i class="tieicon-linkedin"></i></a></div><div class="alignleft"> Java Code Geeks and all content copyright © 2010-2015, <a href="http://www.exelixismedia.com/" rel="external nofollow" title="" class="ext-link" data-wpel-target="_blank">Exelixis Media P.C.</a> | <a href="http://www.javacodegeeks.com/about/terms-of-use/">Terms of Use</a> | <a href="http://www.javacodegeeks.com/about/privacy-policy/">Privacy Policy</a> | <a href="mailto:support@javacodegeeks.com">Contact</a></div></div></div></div><div id="topcontrol" class="tieicon-up-open" title="Scroll To Top" style="bottom: 15px;"></div><div id="fb-root"></div> <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-12271632-2','auto');ga('send','pageview');</script><script>var snp_f=[];</script><div class="snp-root"> <input type="hidden" id="snp_popup" value=""> <input type="hidden" id="snp_popup_id" value=""> <input type="hidden" id="snp_popup_theme" value=""> <input type="hidden" id="snp_exithref" value=""> <input type="hidden" id="snp_exittarget" value=""><div id="snppopup-welcome" class="snp-pop-42061 snppopup"><input type="hidden" class="snp_open" value="load"><input type="hidden" class="snp_open_after" value="6"><input type="hidden" class="snp_open_scroll" value="10"><input type="hidden" class="snp_optin_redirect_url" value=""><input type="hidden" class="snp_show_cb_button" value="no"><input type="hidden" class="snp_popup_id" value="42061"><input type="hidden" class="snp_popup_theme" value="newtheme7"><input type="hidden" class="snp_overlay" value="default"><input type="hidden" class="snp_cookie_conversion" value="30"><input type="hidden" class="snp_cookie_close" value="5"><div class="snp-fb snp-newtheme7"><div class="snp-steps snp-step-1 snp-step-show"><div class="snp-media"><div class="snp-media__img"><img src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/books_promo_lp.png" alt=""></div><div class="snp-media__body"><div class="snp-h3 snp-delta">Want to take your Java Skills to the next level?</div><div class="snp-h1 snp-beta  snp-uppercase  snp-color--primary">Grab our programming books for FREE!</div><ul class="snp-list"><li>Save time by leveraging our field-tested solutions to common problems.</li><li>The books cover a wide range of topics, from JPA and JUnit, to JMeter and Android.</li><li>Each book comes as a standalone guide (with source code provided), so that you use it as reference.</li></ul></div></div> <footer class="snp-theme__footer snp-flush--top"><div class="snp-theme__choice"> <a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#" data-nextstep="2" class="snp_nextstep snp-btn snp-btn--primary">Gimme the FREE eBooks</a><span class="snp-theme__choice-or"> </span><a href="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#" data-nextstep="2" class="snp_nothanks snp-btn snp-btn--secondary">I reject the FREE eBooks</a></div> </footer></div><div class="snp-steps snp-step-2"><div class="snp-h3 snp-gamma">Last Step ...</div><form action="http://www.javacodegeeks.com/2012/10/mapreduce-working-through-data-2.html?utm_content=buffer4091d&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer#" method="post" class="snp-push--ends snp-subscribeform snp_subscribeform"><p><span style="font-size:20px;">Where should we send the free eBooks?</span></p><ul class="snp-fields-list"><li><input type="text" name="email" id="snp_email" placeholder="Your Email..." class="snp-field snp-field-email"></li></ul> <footer class="snp-theme__footer"><p> <button class="snp-subscribe-button snp-submit snp-btn  snp-btn--primary  snp-btn--large" data-nextstep="3" data-loading="" data-success="" type="submit">Send me the FREE eBooks</button></p> </footer></form></div><div class="snp-steps snp-step-3"><div class="snp-h2 snp-gamma">Good Work!</div><div class="snp-h1 snp-alpha snp-uppercase  snp-color--primary"><span>To download the books, please <span style="text-decoration: underline;">verify</span> your email address by following the instructions found on the email we just sent you.</span></div><p class="snp-islet"><img src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/java_duke_thumbs_up.png" alt=""></p> <footer class="snp-theme__footer"><p><a href="" class=" snp-btn snp-btn--secondary">Close</a></p> </footer></div></div><style>/*<![CDATA[*/.snp-pop-42061 .snp-newtheme7{width:890px}.snp-pop-42061 .snp-newtheme7{background:#e5ffff}.snp-pop-42061 .snp-theme__footer{background:#ECFFE8}.snp-pop-42061 .snp-theme__footer{border-top:1px solid #16a126}.snp-pop-42061 .snp-newtheme7{color:#363636}.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-h3{font-size:26px;color:#363636}.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-h1{font-size:40px;color:#1678a1}.snp-pop-42061 .snp-newtheme7 .snp-color--primary{color:#1678a1}.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-btn--primary{background:#16a126}.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-btn--primary{color:#fff}.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-btn--secondary{background:#e01404}.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-btn--secondary{color:#fff}.snp-pop-42061 .snp-newtheme7 .snp-step-2 .snp-h3{font-size:30px;color:#363636}.snp-pop-42061 .snp-newtheme7 .snp-step-2 .snp-btn--primary{background:#16a126}.snp-pop-42061 .snp-newtheme7 .snp-step-2 .snp-btn--primary{color:#fff}.snp-pop-42061 .snp-newtheme7 .snp-step-3 .snp-btn--secondary{background:#e01404}.snp-pop-42061 .snp-newtheme7 .snp-step-3 .snp-btn--secondary{color:#fff}.snp-pop-42061 .snp-newtheme7 .snp-step-3 .snp-h2{font-size:40px;color:#1678a1}.snp-pop-42061 .snp-newtheme7 .snp-step-3 .snp-h1{font-size:30px;color:#363636}/*]]>*/</style><style>.snp-pop-42061 .snp-newtheme7 .snp-step-1 .snp-btn{width:30%}</style></div></div><script>/*<![CDATA[*/var snp_timer;var snp_timer_o;var snp_ajax_url='http://www.javacodegeeks.com/wp-admin/admin-ajax.php';var snp_ignore_cookies=false;var snp_is_interal_link;var snp_enable_analytics_events=true;var snp_enable_mobile=true;jQuery(document).ready(function(){jQuery('[placeholder]').placeholder();jQuery(".snp_nothanks, .snp_closelink, .snp-close-link").click(function(){snp_close();return false;});jQuery(".snp_subscribeform").submit(function(){return snp_onsubmit(jQuery(this));});var snp_open=jQuery('#snppopup-welcome .snp_open').val();var snp_open_after=jQuery('#snppopup-welcome .snp_open_after').val();var snp_open_inactivity=jQuery('#snppopup-welcome .snp_open_inactivity').val();var snp_open_scroll=jQuery('#snppopup-welcome .snp_open_scroll').val();var snp_op_welcome=false;if(snp_open=='inactivity')
{var snp_idletime=0;function snp_timerIncrement()
{snp_idletime++;if(snp_idletime>snp_open_inactivity)
{window.clearTimeout(snp_idleInterval);snp_open_popup('','','snppopup-welcome','welcome');}}
var snp_idleInterval=setInterval(snp_timerIncrement,1000);jQuery(this).mousemove(function(e){snp_idletime=0;});jQuery(this).keypress(function(e){snp_idletime=0;});}
else if(snp_open=='scroll')
{jQuery(window).scroll(function(){var h=jQuery(document).height()-jQuery(window).height();var sp=jQuery(window).scrollTop();var p=parseInt(sp/h*100);if(p>=snp_open_scroll&&snp_op_welcome==false){snp_open_popup('','','snppopup-welcome','welcome');snp_op_welcome=true;}});}
else
{if(snp_open_after)
{snp_timer_o=setTimeout("snp_open_popup('','','snppopup-welcome','welcome');",snp_open_after*1000);}
else
{snp_open_popup('','','snppopup-welcome','welcome');}}});/*]]>*/</script><script type="text/javascript">var qpprFrontData={"linkData":[],"siteURL":"http:\/\/www.javacodegeeks.com","siteURLq":"http:\/\/www.javacodegeeks.com"};</script><script type="text/javascript" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/qppr_frontend_script.js"></script><script type="text/javascript">var mc4wp_vars={"ajaxurl":"http:\/\/www.javacodegeeks.com\/wp-admin\/admin-ajax.php?mc4wp_action=subscribe","ajaxloader":{"enabled":true,"imgurl":"http:\/\/www.javacodegeeks.com\/wp-content\/plugins\/mailchimp-for-wp-pro\/assets\/img\/ajax-loader.gif"}};</script><script type="text/javascript">/*<![CDATA[*/jQuery(function(){$foobar({"height":{"bar":50,"button":30},"width":{"left":"0px","center":"0px","right":"*","button":"80px"},"position":{"ignoreOffsetMargin":false,"bar":"top","button":"right","social":"left"},"display":{"type":"onscroll","delay":0,"speed":100,"backgroundColor":"#326693","border":"solid 3px #ffffff","theme":{"bar":"x-white"},"easing":"swing","shadow":true,"adjustPageHeight":false,"rtl":false,"button":{"type":"close"}},"message":{"delay":2000,"fadeDelay":500,"random":false,"navigation":false,"scroll":{"enabled":true,"speed":50,"delay":2000,"direction":"left"},"cssClass":"__none"},"rightHtml":"<!-- /70432299/JCG_NotifBar --><div id=\'div-gpt-ad-1431445244472-0\' style=\'height:50px; width:1220px; margin-left: auto; margin-right: auto;\'><script src=\'http://a3ab771892fd198a96736e50.javacodegeeks.netdna-cdn.com/wp-content/uploads/fbDFP.js\'/></div>"});jQuery(window).scroll(function(){if(jQuery(this).width()>1220){if(jQuery(this).scrollTop()>0){jQuery('.x-white').slideDown(100);}else{jQuery('.x-white').slideUp(100);}}});jQuery(window).resize(function(){if(jQuery(this).width()<1220){jQuery('.x-white').hide();}});});/*]]>*/</script><script type="text/javascript">/*<![CDATA[*/(function(){function addSubmittedClassToFormContainer(e){var form=e.target.form.parentNode;var className='mc4wp-form-submitted';(form.classList)?form.classList.add(className):form.className+=' '+className;}
function hideHoneypot(h){var n=document.createElement('input');n.type='hidden';n.name=h.name;n.style.display='none';n.value=h.value;h.parentNode.replaceChild(n,h);}
var forms=document.querySelectorAll('.mc4wp-form');for(var i=0;i<forms.length;i++){(function(f){var h=f.querySelector('input[name="_mc4wp_required_but_not_really"]');if(h){hideHoneypot(h);}
var b=f.querySelector('[type="submit"], [type="image"]');if(b.addEventListener){b.addEventListener('click',addSubmittedClassToFormContainer);}else{b.attachEvent('click',addSubmittedClassToFormContainer);}})(forms[i]);}})();/*]]>*/</script><script type="text/javascript" src="./MapReduce_ Working Through Data-Intensive Text Processing - Local Aggregation Part II _ Java Code Geeks_files/single.include-footer.84923a.js"></script><iframe frameborder="0" scrolling="no" style="border: 0px; display: none; background-color: transparent;"></iframe><div id="GOOGLE_INPUT_CHEXT_FLAG" input="null" input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:false,&quot;ss&quot;:true}" style="display: none;"></div></body></html>