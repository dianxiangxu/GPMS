/*!CK:2836337950!*//*1437965356,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["0ZKtw"]); }

__d("TagExpansionButtonConfig",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={FRIENDS_OF_TAGGED:"friends_of_tagged",TAGGED_ONLY:"tagged_only"};},null);
__d("KeyboardShortcuts",["KeyEventController","Layer","ModalLayer"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(l,m,n){"use strict";this.key=l;this.handler=m;this.filter=n;this.register();}j.prototype.register=function(){"use strict";this.token=g.registerKey(this.key,this.handler,this.filter);};j.prototype.remove=function(){"use strict";this.token.remove();};var k={_tokens:[[]],register:function(l,m,n){n=n||{};var o=n.allowDefault?m:function(event,s){m.apply(this,arguments);event.prevent();},p=n.baseFilters||[g.defaultFilter],q=function(event,s){for(var t=0,u=p.length;t<u;t++)if(!p[t](event,s))return false;return !n.filter||n.filter(event,s);},r=new j(l,o,q);this._tokens[this._tokens.length-1].push(r);return r;},init:function(){h.subscribe('show',function(l,m){if(m.hasBehavior(i))this.pushLayer();}.bind(this));h.subscribe('hide',function(l,m){if(m.hasBehavior(i))this.popLayer();}.bind(this));},pushLayer:function(){var l=this._tokens[this._tokens.length-1];l&&l.forEach(function(m){m.remove();});this._tokens.push([]);},popLayer:function(){var l=this._tokens.length-1;if(l<0)return;var m=this._tokens[l];m.forEach(function(o){o.remove();});this._tokens.pop();var n=this._tokens[l-1];n&&n.forEach(function(o){o.register();});}};k.init();e.exports=k;},null);
__d("LikeConfirmer",["AsyncDialog","AsyncRequest"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=false,j=false,k={likeContent:function(){},like:function(l,m){this.likeContent=l;if(j)return;if(i){this.likeContent();}else{var n=new h().setURI('/like/confirm_like.php').setRelativeTo(m);g.send(n,function(o){j=true;o.subscribe('hide',this.onCloseLikeConfirmDialog.bind(this));o.setCausalElement(m);}.bind(this));}return false;},isShowingConfirmation:function(){return j;},onCloseLikeConfirmDialog:function(){j=false;},likeSkipConfirmation:function(l){i=l;this.likeContent();}};e.exports=k;},null);
__d("FeedBaseKeyboardController",["$","AccessibilityLogger","Arbiter","AsyncDialog","AsyncRequest","Banzai","BanzaiODS","BanzaiNectar","CSS","DOM","DOMScroll","DOMQuery","Event","Focus","KeyboardShortcuts","LikeConfirmer","NavigationMessage","Parent","ReactComposerEvents","ReactComposerIDGenerator","Run","Scroll","SubscriptionsHandler","UITinyViewportAction","Vector","ViewportBounds","csx","emptyFunction","ge","getActiveElement","isAsyncScrollQuery","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){b.__markCompiled&&b.__markCompiled();var ma;function na(){ma=da.isTiny()?0:g('pagelet_bluebar').offsetTop+g('pagelet_bluebar').offsetHeight;}setTimeout(na,0);s.listen(window,'resize',la(na));function oa(pa){"use strict";this.root=pa;this.init();}oa.prototype.getStories=function(){"use strict";};oa.prototype.getParentStory=function(pa){"use strict";};oa.prototype.isStory=function(pa){"use strict";};oa.prototype.isHoldoutStory=function(pa){"use strict";};oa.prototype.getHeadline=function(pa){"use strict";};oa.prototype.getPreviousStory=function(pa){"use strict";};oa.prototype.getNextStory=function(pa){"use strict";};oa.prototype.setSelected=function(pa,qa){"use strict";};oa.prototype.clickLike=function(){"use strict";};oa.prototype.clickComment=function(){"use strict";};oa.prototype.clickShare=function(){"use strict";};oa.prototype.clickSeeMore=function(){"use strict";};oa.prototype.clickLeft=function(){"use strict";};oa.prototype.clickRight=function(){"use strict";};oa.prototype.openAttachment=function(){"use strict";};oa.prototype.focusComposer=function(){"use strict";var pa=ia('pagelet_composer');if(!pa)pa=ia('pagelet_group_composer');if(pa){var qa=p.scry(pa,'textarea')[0];if(qa){t.set(qa);q.scrollToTop(true);}else{var ra=p.scry(pa,"div._36bx")[0],sa=ra&&ra.id;if(z.isComposerID(sa)){i.inform(y.FOCUS,{composerID:ra.id});q.scrollToTop(true);}}}};oa.prototype.getScrollOffset=function(){"use strict";return 10;};oa.prototype.getAnimationLength=function(pa){"use strict";return Math.min(Math.abs(ea.getElementPosition(pa).y-fa.getTop()-ba.getTop(document.body)),400);};oa.prototype.findTop=function(){"use strict";var pa=this.getStories();for(var qa=0;qa<pa.length;qa++)if(ea.getElementPosition(pa[qa]).y>ea.getScrollPosition().y)return pa[qa];};oa.prototype.onLeave=function(){"use strict";this.subscriptions&&this.subscriptions.release();};oa.prototype.getHelpDialogRequest=function(){"use strict";if(!this.dialogRequest){this.dialogRequest=new k('/ajax/keyboard_shortcuts');this.dialogRequest.setReadOnly(true);}else if(this.dialogRequest.transport)return null;return this.dialogRequest;};oa.prototype.init=function(){"use strict";aa.onLeave(this.onLeave.bind(this));this.subscriptions=new ca();this.subscriptions.addSubscriptions(i.subscribe(w.NAVIGATION_BEGIN,this.onLeave.bind(this)),u.register('j',this.vert.bind(this,1)),u.register('k',this.vert.bind(this,-1)),u.register('l',function(){var pa=this.getParentStory(ja());v.like(function(){this.setSelected(pa,false);this.clickLike();}.bind(this),ja());}.bind(this),{filter:this.hasActiveStory.bind(this)}),u.register('c',this.clickComment.bind(this),{filter:this.hasActiveStory.bind(this)}),u.register('o',this.openAttachment.bind(this),{filter:this.hasActiveStory.bind(this)}),u.register('p',this.focusComposer.bind(this)),u.register('s',this.clickShare.bind(this),{filter:this.hasActiveStory.bind(this)}),u.register('SLASH',function(){var pa=this.getHelpDialogRequest();if(pa){pa.setRelativeTo(ja());j.send(pa);}}.bind(this),{filter:function(event,pa){return event.getModifiers().shift;}}),u.register('RETURN',this.clickSeeMore.bind(this),{filter:this.hasExpandableStoryInFocus.bind(this)}),u.register('LEFT',this.clickLeft.bind(this),{filter:this.hasActiveStory.bind(this)}),u.register('RIGHT',this.clickRight.bind(this),{filter:this.hasActiveStory.bind(this)}),s.listen(this.root,'focusin',function(event){var pa=event.getTarget();if(!this.isStory(pa)){var qa=(pa.nodeName=='OBJECT'||pa.nodeName=='EMBED'||pa.nodeName=='IFRAME'),ra=this.getParentStory(pa),sa=this.selected;if(ra&&!qa&&sa){this.setSelected(ra,true);this.selected=ra;}}}.bind(this)));};oa.prototype.hasActiveStory=function(event,pa){"use strict";var qa=ja();return !(qa&&o.shown(qa))||!!this.getParentStory(qa);};oa.prototype.hasExpandableStoryInFocus=function(event,pa){"use strict";var qa=ja();return !!(qa.getElementsByClassName('text_exposed_root').length&&!qa.getElementsByClassName('text_exposed_root text_exposed').length);};oa.prototype.click=function(pa){"use strict";if(!this.selected)return;var qa;for(var ra=0,sa=arguments.length;ra<sa;ra++){qa=p.scry(this.selected,arguments[ra])[0];if(qa&&o.shown(qa)){qa.click();return;}}};oa.prototype.vert=function(pa){"use strict";if(!this.scrollInitialized){this.subscriptions.addSubscriptions(s.listen(document,'scroll',function(){if(this.selected&&!this.scrolling)this.setSelected(null,false);}.bind(this)));this.scrollInitialized=true;}var qa,ra;if(this.selected){if(l.isEnabled('kbshortcuts_feed')){ra=pa>0?'kbshortcuts.scroll_down':'kbshortcuts.scroll_up';m.bumpEntityKey('kbshortcuts_feed',ra);n.log('feed_scroll',ra,{});}h.logJKKey();if(this.selected.id=='pagelet_composer'){qa=pa>0?this.getStories()[0]:null;if(this.isHoldoutStory(qa))qa=this.getPreviousStory(qa);}else if(pa===0){qa=this.selected;}else qa=pa>0?this.getNextStory(this.selected):(this.getPreviousStory(this.selected)||ia('pagelet_composer'));if(!qa){return;}else if(!r.isElementNode(qa)){o.removeClass(this.selected,'selectedStorySimple');this.selected=qa;return this.vert(pa);}}if(!qa||x.byClass(qa,'hidden_elem')||!p.contains(document,qa)){qa=this.findTop();if(qa&&pa<0)qa=this.getPreviousStory(qa);if(this.isHoldoutStory(qa))qa=this.getPreviousStory(qa);}if(!qa)return;this.anim&&this.anim.stop();var sa=(Date.now()-(this.lastScroll||0)>30);if(pa!==0)var ta=this.setFocused.bind(this,qa);if(ka()){sa=false;ta();ta=ha;}this.scrolling=true;this.scrollingTimer&&window.clearTimeout(this.scrollingTimer);this.anim=q.scrollTo(qa,sa?this.getAnimationLength(qa):0,false,ea.getViewportDimensions().y-ma-this.getScrollOffset(),0,function(){this.scrollingTimer=window.setTimeout(function(){this.scrolling=false;}.bind(this),300);var ua=ea.getScrollPosition();ta();if(ua.distanceTo(ea.getScrollPosition())!==0)q.scrollTo(ua,0);}.bind(this));this.setSelected(qa,true);this.lastScroll=Date.now();};oa.prototype.isInteractive=function(pa){"use strict";return ((pa.nodeName=='INPUT')||(pa.nodeName=='BUTTON')||(pa.nodeName=='TEXTAREA')||(pa.nodeName=='A')||!!x.byAttribute(pa,'contenteditable'));};oa.prototype.setTabindexOnHeadline=function(pa,qa){"use strict";if(this.isStory(pa)){var ra=this.getHeadline(pa);if(ra)ra.tabIndex=qa;}};oa.prototype.setTabindexOnStory=function(pa,qa){"use strict";if(this.isStory(pa))pa.tabIndex=qa;};oa.prototype.setFocused=function(pa){"use strict";if(this.isStory(pa))t.setWithoutOutline(pa);};e.exports=oa;},null);
__d("ViewportTrackingHelper",["Event","DOMDimensions","Vector"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={getScrollListener:function(k){return g.listen(window,'scroll',k);},looseIsVisible:function(k,l){if(!k.x&&!k.y&&!k.width&&!k.height)return false;var m=i.getScrollPosition().y,n=h.getViewportDimensions().height,o=n+l-m;return k.y<o;},isVisible:function(k,l){if(!k.x&&!k.y&&!k.width&&!k.height)return false;var m=h.getViewportDimensions().height,n=Math.max(k.y,0),o=Math.min(k.y+k.height,m),p=Math.min(k.height,l);return (o-n)>=p;},isDescendantOf:function(k,l){if(k===l)return k;while(k&&k.parentNode){if(k.parentNode===l)return k;k=k.parentNode;}return false;}};e.exports=j;},null);
__d("ViewportTracking",["Arbiter","AsyncSignal","Banzai","BanzaiScuba","CSS","cx","CurrentUser","DOM","DOMDimensions","Event","LitestandMessages","NavigationMessage","Run","SubscriptionsHandler","UserActivity","Vector","ViewportTrackingHelper","clickRefAction","collectDataAttributes","debounce","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();var ca=97,da=51,ea='vpv',fa='/feed/feed_tracking/vpv_waterfall_logging',ga=3,ha=2,ia=1,ja=0,ka=1,la=2,ma=3,na=4;function oa(){"use strict";}oa.prototype.init=function(pa){"use strict";this.useBanzai=true;this.viewportHeightRatio=pa.viewport_height_ratio?pa.viewport_height_ratio:.25;this.vpvDebug=!!pa.vpv_debug;this.vpvdDebug=!!pa.vpvd_debug;this.vpvdAnalysis=!!pa.vpvd_analysis;this.useWaterfallLogging=!!pa.waterfall_logging;this.loggedStoryIDs={};this.readStoryIDs={};this.annotatedStoryIDs={};this.minSizeToBeVisible=200;this.minFractionToBeVisibleForTimetracking=.5;this.scrollThrottlingInterval=100;this.mouseThrottlingInterval=100;this.keyboardThrottlingInterval=100;this.minTimeToReportImmediately=500;this.discardVPVDIntervalThreshold=90000;this.active_state_duration=1000;this.height_diff_to_change_state=25;this.focused_state_duration=3500;this.invalidateAllStoriesCache();this.cachedViewportHeight=o.getViewportDimensions().height;this.isTimetrackingEnabled=0;this.activeStories={};this.userInactiveLock=false;this.userActivityPollerTimeoutID=-1;this._headLoadStoryCount=0;this.getDataFromConfig(pa);if(this.isTimetrackingEnabled){this.lastMouseX=-1;this.lastMouseY=-1;this.lastStreamY=-1;this.latestStreamYChangedTimeStamp=-1;this.userFocus=la;this.latestUserFocus=la;this.latestUserActivity='init';this.focusedStory=null;this.latestFocusedStory=null;this.latestActiveStory=null;this.totalVPVDuration={};}this.isLoose=!!pa.is_loose;this.maxScrollPosition=0;if(pa.tracking_duration_config){this.scrollThrottlingInterval=pa.tracking_duration_config.scroll_throttling_interval;this.mouseThrottlingInterval=pa.tracking_duration_config.mouse_throttling_interval;this.keyboardThrottlingInterval=pa.tracking_duration_config.keyboard_throttling_interval;this.userActivityPollingInterval=pa.tracking_duration_config.user_activity_polling_interval;this.timeToBeConsideredInactive=pa.tracking_duration_config.time_to_be_considered_inactive;this.minFractionToBeVisibleForTimetracking=pa.tracking_duration_config.min_fraction_to_be_visible;this.minTimeToReportImmediately=pa.tracking_duration_config.min_time_to_report_immediately;this.active_state_duration=pa.tracking_duration_config.active_state_duration;this.height_diff_to_change_state=pa.tracking_duration_config.story_height_diff_to_change_state;this.focused_state_duration=pa.tracking_duration_config.focused_state_duration;this.discardVPVDIntervalThreshold=pa.tracking_duration_config.discard_vpvd_interval_threshold;}var qa,ra=z(this.fireTimer,this.getTimeout(),this);if(this.isLoose){this.minSizeToBeVisible=0;qa=ba(function(){this.maxScrollPosition=Math.max(this.maxScrollPosition,v.getScrollPosition().y);ra();}.bind(this));}else qa=ra;this.initialStories=this.getStoriesInView();this.initialStoriesLogged=false;if(this.annotatedVPVLogging)this.initialStories.forEach(this.logAnnotatedVPV,this);if(this.useWaterfallLogging)this.getStoriesInView().forEach(function(va){this.waterfallLogStep(va,'100_all_stories_in_view_ignore_height',true);},this);this.vpvHeartBeatInterval=pa.vpv_heartbeat_interval;this.passVPVHeartbeatGK=pa.use_vpv_heartbeat;if(this.passVPVHeartbeatGK){this.intervalCount=1;this.fireTimerCount=1;this.storiesInView=this.initialStories?this.initialStories:this.getStoriesInView();this.vpvHeartBeatIntervalSignal=setInterval(function(){this._sendSignal('interval');}.bind(this),this.vpvHeartBeatInterval);}this.subscriptions=new t();this.subscriptions.addSubscriptions(this._getScrollListener(qa),p.listen(window,'resize',function(){this.invalidateVisibleStoriesCache();this.cachedViewportHeight=o.getViewportDimensions().height;qa();}.bind(this)),p.listen(window,'focus',function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,'window_focus');}.bind(this)),p.listen(window,'blur',function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(true,'window_blur');}.bind(this)),g.subscribe(r.NAVIGATION_BEGIN,this.cleanup.bind(this)),g.subscribe('Stream/totalHeadLoadedStories',function(va,wa){this._headLoadStoryCount=wa.count;}.bind(this)),g.subscribe(q.STORIES_INSERTED,function(){if(!this.initialStoriesLogged){var va=this.getStoriesInView();va.forEach(this.logAnnotatedVPV,this);}else qa();if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,'stories_inserted');}.bind(this)));if(this.isTimetrackingEnabled){this.updateTimeTrackingData(false,'init');var sa=ba(function(event){this.invalidateVisibleStoriesCache();this.handleScroll(event);}.bind(this),this.scrollThrottlingInterval),ta=ba(function(event){this.handleKeyboard(event);}.bind(this),this.keyboardThrottlingInterval),ua=ba(function(event){this.handleMouse(event);}.bind(this),this.mouseThrottlingInterval);this.subscriptions.addSubscriptions(p.listen(window,'scroll',sa),p.listen(document.documentElement,'DOMMouseScroll',sa),p.listen(document.documentElement,'mousewheel',sa));this.subscriptions.addSubscriptions(p.listen(document.documentElement,'keydown',ta));this.subscriptions.addSubscriptions(p.listen(document.documentElement,'mouseover',ua),p.listen(document.documentElement,'mousemove',ua));this.subscriptions.addSubscriptions(g.subscribe('Event/stop',function(va,wa){this.handleMouse(wa.event);}.bind(this)));this.subscriptions.addSubscriptions(p.listen(document.documentElement,'click',function(event){this.handleMouse(event);}.bind(this)),g.subscribe('PhotoSnowlift.OPEN',function(){this.userFocus=ma;this.handleLayers();}.bind(this)),g.subscribe('PhotoSnowlift.CLOSE',function(){this.userFocus=ka;this.focusedStory=null;this.updateTimeTrackingData(false,'snowlift_close');}.bind(this)));this._userActivityPoller();}s.onLeave(this.cleanup.bind(this));s.onUnload(this.cleanup.bind(this));};oa.prototype._getScrollListener=function(pa){"use strict";return p.listen(window,'scroll',pa);};oa.prototype.cleanup=function(){"use strict";if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}if(this.isTimetrackingEnabled){clearTimeout(this.userActivityPollerTimeoutID);this.updateTimeTrackingData(true,'cleanup');}if(this.passVPVHeartbeatGK)clearInterval(this.vpvHeartBeatIntervalSignal);if(this.annotatedVPVLogging){var pa=this.getStoriesInView();pa.forEach(this.logAnnotatedVPV,this);}this.initialStories=[];this._headLoadStoryCount=0;};oa.prototype.fireTimer=function(){"use strict";if(this.useWaterfallLogging){var pa=this.getStoriesInViewIgnoreHeight();pa.forEach(function(qa){this.waterfallLogStep(qa,'100_all_stories_in_view_ignore_height');},this);}if(!this.initialStoriesLogged){this.initialStories.forEach(this.markStoryRead,this);this.initialStoriesLogged=true;}this.storiesInView=this.getStoriesInView();this.storiesInView.forEach(this.markStoryRead,this);if(this.passVPVHeartbeatGK)this._sendSignal('fireTimer');};oa.prototype.heartBeatIsEnabled=function(){"use strict";return false;};oa.prototype.getSessionID=function(){"use strict";return null;};oa.prototype._sendSignal=function(pa){"use strict";if(!this.heartBeatIsEnabled())return;var qa=-1;if(pa=='interval'){qa=this.intervalCount++;}else if(pa=='fireTimer')qa=this.fireTimerCount++;var ra=-1,sa=-1,ta=-1;if(this.storiesInView.length>0){ra=this.getStoryID(this.storiesInView[0]);sa=this.getQueryID(this.storiesInView[0]);ta=this.getFBFeedLocations(this.storiesInView[0]);}var ua=new j('vpv_heartbeat_js');ua.addInteger('qid',sa);ua.addInteger('uid',m.getID());ua.addInteger('firststoryid',ra);ua.addInteger('time',Math.round(Date.now()/1000));ua.addNormal('type',pa);ua.addInteger('count',qa);ua.addInteger('fbfeed_location',ta);ua.post();};oa.prototype._userActivityPoller=function(){"use strict";if(!this.userInactiveLock&&!u.isActive(this.timeToBeConsideredInactive)){this.userInactiveLock=true;this.userFocus=la;this.updateTimeTrackingData(false,'user_activity_inactive');u.subscribeOnce(function(){this.userFocus=ka;this.updateTimeTrackingData(false,'user_activity_active');this.userInactiveLock=false;}.bind(this));}this.userActivityPollerTimeoutID=setTimeout(this._userActivityPoller.bind(this),this.userActivityPollingInterval);};oa.prototype.getQueryID=function(pa){"use strict";return -1;};oa.prototype.getFBFeedLocations=function(pa){"use strict";return -1;};oa.prototype.getFBFeedInsertionPosition=function(pa){"use strict";return -1;};oa.prototype.createVPVDTimer=function(pa){"use strict";var qa=document.createElement("Label");qa.setAttribute("for",pa);qa.setAttribute("class",'vpvd_debug_timer');return qa;};oa.prototype.updateVPVDTimer=function(pa){"use strict";var qa=this.activeStories[pa].story,ra=n.scry(qa,'.vpvd_debug_timer');if(!ra.length){ra=[this.createVPVDTimer(qa),this.createVPVDTimer(qa)];var sa=n.scry(qa,'.UFIRow');if(sa.length&&sa[sa.length-1].clientWidth>0){sa[sa.length-1].appendChild(ra[0]);}else qa.appendChild(ra[0]);qa.insertBefore(ra[1],qa.firstChild);}var ta=this.totalVPVDuration[pa],ua=Math.floor(ta/1000)+'.'+Math.floor((ta%1000)/100);n.setContent(ra[0],ua);n.setContent(ra[1],ua);};oa.prototype.updateVPVDTimers=function(){"use strict";for(var pa in this.activeStories)if(this.activeStories.hasOwnProperty(pa))this.updateVPVDTimer(pa);};oa.prototype.logVpvdAnalysis=function(pa,qa,ra,sa,ta,ua){"use strict";var va=new j('vpv_duration');va.addDenorm('qid',this.getQueryID(this.activeStories[pa].story));va.addDenorm('uid',m.getID());va.addDenorm('vsid',pa);va.addInteger('time',Math.round(Date.now()/1000));va.addInteger('duration',sa);va.addInteger('total_duration',ta);va.addNormal('story_state',this.activeStories[pa].state);va.addNormal('is_active_state',ra);va.addNormal('num_visible_stories',this.numVisibleStories);va.addInteger('story_height',this.activeStories[pa].story_height);va.addInteger('story_visible_height',this.activeStories[pa].height);va.addInteger('state_visible_height',ua);va.addInteger('total_visible_height',this.totalVisibleHeight);va.addInteger('total_height',this.totalHeight);va.addNormal('user_focus',this.latestUserFocus);va.addNormal('next_user_focus',this.userFocus);va.addInteger('vpvd',qa);va.addInteger('accumulated_vpvd',this.activeStories[pa].vpvd);va.addNormal('user_activity',this.latestUserActivity);va.addNormal('next_user_activity',this.userActivity);va.addInteger('story_position_y',this.activeStories[pa].y);va.addInteger('feed_insertion_position',this.getFBFeedInsertionPosition(this.activeStories[pa].story));va.addNormal('visible_position',this.activeStories[pa].visible_position);va.addNormal('is_focused_story',this.activeStories[pa].is_focused);va.post();};oa.prototype.shouldDiscardStory=function(pa){"use strict";return this.activeStories[pa].height!=this.activeStories[pa].story_height&&this.activeStories[pa].height<this.totalHeight/2;};oa.prototype.calculateTotalHeight=function(){"use strict";this.totalHeight=0;for(var pa in this.activeStories)if(this.activeStories.hasOwnProperty(pa))this.totalHeight+=this.activeStories[pa].height;};oa.prototype.updateVPVDurations=function(pa){"use strict";if(this.latestUserFocus===la||pa-this.latestTimeTrackingTimestamp>this.discardVPVDIntervalThreshold)return;var qa={1:0,2:0,3:0},ra=(pa-this.latestTimeTrackingTimestamp>=this.focused_state_duration);this.totalVisibleHeight=0;for(var sa in this.activeStories)if(this.activeStories.hasOwnProperty(sa))if(!(this.latestUserFocus===ka&&ra&&this.shouldDiscardStory(sa))){qa[this.activeStories[sa].state]+=this.activeStories[sa].height;this.totalVisibleHeight+=this.activeStories[sa].height;}var ta=0,ua=pa-this.latestTimeTrackingTimestamp;if(this.latestUserFocus===ka){ua=qa[ga]>0?this.focused_state_duration:this.active_state_duration;ua=Math.min(ua,pa-this.latestTimeTrackingTimestamp);ta=(pa-this.latestTimeTrackingTimestamp)-ua;}var va=0,wa=ga;for(var xa=ga;xa>=ia;xa--)if(qa[xa]>0){va=qa[xa];wa=xa;break;}var ya=qa[ga]+qa[ha]+qa[ia],za=0;for(sa in this.activeStories)if(this.activeStories.hasOwnProperty(sa)){if(this.latestUserFocus===ka&&ra&&this.shouldDiscardStory(sa))continue;if(va>0&&this.activeStories[sa].state>=wa){za=ua*(this.activeStories[sa].height/va);if(this.vpvdAnalysis&&ua>0)this.logVpvdAnalysis(sa,za,true,ua,ua+ta,va);this.activeStories[sa].vpvd+=za;this.totalVPVDuration[sa]+=za;}if(ya>0){za=ta*(this.activeStories[sa].height/ya);if(this.vpvdAnalysis&&ta>0)this.logVpvdAnalysis(sa,za,false,ta,ua+ta,ya);this.activeStories[sa].vpvd+=za;this.totalVPVDuration[sa]+=za;}}};oa.prototype.updateActiveStory=function(pa,qa,ra,sa){"use strict";this.activeStories[pa].state=qa;this.activeStories[pa].ts=ra;this.activeStories[pa].height_snapshot=sa[pa].height;this.activeStories[pa].is_focused=this.focusedStory===sa[pa].story;this.activeStories[pa].story_height=sa[pa].story_height;if(this.vpvdAnalysis){this.activeStories[pa].visible_position=sa[pa].visible_position;this.activeStories[pa].y=sa[pa].y;}};oa.prototype.updateActiveStories=function(pa,qa){"use strict";for(var ra in pa)if(pa.hasOwnProperty(ra))if(ra in this.activeStories){this.activeStories[ra].height=pa[ra].height;var sa=pa[ra].height-this.activeStories[ra].height_snapshot;if(this.focusedStory===pa[ra].story){this.updateActiveStory(ra,ga,qa,pa);}else if(sa<=-this.height_diff_to_change_state){this.updateActiveStory(ra,this.shouldDiscardStory(ra)?ja:ia,qa,pa);}else if(sa>=this.height_diff_to_change_state||this.activeStories[ra].is_focused||this.activeStories[ra].height===this.activeStories[ra].story_height)this.updateActiveStory(ra,ha,qa,pa);}else{this.activeStories[ra]={evp_ts:qa,story:pa[ra].story,height:pa[ra].height,vpvd:0};if(!this.totalVPVDuration[ra])this.totalVPVDuration[ra]=0;this.updateActiveStory(ra,ha,qa,pa);}};oa.prototype.recordVPVDurations=function(pa,qa){"use strict";for(var ra in this.activeStories)if(this.activeStories.hasOwnProperty(ra))if(qa||!(ra in pa)){if(this.activeStories[ra].vpvd>this.focused_state_duration||this.activeStories[ra].vpvd===this.totalVPVDuration[ra])this.recordTimeStoryWasInView(this.activeStories[ra]);delete this.activeStories[ra];}};oa.prototype.updateTimeTrackingData=function(pa,qa){"use strict";this.userActivity=qa;if(!this.activeStories)this.activeStories={};var ra=Date.now();if(!this.latestTimeTrackingTimestamp)this.latestTimeTrackingTimestamp=ra;var sa=this.getVisibleStoriesFromCache();this.calculateTotalHeight();this.updateVPVDurations(ra);this.updateActiveStories(sa,ra);if(this.vpvdDebug)this.updateVPVDTimers();this.recordVPVDurations(sa,pa);if(pa){this.latestTimeTrackingTimestamp=0;}else this.latestTimeTrackingTimestamp=ra;this.latestUserActivity=this.userActivity;this.latestUserFocus=this.userFocus;if(this.focusedStory)this.latestActiveStory=this.focusedStory;this.latestFocusedStory=this.focusedStory;this.focusedStory=null;};oa.prototype.needsToUpdateTimeTrackingData=function(){"use strict";return !(this.latestUserFocus===this.userFocus&&(this.userFocus===la||(this.userFocus===ka&&!this.latestFocusedStory&&!this.focusedStory)));};oa.prototype.getfocusedStory=function(pa){"use strict";var qa=this.getVisibleStoriesFromCache();for(var ra in qa)if(qa.hasOwnProperty(ra))if(w.isDescendantOf(pa,qa[ra].story))return qa[ra].story;return null;};oa.prototype.handleLayers=function(){"use strict";if(this.userFocus===ma||this.userFocus===na){this.focusedStory=this.latestActiveStory;this.updateTimeTrackingData(false,'media_layer');return true;}return false;};oa.prototype.didInteractWithStream=function(pa){"use strict";return w.isDescendantOf(pa,this.getStream())||w.isDescendantOf(this.getStream(),pa);};oa.prototype.handleScroll=function(event){"use strict";if(this.handleLayers())return;var pa=Date.now(),qa=aa(this.getStream()).y;if(qa!=this.lastStreamY||pa-this.latestStreamYChangedTimeStamp<2.5*this.scrollThrottlingInterval||this.didInteractWithStream(event.target)){this.latestStreamYChangedTimeStamp=pa;this.userFocus=ka;}else this.userFocus=la;this.lastStreamY=qa;if(this.userFocus===ka||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,'scroll');};oa.prototype.handleKeyboard=function(event){"use strict";if(this.handleLayers())return;if(this.didInteractWithStream(event.target)){this.userFocus=ka;this.focusedStory=this.getfocusedStory(event.target);}else if(k.hasClass(event.target,'shareInput')){this.userFocus=ka;this.focusedStory=this.latestActiveStory;}else this.userFocus=la;if(this.userFocus===ka||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,'keyboard');};oa.prototype.handleMouse=function(event){"use strict";if(this.handleLayers())return;if(event.type!='click'&&event.clientX===this.lastMouseX&&event.clientY===this.lastMouseY)return;if(event.type==='click')this.invalidateVisibleStoriesCache();if(this.didInteractWithStream(event.target)){this.userFocus=ka;this.focusedStory=this.getfocusedStory(event.target);}else this.userFocus=la;this.lastMouseX=event.clientX;this.lastMouseY=event.clientY;if(this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,event.type);};oa.prototype.getStoriesInView=function(){"use strict";var pa=this.getAllStories(),qa=[],ra=false;for(var sa=0;sa<pa.length;sa++){var ta=pa[sa],ua=this.getStoryID(ta);if(this.hasBeenVisible(ua))continue;if(this.isVisible(ta)){if(ta.getAttribute('data-insertion-position')===null)ta.setAttribute('data-insertion-position',sa-this._headLoadStoryCount);qa.push(ta);ra=true;}else if(ra)break;}return qa;};oa.prototype.getStoriesInViewIgnoreHeight=function(){"use strict";var pa=this.getAllStories(),qa=false,ra=[];for(var sa=0;sa<pa.length;sa++){var ta=pa[sa];if(this.isVisible(ta,false,0)){ra.push(ta);qa=true;}else if(qa)break;}return ra;};oa.prototype.getAllStoriesFromCache=function(){"use strict";if(this.cachedAllStories===null)this.cachedAllStories=this.getAllStories();return this.cachedAllStories;};oa.prototype.invalidateAllStoriesCache=function(){"use strict";this.cachedAllStories=null;this.invalidateVisibleStoriesCache();};oa.prototype.getVisibleStoriesFromCache=function(){"use strict";if(this.cachedVisibleStories===null)this.cachedVisibleStories=this.getAllStoriesInView();return this.cachedVisibleStories;};oa.prototype.invalidateVisibleStoriesCache=function(){"use strict";this.cachedVisibleStories=null;};oa.prototype.getAllStoriesInView=function(){"use strict";var pa=this.getAllStoriesFromCache(),qa={},ra=false,sa=0,ta=pa.length,ua=1,va=pa.length;if(this._indexOfLastVisibleStoryOnPreviousPass>ta/2){sa=ta-1;ta=-1;ua=-ua;}for(var wa=sa;wa!=ta;wa+=ua){var xa=pa[wa],ya=this.getHeightIfVisible(xa,false,Math.min(this.minSizeToBeVisible,this.minFractionToBeVisibleForTimetracking*o.getElementDimensions(xa).height));if(ya>0||xa===this.focusedStory){if(xa.getAttribute('data-insertion-position')===null)xa.setAttribute('data-insertion-position',wa-this._headLoadStoryCount);var za=this.getStoryID(xa);qa[za]={story:xa,height:ya,story_height:o.getElementDimensions(xa).height};ra=true;if(this.vpvdAnalysis){qa[za].y=aa(xa).y;qa[za].visible_position=wa;va=Math.min(va,wa);}}else if(ra){this._indexOfLastVisibleStoryOnPreviousPass=wa-ua;break;}}if(this.vpvdAnalysis){this.numVisibleStories=0;for(za in qa)if(qa.hasOwnProperty(za)){qa[za].visible_position-=va;this.numVisibleStories++;}}return qa;};oa.prototype.getTimetrackingDataToLog=function(pa){"use strict";var qa={evt:ca,vpvd_start_timestamp:pa.evp_ts,vpvd_time_delta:Math.round(pa.vpvd),story_height:o.getElementDimensions(pa.story).height,viewport_height:this.cachedViewportHeight};return {ft:qa};};oa.prototype.recordTimeStoryWasInView=function(pa){"use strict";if(this.isTimetrackingEnabled&&pa.vpvd>0){var qa=this.getTimetrackingDataToLog(pa),ra=y(pa.story,['ft']);Object.assign(qa.ft,ra.ft);var sa=!!ra.ft.ei&&(qa.ft.vpvd_time_delta>this.minTimeToReportImmediately);delete qa.ei;this.sendDataToLog(pa.story,qa,sa);}};oa.prototype.hasBeenVisible=function(pa){"use strict";return pa in this.readStoryIDs;};oa.prototype.isVisible=function(pa,qa,ra){"use strict";return this.getHeightIfVisible(pa,qa,ra)>0;};oa.prototype.getHeightIfVisible=function(pa,qa,ra){"use strict";if(qa===(void 0))qa=this.isLoose;if(ra===(void 0))ra=this.minSizeToBeVisible;var sa=v.getScrollPosition().y,ta=o.getViewportDimensions().height,ua=aa(pa),va=o.getElementDimensions(pa),wa=ta+this.maxScrollPosition-sa;if(!ua.x&&!ua.y&&!va.x&&!va.y)return false;if(qa&&ua.y<wa)return true;var xa=Math.max(ua.y,0),ya=Math.min(ua.y+va.height,ta),za=Math.min(va.height,ra);return (ya-xa)>=za?(ya-xa):0;};oa.prototype.getHeightInViewport=function(pa){"use strict";var qa=o.getViewportDimensions().height,ra=aa(pa),sa=o.getElementDimensions(pa);if(!ra.x&&!ra.y&&!sa.x&&!sa.y)return false;var ta=Math.max(ra.y,0),ua=Math.min(ra.y+sa.height,qa);return ua-ta;};oa.prototype.sendDataToLog=function(pa,qa,ra){"use strict";if(this.useBanzai){var sa={};if(ra)sa.delay=3000;var ta=this.getSessionID();if(ta)qa.ft.session_id=ta;if(this.useWaterfallLogging&&qa.ft.evt==da){qa.ft.should_waterfall_logging=1;qa.ft["interface"]='www';var ua=!this.initialStoriesLogged;this.waterfallLogStep(pa,'200_sent_to_banzai',ua);}i.post('feed_tracking',qa,sa);}else x(ea,pa,null,'FORCE',qa);};oa.prototype.waterfallLogStep=function(pa,qa,ra){"use strict";var sa=this.getStoryID(pa);if(this.loggedStoryIDs[qa]&&this.loggedStoryIDs[qa][sa])return;var ta=this.getWaterfallData(pa,qa,ra);new h(fa,ta).send();if(!this.loggedStoryIDs[qa])this.loggedStoryIDs[qa]={};this.loggedStoryIDs[qa][sa]=true;};oa.prototype.getWaterfallData=function(pa,qa,ra){"use strict";var sa=this._getDataToLogImpl(pa),ta=y(pa,['ft']);Object.assign(sa.ft,ta.ft);var ua=sa.ft;ua.height_in_viewport=this.getHeightInViewport(pa);ua.step=qa;ua.is_initial_story=ra?1:0;ua["interface"]='www';return ua;};oa.prototype.addSeenClassToStory=function(pa){"use strict";k.addClass(pa,"_50nb");k.removeClass(pa,"_50mx");k.removeClass(pa,"_2z-5");};oa.prototype.markStoryRead=function(pa){"use strict";var qa=this.getStoryID(pa);if(!qa||this.hasBeenVisible(qa))return;this.readStoryIDs[qa]=true;this.annotatedStoryIDs[qa]=true;var ra=this._getDataToLogImpl(pa),sa=y(pa,['ft']);Object.assign(ra.ft,sa.ft);delete ra.ei;this.sendDataToLog(pa,ra,false);k.addClass(pa,"_x72");if(this.vpvDebug)k.addClass(pa,"_5m7s");this.addSeenClassToStory(pa);};oa.prototype.logAnnotatedVPV=function(pa){"use strict";var qa=this.getStoryID(pa);if(!qa||qa in this.annotatedStoryIDs)return;this.annotatedStoryIDs[qa]=true;var ra=this._getDataToLogImpl(pa),sa=y(pa,['ft']);Object.assign(ra.ft,sa.ft);delete ra.ei;ra.ft.vpv_ft_only=1;this.sendDataToLog(pa,ra,false);};oa.prototype._getDataToLogImpl=function(pa){"use strict";var qa=this.getDataToLog(pa);if(!qa.ft)qa.ft={};return qa;};e.exports=oa;},null);
__d("PrivacySelectorOptionNew",["CSS","DOM","DOMQuery","JSXDOM","MenuSelectableItem","PrivacyConst","csx","cx","fbt","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();if(!l.ExpansionType)l.ExpansionType={NONE:0,TAGS_ONLY:1,EVENT_INVITEES_ONLY:2,EVENT_GROUP_ONLY:3,TAGS_AND_EVENT_INVITEES:4,TAGS_AND_EVENT_GROUP:5};var q=l.EventExpansion||{NONE:0,EVENT_INVITEES:1,EVENT_GROUP:2};for(var r in k)if(k.hasOwnProperty(r))t[r]=k[r];var s=k===null?null:k.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=k;function t(u){"use strict";k.call(this,u);var v=u.eventExpansionType||q.NONE;this.updateAfterTagExpansion(!!u.hasTags,v);}t.prototype._getData=function(){"use strict";return this._data;};t.prototype.getTooltip=function(){"use strict";return this._getData().tooltip;};t.prototype.getPostParam=function(){"use strict";return this._getData().postParam;};t.prototype.getTriggerIcon=function(){"use strict";return this._getData().triggerIcon;};t.prototype.getTriggerLabel=function(){"use strict";return this._getData().triggerLabel;};t.prototype.isPublic=function(){"use strict";return this.getPostParam()===l.PostParam.EVERYONE;};t.prototype.isFriends=function(){"use strict";return this.getPostParam()===l.PostParam.FRIENDS;};t.prototype.isOnlyMe=function(){"use strict";return this.getPostParam()===l.PostParam.ONLY_ME;};t.prototype.isBasicOption=function(){"use strict";return true;};t.prototype.isCustomOption=function(){"use strict";return false;};t.prototype.getTagExpansionBehavior=function(){"use strict";return this._getData().tagExpansionBehavior;};t.prototype.getBaseValue=function(){"use strict";return this._getData().baseValue;};t.prototype.getIndex=function(){"use strict";return this._getData().value;};t.prototype.getLoggingEventName=function(){"use strict";switch(this.getPostParam()){case l.PostParam.FRIENDS:return 'click_friends';case l.PostParam.EVERYONE:return 'click_everyone';case l.PostParam.ONLY_ME:return 'click_only_me';case l.PostParam.FRIENDS_MINUS_ACQUAINTANCES:return 'click_friends_except_acquaintances';case l.PostParam.FB_ONLY:return 'click_fb_only';default:return 'click_other';}};t.prototype.updateAfterTagExpansion=function(u,v){"use strict";var w=v!=q.NONE,x=this._getData().triggerLabel;if((u||w)&&this._getData().showPlusOnTagExpansion)x=o._("{privacyLabel} (+)",[o.param("privacyLabel",this._getData().triggerLabel)]);this._setLabel(x);var y=this._getExpansionType(u,v);if(this._getData().optionSubtitles){this._setSubtitle(this._getData().optionSubtitles[y]);}else if(u){this._setSubtitle(this._getData().optionSubtitleWithTags);}else this._setSubtitle(this._getData().optionSubtitle);};t.prototype.isBelowFold=function(){"use strict";var u=g.hasClass(this.getRoot(),"_3ey_");return u;};t.prototype._setLabel=function(u){"use strict";if(!u)return;var v=i.find(this.getRoot(),"._54nh");v&&h.setContent(v,u);this._getData().label=u;};t.prototype._setSubtitle=function(u){"use strict";if(!u)return;var v=i.find(this.getRoot(),"._48u1");v&&h.setContent(v,u);};t.prototype._getExpansionType=function(u,v){"use strict";switch(v){case q.NONE:return u?l.ExpansionType.TAGS_ONLY:l.ExpansionType.NONE;case q.EVENT_INVITEES:return u?l.ExpansionType.TAGS_AND_EVENT_INVITEES:l.ExpansionType.EVENT_INVITEES_ONLY;case q.EVENT_GROUP:return u?l.ExpansionType.TAGS_AND_EVENT_GROUP:l.ExpansionType.EVENT_GROUP_ONLY;default:p(false);}};t.prototype.render=function(){"use strict";var u=s.render.call(this);if(!this._getData().isPrimaryOption)return u;var v=i.find(u,"._54nc");v&&g.addClass(v,"_48t_");var w=h.find(u,"._54nh");w&&g.addClass(w,"_48u0");var x=j.div({className:"_48u1"},this._getData().optionSubtitle);h.appendContent(v,x);return u;};e.exports=t;},null);
__d("XPrivacySelectorLoggingController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/privacy\/selector\/log\/",{event:{type:"Enum",required:true,enumType:1},render_location:{type:"Int",required:true},content_type:{type:"String",required:true}});},null);
__d("PrivacySelectorCustomOption",["AsyncDialog","AsyncRequest","DataStore","PrivacySelectorOptionNew","XPrivacySelectorLoggingController","XPrivacyCustomDialogController"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();for(var m in j)if(j.hasOwnProperty(m))o[m]=j[m];var n=j===null?null:j.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=j;function o(p){"use strict";j.call(this,p);}o.prototype.isBasicOption=function(){"use strict";return false;};o.prototype.isCustomOption=function(){"use strict";return true;};o.prototype.getSelector=function(){"use strict";return this._selector;};o.prototype.setPostParam=function(p){"use strict";this._data.postParam=p;};o.prototype.getLoggingEventName=function(){"use strict";return 'click_custom';};o.prototype.openDialog=function(p){"use strict";if(typeof this._selector==='undefined')this._selector=p;i.set(this._data.id,'PrivacySelectorCustomOption',this);var q=l.getURIBuilder().setString('option_id',this._data.id).setString('id',this._data.privacyfbid.toString()).setString('post_param',p.getPostParam()).setString('content_type',p.getContentType()).setInt('render_location',p.getRenderLocation()).setIntVector('tags',p.getTags()).setBool('autosave',this._data.autosave).setBool('limit_community',this._data.limitcommunity).setBool('limit_facebook',this._data.limitfacebook).setBool('limit_fof',this._data.limitfof).setBool('limit_tagexpand',this._data.limittagexpand).setBool('is_new_privacy_selector',true).setString('tag_expansion_button',p.getTagExpansionButton()).getURI(),r=new h(q);r.setRelativeTo(p.getTriggerButtonElement());g.send(r,function(s){var t=function(u){var v=k.getURIBuilder().setEnum('event',u).setInt('render_location',document.getElementsByName('render_location')[0].value).setString('content_type',document.getElementsByName('content_type')[0].value).getURI();new h().setURI(v).send();};s.subscribe('hide',function(){p.inform('custom/hide');p.inform('selectorFinished');});s.subscribe('success',function(){p.inform('custom/success');t('custom_save');});s.subscribe('cancel',function(){p.inform('custom/cancel');t('custom_cancel');});});};o.customPrivacySave=function(p,q){"use strict";var r=i.get(p,'PrivacySelectorCustomOption');r.getSelector().selectOption(q);i.remove(p,'PrivacySelectorCustomOption');};e.exports=o;},null);
__d("PrivacySelectableMenu",["AsyncRequest","CSS","Ease","PrivacySelectorCustomOption","PrivacySelectorOptionNew","SelectableMenu","SelectableMenuUtils","XPrivacySelectorLoggingController","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();for(var p in l)if(l.hasOwnProperty(p))r[p]=l[p];var q=l===null?null:l.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=l;function r(s,t){"use strict";l.call(this,s,t);}r.prototype.getItemForIndex=function(s){"use strict";for(var t=0;t<this._items.length;t++){var u=this._items[t];if(u instanceof k&&u.getIndex()==s)return u;}return null;};r.prototype.selectDefaultOption=function(){"use strict";this._items.some(function(s){if(s instanceof k&&this._isDefaultOption(s)){this.setValue(s.getIndex());return true;}return false;},this);};r.prototype.selectOption=function(s){"use strict";var t=null,u=this._items.some(function(v){if(v instanceof k&&!v.isCustomOption()&&v.getPostParam()==s){this.setValue(v.getIndex());return true;}if(v instanceof j){t=v;return false;}if(this._isMoreOption(v)){this.expandMenu();return false;}},this);if(!u&&t){t.setPostParam(s);this.setValue(t.getIndex());}};r.prototype._isDefaultOption=function(s){"use strict";return h.hasClass(s.getRoot(),"_plx");};r.prototype._isMoreOption=function(s){"use strict";return h.hasClass(s.getRoot(),"_po2");};r.prototype._handleItemClick=function(s,t){"use strict";if(!m.doesItemSupportSelect(s))return q._handleItemClick.call(this,s,t);if(this._isMoreOption(s)){this._logMoreClick();this.expandMenu();return;}this._logOptionClick(s);var u=this.inform('itemclick',{item:s,event:t});if(u)return;if(!m.isSelected(s)&&!s.isCustomOption()&&s.select()!==false){this._items.forEach(function(v){if(m.isSelected(v)&&v!==s)v.deselect();});this.inform('change',this.getSelection());}this.done();return s.handleClick();};r.prototype._logMoreClick=function(){"use strict";var s=n.getURIBuilder().setEnum('event','more_options').setInt('render_location',this._config.renderlocation).setString('content_type',this._config.contenttype).getURI();new g().setURI(s).send();};r.prototype._logOptionClick=function(s){"use strict";var t=n.getURIBuilder().setEnum('event',s.getLoggingEventName()).setInt('render_location',this._config.renderlocation).setString('content_type',this._config.contenttype).getURI();new g().setURI(t).send();};r.prototype.expandMenu=function(){"use strict";h.removeClass(this.getRoot(),"_po3");h.addClass(this.getRoot(),"_po4");this.inform('expandMenu');};r.prototype.collapseMenu=function(){"use strict";h.removeClass(this.getRoot(),"_po4");h.addClass(this.getRoot(),"_po3");};r.prototype.updateOptionsAfterTagExpansion=function(s,t){"use strict";this.forEachItem(function(u){if(u instanceof k)u.updateAfterTagExpansion(s,t);});};r.prototype.onPopoverOpen=function(s){"use strict";if(this._config.learnMore)this._config.learnMore.collapse();if(s&&s.isBelowFold()){this.expandMenu();}else this.collapseMenu();if(s&&this._items.indexOf(s)>=15)setTimeout(function(){this._scrollableArea.scrollToBottom(true,{duration:1000,ease:i.sineOut});}.bind(this),250);};e.exports=r;},null);
__d("PopoverButton",["DOM","DOMQuery","csx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={setLabel:function(k,l){var m=h.find(k,"._55pe"),n=m.childNodes;for(var o=0;o<n.length;o++)if(h.isTextNode(n[o])){g.replace(n[o],l);return;}g.appendContent(m,l);}};e.exports=j;},null);
__d("PrivacySelectorDataStore",["ArbiterMixin","PrivacySelectorNewDispatcher","KeyedCallbackManager"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=new i(),k=Object.assign({},g,{get:function(l,m){j.executeOrEnqueue(l,m);},hasValueChanged:function(l){return !!j.getResource(l);}});h.register(function(l){if(l.selector_type){var m={};m[l.selector_type]={post_param:l.post_param,unique_id:l.unique_id,reload:l.reload};j.addResourcesAndExecute(m);k.inform('change');}});e.exports=k;},null);
__d("XPrivacySelectorEventNUXController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/privacy\/selector\/nux\/event_checkin\/",{context_node_id:{type:"String",required:true},event_expansion_type:{type:"Enum",enumType:0},event_id:{type:"String"}});},null);
__d("XPrivacySelectorTransitionDefaultController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/privacy\/selector\/transition_default\/",{post_param:{type:"String"},render_location:{type:"Enum",enumType:0}});},null);
__d("XPrivacySelectorUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/privacy\/selector\/update\/",{privacy_fbid:{type:"String",required:true},post_param:{type:"String",required:true},event_expansion_type:{type:"Enum",enumType:0},tags:{type:"IntVector"},render_location:{type:"Int",required:true},is_saved_on_select:{type:"Bool",defaultValue:false},should_return_tooltip:{type:"Bool",defaultValue:false},replace_on_select:{type:"Bool",defaultValue:false},prefix_tooltip_with_app_privacy:{type:"Bool",defaultValue:false},ent_id:{type:"String",required:true},tag_expansion_button:{type:"String"},reload_selector:{type:"Bool",defaultValue:false}});},null);
__d("PrivacySelectorBase",["ArbiterMixin","AsyncRequest","Button","CSS","CurrentUser","Input","MenuStaticItem","MenuSelectableItem","PopoverButton","PopoverLoadingMenu","PrivacyConst","DataStore","PrivacySelectorNewDispatcher","PrivacySelectorDataStore","PrivacySelectableMenu","Run","SubscriptionsHandler","TagExpansionButtonConfig","TooltipData","XPrivacySelectorEventNUXController","XPrivacySelectorLoggingController","XPrivacySelectorTransitionDefaultController","XPrivacySelectorUpdateController","bind","cx","fbt","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){b.__markCompiled&&b.__markCompiled();var ha=3,ia=q.EventExpansion||{NONE:0,EVENT_INVITEES:1,EVENT_GROUP:2},ja=ga(g);for(var ka in ja)if(ja.hasOwnProperty(ka))ma[ka]=ja[ka];var la=ja===null?null:ja.prototype;ma.prototype=Object.create(la);ma.prototype.constructor=ma;ma.__superConstructor__=ja;function ma(na,oa,pa,qa,ra,sa){"use strict";ja.call(this);r.set(na,'selector',this);this._root=na;this._button=oa;this._config=sa;this._menu=pa;this._popoverMenu=ra;this._input=qa;this._isSavedOnSelect=sa.is_saved_on_select;this._privacyFBID=sa.privacy_fbid;this._contentType=sa.content_type;this._renderLocation=sa.render_location;this._supportsTagExpansion=sa.supports_tag_expansion;this._prefixTooltipApps=sa.should_prefix_tooltip_apps;this._shouldDisplayLabel=sa.should_display_label;this._tags=sa.tagged_uids;this._hasTags=this._tags.length>0;this._eventExpansionType=sa.event_expansion_type||ia.NONE;this._entID=sa.ent_id;this._popover=this._popoverMenu.getPopover();this._receivingUpdate=false;this._initTagExpansionButtonState();this._selectorSyncKey=sa.selector_sync_key;this._previousParam=null;this._confirmOnSave=false;this._confirmOnSaveDialogs={};this._listeners=new w();if(sa.use_async_menu){this._listeners.addSubscriptions(this._popoverMenu.subscribe('setMenu',function(){this._menu=this._popoverMenu.getMenu();if(!(this._menu instanceof u))return;this._onMenuLoad();this._onPopoverOpen();this.inform('asyncMenuLoaded');}.bind(this)));}else this._onMenuLoad();if(this._selectorSyncKey)this._initSelectorSync();v.onLeave(this._cleanup.bind(this));}ma.prototype._cleanup=function(){"use strict";this._listeners&&this._listeners.release();this._listeners=null;};ma.prototype._initSelectorSync=function(){"use strict";this._listeners.addSubscriptions(t.subscribe('change',function(){t.get(this._selectorSyncKey,function(na){if(na.unique_id!==this._menu._config.id){this._receivingUpdate=true;if(na.post_param)this.selectOption(na.post_param);na.reload&&this.reloadSelector();}}.bind(this));}.bind(this)));if(!this._syncsToDefault())this._listeners.addSubscriptions(this._menu.subscribe('change',function(){this._broadcastUpdate();}.bind(this)));};ma.prototype._broadcastUpdate=function(){"use strict";if(!this._receivingUpdate){var na=this._getSelectedOption();s.handleUpdateFromSelector({selector_type:this._selectorSyncKey,post_param:na.getPostParam().toString(),unique_id:this._menu._config.id});}else this._receivingUpdate=false;};ma.prototype.shouldReplaceOnPost=function(){"use strict";return this._config.replace_on_post||this.isComposerWithDefault();};ma.prototype.isComposerWithDefault=function(){"use strict";return this._syncsToDefault()&&!this._config.replace_on_select;};ma.prototype._isSelectorForChangingComposerDefault=function(){"use strict";return this._syncsToDefault&&this._config.replace_on_select;};ma.prototype._syncsToDefault=function(){"use strict";return this._config.selector_sync_key==q.PrivacyField.DEFAULT_COMPOSER.toString();};ma.prototype.getIsPublicSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isPublic();};ma.prototype.getIsFriendsSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isFriends();};ma.prototype.getIsOnlyMeSelected=function(){"use strict";return this._selectedOption&&this._selectedOption.isOnlyMe();};ma.prototype.getSelectedBaseValue=function(){"use strict";return this._selectedOption&&this._selectedOption.getBaseValue();};ma.prototype.getSelectedPostParam=function(){"use strict";return this._selectedOption&&this._selectedOption.getPostParam().toString();};ma.prototype.setValue=function(na){"use strict";this._menu.setValue(na);};ma.prototype.openSelectorExpanded=function(na){"use strict";this.openSelector(function(){this._menu.expandMenu();na&&na();}.bind(this));};ma.prototype.openSelector=function(na){"use strict";if(this._menu instanceof p){this.subscribeOnce('asyncMenuLoaded',function(){na&&na();}.bind(this));this._popover.showLayer();}else{this._popover.showLayer();na&&na();}};ma.prototype.closeSelector=function(){"use strict";this._popover.hideLayer();};ma.prototype.getPopover=function(){"use strict";return this._popover;};ma.prototype.getTriggerButtonElement=function(){"use strict";return this._button;};ma.prototype.getRoot=function(){"use strict";return this._root;};ma.prototype.getMenuElement=function(){"use strict";return this._menu.getRoot();};ma.prototype.selectDefaultOption=function(){"use strict";this._menu.selectDefaultOption();this._updateMenu();};ma.prototype.selectOption=function(na){"use strict";if(!na)return;if(this._menu instanceof p){this.subscribeOnce('asyncMenuLoaded',this._selectOptionImpl.bind(this,na));this._fetchAsyncMenu();}else this._selectOptionImpl(na);};ma.prototype._selectOptionImpl=function(na){"use strict";this._menu.selectOption(na);this._updateMenu();};ma.prototype._updateMenu=function(){"use strict";this._selectedOption=this._getSelectedOption();this.updateDataForItemIndex(this._selectedOption.getIndex(),this._selectedOption.getPostParam().toString());};ma.prototype.setTagExpansionButton=function(na){"use strict";this._tagExpansionButton=na;if(this._hasAudienceExpansion()){this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion(),this._getEventExpansionType());this._updateTriggerButtonLabel();this._updateTooltipAfterChange();}};ma.prototype.getTagExpansionButton=function(){"use strict";return this._tagExpansionButton;};ma.prototype._initTagExpansionButtonState=function(){"use strict";this._tagExpansionButton=x.FRIENDS_OF_TAGGED;var na=this._getSelectedOption();if(!na)return;var oa=JSON.parse(na.getPostParam());if(oa.settings&&oa.settings.no_tag_expansion===true){this._tagExpansionButton=x.TAGGED_ONLY;}else this._tagExpansionButton=x.FRIENDS_OF_TAGGED;};ma.prototype._fetchAsyncMenu=function(){"use strict";if(this._config.use_async_menu)this._popoverMenu.fetchMenu();};ma.prototype._getSelectedOption=function(){"use strict";if(!(this._menu instanceof u))return;var na;this._menu.forEachItem(function(oa){if(oa instanceof n&&oa.isSelected())na=oa;}.bind(this));return na;};ma.prototype._onItemClick=function(na,oa){"use strict";var pa=oa.item;if(pa instanceof m)return;if(pa.isBasicOption()){this.updateDataForItemIndex(pa.getIndex(),pa.getPostParam().toString());}else if(pa.isCustomOption()){this._closeForCustom=true;pa.openDialog(this);}this.inform('click',{customSelected:pa.isCustomOption()});};ma.prototype.getContentType=function(){"use strict";return this._contentType;};ma.prototype.getRenderLocation=function(){"use strict";return this._renderLocation;};ma.prototype.getPostParam=function(){"use strict";return this._postParam;};ma.prototype.getTags=function(){"use strict";return this._tags;};ma.prototype.registerConfirmOnSaveDialog=function(na,oa,pa){"use strict";this._confirmOnSave=true;if(!(na in this._confirmOnSaveDialogs))this._confirmOnSaveDialogs[na]={};pa.subscribe('hide',function(){if(this._previousParam!==this._postParam)this.selectOption(this._previousParam);}.bind(this));pa.subscribe('button',function(){this._savePrivacy();pa.hide();}.bind(this));this._confirmOnSaveDialogs[na][oa]=pa;};ma.prototype.updateDataForItemIndex=function(na,oa,pa){"use strict";if(pa){this._tagExpansionButton=pa;this.inform('CustomTagExpansion',this._tagExpansionButton);}var qa=this._menu.getItemForIndex(na);if(qa.isCustomOption())qa.setPostParam(oa);this._selectedOption=qa;this._previousParam=this._postParam;this._postParam=oa;l.setValue(this._input,oa);this._updateTriggerButtonLabel();if(this._shouldUpdateTooltips()){this._updateTooltipAfterChange();}else{if(this._isSavedOnSelect)if(this._confirmOnSave&&(this._previousParam in this._confirmOnSaveDialogs)&&(this._postParam in this._confirmOnSaveDialogs[this._previousParam])){this._confirmOnSaveDialogs[this._previousParam][this._postParam].show();}else this._savePrivacy();this._setTooltipValue(this._selectedOption.getTooltip());}this.inform('changed',{post_param:this._postParam,base_value:this.getSelectedBaseValue()});};ma.prototype._shouldUpdateTooltips=function(){"use strict";return this._prefixTooltipApps||this._supportsTagExpansion;};ma.prototype._savePrivacy=function(){"use strict";this._previousParam=this._postParam;this._sendUpdateRequest();};ma.prototype.reloadSelector=function(){"use strict";this._cleanup();var na=ca.getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setInt('render_location',this._renderLocation).setBool('reload_selector',true).setString('ent_id',String(this._entID)).getURI();new h().setRelativeTo(this._root).setHandler(this.inform.bind(this,'reloaded')).setURI(na).send();};ma.prototype.transitionToDefault=function(){"use strict";var na=ba.getURIBuilder().setString('post_param',this._postParam).setEnum('render_location',this._renderLocation).getURI();new h().setRelativeTo(this._root).setHandler(function(){this._config.selector_sync_key=q.PrivacyField.DEFAULT_COMPOSER.toString();this._initSelectorSync();this.inform.bind(this,'reloaded');}.bind(this)).setURI(na).send();};ma.prototype._sendUpdateRequest=function(){"use strict";var na=ca.getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setIntVector('tags',this._tags).setEnum('event_expansion_type',this._eventExpansionType).setInt('render_location',this._renderLocation).setBool('is_saved_on_select',this._isSavedOnSelect).setBool('should_return_tooltip',this._shouldUpdateTooltips()).setBool('prefix_tooltip_with_app_privacy',this._prefixTooltipApps).setBool('replace_on_select',this._config.replace_on_select).setString('ent_id',String(this._entID)).setString('tag_expansion_button',this._tagExpansionButton).getURI();new h().setRelativeTo(this._root).setHandler(da(this,function(oa){if(this._config.replace_on_select)this._cleanup();if(this._isSelectorForChangingComposerDefault())this._broadcastUpdate();var pa=oa&&oa.payload&&oa.payload.tooltip;pa&&this._setTooltipValue(oa.payload.tooltip);this.inform('selector_updated');})).setURI(na).send();};ma.prototype.informEventExpansionChanged=function(na){"use strict";if(this._eventExpansionType===na)return;this._eventExpansionType=na;this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion(),this._getEventExpansionType());this._updateTriggerButtonLabel();this._updateTooltipAfterChange();this._maybeShowEventExpansionNUX();};ma.prototype.informTagsChanged=function(na){"use strict";var oa=this._getTags(na);this.informTagsChangedWithIDs(oa);};ma.prototype.informTagsChangedWithIDs=function(na){"use strict";var oa=!na.length;if(this._hasTags===oa){this._hasTags=!!na.length;this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion(),this._getEventExpansionType());this._updateTriggerButtonLabel();}if(this._tags.length!==na.length){this._tags=na;this._updateTooltipAfterChange();}};ma.prototype._getEventExpansionType=function(){"use strict";return this._eventExpansionType;};ma.prototype._showTagExpansion=function(){"use strict";return this._hasTags&&(this._tagExpansionButton.valueOf()===x.FRIENDS_OF_TAGGED.valueOf());};ma.prototype._getTags=function(na){"use strict";var oa=[],pa=k.getID();if(na.withTags)for(var qa=0;qa<na.withTags.length;qa++){var ra=na.withTags[qa].info;if(ra.uid!=pa)oa.push(ra.uid);}if(na.mention)for(var sa in na.mention)if(na.mention[sa].type=='user'&&na.mention[sa].uid!=pa)oa.push(na.mention[sa].uid);return oa;};ma.prototype._updateTriggerButtonLabel=function(){"use strict";var na=this._selectedOption.getTriggerIcon();if(this._config.trigger_no_icon)j.hide(na);i.setIcon(this._button,na.cloneNode());if(!this._shouldDisplayLabel)return;o.setLabel(this._button,this._selectedOption.getLabel());if(this._config.trigger_style===ha){j.conditionClass(this.getTriggerButtonElement(),"_mw-",this.getIsOnlyMeSelected());j.conditionClass(this.getTriggerButtonElement(),"_mw_",this.getIsPublicSelected());}};ma.prototype._updateTooltipAfterChange=function(){"use strict";var na=fa._("Loading...");this._setTooltipValue(na);this._sendUpdateRequest();};ma.prototype._setTooltipValue=function(na){"use strict";na&&y.set(this._button,na);};ma.prototype._onPopoverClose=function(){"use strict";if(!this._getSelectedOption())return;if(this._closeForCustom){this._closeForCustom=false;}else this.inform('selectorFinished');this.inform('close');};ma.prototype._onPopoverOpen=function(){"use strict";if(!(this._menu instanceof u))return;this._menu.onPopoverOpen(this._getSelectedOption());var na=aa.getURIBuilder().setEnum('event','opened').setInt('render_location',this._renderLocation).setString('content_type',this._contentType).getURI();new h().setURI(na).send();this.inform('open');};ma.prototype._onMenuLoad=function(){"use strict";this._listeners.addSubscriptions(this._menu.subscribe('itemclick',this._onItemClick.bind(this)),this._popover.subscribe('hide',this._onPopoverClose.bind(this)),this._popover.subscribe('show',this._onPopoverOpen.bind(this)));this._listeners.addSubscriptions(this._menu.subscribe('expandMenu',function(){if(this._popover&&this._popover.getLayer())this._popover.getLayer().updatePosition();}.bind(this)));this._selectedOption=this._getSelectedOption();if(this._selectedOption){this._postParam=this._selectedOption.getPostParam().toString();this._previousParam=this._postParam;this._hasAudienceExpansion()&&this._updateTriggerButtonLabel();}};ma.prototype._hasAudienceExpansion=function(){"use strict";return this._hasTags||this._getEventExpansionType()!=ia.NONE;};ma.prototype._maybeShowEventExpansionNUX=function(){"use strict";if(this._getEventExpansionType()==ia.NONE)return;var na=z.getURIBuilder().setString('context_node_id',this._button.id).setEnum('event_expansion_type',this._getEventExpansionType()).getURI();new h(na).send();};e.exports=ma;},null);
__d("FbFeedKeyboardController",["CSS","DOM","DOMQuery","FeedBaseKeyboardController","Focus","JSXDOM","Parent","FbFeedHighlight","csx","cx","ge","getActiveElement"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(x){if(x.previousElementSibling)return x.previousElementSibling;x=x.previousSibling;while(x&&!i.isElementNode(x))x=x.previousSibling;return x||null;}function t(x){if(x.nextElementSibling)return x.nextElementSibling;x=x.nextSibling;while(x&&!i.isElementNode(x))x=x.nextSibling;return x||null;}for(var u in j)if(j.hasOwnProperty(u))w[u]=j[u];var v=j===null?null:j.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=j;function w(){"use strict";if(j!==null)j.apply(this,arguments);}w.prototype.getStories=function(x){"use strict";return i.scry(x||this.root,"._5jmm");};w.prototype.isHoldoutStory=function(x){"use strict";return !!x&&g.hasClass(x,'holdoutAdStory');};w.prototype.isRelevantStory=function(x){"use strict";return i.isElementNode(x)&&!this.isHoldoutStory(x);};w.prototype.isStory=function(x){"use strict";return g.hasClass(x,"_5jmm");};w.prototype.clickLike=function(){"use strict";this.click('.UFILikeLink');var x=this.getParentStory(r());if(x){var y=i.scry(x,'.UFILikeLink');for(var z=0;z<y.length;z++)if(!g.hasClass(y[z],'accessible_elem'))k.setWithoutOutline(y[z]);}};w.prototype.clickComment=function(){"use strict";this.click('.comment_link');};w.prototype.clickShare=function(){"use strict";this.click('.share_action_link');};w.prototype.clickSeeMore=function(){"use strict";this.click('.see_more_link');};w.prototype.clickLeft=function(){"use strict";this.click("._1mri");};w.prototype.clickRight=function(){"use strict";this.click("._2fu-");};w.prototype.openAttachment=function(){"use strict";this.click("._5dec","a._52c6","._4-eo",'.uiVideoThumb');};w.prototype.getHeadline=function(x){"use strict";return i.scry(x,"h5._5pbw")[0];};w.prototype.getPreviousSibling=function(x){"use strict";var y=s(x);if(y&&this.getParentStory(y))return y;y=null;var z=m.byClass(x,"_5pcb");if(z){var aa=i.scry(this.root,"._5jmm"),ba=aa.indexOf(x);while(ba>-1){if(ba===0){y=q('pagelet_composer');y=y&&m.byClass(y,"_5jmm");}else if(ba>0){y=aa[ba-1];if(y.offsetHeight>0)break;}ba--;}}return y||this.selected;};w.prototype.getPreviousStory=function(x){"use strict";var y=this.getPreviousSibling(x);while(y&&!this.isStory(y))y=this.getPreviousSibling(y);return y;};w.prototype.getParentStory=function(x){"use strict";return m.byClass(x,"_5jmm");};w.prototype.getNextSibling=function(x){"use strict";var y=t(x);if(y&&this.getParentStory(y))return y;y=null;var z=m.byClass(x,"_5pcb");if(z){var aa=i.scry(this.root,"._5jmm"),ba=aa.indexOf(x);if(ba>-1){y=aa[++ba];while(y&&y.offsetHeight===0)y=aa[++ba];}}else if(q('pagelet_composer',x))y=i.scry(document,"div._5pcb ._5jmm")[0];return y||this.selected;};w.prototype.getNextStory=function(x){"use strict";var y=this.getNextSibling(x);while(y&&!this.isStory(y))y=this.getNextSibling(y);return y;};w.prototype.setSelected=function(x,y){"use strict";if(x){var z="_5qdu",aa=i.scry(x,"._5qdu");if(!aa.length&&y)h.prependContent(x,l.div({className:z}));}if(y){this.selected&&this.setTabindexOnStory(this.selected,'-1');this.selected&&g.removeClass(this.selected,"_5qdv");this.selected=x;x&&this.setTabindexOnStory(x,'0');x&&g.addClass(x,"_5qdv");n.highlightSingle(x);}};w.init=function(x){"use strict";new w(x);};e.exports=w;},null);