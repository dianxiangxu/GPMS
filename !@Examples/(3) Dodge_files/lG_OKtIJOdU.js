/*!CK:330814052!*//*1438145265,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["TWyE8"]); }

__d("UFIReactionsFacepile.react",["ActorURI","HovercardLink","Image.react","React","UFIClassNames","UFIConstants","UFIReactionTypes","XUFIReactionProfileBrowserController","XUFIReactionProfileDialogController","XUFIReactionTooltipController","cx","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=r('/images/ufi/reactions/mini/like.png'),u=12,v=32,w=false,x=j.Component;for(var y in x)if(x.hasOwnProperty(y))aa[y]=x[y];var z=x===null?null:x.prototype;aa.prototype=Object.create(z);aa.prototype.constructor=aa;aa.__superConstructor__=x;function aa(ba,ca){"use strict";x.call(this);this.state={};}aa.prototype.componentWillMount=function(){"use strict";if(!w){Object.keys(m.reactions).forEach(function(ba){(new Image()).src=m.reactions[ba].source_urls.mini;});w=true;}};aa.prototype.renderFacepile=function(){"use strict";var ba=this.props.feedback.reactorids;if(this.props.feedback.reactioncount>u)ba=ba.slice(0,u-1);return ba.map(function(ca){ca=this.props.authorProfiles[ca];var da=h.constructEndpointWithLocation(ca,'ufi'),ea=this.props.feedback.userreactions[ca.id],fa=ea===l.LikeReaction?t:m.reactions[ea].source_urls.mini;return (j.createElement("a",{"aria-label":ca.name,className:"_51km","data-hovercard":da,href:ca.uri,key:'reactor-'+ca.id,position:"above"},j.createElement(i,{className:"_1es0",height:32,src:ca.thumbSrc,width:32}),j.createElement("div",{className:"_1es1"},j.createElement(i,{src:fa}))));}.bind(this));};aa.prototype.renderMoreLink=function(){"use strict";if(this.props.feedback.reactioncount<=u)return null;var ba=this.props.feedback.reactorids,ca=this.props.authorProfiles[ba[u-1]],da=this.props.feedback.reactioncountreduced;if(!isNaN(da))da='+'+(this.props.feedback.reactioncount-u+1);var ea=p.getURIBuilder().setIntVector('seen_user_fbids',ba.slice(0,u-1)).setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI();ea=g.create(ea,this.props.feedback.actorforpost);var fa=o.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI();fa=g.create(fa,this.props.feedback.actorforpost);var ga=n.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI();ga=g.create(ga,this.props.feedback.actorforpost);return (j.createElement("a",{ajaxify:fa,className:"_51kn","data-hover":"tooltip","data-tooltip-uri":ea,href:ga,rel:"dialog"},j.createElement(i,{height:v,src:ca.thumbSrc,width:v}),j.createElement("span",null,da)));};aa.prototype.render=function(){"use strict";var ba=s(k.ROW,(("_51ko")+(this.props.feedback.reactioncount>=u?' '+"_1w2m":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":'')));return (j.createElement("li",{className:ba},this.renderFacepile(),this.renderMoreLink()));};e.exports=aa;},null);
__d("UFIReactionsLink.react",["BanzaiLogger","BootloadedComponent.react","InlineBlock.react","JSResource","React","ReactLayeredComponentMixin","UFIConstants","UFIReactionTypes","UFIUserActions","classWithMixins","cx","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s=false,t=1000,u=250,v=p(k.Component,r(l));for(var w in v)if(v.hasOwnProperty(w))y[w]=v[w];var x=v===null?null:v.prototype;y.prototype=Object.create(x);y.prototype.constructor=y;y.__superConstructor__=v;function y(z,aa){"use strict";v.call(this);this.hideDialog=this.hideDialog.bind(this);this.showDialog=this.showDialog.bind(this);this.dialogShownTime=0;this.state={dialogShown:false,reaction:0};}y.prototype.componentWillMount=function(){"use strict";x.componentWillMount.call(this);this.setState({reaction:this.props.reaction});};y.prototype.componentWillReceiveProps=function(z){"use strict";this.setState({reaction:z.reaction});};y.prototype.renderLayers=function(){"use strict";if(!this.state.dialogShown&&!s)return null;return {ufiReactionsPopover:k.createElement(h,{bootloadPlaceholder:k.createElement("div",null),bootloadLoader:j('UFIReactionsMenu.react'),context:k.findDOMNode(this.refs.root),onBlur:this.onBlur.bind(this),onClick:this.onReactionChange.bind(this),onComponentLoad:function(){s=true;},onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),selected:this.state.reaction,shown:this.state.dialogShown})};};y.prototype.hideDialog=function(){"use strict";this.$UFIReactionsLink0(this.state.reaction);clearTimeout(this.hoverTimeout);this.setState({dialogShown:false});};y.prototype.showDialog=function(){"use strict";if(this.dialogShownTime===0)this.dialogShownTime=Date.now();clearTimeout(this.hoverTimeout);this.setState({dialogShown:true});};y.prototype.onReactionChange=function(z){"use strict";this.$UFIReactionsLink0(z);o.changeReaction(this.props.id,z);this.hideDialog();};y.prototype.onBlur=function(event){"use strict";if(!k.findDOMNode(this.refs.root).contains(event.relatedTarget))this.hideDialog();};y.prototype.onMouseEnter=function(event){"use strict";clearTimeout(this.hoverTimeout);this.hoverTimeout=setTimeout(this.showDialog,t);};y.prototype.onMouseLeave=function(event){"use strict";clearTimeout(this.hoverTimeout);this.hoverTimeout=setTimeout(this.hideDialog,u);};y.prototype.onFocus=function(event){"use strict";if(!this.focusHandlerLock)this.showDialog();};y.prototype.setFocusHandlerLock=function(z){"use strict";this.focusHandlerLock=z;};y.prototype.renderTrigger=function(){"use strict";var z={onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onMouseDown:this.setFocusHandlerLock.bind(this,true),onMouseUp:this.setFocusHandlerLock.bind(this,false),onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),ref:'trigger'};if(!this.state.reaction||this.state.reaction===m.LikeReaction||!n.reactions[this.state.reaction]){var aa=k.Children.only(this.props.children);return k.cloneElement(aa,Object.assign(Object.assign({onClick:function(event){this.hideDialog();aa.props.onClick(event);}.bind(this)},z)));}return (k.createElement("a",k.__spread({className:(("UFILikeLink")+(this.state.reaction?' '+"UFILinkBright":'')+(this.state.reaction?' '+"_il0":'')),href:"#",onClick:this.onReactionChange.bind(this,0)},z),n.reactions[this.state.reaction].display_name));};y.prototype.render=function(){"use strict";return (k.createElement(i,{className:"uiContextualLayerParent",ref:"root"},this.renderTrigger()));};y.prototype.$UFIReactionsLink0=function(z){"use strict";if(this.dialogShownTime!==0){g.log('UserReactionsLoggerConfig',{feedback_id:this.props.id,final_reaction:z,initial_reaction:this.state.reaction,time_spent:Date.now()-this.dialogShownTime});this.dialogShownTime=0;}};e.exports=y;},null);
__d("UFIReactionsTokens.react",["InlineBlock.react","Image.react","React","UFIReactionTypes","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=false,m=i.Component;for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q,r){"use strict";m.call(this);this.state={};}p.prototype.componentWillMount=function(){"use strict";if(!l){Object.keys(j.reactions).forEach(function(q){(new Image()).src=j.reactions[q].source_urls.token.uri;});l=true;}};p.prototype.renderLikes=function(){"use strict";if(!this.props.feedback.reactioncountmap[1]["default"])return null;return (i.createElement(g,{className:"_3emk _3eml"},this.props.feedback.reactioncountmap[1].reduced));};p.prototype.renderComments=function(){"use strict";if(this.props.contextArgs.feedbackMode==='expanded'||!parseInt(this.props.feedback.commentcountreduced,10))return null;return (i.createElement(g,{className:"_3emk _3emm"},this.props.feedback.commentcountreduced));};p.prototype.renderShares=function(){"use strict";if(this.props.contextArgs.feedbackMode==='expanded'||!this.props.feedback.sharecount)return null;return (i.createElement(g,{className:"_3emk _3emn"},this.props.feedback.sharecountreduced));};p.prototype.renderTokens=function(){"use strict";var q=j.ordering.map(function(r){if(!j.reactions[r]||!this.props.feedback.reactioncountmap[r]["default"])return null;return (i.createElement(g,{className:"_3emk",key:'reactionType-'+r},i.createElement(h,{src:j.reactions[r].source_urls.token}),this.props.feedback.reactioncountmap[r].reduced));}.bind(this));return q;};p.prototype.render=function(){"use strict";return (i.createElement("div",null,i.createElement("a",{"data-comment-prelude-ref":this.props['data-comment-prelude-ref'],"data-ft":this.props['data-ft'],href:this.props.permalink,onClick:this.props.onToggle,rel:"ignore"},this.renderLikes(),this.renderComments(),this.renderShares(),this.renderTokens())));};e.exports=p;},null);