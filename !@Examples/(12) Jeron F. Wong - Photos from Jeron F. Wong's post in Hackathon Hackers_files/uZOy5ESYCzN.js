/*!CK:2534039469!*//*1438923259,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["JPHD4"]); }

__d("StickerConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120};},null);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("ChatDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("WebMessengerEvents",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=Object.assign(new g(),{MASTER_DOM_CHANGED:'master-dom-changed',DETAIL_DOM_CHANGED:'detail-dom-changed',FOCUS_COMPOSER:'focus-composer',FOCUS_SEARCH:'focus-search',FOCUS_AND_SELECT_SEARCH:'focus-and-select-search',STICKER_CLICKED:'sticker-clicked',SUBMIT_REPLY:'submit-reply',UPDATE_SELECTION:'update-selection',masterDOMChanged:function(){this.inform(h.MASTER_DOM_CHANGED);},detailDOMChanged:function(){this.inform(h.DETAIL_DOM_CHANGED);},focusComposer:function(){this.inform(h.FOCUS_COMPOSER);},focusSearch:function(){this.inform(h.FOCUS_SEARCH);},focusAndSelectSearch:function(){this.inform(h.FOCUS_AND_SELECT_SEARCH);},updateSelection:function(i){this.inform(h.UPDATE_SELECTION,i);},stickerClicked:function(i,j){this.inform(h.STICKER_CLICKED,{packID:i,stickerID:j});},submitReply:function(){this.inform(h.SUBMIT_REPLY);}});e.exports=h;},null);
__d("WebMessengerSubscriptionsHandler",["SubscriptionsHandler"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=new g('webmessenger');e.exports=h;},null);
__d("isWebMessengerURI",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){return (/^(\/messages)/).test(h.getPath());}e.exports=g;},null);
__d("WebMessengerWidthControl",["Arbiter","BlueBar","CSS","CSSClassTransition","DOMDimensions","Event","Style","URI","ViewportBounds","WebMessengerEvents","WebMessengerSubscriptionsHandler","$","cx","isWebMessengerURI","requestAnimationFrame","setTimeoutAcrossTransitions","shield","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();var y=205,z=981,aa=257,ba=18,ca=848,da=724,ea=.57,fa=56,ga,ha,ia;function ja(oa,pa,qa){this.masterChanged=oa;this.detailChaned=pa;q.addSubscriptions(l.listen(window,'resize',x(w(ka,this,this),100)),g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide','minisidebar/show'],w(ka,this,this),g.SUBSCRIBE_NEW));var ra=na()?fa:0;if(qa)ra=y;this._width=na()?0:ca;ia=true;ka(this,ra);}function ka(oa,pa){var qa=o.getRight()+o.getLeft();qa=qa||pa||0;var ra=k.getViewportWithoutScrollbarDimensions().width-qa,sa=Math.round(Math.max(0,ra/2-z/2));ra=z+sa-aa;ra-=ba;ra=Math.max(da,Math.min(ca,ra));if(!isNaN(ra)&&oa._width!==ra){oa._width=ra;var ta=Math.round(ra/(1+ea)),ua=ra-ta;oa.masterChanged(ua);oa.detailChaned(ta);if(na()){var va=ra+aa;la(function(){if(ha){document.body.className=ha;ha='';}ma(va+'px');i.removeClass(document.body,"_5uj5");ia&&p.detailDOMChanged();ia=false;},ha);}}}function la(oa,pa){pa&&i.addClass(document.documentElement,"_5uj6");u(oa);pa&&v(i.removeClass.bind(null,document.documentElement,"_5uj6"),1000);}function ma(oa){m.set(h.getNavRoot(),'width',oa);m.set(r('globalContainer'),'width',oa);}function na(){if(!ga)ga=i.hasClass(document.body,"_6nw");return ga;}j.registerHandler(function(oa,pa,qa,ra){function sa(ta){return na()&&t(new n(ta));}if(sa(ra)){ha=pa;return true;}else if(sa(qa)){la(function(){oa.className=pa;ma('');},true);return true;}});e.exports=ja;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","BlueBar","ChatQuietLinks","CSS","DataStore","DOM","Parent","Scroll","Style","Toggler","Vector","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();b('WebMessengerWidthControl');function w(){}Object.assign(w,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(x){this.init=v;this.rootEl=x;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();l.removeEmptyHrefs(this.rootEl);g.listen(x,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));s.subscribe(['show','hide'],function(y,z){var aa=z.getActive();if(!o.contains(x,aa))return;if(m.hasClass(aa,'fbNub')){this.notifyNub(aa,y);if(y==='show')this._resizeNubFlyout(aa);}else{var ba=p.byClass(aa,'fbNubFlyout');if(ba)m.conditionClass(ba,'menuOpened',y==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=t.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+t.getElementDimensions(this.rootEl).y;var x=k.getBar();if(x){var y=r.isFixed(x)?'viewport':'document';this.flyoutHeightOffset+=t.getElementPosition(x,y).y+t.getElementDimensions(x).y;}},toggle:function(x){var y=this._findFlyout(x);if(!y)return;this.subscribe('init',function(){s.toggle(x);});},show:function(x){this.subscribe('init',function(){s.show(x);});},showNub:function(x){m.show(x);},hide:function(x){this.subscribe('init',function(){var y=s.getInstance(x);o.contains(x,y.getActive())&&y.hide();});},hideNub:function(x){m.hide(x);this.hide(x);},setUseMaxHeight:function(x,y){m.conditionClass(x,'maxHeight',y!==false);this._resizeNubFlyout(x);},_resizeNubFlyout:function(x){var y=this._findFlyout(x);if(!y||m.hasClass(x,'placeholder')||!(m.hasClass(x,'openToggler')||m.hasClass(x,'opened')))return;var z=o.find(y,'div.fbNubFlyoutOuter'),aa=o.find(z,'div.fbNubFlyoutInner'),ba=o.find(aa,'div.fbNubFlyoutBody'),ca=q.getTop(ba),da=ba.offsetHeight;r.set(ba,'height','auto');var ea=t.getElementDimensions(y),fa=t.getElementDimensions(ba),ga=this.getMaxFlyoutHeight(x);r.set(y,'max-height',ga+'px');r.set(z,'max-height',ga+'px');ea=t.getElementDimensions(y);var ha=t.getElementDimensions(aa),ia=ha.y-fa.y,ja=ea.y-ia,ka=parseInt(ba.style.height||ba.clientHeight,10),la=ja!==ka;if(ea.y>ia&&la)r.set(ba,'height',ja+'px');m.removeClass(y,'swapDirection');var ma=t.getElementPosition(y).x;m.conditionClass(y,'swapDirection',function(){if(ma<0)return true;return (ma+ea.x>this.viewportDimensions.x);}.bind(this)());if(la&&ca+da>=fa.y){q.setTop(ba,ba.scrollHeight);}else q.setTop(ba,ca);this.notifyNub(x,'resize');},getMaxFlyoutHeight:function(x){var y=this._findFlyout(x),z=t.getElementPosition(y,'viewport'),aa=t.getElementDimensions(y),ba=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-z.y-aa.y);return Math.max(ba,0);},resizeAllFlyouts:function(){var x=this._getAllNubs(),y=x.length;while(y--)this._resizeNubFlyout(x[y]);},hideAllFlyouts:function(){var x=this._getAllNubs(),y=x.length;while(y--)this.hide(x[y]);},_getAllNubs:function(){var x=o.scry(this.rootEl,"div._50-v.openToggler");return x.concat(o.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var x=event.getTarget(),y=p.byClass(x,'fbNub');if(y){if(p.byClass(x,'fbNubFlyoutTitlebar')){var z=p.byTag(x,'a'),aa=x.nodeName=='INPUT'&&x.getAttribute('type')=='submit';if(!z&&!aa){this.hide(y);return false;}}this.notifyNub(y,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(x){return m.hasClass(x,'fbNubFlyout')?x:o.scry(x,'div.fbNubFlyout')[0]||null;},registerNubController:function(x,y){n.set(x,'dock:nub:controller',y);y.subscribe('nub/button/content-changed',h(this.inform,this,'resize',x));y.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,x));},unregisterNubController:function(x){n.remove(x,'dock:nub:controller');},notifyNub:function(x,y,z){var aa=n.get(x,'dock:nub:controller');aa&&aa.inform(y,z);}});e.exports=a.Dock||w;},null);
__d("PureStoreBasedStateMixin",["StoreBasedStateMixinHelper","invariant","setImmediate"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=function(){for(var k=[],l=0,m=arguments.length;l<m;l++)k.push(arguments[l]);return {getInitialState:function(){return this.constructor.calculateState();},componentWillMount:function(){h(this.constructor.calculateState);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState());this._recalculateStateID=null;}.bind(this);this._mixin=new g(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=i(n);}.bind(this));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}.bind(this);e.exports=j;},null);
__d("StoreAndPropBasedStateMixin",["StoreBasedStateMixinHelper","invariant","setImmediate"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=function(){for(var k=[],l=0,m=arguments.length;l<m;l++)k.push(arguments[l]);return {getInitialState:function(){return this.constructor.calculateState(this.props);},componentWillMount:function(){h(this.constructor.calculateState);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState(this.props));this._recalculateStateID=null;}.bind(this);this._mixin=new g(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=i(n);}.bind(this));},componentWillReceiveProps:function(n){this.setState(this.constructor.calculateState(n));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}.bind(this);e.exports=j;},null);
__d("DateConsts",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=1000,h=60,i=60,j=24,k=7,l=12,m=30.43,n=365.242,o=h*i,p=o*j,q=p*k,r=p*n,s=g*h,t=s*i,u=g*p,v=u*k,w=u*n,x={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6};Object.freeze(x);var y={getDaysInMonth:function(z,aa){return (new Date(z,aa,0)).getDate();},getCurrentTimeInSeconds:function(){return Date.now()/g;},DAYS:x,MS_PER_SEC:g,MS_PER_MIN:s,MS_PER_HOUR:t,MS_PER_DAY:u,MS_PER_WEEK:v,MS_PER_YEAR:w,SEC_PER_MIN:h,SEC_PER_HOUR:o,SEC_PER_DAY:p,SEC_PER_WEEK:q,SEC_PER_YEAR:r,MIN_PER_HOUR:i,HOUR_PER_DAY:j,DAYS_PER_WEEK:k,MONTHS_PER_YEAR:l,AVG_DAYS_PER_MONTH:m,AVG_DAYS_PER_YEAR:n};e.exports=y;},null);
__d("formatDate",["DateStrings","DateFormatConfig","fbt","invariant"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(o,p,q){q=q||{};if(!p||!o)return '';if(typeof o==='string')o=parseInt(o,10);if(typeof o==='number')o=new Date(o*1000);j(o instanceof Date);j(!isNaN(o.getTime()));j(o.getTime()<1e+15);if(typeof p!=='string'){var r=m();for(var s in r){var t=r[s];if(t.start<=o.getTime()&&p[t.name]){p=p[t.name];break;}}}var u;if(q.skipPatternLocalization||(!q.formatInternal&&n())||p.length===1){u=p;}else{j(h.formats[p]);u=h.formats[p];}var v=q.utc?'getUTC':'get',w=o[v+'Date'](),x=o[v+'Day'](),y=o[v+'Month'](),z=o[v+'FullYear'](),aa=o[v+'Hours'](),ba=o[v+'Minutes'](),ca=o[v+'Seconds'](),da=o[v+'Milliseconds'](),ea='';for(var fa=0;fa<u.length;fa++){var ga=u.charAt(fa);switch(ga){case '\\':fa++;ea+=u.charAt(fa);break;case 'd':ea+=l(w,2);break;case 'j':ea+=w;break;case 'S':ea+=g.getOrdinalSuffix(w);break;case 'D':ea+=g.getWeekdayNameShort(x);break;case 'l':ea+=g.getWeekdayName(x);break;case 'F':case 'f':ea+=g.getMonthName(y+1);break;case 'M':ea+=g.getMonthNameShort(y+1);break;case 'm':ea+=l(y+1,2);break;case 'n':ea+=y+1;break;case 'Y':ea+=z;break;case 'y':ea+=(''+z).slice(2);break;case 'a':if(aa<12){ea+=i._("am");}else ea+=i._("pm");break;case 'A':if(aa<12){ea+=i._("AM");}else ea+=i._("PM");break;case 'g':ea+=(aa===0||aa===12)?12:aa%12;break;case 'G':ea+=aa;break;case 'h':if(aa===0||aa===12){ea+=12;}else ea+=l(aa%12,2);break;case 'H':ea+=l(aa,2);break;case 'i':ea+=l(ba,2);break;case 's':ea+=l(ca,2);break;case 'X':ea+=l(da,3);break;default:ea+=ga;}}return ea;}function l(o,p){return Array(p-(''+o).length+1).join('0')+o;}function m(){var o=new Date(),p=o.getTime(),q=o.getFullYear(),r=o.getDate()-((o.getDay()-h.weekStart+6)%7),s=new Date(q,o.getMonth()+1,0).getDate(),t=new Date(q,1,29).getMonth()===1?366:365,u=1000*60*60*24;return [{name:'today',start:o.setHours(0,0,0,0)},{name:'withinDay',start:p-u},{name:'thisWeek',start:new Date(o.getTime()).setDate(r)},{name:'withinWeek',start:p-u*7},{name:'thisMonth',start:o.setDate(1)},{name:'withinMonth',start:p-u*s},{name:'thisYear',start:o.setMonth(0)},{name:'withinYear',start:p-u*t},{name:'older',start:-Infinity}];}k.periodNames=['today','thisWeek','thisMonth','thisYear','withinDay','withinWeek','withinMonth','withinYear','older'];function n(){if(typeof window==='undefined'||!window||!window.location||!window.location.pathname)return false;var o=window.location.pathname,p='/intern';return o.substr(0,p.length)===p;}e.exports=k;},null);
__d("keyMirrorRecursive",["invariant"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(k,l){return i(k,l);}function i(k,l){var m={},n;g(j(k));for(n in k){if(!k.hasOwnProperty(n))continue;var o=k[n],p=l?l+'.'+n:n;if(j(o)){o=i(o,p);}else o=p;m[n]=o;}return m;}function j(k){return k instanceof Object&&!Array.isArray(k);}e.exports=h;},null);
__d("mergeDeep",["mergeHelpers","mergeDeepInto"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g.checkArrayStrategy,j=g.checkMergeObjectArgs,k=g.normalizeMergeArg,l=function(m,n,o){var p=k(m),q=k(n);j(p,q);i(o);var r={};h(r,p,o);h(r,q,o);return r;};e.exports=l;},null);
__d("ReactComponentRenderer",["React","Object.assign","warning"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';function j(k,l){this.klass=k;this.container=l;this.props={};this.component=null;}j.prototype.replaceProps=function(k,l){this.props={};this.setProps(k,l);};j.prototype.setProps=function(k,l){if(this.klass==null)return;h(this.props,k);var m=g.createElement(this.klass,this.props);this.component=g.render(m,this.container,l);};j.prototype.unmount=function(){g.unmountComponentAtNode(this.container);this.klass=null;};e.exports=j;},null);
__d("TreeMap",["Map","nullthrows"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(w,x,y){this.key=w;this.value=x;this.time=y;}function j(w){this.$TreeMap0=function(x,y){var z=w(x,y);return z!==0?z:x.time-y.time;};this.$TreeMap1=new g();this.$TreeMap2=null;this.$TreeMap3=0;this.size=this.$TreeMap1.size;}j.prototype.clear=function(){this.$TreeMap1=new g();this.$TreeMap2=null;this.size=this.$TreeMap1.size;};j.prototype.has=function(w){return this.$TreeMap1.has(w);};j.prototype.set=function(w,x){if(this.has(w))this["delete"](w);var y=new i(w,x,this.$TreeMap3++);this.$TreeMap1.set(w,y);this.$TreeMap2=q(this.$TreeMap2,y,this.$TreeMap0);this.size=this.$TreeMap1.size;return this;};j.prototype.get=function(w){return this.has(w)?this.$TreeMap1.get(w).value:(void 0);};j.prototype["delete"]=function(w){if(!this.has(w))return false;var x=this.$TreeMap1.get(w);this.$TreeMap2=r(this.$TreeMap2,x,this.$TreeMap0);this.$TreeMap1["delete"](w);this.size=this.$TreeMap1.size;return true;};j.prototype.keys=function(){var w=[];v(this.$TreeMap2,w,function(x){return x.key;});return w;};j.prototype.values=function(){var w=[];v(this.$TreeMap2,w,function(x){return x.value;});return w;};j.prototype.entries=function(){var w=[];v(this.$TreeMap2,w,function(x){return {key:x.key,value:x.value};});return w;};j.prototype.range=function(w,x){var y=[],z=null;if(w)z=new i(w.key,w.value,-1);var aa=null;if(x)aa=new i(x.key,x.value,this.$TreeMap3);v(this.$TreeMap2,y,function(ba){return {key:ba.key,value:ba.value};},this.$TreeMap0,z,aa);return y;};j.prototype.min=function(){if(!this.$TreeMap2)return undefined;var w=s(h(this.$TreeMap2)),x=w.key,y=w.value;return {key:x,value:y};};j.prototype.max=function(){if(!this.$TreeMap2)return undefined;var w=t(h(this.$TreeMap2)),x=w.key,y=w.value;return {key:x,value:y};};j.prototype.__testRoot=function(){};function k(w){if(!w)return w;p(w);if(w.balanceFactor<-1){if(w.right&&w.right.balanceFactor<=0){return l(w);}else return m(w);}else if(w.balanceFactor>1){if(w.left&&w.left.balanceFactor>=0){return n(w);}else return o(w);}else return w;}function l(w){var x=w,y=h(x.right),z=y.left;x.right=z;p(x);h(y).left=x;p(y);return y;}function m(w){var x=w,y=h(x.right),z=h(y.left),aa=z.left,ba=z.right;x.right=aa;p(x);y.left=ba;p(y);z=h(z);z.left=x;z.right=y;p(z);return z;}function n(w){var x=w,y=h(x.left),z=y.right;x.left=z;p(x);y.right=x;p(y);return y;}function o(w){var x=w,y=h(x.left),z=h(y.right),aa=z.left,ba=z.right;y.right=aa;p(y);x.left=ba;p(x);z.left=y;z.right=x;p(z);return z;}function p(w){var x=w.left?w.left.height:-1,y=w.right?w.right.height:-1;w.height=Math.max(x,y)+1;w.balanceFactor=x-y;}function q(w,x,y){if(w==null)return k(x);var z=y(x,w);if(z<0){w.left=q(w.left,x,y);return k(w);}else{w.right=q(w.right,x,y);return k(w);}}function r(w,x,y){if(w==null)return null;if(w===x)if(w.left&&w.right){var z=t(w.left);w.left=u(w.left);z.left=w.left;z.right=w.right;return k(z);}else if(w.left){return k(w.left);}else if(w.right){return k(w.right);}else return null;var aa=y(x,w);if(aa<0){w.left=r(w.left,x,y);return k(w);}else{w.right=r(w.right,x,y);return k(w);}}function s(w){while(w.left)w=w.left;return w;}function t(w){while(w.right)w=w.right;return w;}function u(w){if(!w)return null;if(w.right==null)return k(w.left||null);w.right=u(w.right);return k(w);}function v(w,x,y,z,aa,ba){if(w==null)return;var ca=!z||!aa||z(w,aa)>=0,da=!z||!ba||z(w,ba)<=0;if(ca)v(w.left,x,y,z,aa,ba);if(ca&&da)x.push(y(w));if(da)v(w.right,x,y,z,aa,ba);}e.exports=j;},null);
__d("QE",["Banzai","Cache"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='qe_log_exposure',j=60,k=new h(),l={logExposure:function(m){if(k.has(m))return;var n={signal:true},o={name:m};g.post(i,o,n);k.set(m,true,1,j);}};e.exports=l;},null);
__d("MercuryMessageActions",["MercuryActionType","MercuryDispatcher","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n){this.$MercuryMessageActions0=n;this.$MercuryMessageActions1=i.getForFBID(this.$MercuryMessageActions0);this.__serverRequests=k.getForFBID(this.$MercuryMessageActions0);this.$MercuryMessageActions2=h.getForFBID(this.$MercuryMessageActions0);}m.prototype.send=function(n,o,p){o=o||Function.prototype;this.$MercuryMessageActions1.normalizeNewMessage(n);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},n),j.CLIENT_SEND_MESSAGE));this.__serverRequests.sendNewMessage(n,p);o(n.thread_id);};m.prototype.resend=function(n,o){var p=Object.assign({},n);this.$MercuryMessageActions1.normalizeResendMessage(p);this.send(p,(void 0),o);};m.prototype.addAttachmentPlaceholder=function(n,o,p){this.$MercuryMessageActions1.normalizeAddAttachmentPlaceholder(n,o,p);this.$MercuryMessageActions1.normalizeNewMessage(n);this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3(Object.assign({},n),j.CLIENT_SEND_MESSAGE));};m.prototype.cancelAttachmentPlaceholder=function(n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:n,upload_data:o,action_type:g.CANCEL_ATTACHMENT_PLACEHOLDER},j.CLIENT_SEND_MESSAGE));};m.prototype.confirmAttachmentPlaceholder=function(n,o){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions3({upload_id:n,upload_data:o,action_type:g.CONFIRM_ATTACHMENT_PLACEHOLDER},j.CLIENT_SEND_MESSAGE));};m.prototype["delete"]=function(n,o,p){this.$MercuryMessageActions2.handleUpdate(this.$MercuryMessageActions4(n,o,g.DELETE_MESSAGES,p||j.CLIENT_DELETE_MESSAGES));};m.prototype.$MercuryMessageActions3=function(n,o){return {actions:[n],from_client:true,payload_source:o};};m.prototype.$MercuryMessageActions5=function(n,o){return {actions:[n],from_client:false,payload_source:o};};m.prototype.$MercuryMessageActions4=function(n,o,p,q){return {actions:[{action_type:p,action_id:null,thread_id:n,message_ids:o}],from_client:true,payload_source:q};};Object.assign(m,l);e.exports=m;},null);
__d("FBRTCAvailability",["ChannelConstants","PresenceStatus"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={isCallable:function(j){var k=h.getCapabilities(j),l=g.CAPABILITY_VOIP_INTEROP|g.CAPABILITY_VIDEO;return !!(k&l);}};e.exports=i;},null);
__d("FBRTCStruct",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=function(i,j,k){var l,m;if(typeof i=='string'||i instanceof String){m=i;l=i;}else for(var n in i)if(i.hasOwnProperty(n))if(n==='index'){k=i[n];}else{m=n;l=i[n];}j[m]=k;j.strNames[k]=l;};function h(i){"use strict";this.strNames=[];for(var j=0;j<i.length;j++)g(i[j],this,j);}e.exports=h;},null);
__d("FBRTCConstants",["FBRTCStruct"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={OFFER:'offer',ANSWER:'answer',ICE_CANDIDATE:'ice_candidate',OK:'ok',PING:'ping',HANGUP:'hang_up',OTHER_DISMISS:'other_dismiss',MSG_ACK:'msg_ack',PRANSWER:'pranswer',ICERESTART_OFFER:'icerestart_offer',ICERESTART_ANSWER:'icerestart_answer',PCRESTART_OFFER:'pcrestart_offer',PCRESTART_ANSWER:'pcrestart_answer',SDP_UPDATE:'sdp_update',OFFER_ACK:'offer_ack',OFFER_NACK:'offer_nack',ANSWER_ACK:'answer_ack',SET_VIDEO:'set_video',VIDEO_REQUEST:'video_request',ACK:'ack'},i=new g([{IGNORE_CALL:'IgnoreCall'},{HANGUP_CALL:'HangupCall'},{IN_ANOTHER_CALL:'InAnotherCall'},{ACCEPT_AFTER_HANGUP:'CallEndAcceptAfterHangUp'},{NO_ANSWER_TIMEOUT:'NoAnswerTimeout'},{INCOMING_TIMEOUT:'IncomingTimeout'},{OTHER_INSTANCE_HANDLED:'OtherInstanceHandled'},{SIGNALING_MESSAGE_FAILED:'SignalingMessageFailed'},{CONNECTION_DROPPED:'ConnectionDropped'},{CLIENT_INTERRUPTED:'ClientInterrupted'},{WEBRTC_ERROR:'WebRTCError'},{CLIENT_ERROR:'ClientError'},{NO_PERMISSION:'NoPermission'},{OTHER_NOT_CAPABLE:'OtherNotCapable'},{NO_UI_ERROR:'NoUIShown'},{UNSUPPORTED_VERSION:'VersionUnsupported'},{CALLER_NOT_VISIBLE:'CallerNotVisible'},{CARRIER_BLOCKED:'CarrierBlocked'},{OTHER_CARRIER_BLOCKED:'OtherCarrierBlocked'}]),j={TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10},k={PayloadType:h,CallEndReason:i,UIEventType:j,endCallReasonFromString:function(l){return i.strNames.indexOf(l);},callEndReasonString:function(l){if(l<0||l>i.strNames.length)return 'Unknown';return i.strNames[l];},fullCallEndReasonString:function(l,m){return this.callEndReasonString(l)+'_'+(m?'remote':'local');}};e.exports=k;},null);
__d("FBRTCIceStatsParser",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=null;h.getInstance=function(){"use strict";if(!g)g=new h();return g;};function h(){"use strict";}h.prototype.extractIceInfo=function(i){"use strict";var j=[],k=i.split("\r\n");for(var l=0;l<k.length;l++){var m=k[l];if(this.$FBRTCIceStatsParser0(m))j.push({gen:this.$FBRTCIceStatsParser1(m),type:this.$FBRTCIceStatsParser2(m)});}return j;};h.prototype.$FBRTCIceStatsParser0=function(i){"use strict";return (i.indexOf('candidate:')>-1);};h.prototype.$FBRTCIceStatsParser1=function(i){"use strict";var j=0,k=i.match(/generation (\d+)/);if(k)j=parseInt(k[1],10);return j;};h.prototype.$FBRTCIceStatsParser2=function(i){"use strict";var j=i.match(/typ (host|relay|srflx|prflx)/);if(j){return j[1];}else return 'unknown';};e.exports=h;},null);
__d("FBRTCLogger",["Log","LogHistory","MarauderLogger","formatDate","pageID"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l='webrtc',m='sent_message',n='received_message',o='send_succeeded',p='send_failed',q='info',r='call_action',s='client_event',t='client_error',u='type',v='msg_id',w='ack_msg_id',x='call_id',y='from',z='to',aa='content',ba='tag',ca='peer_id',da='error_code',ea='trigger',fa='endcallstats',ga=null;ha.getInstance=function(){"use strict";if(!ga)ga=new ha();return ga;};function ha(){"use strict";this.$FBRTCLogger0=h.getInstance(l);}ha.prototype.logToConsole=function(ia){"use strict";var ja='Console';this.$FBRTCLogger1(null,null,ja,ia);this.$FBRTCLogger0.log(ja,ia);};ha.prototype.logReceivedMessage=function(ia,ja,ka){"use strict";var la={};la[y]=ia;la[x]=ja;la[u]=ka.type;la[v]=ka.msg_id;if(ka.sdp)la[aa]=ka.sdp;if(ka.ack_id)la[w]=ka.ack_id;this.$FBRTCLogger2(n,la);this.$FBRTCLogger1(ia,ja,'Received',ka.type+', '+ka.msg_id);};ha.prototype.logSentMessage=function(ia,ja,ka){"use strict";var la={};la[z]=ia;la[x]=ja;la[u]=ka.type;la[v]=ka.msg_id;if(ka.sdp)la[aa]=ka.sdp;if(ka.ack_id)la[w]=ka.ack_id;this.$FBRTCLogger2(m,la);this.$FBRTCLogger1(ia,ja,'Sent',ka.type+', '+ka.msg_id);};ha.prototype.logSentMessageSuccess=function(ia,ja,ka,la){"use strict";var ma={};ma[ca]=ia;ma[x]=ja;ma[u]=ka;ma[v]=la;this.$FBRTCLogger2(o,ma);};ha.prototype.logSentMessageFailure=function(ia,ja,ka,la,ma){"use strict";var na={};na[ca]=ia;na[x]=ja;na[u]=ka;na[v]=la;na[da]=ma;this.$FBRTCLogger2(p,na);this.$FBRTCLogger1(ia,ja,'Send Failed',ka+', '+ma);};ha.prototype.logCallAction=function(ia,ja,ka,la,ma){"use strict";var na={};na[ca]=ia;na[x]=ja;na[r]=ka;na[aa]=la;if(ma)na[ea]=ma;this.$FBRTCLogger2(r,na);this.$FBRTCLogger1(ia,ja,'CallAction',ka+', '+la);};ha.prototype.logEvent=function(ia,ja,event){"use strict";var ka={};ka[ca]=ia;ka[x]=ja;ka[aa]=event;this.$FBRTCLogger2(s,ka);this.$FBRTCLogger1(ia,ja,'Event',event);};ha.prototype.logInfo=function(ia,ja,ka){"use strict";var la={};la[ca]=ia;la[x]=ja;la[aa]=ka;this.$FBRTCLogger2(q,la);this.$FBRTCLogger1(ia,ja,'Info',ka);};ha.prototype.logError=function(ia,ja,ka){"use strict";var la={};la[ca]=ia;la[x]=ja;la[aa]=ka;this.$FBRTCLogger2(t,la);this.$FBRTCLogger1(ia,ja,'Error',ka);};ha.prototype.logErrorWithoutID=function(ia){"use strict";this.logError(null,null,ia);};ha.prototype.logEndCallSummary=function(ia){"use strict";if(!ia)return;var ja={};ja[ca]=ia.peerID;ja[x]=ia.callID;ja[ba]=fa;ja[aa]=ia.toString();var ka=ia.getExtraInfo();for(var la in ka)if(ka.hasOwnProperty(la))ja[la]=ka[la];this.$FBRTCLogger2(q,ja);this.$FBRTCLogger1(ia.peerID,ia.callID,'Call Summary',ja);};ha.prototype.$FBRTCLogger2=function(ia,ja){"use strict";ja.page_id=k;this.$FBRTCLogger0.log(ia,ja);i.log(ia,l,ja);};ha.prototype.$FBRTCLogger1=function(ia,ja,ka,la){"use strict";};ha.CallAction={START_CALL:'start_call',RECEIVED_CALL:'received_call',ANSWER_CALL:'answer_call',END_CALL:'end_call',DENIED_PERMISSION:'denied_permission',SET_MUTE:'set_mute',SET_VIDEO_ON:'set_video_on',SET_SELF_VIEW_ON:'set_self_view_on',SET_FULLSCREEN_ON:'set_fullscreen_on',START_SKYPE:'start_skype',TRY_NEW:'try_new',OPEN_POPUP:'open_popup',POPUP_OPENED:'popup_opened',AUTO_DISABLE_VIDEO:'auto_disable_video',FAILED_GETTING_URI:'failed_getting_uri',OLD_URI:'old_uri',USER_SETTINGS_CHANGED:'user_settings_changed'};ha.Trigger={ADMIN_MESSAGE:'admin_message',CHAT_TAB_ICON:'chat_tab_icon',CHAT_TAB_ICON_TOUR:'chat_tab_icon_tour',CHAT_TAB_VOICE_ICON:'chat_tab_voice_icon',SKYPE_DEPRECATION_DIALOG:'skype_deprecation_dialog',REDIAL_BUTTON:'redial_button',RETURN_CALL:'return_call',WEB_MESSENGER:'web_messenger',POPUP_CALL_START_BUTTON:'popup_start_call_button',TIMELINE_PROFILE:'timeline_profile',UNKNOWN:'unknown'};ha.Key={DEVICE_INFO:'device_info',RATING:'rating5',RATING_SHOWN:'rating_shown',SURVEY_CHOICE:'survey_choice',SURVEY_DETAILS:'survey_details',SURVEY_SHOWN:'survey_shown',INITIATED_BY_PAGE_ID:'initiated_by_page_id',PEER_IS_MOBILE:'peer_is_mobile'};e.exports=ha;},null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCIceStatsParser","FBRTCLogger","UserAgentData","performanceNow"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=5*60*1000,m={CALL_STARTED:'started',POPUP_OPENED:'opened',SENT_OFFER:'s_o',RECV_OFFER:'r_o',SENT_OFFER_ACK:'s_oack',RECV_OFFER_ACK:'r_oack',SENT_RETRIED_OFFER:'s_o2',RECV_RETRIED_OFFER:'r_o2',SENT_RETRIED_OFFER_ACK:'s_oack2',RECV_RETRIED_OFFER_ACK:'r_oack2',SENT_PRANSWER:'s_pr',RECV_PRANSWER:'r_pr',NETWORK_READY:'network_ready',SENT_ANSWER:'s_a',RECV_ANSWER:'r_a',SENT_ANSWER_ACK:'s_aack',RECV_ANSWER_ACK:'r_aack',SENT_RETRIED_ANSWER:'s_a2',RECV_RETRIED_ANSWER:'r_a2',SENT_RETRIED_ANSWER_ACK:'s_aack2',RECV_RETRIED_ANSWER_ACK:'r_aack2',SENT_OK:'s_ok',RECV_OK:'r_ok',CALL_CONNECTED:'connected',CALL_ENDED:'ended'};n.CURRENT_SUMMARY_VERSION=19;function n(o){"use strict";this.peerID=o.peerID;this.callID=o.callID;this.$FBRTCCallSummary0=o.isCaller;this.$FBRTCCallSummary1=(new Date()).valueOf();this.$FBRTCCallSummary2=null;this.$FBRTCCallSummary3={};this.$FBRTCCallSummary4=null;this.$FBRTCCallSummary5=null;this.$FBRTCCallSummary6=null;this.$FBRTCCallSummary7=null;this.$FBRTCCallSummary8=null;this.$FBRTCCallSummary9=null;this.$FBRTCCallSummarya={};this.$FBRTCCallSummaryb={};this.$FBRTCCallSummaryc={};this.$FBRTCCallSummaryd={};this.$FBRTCCallSummarye={};this.$FBRTCCallSummaryf={};this.$FBRTCCallSummaryg=k();this.$FBRTCCallSummaryh=0;this.$FBRTCCallSummaryi={};this.$FBRTCCallSummaryj=this.$FBRTCCallSummaryg;this.$FBRTCCallSummaryk=0;this.$FBRTCCallSummaryl={};this.addExtraInfo(i.Key.DEVICE_INFO,this.$FBRTCCallSummarym());this.$FBRTCCallSummaryn();this.$FBRTCCallSummaryo=h.getInstance();this.$FBRTCCallSummaryp=i.getInstance();}n.prototype.toJsonString=function(){"use strict";this.$FBRTCCallSummary8=(new Date()).valueOf();return JSON.stringify({version:n.CURRENT_SUMMARY_VERSION,peerID:this.peerID,callID:this.callID,isCaller:this.$FBRTCCallSummary0,callType:this.$FBRTCCallSummaryq,localVideoDuration:this.$FBRTCCallSummaryr,remoteVideoDuration:this.$FBRTCCallSummarys,startTime:this.$FBRTCCallSummary1,trigger:this.$FBRTCCallSummary2,signalingTime:this.$FBRTCCallSummary3,endCallReason:this.$FBRTCCallSummary4,endCallSubreason:this.$FBRTCCallSummary5,isRemoteEnded:this.$FBRTCCallSummary6,lastUpdatedTime:this.$FBRTCCallSummary7,lastSerializedTime:this.$FBRTCCallSummary8,unsetOnRetrieve:this.$FBRTCCallSummary9,openCount:this.$FBRTCCallSummaryk,extraInfo:this.$FBRTCCallSummaryl,pcStats:this.$FBRTCCallSummarya,captureStats:this.$FBRTCCallSummaryb,gen0IceSentCount:this.$FBRTCCallSummaryc,gen0IceReceivedCount:this.$FBRTCCallSummaryd,iceSentCount:this.$FBRTCCallSummarye,iceReceivedCount:this.$FBRTCCallSummaryf,newSignalingTime:this.$FBRTCCallSummaryi,accumulatedCallTime:this.$FBRTCCallSummaryt()});};n.fromJsonString=function(o){"use strict";var p;try{p=JSON.parse(o);}catch(q){return null;}if(p.version!==n.CURRENT_SUMMARY_VERSION)return null;if(!p.hasOwnProperty('peerID')||!p.hasOwnProperty('callID')||!p.hasOwnProperty('isCaller')||!p.hasOwnProperty('startTime')||!p.hasOwnProperty('trigger')||!p.hasOwnProperty('signalingTime')||!p.hasOwnProperty('endCallReason')||!p.hasOwnProperty('isRemoteEnded')||!p.hasOwnProperty('lastUpdatedTime')||!p.hasOwnProperty('lastSerializedTime'))return null;var r=new n({peerID:p.peerID,callID:p.callID,isCaller:p.isCaller});r.$FBRTCCallSummary1=p.startTime;r.$FBRTCCallSummary2=p.trigger;r.$FBRTCCallSummary3=p.signalingTime;r.$FBRTCCallSummary4=p.endCallReason;r.$FBRTCCallSummary5=p.endCallSubreason;r.$FBRTCCallSummary6=p.isRemoteEnded;r.$FBRTCCallSummary7=p.lastUpdatedTime;r.$FBRTCCallSummary8=p.lastSerializedTime;if(p.callType)r.$FBRTCCallSummaryq=p.callType;if(p.localVideoDuration)r.$FBRTCCallSummaryr=p.localVideoDuration;if(p.remoteVideoDuration)r.$FBRTCCallSummarys=p.remoteVideoDuration;if(p.unsetOnRetrieve)r.$FBRTCCallSummary9=p.unsetOnRetrieve;if(p.openCount)r.$FBRTCCallSummaryk=p.openCount;if(p.extraInfo)r.$FBRTCCallSummaryl=p.extraInfo;if(p.pcStats)r.$FBRTCCallSummarya=p.pcStats;if(p.captureStats)r.$FBRTCCallSummaryb=p.captureStats;if(p.gen0IceSentCount)r.$FBRTCCallSummaryc=p.gen0IceSentCount;if(p.gen0IceReceivedCount)r.$FBRTCCallSummaryd=p.gen0IceReceivedCount;if(p.iceSentCount)r.$FBRTCCallSummarye=p.iceSentCount;if(p.iceReceivedCount)r.$FBRTCCallSummaryf=p.iceReceivedCount;if(p.newSignalingTime)r.$FBRTCCallSummaryi=p.newSignalingTime;if(p.accumulatedCallTime)r.$FBRTCCallSummaryh=p.accumulatedCallTime;return r;};n.restoreOrInitialize=function(o,p,q,r,s){"use strict";var t=o.retrieveCallSummary(p,q);if(!t){t=new n({peerID:p,callID:q,isCaller:r});if(s){t.onFullMessageReceived({msg:s});t.onOfferAckSent(s);}else t.onCallStarted(i.Trigger.UNKNOWN);i.getInstance().logError(p,q,'Missing call summary from storage');}else if(t.$FBRTCCallSummary9){t.$FBRTCCallSummary4=null;t.$FBRTCCallSummary5=null;t.$FBRTCCallSummary6=null;delete t.$FBRTCCallSummary3[m.CALL_ENDED];delete t.$FBRTCCallSummaryi[m.CALL_ENDED];t.$FBRTCCallSummary9=null;}return t;};n.logSavedSummaries=function(o){"use strict";var p=o.getLoggableSummaries(),q=p.length;if(q<=0)return;var r=i.getInstance(),s=[];for(var t=0;t<q;t++){var u=p[t];r.logEndCallSummary(u);s.push({peerID:u.peerID,callID:u.callID});}o.removeCallSummaries(s);r.logToConsole('Logged pending summaries: '+q);};n.prototype.save=function(o){"use strict";var p=k(),q=p-this.$FBRTCCallSummaryj;if(q>l){this.$FBRTCCallSummaryp.logInfo(this.peerID,this.callID,'Summary too old: '+q);return;}o.storeCallSummary(this.peerID,this.callID,this);this.$FBRTCCallSummaryj=p;};n.prototype.getLastUpdatedTime=function(){"use strict";return this.$FBRTCCallSummary7;};n.prototype.setLastUpdatedTime=function(o){"use strict";this.$FBRTCCallSummary7=o;};n.prototype.getExtraInfo=function(){"use strict";return this.$FBRTCCallSummaryl;};n.prototype.addExtraInfo=function(o,p){"use strict";this.$FBRTCCallSummaryl[o]=p;this.$FBRTCCallSummaryn();};n.prototype.onCallStarted=function(o){"use strict";this.$FBRTCCallSummary2=o;this.$FBRTCCallSummaryu(m.CALL_STARTED);this.$FBRTCCallSummaryn();};n.prototype.onPopupOpened=function(){"use strict";this.$FBRTCCallSummaryu(m.POPUP_OPENED);this.$FBRTCCallSummaryk++;this.$FBRTCCallSummaryn();};n.prototype.setPcStats=function(o){"use strict";this.$FBRTCCallSummarya=o;this.$FBRTCCallSummaryn();};n.prototype.setVideoCaptureStats=function(o,p){"use strict";this.$FBRTCCallSummaryb={w:o,h:p};this.$FBRTCCallSummaryn();};n.prototype.setCallType=function(o){"use strict";this.$FBRTCCallSummaryq=o;this.$FBRTCCallSummaryn();};n.prototype.setVideoDurations=function(o,p){"use strict";this.$FBRTCCallSummaryr=o;this.$FBRTCCallSummarys=p;this.$FBRTCCallSummaryn();};n.prototype.onOfferAckSent=function(o){"use strict";this.onMessageSent({type:g.PayloadType.OFFER_ACK,flag:o.flag});};n.prototype.onMessageSent=function(o){"use strict";var p=o.flag===1;switch(o.type){case g.PayloadType.OFFER:this.$FBRTCCallSummaryv(p,m.SENT_OFFER,m.SENT_RETRIED_OFFER);this.$FBRTCCallSummaryw(o,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;case g.PayloadType.ANSWER:this.$FBRTCCallSummaryv(p,m.SENT_ANSWER,m.SENT_RETRIED_ANSWER);this.$FBRTCCallSummaryw(o,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;case g.PayloadType.OK:this.$FBRTCCallSummaryu(m.SENT_OK);break;case g.PayloadType.PRANSWER:this.$FBRTCCallSummaryu(m.SENT_PRANSWER);break;case g.PayloadType.OFFER_ACK:this.$FBRTCCallSummaryv(p,m.SENT_OFFER_ACK,m.SENT_RETRIED_OFFER_ACK);break;case g.PayloadType.ANSWER_ACK:this.$FBRTCCallSummaryv(p,m.SENT_ANSWER_ACK,m.SENT_RETRIED_ANSWER_ACK);break;case g.PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummaryw(o,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;default:}this.$FBRTCCallSummaryn();};n.prototype.$FBRTCCallSummaryw=function(o,p,q){"use strict";var r=null,s=null,t=this.$FBRTCCallSummaryo.extractIceInfo(o.sdp);for(var u=0;u<t.length;u++){r=t[u].gen;s=t[u].type;if(r===0)this.$FBRTCCallSummaryx(p,s);this.$FBRTCCallSummaryx(q,s);}};n.prototype.$FBRTCCallSummaryx=function(o,p){"use strict";if(!o[p]){o[p]=1;}else o[p]=o[p]+1;};n.prototype.$FBRTCCallSummaryy=function(o){"use strict";if(o.isFromMobile())this.addExtraInfo(i.Key.PEER_IS_MOBILE,'1');};n.prototype.onFullMessageReceived=function(o){"use strict";var p=o.msg,q=p.flag===1;switch(p.type){case g.PayloadType.OFFER:this.$FBRTCCallSummaryy(o);this.$FBRTCCallSummaryv(q,m.RECV_OFFER,m.RECV_RETRIED_OFFER);this.$FBRTCCallSummaryw(p,this.$FBRTCCallSummaryd,this.$FBRTCCallSummaryf);break;case g.PayloadType.ANSWER:this.$FBRTCCallSummaryy(o);this.$FBRTCCallSummaryv(q,m.RECV_ANSWER,m.RECV_RETRIED_ANSWER);this.$FBRTCCallSummaryw(p,this.$FBRTCCallSummaryd,this.$FBRTCCallSummaryf);break;case g.PayloadType.OK:this.$FBRTCCallSummaryu(m.RECV_OK);break;case g.PayloadType.PRANSWER:this.$FBRTCCallSummaryu(m.RECV_PRANSWER);break;case g.PayloadType.OFFER_ACK:this.$FBRTCCallSummaryv(q,m.RECV_OFFER_ACK,m.RECV_RETRIED_OFFER_ACK);break;case g.PayloadType.ANSWER_ACK:this.$FBRTCCallSummaryv(q,m.RECV_ANSWER_ACK,m.RECV_RETRIED_ANSWER_ACK);break;case g.PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummaryw(p,this.$FBRTCCallSummaryd,this.$FBRTCCallSummaryf);break;default:}this.$FBRTCCallSummaryn();};n.prototype.onMsgAckReceived=function(o,p){"use strict";var q=o.msg.flag===1;if(p){this.$FBRTCCallSummaryv(q,m.RECV_OFFER_ACK,m.RECV_RETRIED_OFFER_ACK);}else this.$FBRTCCallSummaryv(q,m.RECV_ANSWER_ACK,m.RECV_RETRIED_ANSWER_ACK);};n.prototype.onCallConnected=function(){"use strict";this.$FBRTCCallSummaryu(m.NETWORK_READY);this.$FBRTCCallSummaryu(m.CALL_CONNECTED);this.$FBRTCCallSummaryn();};n.prototype.onCallEnded=function(o,p,q,r){"use strict";this.$FBRTCCallSummary9=q;this.$FBRTCCallSummary4=o;this.$FBRTCCallSummary5=r;this.$FBRTCCallSummary6=p;this.$FBRTCCallSummaryu(m.CALL_ENDED);this.$FBRTCCallSummaryn();};n.prototype.toString=function(){"use strict";var o={};o.core_metrics=this.$FBRTCCallSummaryz();o.time_series=null;return JSON.stringify(o);};n.prototype.$FBRTCCallSummaryz=function(){"use strict";var o={};o.ver=n.CURRENT_SUMMARY_VERSION;o.caller=this.$FBRTCCallSummary0;o.call_type=this.$FBRTCCallSummaryq;o.conn=this.$FBRTCCallSummaryA();o.peer_id=this.peerID;o.has_video=true;o.open_count=this.$FBRTCCallSummaryk;o.signaling=this.$FBRTCCallSummaryB();o.sender=this.$FBRTCCallSummaryC();o.receiver=this.$FBRTCCallSummaryD();o.end=this.$FBRTCCallSummaryE();o.video=this.$FBRTCCallSummaryF();return o;};n.prototype.$FBRTCCallSummaryA=function(){"use strict";var o={dtls:1};if(this.$FBRTCCallSummarya.sender&&this.$FBRTCCallSummarya.sender.rtt)o.rtt=this.$FBRTCCallSummarya.sender.rtt;return o;};n.prototype.$FBRTCCallSummaryB=function(){"use strict";var o={};if(this.$FBRTCCallSummary2)o.trigger=this.$FBRTCCallSummary2;o.start_time=this.$FBRTCCallSummary1;o.time_from_start=this.$FBRTCCallSummary3;var p=this.$FBRTCCallSummary3[m.CALL_CONNECTED],q=this.$FBRTCCallSummary3[m.CALL_ENDED];if(p){if(!q)if(this.$FBRTCCallSummary8){q=this.$FBRTCCallSummary8-this.$FBRTCCallSummary1;}else q=this.$FBRTCCallSummaryG();var r=q-p;if(r>0)o.duration=r;}o.new_time_from_start=this.$FBRTCCallSummaryi;p=this.$FBRTCCallSummaryi[m.CALL_CONNECTED];q=this.$FBRTCCallSummaryi[m.CALL_ENDED];if(p){if(!q)if(this.$FBRTCCallSummaryh>0){q=this.$FBRTCCallSummaryh;}else q=this.$FBRTCCallSummaryt();r=q-p;if(r>0)o.new_duration=r;}return o;};n.prototype.$FBRTCCallSummaryC=function(){"use strict";var o={};if(this.$FBRTCCallSummaryc)o.ice_g0=this.$FBRTCCallSummaryc;if(this.$FBRTCCallSummarye)o.ice=this.$FBRTCCallSummarye;if(this.$FBRTCCallSummarya.sender)Object.assign(o,this.$FBRTCCallSummarya.sender);return o;};n.prototype.$FBRTCCallSummaryD=function(){"use strict";var o={};if(this.$FBRTCCallSummaryd)o.ice_g0=this.$FBRTCCallSummaryd;if(this.$FBRTCCallSummaryf)o.ice=this.$FBRTCCallSummaryf;return o;};n.prototype.$FBRTCCallSummaryE=function(){"use strict";var o={};if(this.$FBRTCCallSummary4!==null){o.end_call_reason_string=g.callEndReasonString(this.$FBRTCCallSummary4);if(this.$FBRTCCallSummary5!==null)o.end_call_subreason_string=this.$FBRTCCallSummary5;o.remote_ended=this.$FBRTCCallSummary6;}if(this.$FBRTCCallSummarya.end)Object.assign(o,this.$FBRTCCallSummarya.end);return o;};n.prototype.$FBRTCCallSummaryF=function(){"use strict";var o={capture:{}};if(this.$FBRTCCallSummarya.video&&this.$FBRTCCallSummarya.video.sender)Object.assign(o,this.$FBRTCCallSummarya.video.sender);if(this.$FBRTCCallSummaryb)Object.assign(o.capture,this.$FBRTCCallSummaryb);return {sender:o,ld:this.$FBRTCCallSummaryr,rd:this.$FBRTCCallSummarys};};n.prototype.$FBRTCCallSummaryG=function(){"use strict";return (new Date()).valueOf()-this.$FBRTCCallSummary1;};n.prototype.$FBRTCCallSummaryt=function(){"use strict";var o=k()-this.$FBRTCCallSummaryg;return Math.floor(this.$FBRTCCallSummaryh+o);};n.prototype.$FBRTCCallSummaryu=function(o){"use strict";if(this.$FBRTCCallSummary3[o])return;this.$FBRTCCallSummary3[o]=this.$FBRTCCallSummaryG();this.$FBRTCCallSummaryi[o]=this.$FBRTCCallSummaryt();};n.prototype.$FBRTCCallSummaryv=function(o,p,q){"use strict";if(o){this.$FBRTCCallSummaryu(q);}else this.$FBRTCCallSummaryu(p);};n.prototype.$FBRTCCallSummaryn=function(){"use strict";this.$FBRTCCallSummary7=(new Date()).valueOf();};n.prototype.$FBRTCCallSummarym=function(){"use strict";return {device:j.deviceName,os:j.platformName,os_version:j.platformFullVersion,browser:j.browserName,browser_version:j.browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth};};e.exports=n;},null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBRTCCallSummary","FBRTCLogger","areEqual"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k='localstorage',l='RTC_CALL_SUMMARY_',m='summary',n=2000,o=3,p=3*60*1000,q=null;r.getInstance=function(){"use strict";if(!q)q=new r();return q;};function r(){"use strict";this.$FBRTCCallSummaryStore0=new g(k,l);this.$FBRTCCallSummaryStore1=i.getInstance();}r.prototype.storeCallSummary=function(s,t,u){"use strict";var v=this;this.$FBRTCCallSummaryStore2(function(w){if(!w[s])w[s]={};var x=w[s][t];if(x){var y=v.$FBRTCCallSummaryStore3(x);if(y&&y.getLastUpdatedTime()>u.getLastUpdatedTime()){v.$FBRTCCallSummaryStore1.logToConsole('Outdated summaries');return null;}}w[s][t]=v.$FBRTCCallSummaryStore4(u);return w;},v.$FBRTCCallSummaryStore1.logError.bind(v.$FBRTCCallSummaryStore1,s,t));};r.prototype.retrieveCallSummary=function(s,t){"use strict";var u=this.$FBRTCCallSummaryStore5(),v=null;if(u[s])v=u[s][t];if(v){return this.$FBRTCCallSummaryStore3(v);}else return null;};r.prototype.removeCallSummary=function(s,t){"use strict";this.removeCallSummaries([{peerID:s,callID:t}]);};r.prototype.removeCallSummaries=function(s){"use strict";var t=this;this.$FBRTCCallSummaryStore2(function(u){var v=s.length;for(var w=0;w<v;w++){var x=s[w].peerID,y=s[w].callID;if(u[x]&&u[x][y]){delete u[x][y];if(t.$FBRTCCallSummaryStore6(u[x]))delete u[x];}}return u;},t.$FBRTCCallSummaryStore1.logError.bind(t.$FBRTCCallSummaryStore1,null,null));};r.prototype.getLoggableSummaries=function(){"use strict";var s=this.$FBRTCCallSummaryStore5(),t=[];for(var u in s)if(s.hasOwnProperty(u))for(var v in s[u])if(s[u].hasOwnProperty(v)){var w=this.$FBRTCCallSummaryStore3(s[u][v],p);if(w)t.push(w);}return t;};r.prototype.$FBRTCCallSummaryStore6=function(s){"use strict";for(var t in s)if(s.hasOwnProperty(t))return false;return true;};r.prototype.$FBRTCCallSummaryStore4=function(s){"use strict";var t={__t:Date.now(),__d:s.toJsonString()};return t;};r.prototype.$FBRTCCallSummaryStore3=function(s,t){"use strict";if(s)if(!t||(Date.now()-s.__t>=t))return h.fromJsonString(s.__d);return null;};r.prototype.$FBRTCCallSummaryStore5=function(){"use strict";var s=this.$FBRTCCallSummaryStore0.get(m)||{};return s;};r.prototype.$FBRTCCallSummaryStore2=function(s,t,u,v){"use strict";if(u===(void 0)||u===null)u=o;var w=this.$FBRTCCallSummaryStore5(),x=this.$FBRTCCallSummaryStore5(),y=s(w);if(y===null)return;var z=this.$FBRTCCallSummaryStore5();if(j(x,z)){this.$FBRTCCallSummaryStore0.set(m,y);this.$FBRTCCallSummaryStore1.logToConsole('Updated summaries');}else if(u>0){t('Retry lock');if(v){var aa=this;setTimeout(function(){aa.$FBRTCCallSummaryStore2(s,t,u-1,true);},n);}else this.$FBRTCCallSummaryStore2(s,t,u-1,true);}else t('Failed to lock');};e.exports=r;},null);
__d("FBRTCExperiments",["FBRTCStruct","QE"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={},j=new g([{VIDEO_QUALITY:'rtc_www_video_quality_new'},{AUTO_DISABLE:'rtc_www_stats_interpreter_new'}]),k={setExperimentsConfig:function(l){i=l||{};},getExperiment:function(l){var m=this._getExperimentName(l);if(this._hasExperiment(m)){return i[m];}else return {};},logExposure:function(l){var m=this._getExperimentName(l);if(this._hasExperiment(m))h.logExposure(m);},_getExperimentName:function(l){return j.strNames[l];},_hasExperiment:function(l){return i.hasOwnProperty(l);}};k.QE=j;e.exports=k;},null);
__d("FBRTCScreenSharingLogger",["Log","MarauderLogger","formatDate","keyMirror"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k='webrtc_screen_sharing',l=j({P2P_VIDEO_CALL:null}),m=j({screen_sharing_action:null,screen_sharing_error:null}),n=j({PEER_ID:null,SESSION_ID:null,CONTEXT_TYPE:null,CONTENT:null}),o=j({SCREEN_SHARING_TOGGLED:null,SCREEN_SHARING_CANCELLED:null,SCREEN_SHARING_ENABLED:null,SCREEN_SHARING_DISABLED:null,SCREEN_SHARING_EXT_DIALOG:null,SCREEN_SHARING_EXT_LINK:null}),p=null;function q(){}q.getInstance=function(){if(!p)p=new q();return p;};q.prototype.logAction=function(r,s,t,u){var v={};v[m.screen_sharing_action]=t;v[n.PEER_ID]=r;v[n.SESSION_ID]=s;v[n.CONTEXT_TYPE]=l.P2P_VIDEO_CALL;v[n.CONTENT]=u;this.$FBRTCScreenSharingLogger0(m.screen_sharing_action,v);this.logToConsole(r,s,t);};q.prototype.logError=function(r,s,t){var u={};u[n.PEER_ID]=r;u[n.SESSION_ID]=s;u[n.CONTEXT_TYPE]=l.P2P_VIDEO_CALL;u[n.CONTENT]=t;this.$FBRTCScreenSharingLogger0(m.screen_sharing_error,u);this.logToConsole(r,s,t);};q.prototype.logToConsole=function(r,s,t){};q.prototype.$FBRTCScreenSharingLogger0=function(r,s){h.log(r,k,s);};q.Action=o;e.exports=q;},null);
__d("FBRTCVersionDetection",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={isChrome:function(){return !!navigator.webkitGetUserMedia;},isFirefox:function(){return !!navigator.mozGetUserMedia;},webrtcVersion:function(){if(this.isFirefox())return parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10);if(this.isChrome()){var h=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(h!==null){return parseInt(h[2],10);}else return 999;}return 0;}};e.exports=g;},null);
__d("FBRTCScreenSharingUtils",["FBRTCScreenSharingLogger","FBRTCStruct","FBRTCVersionDetection","RTCConfig","VideoCallSupport","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=l({OPEN_IN_NEW:null,WINDOW_CLOSED:null}),n=new h(['UNKNOWN','NOT_INSTALLED','INSTALLED']),o=n.UNKNOWN,p={ActionTypes:m,RECIPIENT:'SC_CONTENT_SCRIPT',isScreenSharingSupported:function(){return j.ScreenSharingGK;},isSupportedBrowser:function(){return i.isChrome()&&i.webrtcVersion()>=34;},canReceiveScreenSharing:function(){return j.ReceiveScreenGK&&k.isOSSupported()&&p.isSupportedBrowser();},isExtensionInstalled:function(){return o===n.INSTALLED;},checkExtensionInstalled:function(){if(o!==n.UNKNOWN)return;window.addEventListener('message',p.updateExtensionStatus);p._loopForExtensionStatus(5);},_loopForExtensionStatus:function(q){setTimeout(function(){setTimeout(function(){if(o===n.UNKNOWN)window.postMessage({recipient:'SC_CONTENT_SCRIPT',type:'SC_IS_EXT_INSTALLED',text:'is extension installed'},'*');},1);if(q>1)p._loopForExtensionStatus(q-1);},1000);},updateExtensionStatus:function(event){if(event.origin!=window.location.origin||!event.data.type)return;if(event.data.type==='SC_EXT_INSTALLED'){window.removeEventListener('message',p.updateExtensionStatus);o=n.INSTALLED;}},logFailedAttempt:function(q,r){g.getInstance().logAction(q,r,g.Action.SCREEN_SHARING_TOGGLED,'feature not available');}};e.exports=p;},null);
__d("FBRTCConfig",["FBRTCExperiments","FBRTCScreenSharingUtils","UserAgent"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={},k={setConfig:function(l,m,n){j=l;g.setExperimentsConfig(l.qe);},statsInterpreterConfig:function(){var l=g.getExperiment(g.QE.AUTO_DISABLE),m={};if(l.hasOwnProperty('rtt_weight'))m.rtt_weight=parseInt(l.rtt_weight,10);if(l.hasOwnProperty('frr_weight'))m.frr_weight=parseInt(l.frr_weight,10);if(l.hasOwnProperty('plr_weight'))m.plr_weight=parseInt(l.plr_weight,10);if(l.hasOwnProperty('score_threshold'))m.score_threshold=parseInt(l.score_threshold,10);if(l.hasOwnProperty('bad_score_count'))m.bad_score_count=parseInt(l.bad_score_count,10);return m;},settingsEnabled:function(){return j.enable_settings;},shouldAutoDisableVideo:function(){var l=g.getExperiment(g.QE.AUTO_DISABLE);return this._getBool(l,'disable_video',false);},shouldUseHdVideo:function(){var l=g.getExperiment(g.QE.VIDEO_QUALITY);return this._getBool(l,'hd_video',true);},unsupportedBrowserUrl:function(){if(j.troubleshooting_urls&&j.troubleshooting_urls.unsupported_browser)return j.troubleshooting_urls.unsupported_browser;return 'https://www.facebook.com/help/211644178877843';},userMediaErrorUrl:function(){if(j.troubleshooting_urls&&j.troubleshooting_urls.user_media_error)return j.troubleshooting_urls.user_media_error;return 'https://www.facebook.com/help/232232800134371';},userMediaPermissionErrorUrl:function(){if(j.troubleshooting_urls&&j.troubleshooting_urls.user_media_permission_error)return j.troubleshooting_urls.user_media_permission_error;return 'https://www.facebook.com/help/232232800134371';},supportedSignalingExperiments:function(){var l=[];if(i.isBrowser('Chrome')||i.isBrowser('Opera'))l.push('sdp_update');if(h.canReceiveScreenSharing())l.push('screen_sharing');return l;},isMessengerDotCom:function(){return j.is_messenger_dot_com;},useMessengerCallUI:function(){return j.messenger_call_ui;},shouldCreateDataChannel:function(){return j.data_channel;},disableURLManager:function(){return j.disable_url_manager;},_getBool:function(l,m,n){if(l.hasOwnProperty(m)){return l[m]==='1'||l[m]===1||l[m]==='true';}else return n;}};e.exports=k;},null);
__d("FBRTCUtils",["emptyFunction","randomInt","AsyncRequest","FBID","RTCConfig"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=6000,m={attachMediaStream:function(n,o){if(window.webkitRTCPeerConnection){n.src=window.webkitURL.createObjectURL(o);}else{n.mozSrcObject=o;n.play();}},reattachMediaStream:function(n,o){if(window.webkitRTCPeerConnection){n.src=o.src;}else{n.mozSrcObject=o.mozSrcObject;n.play();}},generateRandomInt:function(){return h(0,4294967294)+1;},aboutEqual:function(n,o){return (n-o)<.01&&(o-n)<.01;},sendServerRequest:function(n,o,p,q,r,s){o=o||g;p=p||g;q=q||false;r=r||l;s=s||{};var t=new i().setURI(n).setData(s).setAllowCrossPageTransition(true).setHandler(o).setErrorHandler(p).setTimeoutHandler(r,function(){p();});if(q)t.setOption('asynchronous',false);t.send();},isCollabCallable:function(n){return !j.isUser(n)&&k.CollaborationVideoGroupCallGK;}};e.exports=m;},null);
__d("XVideoCallInitController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/init\/",{peer_id:{type:"Int",required:true},call_id:{type:"Int",required:true},is_caller:{type:"Bool",defaultValue:false},audio_only:{type:"Bool",defaultValue:false}});},null);
__d("XVideoCallController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/videocall\/incall\/",{peer_id:{type:"Int",required:true},call_id:{type:"Int"},is_caller:{type:"Bool",defaultValue:false},audio_only:{type:"Bool",defaultValue:false}});},null);
__d("FBRTCUrlManager",["FBRTCConfig","FBRTCLogger","FBRTCUtils","XVideoCallInitController","XVideoCallController"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=3,m=function(q,r,s,t){h.getInstance().logCallAction(q,r,h.CallAction.OLD_URI);return k.getURIBuilder().setInt('peer_id',q).setInt('call_id',r).setBool('is_caller',s).setBool('audio_only',t).getURI();},n=function(q,r,s,t,u,v,w){if(w===(void 0)||w===null)w=l;var x=j.getURIBuilder().setInt('peer_id',q).setInt('call_id',r).setBool('is_caller',s).setBool('audio_only',t).getURI();i.sendServerRequest(x,function(y){u(y.payload.uri);},function(y){if(w>0){n(q,r,s,t,u,v,w-1);}else u(m(q,r,s,t));});},o=function(q){if(g.disableURLManager())return;window.history.replaceState({},'',q);},p={init:function(q){this._peerID=q;},onCallStarted:function(){o(m(this._peerID));},getCallUri:n};e.exports=p;},null);
__d("FBRTCCallUI",["BanzaiLogger","UserAgent","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","FBRTCUrlManager","pageID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=null,p={openAsCaller:function(q,r,s,t){if(!o&&window.rtcCallChildWindow){o=window.rtcCallChildWindow;window.rtcCallChildWindow=null;}if(this._shouldFocusCallWindow(q)){o.focus();return;}if(this._shouldCloseCallWindow())o.close();g.log('VideoCallLoggerConfig',{event:'open_as_caller'});l.getInstance().logCallAction(q,r,l.CallAction.START_CALL,null,s);var u=new i({peerID:q,callID:r,isCaller:true});u.onCallStarted(s);this._open(q,r,true,u,false,t);},openAsCallee:function(q,r,s,t,u){g.log('VideoCallLoggerConfig',{event:'open_as_callee'});this._open(q,r,false,s,t,u);},_shouldFocusCallWindow:function(q){return o&&!o.closed&&o.rtcCallInProgessWith===q;},_shouldCloseCallWindow:function(){return o&&!o.closed&&!o.rtcCallInProgessWith;},_open:function(q,r,s,t,u,v){var w=this._windowPosition(),x=['menubar=no','location=no','scrollbars=no','status=no','personalbar=no',w.height,w.width,w.top,w.left].join(',');if(this._isSparkBrowser())x='';t.addExtraInfo(l.Key.INITIATED_BY_PAGE_ID,n);t.onCallEnded(k.CallEndReason.CLIENT_ERROR,false,true,'PopupPending');t.save(j.getInstance());g.log('VideoCallLoggerConfig',{event:'open_popup'});if(!u){o=window.open('','Video Call',x);this._setUri(o,q,r,s,v);}else{l.getInstance().logCallAction(q,r,l.CallAction.OPEN_POPUP);o=window.open(u,'Video Call',x);}if(window.focus)o.focus();},_setUri:function(q,r,s,t,u){m.getCallUri(r,s,t,u,function(v){l.getInstance().logCallAction(r,s,l.CallAction.OPEN_POPUP);q.location=v;},function(){l.getInstance().logCallAction(r,s,l.CallAction.FAILED_GETTING_URI);});},_windowPosition:function(){var q=960,r=540,s,t,u,v;if(screen&&screen.width>1280){q=1280;r=720;}if(window.innerWidth!==(void 0)){t=window.innerWidth;s=window.innerHeight;}else{t=screen.width;s=screen.height;}if(window.screenLeft!==(void 0)){u=window.screenLeft;v=window.screenTop;}else{u=window.screenX;v=window.screenY;}var w=Math.floor(((t/2)-(q/2))+u),x=Math.floor(((s/2)-(r/2))+v);return {height:'height='+r.toString(),width:'width='+q.toString(),top:'top='+x.toString(),left:'left='+w.toString()};},_isSparkBrowser:function(){return h.isBrowser('Chrome < 34')&&h.isBrowser('Chrome > 33');}};e.exports=p;},null);
__d("FBRTCCore",["Bootloader","FBRTCAvailability","FBRTCCallUI","VideoCallSupport","invariant","randomInt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=false,n={startOutgoingCall:function(o,p,q){k(!isNaN(parseInt(o,10)));if(m)return;m=true;setTimeout(function(){m=false;},1000);if(j.isWebrtcSupported()){var r=this._generateCallID();i.openAsCaller(o,r,p,q);}else g.loadModules(["FBRTCUnsupportedBrowserMessage"],function(s){s.showForOutgoingCall();});},isAvailableForWebrtcCalling:function(o){return h.isCallable(o);},shouldEnableVideoCalling:function(){return j.isOSSupported();},_generateCallID:function(){return l(0,4294967295);}};e.exports=n;},null);
__d("FBRTCDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("FBRTCMessageListener",["Arbiter","ChannelConstants","invariant","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=[],l=null,m={init:function(){g.subscribe(h.getArbiterType('webrtc'),function(n,o){this._onMessage(o.obj);}.bind(this));},setMessageHandler:function(n,o){i(!l);l=o?n.bind(o):n;while(k.length)l(k.shift());},_onMessage:function(n){this.emit('messageReceived',n);if(l){l(n);}else k.push(n);}};j(m,{messageReceived:true});e.exports=m;},null);
__d("FBRTCCallabilityActions",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g({CALLABILITY_FETCHED:null,CALLABILITY_FETCH_ERROR:null});function i(j){this.$FBRTCCallabilityActions0=j;}i.prototype.callabilityFetched=function(j,k){this.$FBRTCCallabilityActions0.dispatch({type:h.CALLABILITY_FETCHED,userID:j,callability:k});};i.prototype.callabilityFetchError=function(j){this.$FBRTCCallabilityActions0.dispatch({type:h.CALLABILITY_FETCH_ERROR,userID:j});};i.Types=h;e.exports=i;},null);
__d("XRTCCallabilityController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/rtc\/callability\/",{user_id:{type:"Int",required:true}});},null);
__d("FBRTCCallabilityDataManager",["AsyncRequest","FBRTCCallabilityActions","XRTCCallabilityController"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';function j(k){this.$FBRTCCallabilityDataManager0=new h(k);}j.prototype.fetchCallability=function(k){var l=i.getURIBuilder().setInt('user_id',parseInt(k,10)).getURI(),m=this.$FBRTCCallabilityDataManager1.bind(this,k),n=this.$FBRTCCallabilityDataManager2.bind(this,k);new g().setURI(l).setHandler(m).setErrorHandler(n).setAllowCrossPageTransition(true).send();};j.prototype.$FBRTCCallabilityDataManager1=function(k,l){this.$FBRTCCallabilityDataManager0.callabilityFetched(k,l.payload);};j.prototype.$FBRTCCallabilityDataManager2=function(k,l){this.$FBRTCCallabilityDataManager0.callabilityFetchError(k);};e.exports=j;},null);
__d("RTCCallabilityStore",["Cache","FBRTCAvailability","FluxStore","FBRTCCallabilityActions","FBRTCCallabilityDataManager","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=.5,n=5;for(var o in i)if(i.hasOwnProperty(o))q[o]=i[o];var p=i===null?null:i.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=i;function q(r){i.call(this,r);this.$RTCCallabilityStore0=new k(r);this.$RTCCallabilityStore1=new g();}q.prototype.__onDispatch=function(r){var s=r.type;switch(s){case j.Types.CALLABILITY_FETCHED:var t=r,u=t.userID,v=t.callability;this.$RTCCallabilityStore1.set(u,v.is_callable,null,(v.is_callable?n:m));this.__emitChange();break;case j.Types.CALLABILITY_FETCH_ERROR:this.$RTCCallabilityStore1.set(r.userID,false,null,m);this.__emitChange();break;}};q.prototype.isCallable=function(r){if(h.isCallable(r))return true;if(!this.$RTCCallabilityStore1.has(r)){this.$RTCCallabilityStore0.fetchCallability(r);this.$RTCCallabilityStore1.set(r,false,null,m);}return !!(this.$RTCCallabilityStore1.get(r));};q.prototype.callButtonTooltip=function(r,s){if(this.isCallable(r))return l._("Start a video call with {shortname}",[l.param("shortname",s)]);return l._("{shortname} is currently unavailable for video calling",[l.param("shortname",s)]);};q.prototype.voiceCallButtonTooltip=function(r,s){if(this.isCallable(r))return l._("Start a voice call with {shortname}",[l.param("shortname",s)]);return l._("{shortname} is currently unavailable for voice calling",[l.param("shortname",s)]);};e.exports=q;},null);
__d("FBRTCCallabilityStore",["FBRTCDispatcher","RTCCallabilityStore"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new h(g);},null);
__d("MercuryGroupThreadMentions",["CurrentUser","ShortProfiles"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={messageMentionsViewer:function(j,k){h.get(g.getID(),function(l){k((new RegExp('@'+l.firstName,'i')).test(j.body));});}};e.exports=i;},null);
__d("MercuryDelayedDispatcher",["MercuryDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonMixin","MercuryThreadIDMap"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';function l(m){this.$MercuryDelayedDispatcher0=m;this.$MercuryDelayedDispatcher1=[];this.$MercuryDelayedDispatcher2=k.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher3=g.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher4=i.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher5=h.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher3.subscribe('model-update-completed',function(n,o){return this.$MercuryDelayedDispatcher7();}.bind(this));}l.prototype.handleUpdateWaitForThread=function(m,n){var o=this.$MercuryDelayedDispatcher2.getClientIDFromFBIDNow(n);if(o){this.$MercuryDelayedDispatcher8(m);return;}this.$MercuryDelayedDispatcher2.getClientIDFromFBID(n,function(){return this.$MercuryDelayedDispatcher1.push(m);}.bind(this));this.$MercuryDelayedDispatcher4.ensureThreadIsFetched(n);};l.prototype.$MercuryDelayedDispatcher7=function(){if(this.$MercuryDelayedDispatcher1&&this.$MercuryDelayedDispatcher1.length){var m=this.$MercuryDelayedDispatcher1[0];this.$MercuryDelayedDispatcher1=this.$MercuryDelayedDispatcher1.slice(1);this.$MercuryDelayedDispatcher8(m);}};l.prototype.$MercuryDelayedDispatcher8=function(m){if(m.from_client){this.$MercuryDelayedDispatcher3.handleUpdate(m);}else this.$MercuryDelayedDispatcher5.handleUpdate(m);};Object.assign(l,j);e.exports=l;},null);
__d("SoundPlayer",["Arbiter","Flash","URI","createArrayFromMixed"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={},l=null,m=false,n='so_sound_player',o='/swf/SoundPlayer.swf?v=1',p=null;function q(y){var z=new i(y);if(!z.getDomain())return new i(window.location.href).setPath(z.getPath()).toString();return y;}function r(y){var z=new i(y).getPath();if(/\.mp3$/.test(z))return 'audio/mpeg';if(/\.og[ga]$/.test(z))return 'audio/ogg';return '';}function s(){if(!p){var y=document.createElement('audio');if(!y||!y.canPlayType)return null;y.setAttribute('preload','auto');document.body.appendChild(y);p=y;}return p;}function t(){var y=document[n]||window[n];if(y)if(!y.playSound&&y.length)y=y[0];return (y&&y.playSound&&y.loopSound)?y:null;}function u(){return m;}function v(y,z,aa){l={path:y,sync:z,loop:aa};}function w(){m=true;if(l){var y=t();if(l.loop){y.loopSound(l.path,l.sync);}else y.playSound(l.path,l.sync);}}var x={init:function(y){y=j(y);var z;for(var aa=0;aa<y.length;++aa){z=y[aa];if(k[z])return;}var ba=s();for(aa=0;ba&&aa<y.length;++aa){z=y[aa];if(ba.canPlayType(z)){k[z]=true;return;}}k['audio/mpeg']=true;if(t())return;try{g.registerCallback(w,['sound/player_ready','sound/ready']);var da=document.createElement('div');da.id='sound_player_holder';document.body.appendChild(da);var ea=window[n]=h.embed(o,da,{allowscriptaccess:'always',wmode:'transparent'},{swf_id:n});ea.setAttribute('id',n);ea.setAttribute('width','1px');ea.setAttribute('height','1px');g.inform('sound/player_ready');}catch(ca){}},play:function(y,z){y=j(y);var aa=s(),ba,ca;for(var da=0;aa&&da<y.length;++da){ba=y[da];ca=r(ba);if(!aa.canPlayType(ca))continue;x.init([ca]);aa.src=q(ba);if(z){aa.setAttribute('loop','');}else aa.removeAttribute('loop');aa.play();return;}for(da=0;da<y.length;++da){ba=q(y[da]);ca=r(ba);if(ca!='audio/mpeg')continue;x.init([ca]);var ea=t();if(!u()){v(ba,true,z);return;}else if(ea){if(z){ea.loopSound(ba,true);}else ea.playSound(ba,true);return;}}},stop:function(y){y=j(y);for(var z=0;z<y.length;++z){var aa=q(y[z]),ba=s(),ca=t();if(ba&&ba.src==aa){ba.pause();ba.removeAttribute('src');}else ca&&ca.stopSound(aa);}}};e.exports=x;},null);
__d("SoundSynchronizer",["SoundPlayer","WebStorage","createArrayFromMixed"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j='fb_sounds_playing3';function k(){var o=h.getLocalStorage();if(o)try{var q=o[j];if(q){q=JSON.parse(q);if(Array.isArray(q))return q;}}catch(p){}return [];}function l(o){var p=h.getLocalStorage();if(p){var q=k();q.push(o);while(q.length>5)q.shift();try{p[j]=JSON.stringify(q);}catch(r){}}}function m(o){return k().some(function(p){return p===o;});}var n={play:function(o,p,q){o=i(o);p=p||(o[0]+Math.floor(Date.now()/1000));if(m(p))return;g.play(o,q);l(p);},isSupported:function(){return !!h.getLocalStorage();}};e.exports=n;},null);
__d("SoundRPC",["Event","SoundSynchronizer"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(k,l,m){h.play(k,l,m);}var j={playLocal:i,playRemote:function(k,l,m,n){var o={paths:l,sync:m,loop:n};k.postMessage(JSON.stringify(o),'*');},supportsRPC:function(){return !!window.postMessage;},_listen:function(){g.listen(window,'message',function(k){if(!/\.facebook.com$/.test(k.origin))return;var l=JSON.parse(k.data||'{}');i(l.paths,l.sync,l.loop);});}};e.exports=j;},null);
__d("Sound",["SoundInitialData","SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent_DEPRECATED","isFacebookURI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=null,o={init:function(s){if(!n)h.init(s);},play:function(s,t,u){if(n){i.playRemote(n.contentWindow,s,t,false);}else i.playLocal(s,t,u);},stop:function(s){if(!n)h.stop(s);}},p=new k(location.href);if(p.getSubdomain()&&p.getSubdomain()!=='www')p.setSubdomain('www');var q=p.getDomain();function r(){if(l.ie()<9)return false;if(g.RPC_DISABLED)return false;return j.isSupported()&&i.supportsRPC();}if(m(p)&&location.host!==q&&r()){n=document.createElement('iframe');n.setAttribute('src','//'+q+'/sound_iframe.php');n.style.display='none';document.body.appendChild(n);}e.exports=o;},null);