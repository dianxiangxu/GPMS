/*!CK:2050144189!*//*1438913974,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["0KWUH"]); }

__d("MessengerView",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={DETAIL:{COMPOSE:"detail\/compose",THREAD:"detail\/thread"},MASTER:{GROUPS:"master\/groups",PEOPLE:"master\/people",RECENT:"master\/recent"}};},null);
__d("P2PBannerType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SENDER_NUX:"SENDER_NUX",RECEIVER_NUX:"RECEIVER_NUX"};},null);
__d("P2PPasswordProtectionParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={STATUS:"status"};},null);
__d("P2PPaymentCampaignNames",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ZANGOOSE:"zangoose",SEVIPER:"seviper"};},null);
__d("P2PPaymentCreditCardsTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SENDING:1,RECEIVING:2};},null);
__d("P2PPaymentLoggerEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ACTN_ADD_CREDIT_CARD:"Actn_AddCreditCard",ACTN_UPDATE_CREDIT_CARD:"Actn_UpdateCreditCard",ACTN_REMOVE_CREDIT_CARD:"Actn_RemoveCreditCard",ACTN_UNLOCK_CREDIT_CARD:"Actn_UnlockCreditCard",ACTN_VALIDATE_CARD:"Actn_ValidateCard",ACTN_TRANSFER_MONEY:"Actn_TransferMoney",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN:"Actn_TransferMoneyWithCampaign",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN_PARENT_CALL:"Actn_TransferMoneyWithCampaignParentCall",ACTN_TRANSFER_MONEY_CHECK_NEEDS_REVERT:"Actn_TransferMoneyCheckNeedsRevert",ACTN_TRANSFER_MONEY_REVERT:"Actn_TransferMoneyRevert",ACTN_TRANSFER_MONEY_CREATE_CONTEXT:"Actn_TransferMoneyCreateContext",ACTN_ACCEPT_MONEY:"Actn_AcceptMoney",ACTN_DECLINE_MONEY:"Actn_DeclineMoney",ACTN_SET_PRIMARY:"Actn_SetPrimary",ACTN_WITHDRAW_MONEY:"Actn_WithdrawMoney",ACTN_GRAPH_API_GENERIC_WRITE:"Actn_GraphApiGenericWrite",ACTN_SEND_TRANSFER_MESSAGE:"Actn_SendTransferMessage",ACTN_SEND_TRANSFER_EMAIL:"Actn_SendTransferEmail",ACTN_SEND_EXPIRE_NOTIFICATIONS:"Actn_SendExpireNotifications",ACTN_SEND_TRANSFER_MESSAGE_QUEUED:"Actn_SendTransferMessageQueued",ACTN_CREATE_PAYMENT_REQUEST:"Actn_CreatePaymentRequest",ACTN_ACCEPT_PAYMENT_REQUEST:"Actn_AcceptPaymentRequest",ACTN_DECLINE_PAYMENT_REQUEST:"Actn_DeclinePaymentRequest",ACTN_AUTH_FOR_SENDER_REVIEW:"Actn_AuthForSenderReview",ACTN_COMPLETE_SENDER_REVIEW:"Actn_CompleteSenderReview",ACTN_COMPLETE_RECEIVER_REVIEW:"Actn_CompleteReceiverReview",ACTN_SUBMIT_VERIFICATION_STEP:"Actn_SubmitVerificationStep",ACTN_COMPLETE_SENDER_VERIFICATION:"Actn_CompleteSenderVerification",ACTN_COMPLETE_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_VERIFICATION:"Actn_CancelSenderVerification",ACTN_CANCEL_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_RISK:"Actn_CancelSenderRisk",ACTN_CANCEL_EXPIRE:"Actn_CancelExpire",ACTN_CANCEL_FOR_SAME_CARD:"Actn_CancelForSameCard",ACTN_CANCEL_BY_CUSTOMER_SERVICE:"Actn_CancelByCustomerService",ACTN_CANCEL_RECEIVER_REVIEW:"Actn_CancelReceiverReview",ACTN_CANCEL_SENDER_REVIEW:"Actn_CancelSenderReview",ACTN_CANCEL_ALL_PENDING_TRANSFERS:"Actn_CancelAllPendingTransfers",ACTN_ADD_PIN:"Actn_AddPIN",ACTN_UPDATE_PIN:"Actn_UpdatePIN",ACTN_REMOVE_PIN:"Actn_RemovePIN",ACTN_RESET_PIN:"Actn_ResetPIN",ACTN_ENABLE_TOUCH_ID:"Actn_EnableTouchID",ACTN_VERIFY_TOUCH_ID:"Actn_VerifyTouchID",ACTN_DISABLE_TOUCH_ID:"Actn_DisableTouchID",ACTN_CHANNEL_NOTIF_CARD_EVENT:"Actn_ChannelNotifCardEvent",ACTN_CHANNEL_NOTIF_TRANSFER_STATUS_EVENT:"Actn_ChannelNotifTransferStatusEvent",UI_ACTN_INITIATE_SEND:"UI_Actn_Initiate_Send",UI_ACTN_CANCEL_SEND:"UI_Actn_Send_Money_Cancelled",UI_ACTN_INITIATE_ADD_CARD:"UI_Actn_Initiate_Add_Card",UI_ACTN_INITIATE_CHOOSE_CARD:"UI_Actn_Initiate_Choose_Card",UI_ACTN_CANCEL_ADD_CARD:"UI_Actn_Cancel_Add_Card",UI_ACTN_CONFIRM_CARD_DETAILS:"UI_Actn_Confirm_Card_Details",UI_ACTN_ACCEPT_MONEY_CANCEL:"UI_Actn_Accept_Money_Cancel",UI_ACTN_ACCEPT_WITH_CARD:"UI_Actn_Accept_With_Card",UI_ACTN_ADD_CARD_SUCCESS:"UI_Actn_Add_Card_Success",UI_ACTN_ADD_CARD_FAIL:"UI_Actn_Add_Card_Fail",UI_ACTN_CONFIRM_SEND:"UI_Actn_Confirm_Send",UI_ACTN_SEND_SUCCESS:"UI_Actn_Send_Success",UI_ACTN_SEND_MONEY_CANCELLED:"UI_Actn_Send_Money_Cancelled",UI_ACTN_SEND_FAIL:"UI_Actn_Send_Fail",UI_ACTN_INITIATE_EDIT_CARD:"UI_Actn_Initiate_Edit_Card",UI_ACTN_CANCEL_EDIT_CARD:"UI_Actn_Cancel_Edit_Card",UI_ACTN_CONFIRM_EDIT_CARD_DETAILS:"UI_Actn_Confirm_Edit_Card_Details",UI_ACTN_EDIT_CARD_SUCCESS:"UI_Actn_Edit_Card_Success",UI_ACTN_EDIT_CARD_FAIL:"UI_Actn_Edit_Card_Fail",UI_ACTN_INITIATE_REMOVE_CARD:"UI_Actn_Initiate_Remove_Card",UI_ACTN_CONFIRM_REMOVE_CARD:"UI_Actn_Confirm_Remove_Card",UI_ACTN_REMOVE_CARD_SUCCESS:"UI_Actn_Remove_Card_Success",UI_ACTN_REMOVE_CARD_FAIL:"UI_Actn_Remove_Card_Fail",UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX:"UI_Actn_Initiate_Password_Protection_NUX",UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_In_Password_Protection_NUX",UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_Out_Password_Protection_NUX",UI_ACTN_ENABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Enabled_Password_Protection_Setting",UI_ACTN_DISABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Disabled_Password_Protection_Setting",UI_ACTN_SEND_CLICKED:"UI_Actn_Send_Clicked",UI_ACTN_VERIFY_CSC:"UI_Actn_Verify_CSC",UI_ACTN_CONFIRM_AMOUNT:"UI_Actn_Confirm_Amount",UI_ACTN_EDIT_CARD:"UI_Actn_Edit_Card",UI_ACTN_CHANGE_CARD:"UI_Actn_Change_Card",UI_ACTN_INITIATE_SEND_TRIGGER:"UI_Actn_Initiate_Send_Trigger",UI_ACTN_INITIATE_GROUP_SEND:"UI_Actn_Initiate_Group_Send",UI_ACTN_GROUP_SEND_CANCELLED:"UI_Actn_Group_Send_Cancelled",UI_ACTN_INITIATE_GROUP_SEND_TRIGGER:"UI_Actn_Initiate_Group_Send_Trigger",UI_ACTN_GROUP_SEND_RECIPIENT_PICKED:"UI_Actn_Group_Send_Recipient_Picked",UI_ACTN_3RD_PARTY_RECEIPT_SHOWN:"UI_Actn_3rd_Party_Receipt_Shown",UI_ACTN_3RD_PARTY_RECEIPT_DISMISSED:"UI_Actn_3rd_Party_Receipt_Dismissed",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CLICKED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Clicked",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CANCELLED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Cancelled",UI_ACTN_CHAT_THREAD_BANNER_CLICKED:"UI_Actn_Chat_Thread_Banner_Clicked",UI_ACTN_CHAT_THREAD_BANNER_VIEWED:"UI_Actn_Chat_Thread_Banner_Viewed",UI_ACTN_CHAT_THREAD_BANNER_DISMISSED:"UI_Actn_Chat_Thread_Banner_Dismissed",UI_ACTN_INITIATE_MONEYPENNY_ORDER:"UI_Actn_Initiate_Moneypenny_Order",UI_ACTN_CONFIRM_MONEYPENNY_ORDER:"UI_Actn_Confirm_Moneypenny_Order",UI_ACTN_MONEYPENNY_ORDER_FAIL:"UI_Actn_Moneypenny_Order_Fail",UI_ACTN_MONEYPENNY_ORDER_SUCCESS:"UI_Actn_Moneypenny_Order_Success",UI_ACTN_MONEYPENNY_ORDER_CANCEL:"UI_Actn_Moneypenny_Order_Cancel",UI_ACTN_FRIEND_PICKER_SEARCH:"UI_Actn_Friend_Picker_Search",UI_ACTN_FRIEND_PICKER_SELECT:"UI_Actn_Friend_Picker_Select",UI_ACTN_FI_CANCEL:"UI_Actn_FI_Cancel",UI_ACTN_FI_SUCCESS_DIALOG_NEXT:"UI_Action_Success_Dialog_Next",UI_ACTN_FI_BANNER_DISMISSED:"UI_Actn_FI_Banner_Dismissed",UI_ACTN_FI_BANNER_IMPRESSION:"UI_Actn_FI_Banner_Impression",UI_ACTN_INCENTIVE_TRANSFER_SUCCESS:"UI_Actn_Incentive_Transfer_Success",UI_ACTN_INCENTIVE_TRANSFER_FAILURE:"UI_Actn_Incentive_Transfer_Failure"};},null);
__d("P2PPaymentLoggerEventFlow",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={UI_FLOW_P2P_SEND:"UI_Flow_P2P_Send",UI_FLOW_P2P_RECEIVE:"UI_Flow_P2P_Receive",UI_FLOW_P2P_SETTINGS:"UI_Flow_P2P_Settings",UI_FLOW_P2P_GROUP_SEND:"UI_Flow_P2P_Group_Send",UI_FLOW_RECEIVER_NUX_CHAT_THREAD_BANNER:"UI_Flow_Receiver_NUX_Chat_Thread_Banner",UI_FLOW_SENDER_NUX_CHAT_THREAD_BANNER:"UI_Flow_Sender_NUX_Chat_Thread_Banner",UI_FLOW_MONEYPENNY_CHECKOUT:"UI_Flow_Moneypenny_Checkout",UI_FLOW_FINANCIAL_INCENTIVES:"UI_Flow_Financial_Incentives"};},null);
__d("P2PTransferParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TRANSFER_ID:"transfer_id",STATUS:"status",SENDER_STATUS:"sender_status",RECEIVER_STATUS:"receiver_status",RISK_RESULT:"risk_result"};},null);
__d("AppsDivebarDisplayController",["AppsDivebarConfigData","AsyncRequest","Arbiter","CSS","UIPagelet","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m='173',n={isVisible:function(){if(typeof(this._visible)!='undefined')return this._visible;this._visible=!g.hidden;return this._visible;},showApps:function(){this._visible=true;var o={fb_source_category:'sidebar'};k.loadFromEndpoint('GamesDivebarPagelet','pagelet_canvas_nav_content',o);j.show('apps_gripper');j.show('pagelet_canvas_nav_content');j.addClass('pagelet_canvas_nav_content',"_4woj");i.inform('AppsDivebar/show-apps');new h('/ajax/feed/apps/resize').setData({height:''+m,menu:true}).setMethod('POST').send();},hideApps:function(){this._visible=false;j.hide('pagelet_canvas_nav_content');j.hide('apps_gripper');i.inform('AppsDivebar/hide-apps');new h('/ajax/feed/apps/resize').setData({height:'1',menu:true}).setMethod('POST').send();}};e.exports=n;},null);
__d("AsyncLoader",["AsyncRequest","BaseAsyncLoader"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j,k){this._endpoint=j;this._type=k;}Object.assign(i.prototype,h.prototype);i.prototype.send=function(j,k,l,m,n){new g(j).setData({ids:k}).setHandler(m).setErrorHandler(n).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};e.exports=i;},null);
__d("BuddyListNub",["Arbiter","AvailableList","ChannelConnection","ChannelConstants","ChatConfig","ChatSidebarActions","ChatVisibility","CSS","Dock","DOM","Event","JSLogger","JSXDOM","KeyEventController","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","Style","Toggler","csx","cx","setTimeoutAcrossTransitions","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){b.__markCompiled&&b.__markCompiled();var ga=32,ha=k.get('divebar_new_design',false),ia=r.create('buddylist_nub');for(var ja in v)if(v.hasOwnProperty(ja))la[ja]=v[ja];var ka=v===null?null:v.prototype;la.prototype=Object.create(ka);la.prototype.constructor=la;la.__superConstructor__=v;function la(ma,na,oa){"use strict";v.call(this);ka.init.call(this,ma);this.root=ma;this.orderedList=na;this.typeahead=oa;this.button=p.find(ma,'a.fbNubButton');this.unreadCount=p.find(ma,"span._5ayx");this.label=p.find(ma,'span.label');this.body=p.scry(ma,'div.fbNubFlyoutBody')[0];this.container=x.byClass(ma,"_56ox");this.typeaheadContainer=p.find(ma,'.fbChatTypeaheadViewContainer');var pa=p.find(ma,'div.fbNubFlyoutTitlebar');ba.createInstance(pa).setSticky(false);if(ha)ba.createInstance(ma).setSticky(true);na.subscribe('render',this.flyoutContentChanged.bind(this));na.setScrollContainer(this.body);h.subscribe('buddylist/availability-changed',this._updateCount.bind(this));g.subscribe('chat/connect',this._handleConnect.bind(this));g.subscribe('chat/option-changed',function(qa,ra){if(ra.name=='hide_groups')this.onResize();}.bind(this));y.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=p.find(ma,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;i.subscribe(i.CONNECTED,this._handleChannelConnected.bind(this));i.subscribe(i.SHUTDOWN,this._handleChannelShutdown.bind(this));i.subscribe(i.RECONNECTING,this._handleChannelReconnecting.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));q.listen(ma,'keydown',this._onKeyDown.bind(this));q.listen(this.button,'click',this.onButtonClick.bind(this));t.registerKey('q',function(event){if(this._isOpen){oa.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}.bind(this));oa.getCore().subscribe('escape',this.hide.bind(this));oa.subscribe(['respond','reset'],function(qa,ra){if(this._isOpen){if(ra&&ra.value&&ra.value===oa.getCore().getValue()&&oa.getView().isVisible()){o.setUseMaxHeight(this.root,false);this._hideBuddyList();}else this._showBuddyList();this.flyoutContentChanged();}}.bind(this));g.subscribe('sidebar/show',this.hide.bind(this));g.subscribe('minisidebar/show',this.hide.bind(this));g.subscribe('sidebar/hide',this._onSidebarHide.bind(this));this._orderedListCount=w.getList().length;if(ha){aa.set(this.body,'max-height','285px');this.show();}g.inform('buddylist-nub/initialized',this,g.BEHAVIOR_PERSISTENT);this._handleVisibilityChange();ia.log('buddylist_initialized');}la.prototype.getButton=function(){"use strict";return this.button;};la.prototype.getRoot=function(){"use strict";return this.root;};la.prototype._handleConnect=function(ma){"use strict";this._updateView(true);};la.prototype._getShutdownReason=function(ma){"use strict";switch(ma){case j.HINT_AUTH:return fa._("Your session has timed out. Please log in.");case j.HINT_CONN:return fa._("Facebook {Chat} is currently unavailable.",[fa.param("Chat",fa._("Chat"))]);case j.HINT_MAINT:return fa._("Facebook {Chat} is currently down for maintenance.",[fa.param("Chat",fa._("Chat"))]);default:return fa._("Facebook {Chat} is currently unavailable.",[fa.param("Chat",fa._("Chat"))]);}};la.prototype._getReconnectMsg=function(ma){"use strict";var na;if(ma===null||false===navigator.onLine){na=fa._("Unable to connect to chat. Check your Internet connection.");}else if(ma>j.WARNING_COUNTDOWN_THRESHOLD_MSEC){var oa=p.create('a',{href:'#',className:'fbChatReconnectLink'},fa._("Try again")),pa=p.create('div',null,oa);na=p.create('div',{},fa._("Unable to connect to chat."));p.appendContent(na,pa);}else if(ma>1000){na=fa._("Unable to connect to chat. Reconnecting in {seconds}...",[fa.param("seconds",Math.floor(ma/1000))]);}else na=fa._("Unable to connect to chat. Reconnecting...");return na;};la.prototype._resetShowWarningTimeout=function(){"use strict";if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};la.prototype._handleChannelConnected=function(ma){"use strict";this._resetShowWarningTimeout();if(this.orderedList.isVisible())m.goOnline();this.warningMsgText=null;this._updateView();};la.prototype._handleChannelShutdown=function(ma,na){"use strict";this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(na);this._updateView();};la.prototype._handleChannelReconnecting=function(ma,na){"use strict";this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(na);if(na>1000){if(na>j.WARNING_COUNTDOWN_THRESHOLD_MSEC){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=q.listen(this.message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}.bind(this));}this.showWarningTimeout=ea(this._handleChannelReconnecting.bind(this,ma,na-1000),1000);}this._updateView();};la.prototype._tryReconnect=function(){"use strict";if(i.disconnected())i.reconnect();};la.prototype._handleVisibilityChange=function(){"use strict";this._updateView();if(!m.isOnline())this.hide();};la.prototype._updateView=function(ma){"use strict";var na=this.container;if(na){n.conditionClass(na,'offline',!m.isOnline());n.conditionClass(na,'error',i.disconnected());}if(i.disconnected())p.setContent(this.message,this.warningMsgText);var oa,pa;if(!m.isOnline()){oa=fa._("{Chat} (Off)",[fa.param("Chat",fa._("Chat"))]);}else if(i.disconnected()){oa=fa._("{Chat} (Disconnected)",[fa.param("Chat",fa._("Chat"))]);}else{var qa=z.getOnlineCount();if(qa){var ra=s.span({className:"count"},"(",qa,")");oa=fa._({"*":"{Chat} {number-available}"},[fa.param("Chat",fa._("Chat")),fa.param("number-available",ra,[0,qa])]);}else{oa=fa._("Chat");pa=true;}}this._setUnread(this._unreadMessageCount);this._setLabel(oa,pa);this.buttonContentChanged();};la.prototype.onButtonClick=function(){"use strict";if(n.shown(this.typeahead.getElement())){var ma=this.subscribe('show',function(){this.typeahead.getCore().getElement().focus();}.bind(this));setTimeout(this.unsubscribe.bind(this,ma),0);}};la.prototype.onHide=function(){"use strict";this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this._hideBuddyList();this.typeahead.getCore().reset();};la.prototype._onKeyDown=function(event){"use strict";var ma=q.getKeyCode(event);if(ma===u.ESC&&!n.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(ma==u.RETURN)l.enable();};la.prototype._onSidebarHide=function(event){"use strict";if(ha){this.show();}else this.getButton().focus();};la.prototype.onResize=function(){"use strict";var ma=o.getMaxFlyoutHeight(this.root)-60,na=Math.max(250,ma);this.orderedList.setNumTopFriends(Math.floor(na/ga));};la.prototype._showBuddyList=function(){"use strict";if(!this._buddyListRenderSubscription)this._buddyListRenderSubscription=this.orderedList.subscribe('render',o.setUseMaxHeight.bind(o,this.root,false));n.hide(this.typeaheadContainer);this.orderedList.show();ia.bump('buddylist_show');};la.prototype._hideBuddyList=function(){"use strict";n.show(this.typeaheadContainer);this.orderedList.hide();ia.bump('buddylist_hide');};la.prototype.onShow=function(){"use strict";this._isOpen=true;if(i.disconnected()){this._tryReconnect();this._showBuddyList();}else m.goOnline(this._showBuddyList.bind(this));};la.prototype._setLabel=function(ma,na){"use strict";var oa=this.label.textContent||this.label.innerText;if(oa!==ma){var pa=this.label.cloneNode(true);p.setContent(pa,ma);p.replace(this.label,pa);this.label=pa;}this.throbber&&n.conditionShow(this.throbber,!!na);};la.prototype._setUnread=function(ma){"use strict";n.conditionShow(this.unreadCount,!!ma);if(ma){ma=s.span({className:"_51jx _5ayw"},ma);p.setContent(this.unreadCount,ma);}};la.prototype._updateCount=function(){"use strict";this._updateView();};e.exports=la;},null);
__d("ChatHovercard",["Arbiter","AsyncLoader","Bootloader","JSLogger","debounce"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=5,m=new h('/ajax/chat/hovercard/sidebar.php','hover'),n=j.create('chat_hovercard');g.subscribe('Hovercard/dirty',m.reset.bind(m));function o(s,t){m.get(s,function(u){setTimeout(function(){if(!u){n.error('fetch_failure',{id:s});return;}i.loadModules(["Hovercard"],function(v){var w=v.getDialog(u);if(!w){n.error('no_hovercard',{id:s,endpoint:u});return;}if(s==t.getActiveID())t.showHovercard(s,w);});},0);});}function p(s,t){var u=[];function v(y){if(y>=0&&y<s.length)u.push(s[y]);}var w=s.indexOf(t);if(w>-1){v(w);for(var x=1;x<l;x++){v(w+x);v(w-x);}}return u.filter(function(y){return y;});}function q(s,t){var u=t.getActiveID();if(u){var v=s.getShowingUsers(),w=p(v,u);m.get(w,function(){});}}function r(s){var t=s.getHoverController();t.registerDefault(o);t.subscribe('hover',k(q.bind(null,s,t),100));}e.exports=r;},null);
__d("ChatOrderedListHover",["ArbiterMixin","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","cx","mixin","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();function q(w){h.addClass(w,'fetching');}function r(w){h.removeClass(w,'fetching');}var s=n(g);for(var t in s)if(s.hasOwnProperty(t))v[t]=s[t];var u=s===null?null:s.prototype;v.prototype=Object.create(u);v.prototype.constructor=v;v.__superConstructor__=s;function v(w){"use strict";s.call(this);this._orderedList=w;this._root=w.getRoot();j.listen(this._root,'mouseover',this._mouseOver.bind(this));j.listen(this._root,'mouseleave',this._mouseLeave.bind(this));w.subscribe('click',p(this._hide,this));}v.prototype._mouseOver=function(event){"use strict";if(this._paused)return;var w=event.getTarget(),x=l.byClass(w,"_42fz")||l.byClass(w,"_5a58");x&&this._setActiveItem(x);};v.prototype._mouseLeave=function(event){"use strict";this._setActiveItem(null);};v.prototype._clearTimeouts=function(){"use strict";this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};v.prototype._hide=function(){"use strict";if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};v.prototype._show=function(){"use strict";var w=this.getActiveID(),x=false;if(this._defaultHandler){x=true;i.applyWithGuard(this._defaultHandler,{},[w,this]);}if(x&&this._showingID!=this.getActiveID())q(this._activeItem);};v.prototype._setActiveItem=function(w){"use strict";if(w!=this._activeItem){this._clearTimeouts();this._activeItem&&r(this._activeItem);this._activeItem=null;var x=w?0:100;this._hideTimeout=o(function(){if(this.getActiveID()!=this._showingID)this._hide();}.bind(this),x);if(w){this._activeItem=w;var y=x+500;this._showTimeout=o(function(){this._show();}.bind(this),y);this.inform('hover');}else this.inform('leave');}};v.prototype.registerDefault=function(w){"use strict";this._defaultHandler=w;};v.prototype.getActiveID=function(){"use strict";var w=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return w||null;};v.prototype.showHovercard=function(w,x){"use strict";if(w==this.getActiveID()&&w!=this._showingID){this._clearTimeouts();r(this._activeItem);this._hide();this._showingDialog=x;this._showingID=w;var y=x.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),z=x.subscribe('mouseleave',function(){y.unsubscribe();this._setActiveItem(null);}.bind(this)),aa=x.subscribe('hide',function(){this.inform('hovercard_hide');y.unsubscribe();z.unsubscribe();aa.unsubscribe();}.bind(this));x.enableBehavior(k).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};Object.assign(v.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});e.exports=v;},null);
__d("ChatSidebarConstants",["ChatConfig"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=g.get('divebar_new_design',false),i={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:h?32:28};Object.assign(i,{getImageSize:function(j){if(j===false)return i.IMAGE_SIZE;return i.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(j){if(h)return i.IMAGE_SIZE+8;if(j===false)return i.IMAGE_SIZE+4;return i.LITESTAND_CLASSIC_SIZE+4;}});e.exports=i;},null);
__d("ChatSidebarItem.react",["AvailableListConstants","XUIBadge.react","ChatConfig","ChatSidebarConstants","Image.react","Link.react","ReactComponentWithPureRenderMixin","React","SplitImage.react","TextWithEmoticons.react","Timestamp.react","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=n,u=t.PropTypes,v=i.get('divebar_new_design',false),w=9,x=n.createClass({displayName:"ChatSidebarItem",mixins:[m],propTypes:{image:u.string,images:u.array,birthday:u.bool,context:u.string,detailedStatus:u.string,href:u.string,imageSize:u.number,name:u.string,onClick:u.func,status:u.number,statusTime:u.string,unreadCount:u.number,nowData:u.object},render:function(){var y=(("_55ln")+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount?' '+"_5bom":'')+(v?' '+"_55za":'')),z=(("_55lr")+(this.props.nowData&&this.props.nowData.location?' '+"_3zz8":''));return (n.createElement(l,{className:y,href:{url:this.props.href},onClick:this.props.onClick,rel:"ignore"},n.createElement("div",{className:"_55lp"},n.createElement("div",{className:"_56p9"},n.createElement(o,{size:this.props.imageSize||j.IMAGE_SIZE,srcs:this.props.image||this.props.images}),n.createElement("div",{className:"_568w"})),n.createElement("div",{className:"_5bon"},this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),n.createElement("div",{className:z},n.createElement(p,{renderEmoticons:true,renderEmoji:true,text:this.props.name}),this.renderLocation()),n.createElement("div",{className:"_55ls"},this.props.context))));},renderUnreadCount:function(){var y=this.props.unreadCount;if(!y)return null;return (n.createElement(h,{count:y,maxcount:w,type:"regular"}));},renderLocation:function(){if(i.get('badger_www_nub')&&this.props.nowData&&this.props.nowData.location)return (n.createElement("span",{className:"_3zz9"},this.props.nowData.location));return null;},renderStatus:function(){if(i.get('badger_www_nub')&&this.props.nowData&&this.props.nowData.icon&&this.props.nowData.background_color){var y=this.props.nowData,z={backgroundColor:'#'+y.background_color},aa=y.icon.filepath?'/'+y.icon.filepath:y.icon.uri,ba=n.createElement(k,{className:"_568_ _5jvt",src:aa,style:z}),ca=n.createElement(q,{className:"_568-",minimize:true,time:this.props.nowData.timestamp});return (n.createElement("div",{className:"_568z"},ca,ba));}var da=this.getStatusSrc();if(!da&&!this.props.statusTime)return null;var ea=da?n.createElement(k,{className:"_568_",src:da}):null,fa=true,ga=this.props.unreadCount||0;if(i.get('remove_lat')){ea=this.props.statusTime?null:ea;fa=false;}else if(ga>0){ea=this.props.statusTime?null:ea;fa=false;}return (n.createElement("div",{className:"_568z"},fa?this.renderLastActiveTime():null,this.renderDetailedPresence(),ea));},renderLastActiveTime:function(){return (n.createElement("div",{className:"_568-"},this.props.statusTime));},renderDetailedPresence:function(){if(i.get('remove_surface')){return null;}else{var y=this.props.unreadCount||0;if(y>0)return null;}return (n.createElement("div",{className:"_5t35"},this.props.detailedStatus));},renderBirthday:function(){if(!this.props.birthday)return null;var y=s('/images/gifts/icons/cake_icon.png');return (n.createElement(k,{className:"_5dv3",src:y}));},getStatusSrc:function(){switch(this.props.status){case g.ACTIVE:return v?s('/images/chat/sidebar/buddylist_nub/greenDot.png'):s('/images/litestand_classic/sidebar/online.png');case g.MOBILE:return v?s('/images/chat/sidebar/buddylist_nub/phone.png'):s('/images/litestand_classic/sidebar/pushable.png');}return null;}});e.exports=x;},null);
__d("Tooltip.react",["React","TooltipMixin"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g,j=i.PropTypes,k=g.createClass({displayName:"Tooltip",propTypes:{display:j.oneOf(['inline','block'])},getDefaultProps:function(){return {display:'inline'};},mixins:[h],render:function(){if(this.props.display==='block')return (g.createElement("div",g.__spread({},this.props),this.props.children));return g.createElement("span",g.__spread({},this.props),this.props.children);}});e.exports=k;},null);
__d("ChatSidebarThread.react",["ChatSidebarItem.react","ChatOpenTab","WebMessengerPermalinkConstants","React","MercuryThreadMetadataRawRenderer","Tooltip.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=j,o=n.PropTypes,p=j.createClass({displayName:"ChatSidebarThread",getInitialState:function(){return {maxNumParticipantsToRender:10};},propTypes:{image:o.string,imageSize:o.number,name:o.string,participants:o.array,numOtherParticipants:o.number,referrer:o.string,status:o.number,threadFBID:o.string,unreadCount:o.number},_renderParticipants:function(){var s=[],t=this.props.participants.length,u=this.props.numOtherParticipants,v=Math.min(this.state.maxNumParticipantsToRender,t);if(u-v==1)v--;for(var w=0;w<v;w++){var x=this.props.participants[w];s.push(j.createElement("li",{key:x.id},x.name));}if(v<u)s.push(j.createElement("li",{key:"more-participants"},m._("and {num} more...",[m.param("num",u-v)])));return (j.createElement("ul",null,s));},render:function(){var s=this.props.name,t=q(this.props.threadFBID,this.props.participants,this.props.numOtherParticipants),u=s?t:undefined,v=i.getURIPathForThreadID(this.props.threadFBID),w=r(this.props.image,this.props.participants),x=s?s:t;return (j.createElement(l,{display:"block",position:"above",tooltip:this._renderParticipants()},j.createElement(g,{context:u,href:v,imageSize:this.props.imageSize,image:this.props.image,images:w,name:x,onClick:this._openTab,referrer:this.props.referrer,status:this.props.status,unreadCount:this.props.unreadCount})));},_openTab:function(s){s.preventDefault();h.openThread(this.props.threadFBID,this.props.referrer);}});function q(s,t,u){return k.renderRawParticipantList(s,t,u,{names_renderer:k.renderShortNames});}function r(s,t){if(s)return null;return t.map(function(u){return u.image_src;});}e.exports=p;},null);
__d("ChatSidebarGroupThreadsGroup.react",["ChannelConnection","ChatSidebarThread.react","ChatSidebarSections","ChatSidebarConstants","PresencePrivacy","PresenceStatus","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=m,p=o.PropTypes,q=m.createClass({displayName:"ChatSidebarGroupThreadsGroup",propTypes:{groups:p.array.isRequired},render:function(){return (m.createElement("ul",null,this.props.groups.map(this._renderGroup)));},_renderGroup:function(r){var s=r.mercury_thread.participants,t=g.disconnected()||k.isUserOffline();return (m.createElement("li",{className:(("_42fz")+(t?' '+"_570-":'')),"data-id":r.uid,key:r.uid},m.createElement(h,{image:r.mercury_thread.image_src,imageSize:j.getImageSize(),name:r.mercury_thread.name,participants:r.participants_to_render,numOtherParticipants:s.length-1,referrer:i.ORDERED_LIST,status:l.getGroup(s),threadFBID:r.uid})));}});e.exports=q;},null);
__d("ChatSidebarLog",["AsyncSignal","Banzai","BanzaiLogger","Bootloader","ChatPerfEvent","csx","DOM","ErrorUtils","ModuleDependencies","JSLogger","Run","performanceAbsoluteNow"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s=p.create('chat_sidebar_load'),t=null,u=null,v=false,w=(Math.random()*2147483648|0).toString(36),x=Date.now(),y=null,z=false;q.onLoad(function(){v=true;});try{d(['ChatSidebarStore','ChatSidebarVisibility'],function(ga,ha){t=ga;u=ha;});}catch(aa){s.warn('exception',{reason:aa.toString()});}function ba(ga,ha){if(ga&&ga.length>ha)return ga[ha];return null;}function ca(ga){if(ga.name=='SyntaxError'||/syntaxerror/i.test(ga.message))z=true;}function da(){if(!y)y=i.create(Object.assign({retry:true},h.VITAL));return y;}function ea(ga,ha){setTimeout(function(){var ia=o.getMissing('ChatSidebar'),ja=j.getErrorUrls(),ka=j.getLoadingUrls(),la=[];for(var ma in ka)la.push({url:ma,time:ka[ma]});la.sort(function(ta,ua){return ua.time-ta.time;});var na={};for(var oa=0,pa=la.length;oa<pa;oa++)na[la.url]=la.time;var qa={start_gap:x-j.getStartTime(),page_loaded:v,page_id:w,timeout:ga,missing_total:ia?ia.length:null,module_1:ba(ia,0),module_2:ba(ia,1),module_3:ba(ia,2),error_url_total:ja.length,error_url_1:ba(ja,0),error_url_2:ba(ja,1),error_url_3:ba(ja,2),loading_url_total:la.length,loading_url_1:ba(la,0)?ba(la,0).url:null,loading_time_1:ba(la,0)?ba(la,0).time:null,loading_url_2:ba(la,1)?ba(la,1).url:null,loading_time_2:ba(la,1)?ba(la,1).time:null,loading_url_3:ba(la,2)?ba(la,2).url:null,loading_time_3:ba(la,2)?ba(la,2).time:null},ra=null;if(!t){s.warn('require_'+ga,{missing:ia});ra='require';}if(t&&!t.isInitialized()){s.warn('init_'+ga,{missing:ia});ra='init';}if(t&&t.isInitialized()&&t.isEnabled()&&u&&u.shouldShowSidebar()){var sa=m.scry(ha,"._42fz");if(!sa||sa.length===0){s.warn('render_'+ga,{missing:ia});ra='render';}}if(ra){qa.symptom=ra;new g('/ajax/chat/sidebar_load.php',qa).send();da().log('SidebarLoadFailureLoggerConfig',{start_gap:x-j.getStartTime(),page_loaded:v,page_id:w,timeout:ga,symptom:ra,has_syntax_error:z});}},ga);}var fa={start:function(ga){this._serverStartTime=r();n.addListener(ca);ea(5000,ga);ea(10000,ga);ea(15000,ga);ea(30000,ga);ea(60000,ga);},logRendered:function(){if(this._loggedPerformance)return;var ga=r();if(this._serverStartTime)i.log('ChatPerfLoggerConfig',{event:k.SIDEBAR_FROM_SERVER_TTI,duration:ga-this._serverStartTime});var ha=t&&t.getInitTime();if(ha)i.log('ChatPerfLoggerConfig',{event:k.SIDEBAR_FROM_CLIENT_TTI,duration:ga-ha});this._loggedPerformance=true;}};e.exports=fa;},null);
__d("ChatSidebarUser.react",["ChatOpenTab","ChatSidebarItem.react","WebMessengerPermalinkConstants","ReactComponentWithPureRenderMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=k,m=l.PropTypes,n=k.createClass({displayName:"ChatSidebarUser",mixins:[j],propTypes:{birthday:m.bool,detailedStatus:m.string,image:m.string,imageSize:m.number,name:m.string,sectionName:m.string.isRequired,slot:m.number,status:m.number,statusTime:m.string,unreadCount:m.number,userID:m.string.isRequired,nowData:m.object},_openTab:function(event){g.openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});return event.preventDefault();},render:function(){var o=i.getURIPathForIDOrVanity(this.props.userID);return (k.createElement(h,{onClick:this._openTab,href:o,imageSize:this.props.imageSize,image:this.props.image,name:this.props.name,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,detailedStatus:this.props.detailedStatus,context:this.props.context,unreadCount:this.props.unreadCount,nowData:this.props.nowData}));}});e.exports=n;},null);
__d("ChatUnreadCount",["ArbiterMixin","ChatConfig","Map","MercuryIDs","MercurySingletonMixin","MercuryThreadInformer","MercuryThreads","MercuryUnreadState","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=o(g);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";p.call(this);this.$ChatUnreadCount0=t;this.$ChatUnreadCount1=l.getForFBID(t);this.$ChatUnreadCount2=m.getForFBID(t);this.$ChatUnreadCount3=new i();this.$ChatUnreadCount4=n.getForFBID(t);this.setupSubscriptions();}s.prototype.getUnreadCountForUID=function(t){"use strict";if(!h.get('unread_count_enabled')||!t)return null;var u=j.getThreadIDFromUserID(t);if(!this.$ChatUnreadCount4.getIsThreadUnread(u)){this.$ChatUnreadCount3["delete"](t);return 0;}var v=this.$ChatUnreadCount2.getOrFetch(u),w=v&&v.unread_count;this.$ChatUnreadCount3.set(t,w);return w;};s.prototype.setupSubscriptions=function(){"use strict";if(!h.get('unread_count_enabled'))return;this.$ChatUnreadCount1.subscribe('threads-updated',function(t,u){var v=Object.keys(u).some(function(w){var x=j.getUserIDFromThreadID(w);if(x===null)return false;var y=this.$ChatUnreadCount3.get(x)||0;return this.getUnreadCountForUID(x)!==y;}.bind(this));if(v)this.inform('unread-count-changed');}.bind(this));this.$ChatUnreadCount1.subscribe('unread-updated',function(){return this.inform('unread-count-changed');}.bind(this));};Object.assign(s,k);e.exports=s;},null);
__d("ChatSidebarUserGroup.react",["AvailableList","AvailableListConstants","ChannelConnection","ChatContexts","ChatSidebarSections","ChatSidebarUser.react","LastMobileActiveTimes","PresencePrivacy","PresenceStatus","React","ShortProfiles","SubscriptionsHandler","WorkModeConfig","cx","shield","ChatUnreadCount"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=b('ChatUnreadCount').get(),w=p,x=w.PropTypes,y=Object.keys(k).map(function(aa){return k[aa];}),z=p.createClass({displayName:"ChatSidebarUserGroup",propTypes:{ids:x.array.isRequired,sectionName:x.oneOf(y).isRequired,nowDataFetcher:x.func},getInitialState:function(){return {userData:[]};},_onAvailabilityChanged:function(aa,ba){if(!ba||this.props.ids.indexOf(ba)!==-1)this.forceUpdate();},componentWillMount:function(){this.componentWillReceiveProps(this.props);this._subscriptions=new r();this._subscriptions.addSubscriptions(g.subscribe(h.ON_AVAILABILITY_CHANGED,this._onAvailabilityChanged),v.subscribe('unread-count-changed',u(this.forceUpdate,this)));},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(aa){q.getMulti(aa.ids,function(ba){var ca=aa.ids.map(function(da){return ba[da];});this.setState({userData:ca});}.bind(this));},_renderProfile:function(aa,ba){var ca=s.is_work_user;if(aa.id===0||!(aa.is_friend||aa.is_messenger_only||ca))return null;var da=o.get(aa.id),ea=(da!==h.ACTIVE)?m.getShortDisplay(aa.id):null,fa=(da===h.ACTIVE)?o.getDetailedActivePresence(aa.id):null,ga=i.disconnected()||!n.allows(aa.id),ha=j.getShortDisplay(aa.id),ia=this.props.nowDataFetcher?this.props.nowDataFetcher(aa.id):null;return (p.createElement("li",{className:(("_42fz")+(ha?' '+"_52zj":'')+(ga?' '+"_570-":'')),"data-id":aa.id,key:aa.id},p.createElement(l,{birthday:aa.is_birthday,context:ha,detailedStatus:fa,image:aa.thumbSrc,imageSize:this.props.imageSize,name:aa.name,sectionName:this.props.sectionName,slot:ba,status:da,statusTime:ea,userID:aa.id,nowData:ia,unreadCount:v.getUnreadCountForUID(aa.id)})));},render:function(){return (p.createElement("ul",p.__spread({},this.props),this.state.userData.map(this._renderProfile)));}});e.exports=z;},null);
__d("XNowQueryController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/status\/sidebar\/",{});},null);
__d("NowPoller",["Arbiter","Poller","XNowQueryController"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=5000;function k(n,o){"use strict";this.$NowPoller0=n;this.$NowPoller1=new h({interval:j,setupRequest:this.$NowPoller2.bind(this),clearOnQuicklingEvents:false,dontStart:true});this.$NowPoller3=o;this.$NowPoller4=null;}k.prototype.$NowPoller2=function(n){"use strict";this.$NowPoller5=Date.now();n.setHandler(this.$NowPoller6.bind(this)).setErrorHandler(this.$NowPoller7.bind(this)).setOption('suppressErrorAlerts',true).setOption('retries',1).setData({section:this.$NowPoller3,includeusers:this.$NowPoller4}).setURI(i.getURIBuilder().getURI()).setAllowCrossPageTransition(true);};k.prototype.$NowPoller6=function(n){"use strict";var o=n.getPayload();this.$NowPoller0({pinnedfriends:o.pinned,topfriends:o.top_friends,mostrecent:o.most_recent,self:o.self});};k.prototype.$NowPoller7=function(n){"use strict";};k.prototype.setIncludeUsers=function(n){"use strict";this.$NowPoller4=n;};k.prototype.start=function(){"use strict";setTimeout(this.$NowPoller1.start.bind(this.$NowPoller1),0);};k.prototype.restart=function(){"use strict";if(this.$NowPoller1.isMuted()){this.$NowPoller1.resume();this.forceUpdate();}};k.prototype.stop=function(){"use strict";this.$NowPoller1.mute();};k.prototype.forceUpdate=function(){"use strict";this.$NowPoller1.request();};var l,m;k.start=function(){if(!l){l=new k(function(n){g.inform('Now/updatedData',n);},'all');if(m)l.setIncludeUsers(m);l.start();}};k.setIncludeUsers=function(n){m=n;if(l)l.setIncludeUsers(m);};k.forceUpdate=function(){if(l)l.forceUpdate();};k.listenForUpdate=function(n){g.subscribe('Now/updatedData',function(o,p){n(p);});};e.exports=k;},null);
__d("ChatSidebarOrderedList.react",["Animation","BanzaiODS","ChatConfig","ChatQuietLinks","ChatSidebarConstants","ChatSidebarGroupThreadsGroup.react","ChatSidebarLog","ChatSidebarSections","ChatSidebarUserGroup.react","NowPoller","PresencePrivacy","ReactComponentWithPureRenderMixin","React","Scroll","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w='chat_sidebar_visibility',x=i.get('divebar_new_design',false),y=s,z=y.PropTypes;h.setEntitySample(w,.0001);var aa=s.createClass({displayName:"ChatSidebarOrderedList",propTypes:{topUsers:z.array.isRequired,availableUsers:z.array.isRequired,isSidebar:z.bool.isRequired,scrollContainer:z.object,groups:z.array.isRequired,showNow:z.bool},getInitialState:function(){return {nowData:{}};},componentDidMount:function(){m.logRendered&&m.logRendered();j.nukeLinks(s.findDOMNode(this));this._logFriendCount();if(this.props.showNow){p.listenForUpdate(function(ca){return this.setState({nowData:ca});}.bind(this));p.start();}},_scrollToSeparator:function(ca){if(!this.props.scrollContainer)return;var da=this.props.scrollContainer.scrollHeight,ea=this.props.scrollContainer.clientHeight,fa=t.getTop(this.props.scrollContainer),ga=Math.min(ca.offsetTop,da-ea);if(fa!==ga){var ha=Math.abs(ga-fa)/this.props.scrollContainer.clientHeight*500;new g(this.props.scrollContainer).to('scrollTop',ga).ease(g.ease.end).duration(ha).go();}},_renderOfflineSection:function(){var ca=k.getImageSize(this.props.isSidebar),da=this.props.topUsers.filter(function(fa){return !q.allows(fa);});da.splice(-2);var ea=(s.createElement("a",{ajaxify:"/ajax/chat/privacy/settings_dialog.php?ref=whitelist_separator",href:"#",rel:"dialog"},v._("Edit")));return [s.createElement("div",{key:"users_separator1",className:"_554m"},s.createElement(ba,null,v._("MORE FRIENDS"))),s.createElement("div",{key:"users_separator2",className:"_554m blackbirdWhitelist"},s.createElement("div",{className:"_554o"},s.createElement("div",{className:"_554n"},s.createElement("div",{className:"_5v-d"},s.createElement("span",{className:"_554t"},v._("These friends can't see you on chat. {=link}",[v.param("=link",ea)])))))),s.createElement(o,{key:n.OFFLINE_USERS,sectionName:n.OFFLINE_USERS,ids:da,imageSize:ca})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0)return null;var ca=k.getImageSize(this.props.isSidebar);return [s.createElement("div",{key:"users_separator",ref:"usersSeparator",onClick:function(){return this._scrollToSeparator(s.findDOMNode(this.refs.usersSeparator));}.bind(this),className:"_554m moreOnlineFriends"},s.createElement(ba,null,v._("{MORE ONLINE FRIENDS} ({=count})",[v.param("MORE ONLINE FRIENDS",v._("MORE FRIENDS")),v.param("=count",this.props.availableUsers.length)]))),s.createElement(o,{key:n.MORE_ONLINE_FRIENDS,sectionName:n.MORE_ONLINE_FRIENDS,ids:this.props.availableUsers,imageSize:ca})];},_renderGroupsSection:function(){if(this.props.groups.length===0)return null;return [s.createElement("div",{key:"group_separator",ref:"groupSeparator",onClick:function(){return this._scrollToSeparator(s.findDOMNode(this.refs.groupSeparator));}.bind(this),className:"_554m moreOnlineFriends"},s.createElement(ba,null,v._("GROUP CONVERSATIONS"))),s.createElement(l,{key:"group_threads_section",groups:this.props.groups})];},render:function(){var ca=k.getImageSize(this.props.isSidebar),da=this.props.topUsers;if(q.getVisibility()==q.ONLINE)da=this.props.topUsers.filter(function(ka){return q.allows(ka);});var ea=(q.getOnlinePolicy()==q.ONLINE_TO_WHITELIST&&q.getVisibility())?this._renderOfflineSection():this._renderOnlineSection(),fa=null,ga=null;if(this.props.showNow&&this.state.nowData){var ha=da,ia=[];if(this.state.nowData.pinnedfriends)ia=this.state.nowData.pinnedfriends.map(function(ka){return ka.user_id;});if(this.state.nowData.topfriends)da=this.state.nowData.topfriends.map(function(ka){return ka.user_id;});ha=ha.filter(function(ka){return (ia.indexOf(ka)==-1);});p.setIncludeUsers(ha);ha=ha.filter(function(ka){return (da.indexOf(ka)==-1);});ha.forEach(function(ka){da.push(ka);});var ja=function(ka){var la=null;if(this.state.nowData.pinnedfriends)this.state.nowData.pinnedfriends.forEach(function(ma){if(ma.user_id==ka)la=ma;});if(this.state.nowData.topfriends)this.state.nowData.topfriends.forEach(function(ma){if(ma.user_id==ka)la=ma;});return la;}.bind(this);fa=s.createElement("div",null,s.createElement(ba,null,v._("PINNED FRIENDS")),s.createElement(o,{ids:ia,imageSize:ca,key:n.NOW_PINNED_LIST,nowDataFetcher:ja,sectionName:n.NOW_PINNED_LIST}));ga=s.createElement("div",null,s.createElement(ba,null,v._("TOP FRIENDS")),s.createElement(o,{key:n.ORDERED_LIST,ids:da,imageSize:ca,nowDataFetcher:ja,sectionName:n.ORDERED_LIST}));}else ga=s.createElement(o,{key:n.ORDERED_LIST,ids:da,imageSize:ca,sectionName:n.ORDERED_LIST});return (s.createElement("li",{className:x?"_bxd":null},fa,ga,this._renderGroupsSection(),ea));},_logFriendCount:function(){this._logTimeout=setTimeout(function(){h.bumpEntityKey(w,this.props.availableUsers.length===0?'state_list_empty':'state_list_mounted');}.bind(this),5000);}}),ba=s.createClass({displayName:"ChatSidebarSeparator",mixins:[r],render:function(){var ca=x?null:s.createElement("div",{className:"_554q"},s.createElement("span",{className:"_554r"}));return (s.createElement("div",{className:"_554o"},s.createElement("div",{className:"_554n"},s.createElement("span",{className:"_554p"},this.props.children),ca)));}});e.exports=aa;},null);
__d("ChatSortUsers",["AvailableListConstants","OrderedFriendsList","PresencePrivacy","PresenceStatus","ShortProfiles","TokenizeUtil"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(q,r){var s=i.allows(q),t=i.allows(r);if(s!==t)return s?-1:1;return 0;}var n={};function o(q){if(n[q])return n[q];var r=(k.getNowUnsafe(q)||{}).name;if(r)return n[q]=l.flatten(r);return '~';}var p={sortAlphabetical:function(q,r){var s=o(q),t=o(r);if(s!==t)return s<t?-1:1;return 0;},sortMobile:function(q,r){var s=j.get(q)===g.MOBILE,t=j.get(r)===g.MOBILE;if(s!==t)return t?-1:1;return p.sortAlphabetical(q,r);},sortCoefficient:function(q,r){var s=h.getRank(q),t=h.getRank(r);if(s!==t)return s-t;return p.sortAlphabetical(q,r);},sort:function(q,r){var s=m(q,r);if(s!==0)return s;return p.sortCoefficient(q,r);}};e.exports=p;},null);
__d("ChatOrderedList",["Arbiter","ArbiterMixin","AvailableList","AvailableListConstants","CSS","ChatConfig","ChatOptions","ChatHovercard","ChatOrderedListHover","ChatSidebarConstants","ChatSidebarInboxConfig","ChatSidebarOrderedList.react","ChatSortUsers","ChatVisibility","DOM","DataStore","JSLogger","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","React","createObjectFrom","csx","debounceAcrossTransitions","mixin","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){b.__markCompiled&&b.__markCompiled();var ha=null,ia=fa(h);for(var ja in ia)if(ia.hasOwnProperty(ja))la[ja]=ia[ja];var ka=ia===null?null:ia.prototype;la.prototype=Object.create(ka);la.prototype.constructor=la;la.__superConstructor__=ia;function la(ma,na){"use strict";ia.call(this);this._isSidebar=ma;this._root=na;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._groups=[];this._hoverController=null;this._orderedList=u.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=y.byClass(this._root,'scrollableOrderedList');this._scrollableArea=y.byClass(this._root,'scrollable');if(this._isSidebar)new n(this);g.subscribe(w.DUMP_EVENT,function(oa,pa){pa.chat_lists=pa.chat_lists||{sorted_list:this.getCachedSortedList(),ordered_list:x.getList(),available_list:la.getAvailableList(this._excludedIds),excluded_list:this._excludedIds};}.bind(this));z.subscribe('privacy-user-presence-changed',ga(this._render,this));i.subscribe(j.ON_AVAILABILITY_CHANGED,ga(this._render,this));}la.prototype.getShowingUsers=function(){"use strict";return u.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};la.prototype.getUserForNode=function(ma){"use strict";return v.get(ma,'id')||v.get(ma,'serverthreadid');};la.prototype.getHoverController=function(){"use strict";if(!this._hoverController)this._hoverController=new o(this);return this._hoverController;};la.prototype.getItemHeight=function(){"use strict";return p.getItemHeight(this._isSidebar);};la.prototype.getRoot=function(){"use strict";return this._root;};la.prototype.getSortedList=function(ma){"use strict";return la.getSortedList(ma||this._excludedIds,this._numTopFriends);};la.prototype.getCachedSortedList=function(ma){"use strict";if(ha==null)ha=this.getSortedList(ma);return ha;};la.prototype.hide=function(){"use strict";if(!this._isVisible)return;this._isVisible=false;k.hide(this._scrollableOrderedList||this._root);this.inform('hide');};la.prototype.setNumTopFriends=function(ma){"use strict";var na=la.getGroups(),oa=ma-na.length;if(oa>l.get('min_top_friends'))ma=oa;if(ma!==this._numTopFriends||na.length!==this._groups.length){this._groups=na;this._numTopFriends=ma;this._render();}};la.prototype._renderOrderedList=function(){"use strict";if(!this._isVisible)return;var ma=la.getSortedList({},this._numTopFriends),na=la.getAvailableList(ca(ma));na.sort(s.sortMobile);var oa=q.component;if(oa){ba.render(ba.createElement(oa,{showCount:q.show_count,showPresence:q.show_presence,threadCount:this._numTopFriends}),this._orderedList);}else ba.render(ba.createElement(r,{availableUsers:na,isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:ma,groups:la.getGroups(),showNow:l.get('badger_www_nub')}),this._orderedList);this.inform('render');};la.prototype._render=function(){"use strict";this._render=ea(this._renderOrderedList.bind(this),300);this._render();};la.prototype.show=function(){"use strict";if(this._isVisible)return;this._isVisible=true;k.show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};la.prototype.isVisible=function(){"use strict";return this._isVisible;};la.prototype.setScrollContainer=function(ma){"use strict";if(u.contains(ma,this._root))this._scrollContainer=ma;};la.getGroups=function(){"use strict";if(!m.getSetting('hide_groups')){return x.getGroups();}else return [];};la.getSortedList=function(ma,na){"use strict";var oa=x.getList().filter(function(ra){return !(ra in ma)&&z.getFriendVisibility(ra)!==z.BLACKLISTED;});if(!t.isOnline())if(z.getOnlinePolicy()===z.ONLINE_TO_WHITELIST)oa=this._filterByWhitelist(oa);var pa=oa.slice(0,na);if(pa.length===na){var qa=la.getAvailableList(pa.concat(ma)).length;qa&&pa.splice(-1);}ha=pa.slice();return pa;};la._filterByWhitelist=function(ma){"use strict";var na=ma,oa={},pa,qa;ma=[];for(pa=0;pa<na.length;++pa){qa=na[pa];if(z.allows(qa)){oa[qa]=true;ma.push(qa);}}var ra=z.getWhitelist();for(pa=0;pa<ra.length;++pa){qa=ra[pa];if(!(qa in oa))ma.push(qa);}for(pa=0;pa<na.length;++pa){qa=na[pa];if(!z.allows(qa))ma.push(qa);}return ma;};la.getAvailableList=function(ma){"use strict";var na;if(!na)na=aa.getOnlineIDs();return na.filter(function(oa){return !(oa in ma);});};e.exports=la;},null);
__d("ChatSidebarDropdown",["AppsDivebarDisplayController","Arbiter","AsyncRequest","ChatOptions","ChatSidebar","ChatSidebarActions","ChatTabActions","ChatVisibility","CSS","JSLogger","PresenceState","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();function t(u,v,w,x,y){"use strict";this._menu=v;this._popover=u.getPopover();this._selectedValues={};this._menuIsRendered=false;this._editingFavoriteList=false;this._hasAppsOption=y;this._logger=p.create('blackbird');this._menu.subscribe('itemclick',this._onClick.bind(this));this._popover.subscribe('init',this._onLayerInit.bind(this));this._popover.subscribe('show',this._updateTickerVisibility.bind(this));h.subscribe('chat/option-changed',this._onOptionChanged.bind(this));}t.prototype._onLayerInit=function(){"use strict";this._menuIsRendered=true;o.addClass(this._popover.getLayer().getContentRoot(),"_5vm9");this._displayBrowserNotificationsIfNeeded();this._updateVisibility();h.subscribe('chat-visibility/go-online',this._updateVisibility.bind(this));h.subscribe('chat-visibility/go-offline',this._updateVisibility.bind(this));this._updateSelectedItems();if(this._editingFavoriteList)this._updateEditFavoriteListLabel(this._editingFavoriteList);if(this._hasAppsOption)this._registerAppHandlers();};t.prototype._updateSelectedItems=function(){"use strict";this._menu.forEachItem(function(u){var v=u.getValue&&u.getValue();if(v in this._selectedValues){var w=this._selectedValues[v];if(w){u.select();}else u.deselect();}}.bind(this));};t.prototype._registerAppHandlers=function(){"use strict";this._updateAppsVisibility();h.subscribe('AppsDivebar/hide-apps',this._updateAppsVisibility.bind(this));h.subscribe('AppsDivebar/show-apps',this._updateAppsVisibility.bind(this));};t.prototype._updateTickerVisibility=function(){"use strict";var u=s('pagelet_ticker');o.conditionClass(this._popover.getLayer().getContentRoot(),"_2rox",!u||u.offsetHeight===0);};t.prototype._updateAppsVisibility=function(){"use strict";o.conditionClass(this._popover.getLayer().getContentRoot(),"_2vh",!g.isVisible());};t.prototype._updateVisibility=function(){"use strict";o.conditionClass(this._popover.getLayer().getContentRoot(),"_5vma",!n.isOnline());};t.prototype._displayBrowserNotificationsIfNeeded=function(){"use strict";if(window.webkitNotifications){var u;this._menu.forEachItem(function(v){if(v.getValue&&v.getValue()==='browser_notif')u=v;});if(u){o.show(u.getRoot());if(window.webkitNotifications.checkPermission()!==0)u.deselect();}}};t.prototype._onChangeSettingResponse=function(u,v,w){"use strict";q.doSync();};t.prototype._onChangeSettingError=function(u,v,w){"use strict";j.setSetting(u,!v,'sidebar_menu_error');};t.prototype._onChangeFinally=function(){"use strict";this._pendingChange=false;};t.prototype._onOptionChanged=function(u,v){"use strict";var w=v.name,x=v.value;if(this._menuIsRendered){this._menu.forEachItem(function(y){if(y.getValue&&(y.getValue()===w))if(y.isSelected()&&!x){y.deselect();}else if(!y.isSelected()&&x)y.select();});}else this._selectedValues[w]=x;};t.prototype._onClick=function(u,v){"use strict";if(this._pendingChange)return false;var w=false,x=v.item.getValue(),y=true;switch(x){case 'sidebar':this.toggleSidebar();break;case 'online':if(!n.isOnline()){n.goOnline();}else this._logVisibilityChange(x,true);w=true;break;case 'offline':if(n.isOnline()){n.goOffline();}else this._logVisibilityChange(x,true);w=true;break;case 'advanced_settings':case 'turn_off_dialog':h.inform('chat/advanced-settings-dialog-opened');w=true;this._logVisibilityChange(x,false);break;case 'browser_notif':if(!v.item.isSelected()&&window.webkitNotifications&&window.webkitNotifications.checkPermission()!==0){window.webkitNotifications.requestPermission(function(){this.changeSetting(x,!v.item.isSelected());}.bind(this));}else this.changeSetting(x,!v.item.isSelected());w=true;break;case 'sound':this.changeSetting(x,!v.item.isSelected());w=true;break;case 'close_all_tabs':m.closeAllTabs();this._logVisibilityChange(x,false);w=true;break;case 'show_apps':if(!g.isVisible()){g.showApps();k.resize();}w=true;break;case 'hide_apps':if(g.isVisible()){g.hideApps();k.resize();}w=true;break;case 'show_ticker':h.inform('ChatSidebarDropdown/openTicker');w=true;break;case 'hide_ticker':h.inform('ChatSidebarDropdown/closeTicker');w=true;break;case 'hide_groups':var z=v.item.isSelected();this.changeSetting('hide_groups',!z);w=true;break;}if(w){this.hideMenu();return y;}};t.prototype._logVisibilityChange=function(u,v){"use strict";this._logger.error(v?'sidebar_dropdown_visibility_error':'sidebar_dropdown_set_visibility',{action:u});};t.prototype.changeSetting=function(u,v){"use strict";if(this._pendingChange)return false;this._pendingChange=true;var w={};w[u]=v;j.setSetting(u,v,'sidebar_menu');new i('/ajax/chat/settings.php').setHandler(this._onChangeSettingResponse.bind(this,u,v)).setErrorHandler(this._onChangeSettingError.bind(this,u,v)).setFinallyHandler(this._onChangeFinally.bind(this)).setData(w).setAllowCrossPageTransition(true).send();};t.prototype.hideMenu=function(){"use strict";if(this._menuIsRendered)this._popover.hideLayer();};t.prototype.toggleSidebar=function(){"use strict";l.toggle();this.hideMenu();return false;};e.exports=t;},null);
__d("ChatSidebarTypeaheadDataSource",["MercuryConfig","MercuryTypeaheadDataSource","ShortProfiles"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();for(var j in h)if(h.hasOwnProperty(j))l[j]=h[j];var k=h===null?null:h.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=h;function l(m){"use strict";m=m||{};m.kanaNormalization=true;if(g.ScrollableSidebarTypeaheadGK)m.maxResults=30;h.call(this,m);}l.prototype.init=function(){"use strict";k.init.call(this);this.updateBootstrapData();};l.prototype.bootstrap=function(){"use strict";k.bootstrap.call(this);};l.prototype.updateBootstrapData=function(){"use strict";if(this.isBootstrapped())return;k.updateBootstrapData.call(this);};l.prototype.fetchAll=function(){"use strict";i.fetchAll();};l.prototype.refreshData=function(){"use strict";this.fetchAll();d(['AvailableList'],function(m){m.update();}.bind(this));};l.prototype.query=function(m,n,o,p){"use strict";this.logQuery({event:'query_dive_bar',query:m});return k.query.call(this,m,n,o,p);};l.prototype.respond=function(m,n,o){"use strict";var p=k.respond.call(this,m,n,o);this.logResponse({event:'query_response_dive_bar',response_query:m,response_uids:n});return p;};e.exports=l;},null);
__d("ChatTypeaheadCore",["Event","Keys","TypeaheadCore","emptyFunction","shield"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();for(var l in i)if(i.hasOwnProperty(l))n[l]=i[l];var m=i===null?null:i.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=i;function n(){"use strict";if(i!==null)i.apply(this,arguments);}n.prototype.init=function(o,p,q){"use strict";m.init.call(this,o,p,q);this.informBeginActive=false;this.informEndActive=false;this.data.subscribe('respond',function(){if(this.informBeginActive){this.informBeginActive=false;this.inform('sidebar/typeahead/active',true);}else if(this.informEndActive){this.informEndActive=false;this.inform('sidebar/typeahead/active',false);}}.bind(this));};n.prototype.keydown=function(event){"use strict";this.data.fetchAll();var o=g.getKeyCode(event);if(o===h.ESC){this.view.clearContent();setTimeout(k(this.reset,this),0);if(!this.getValue()){this.element.blur();this.inform('escape');}return event.kill();}return m.keydown.call(this,event);};n.prototype.checkValue=function(){"use strict";var o=this.getValue(),p=this.value;if(o==p)return;if(p&&!o){this.typeaheadActive=false;this.informEndActive=true;}else if(!p&&o){this.typeaheadActive=true;this.informBeginActive=true;this.inform('sidebar/typeahead/preActive');}m.checkValue.call(this);};Object.assign(n.prototype,{handleTab:j});e.exports=n;},null);
__d("ChatSidebarHeader.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g.createClass({displayName:"ReactChatSidebarHeader",render:function(){return (g.createElement("div",g.__spread({},this.props,{className:i(this.props.className,"_55ob")}),g.createElement("div",{className:"_55oc"},this.props.children)));}});e.exports=j;},null);
__d("ChatTypeaheadRenderer",["AvailableListConstants","ChatConfig","ChatSidebarConstants","ChatSidebarHeader.react","ChatSidebarSections","ChatSidebarThread.react","ChatSidebarUser.react","ChatTypeaheadConstants","DOM","LastMobileActiveTimes","MercuryIDs","PresenceStatus","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u={};function v(aa,ba){if(!(aa in u))u[aa]=o.create('li');s.render(ba,u[aa]);return u[aa];}function w(aa){return v(aa.text,s.createElement(j,{className:((h.get('divebar_new_design',false)?"_4ebb":''))},aa.text));}function x(aa){var ba=aa.mercury_thread.participants.map(function(ca){return q.getUserIDFromParticipantID(ca);});return v(aa.uid,s.createElement(l,{image:aa.mercury_thread.image_src,imageSize:i.getImageSize(),name:aa.mercury_thread.name,participants:aa.participants_to_render,numOtherParticipants:ba.length-1,referrer:k.TYPEAHEAD,status:r.getGroup(ba),threadFBID:aa.uid}));}function y(aa){var ba=r.get(aa.uid),ca=(ba===g.MOBILE)?p.getShortDisplay(aa.uid):null,da=(aa.render_type==n.NON_FRIEND_TYPE||aa.render_type==n.PAGE_TYPE||aa.render_type==n.FB4C_TYPE)?aa.subtext:null,ea=null;if(ba===g.ACTIVE)ea=r.getDetailedActivePresence(aa.uid);return v(aa.uid,s.createElement(m,{image:aa.photo,imageSize:i.getImageSize(),name:aa.text,sectionName:k.TYPEAHEAD,status:ba,statusTime:ca,detailedStatus:ea,userID:aa.uid,context:da}));}function z(aa,ba){if(aa.type===n.HEADER_TYPE)return w(aa);if(aa.type==n.THREAD_TYPE)return x(aa);return y(aa);}e.exports=z;},null);
__d("ChatTypeaheadView",["BucketedTypeaheadView","ChatTypeaheadConstants","CurrentUser","DOM","MercuryConfig","React","ScrollableArea","MercuryThreadSearchUtils","Style","WorkModeConfig","XUISpinner.react","arrayContains","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();for(var u in g)if(g.hasOwnProperty(u))w[u]=g[u];var v=g===null?null:g.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=g;function w(x,y){"use strict";if(k.ScrollableSidebarTypeaheadGK){var z=m.renderDOM();j.appendContent(x,z.root);var aa=m.fromNative(z.root);g.call(this,z.content,y);this.$ChatTypeaheadView0=z;this.$ChatTypeaheadView1=aa;}else g.call(this,x,y);this.showingLoadingIndicator=false;this.typeObjects={};this.typeObjectsOrder=[];this.typeObjects[h.NON_FRIEND_TYPE]={uid:h.NON_FRIEND_TYPE,type:h.HEADER_TYPE,text:t._("MORE PEOPLE")};this.typeObjectsOrder.push(h.NON_FRIEND_TYPE);this.typeObjects[h.PAGE_TYPE]={disabled:true,uid:h.PAGE_TYPE,type:h.HEADER_TYPE,text:t._("BUSINESSES")};this.typeObjectsOrder.push(h.PAGE_TYPE);this.typeObjects[h.THREAD_TYPE]={uid:h.THREAD_TYPE,type:h.HEADER_TYPE,text:t._("GROUP CONVERSATIONS")};this.typeObjectsOrder.push(h.THREAD_TYPE);this.typeObjects[h.FB4C_TYPE]={uid:h.FB4C_TYPE,type:h.HEADER_TYPE,text:t._("CO-WORKERS")};this.typeObjects[h.FRIEND_TYPE]={disabled:true,uid:h.FRIEND_TYPE,type:h.HEADER_TYPE,text:t._("FRIENDS")};this.typeObjectsOrder.push(h.FB4C_TYPE);this.typeObjectsOrder.push(h.FRIEND_TYPE);}w.prototype.reset=function(){"use strict";if(this.value==='')this.clearContent();this.index=-1;this.items=[];this.results=[];this.value='';this.inform('reset');return this;};w.prototype.clearContent=function(){"use strict";this.hideLoadingIndicator();j.empty(this.content);};w.prototype.buildBuckets=function(x,y){"use strict";var z=y.filter(function(aa){var ba=aa.render_type||aa.type;if(ba==='thread'){var ca='fbid:'+i.getID();if(!r(aa.mercury_thread.participants,ca))return false;var da=aa.participants_to_render.some(function(fa){return n.queryMatchesName(x,fa.name);}),ea=n.queryMatchesName(x,aa.mercury_thread.name);if(!da&&!ea)return false;}return true;}).reverse();return v.buildBuckets.call(this,x,z);};w.prototype.getDefaultIndex=function(x){"use strict";if(x.length===0)return -1;var y=x.length-1;while(!this.isHighlightable(x[y])&&y>=0)y--;return y;};w.prototype.showLoadingIndicator=function(){"use strict";if(!this.showingLoadingIndicator){l.render(l.createElement("div",{className:"spinnerContainer"},l.createElement(q,{className:"_3-8i",background:"light",size:"small",paused:false})),this.content);this.showingLoadingIndicator=true;}};w.prototype.hideLoadingIndicator=function(){"use strict";if(this.showingLoadingIndicator){l.unmountComponentAtNode(this.content);this.showingLoadingIndicator=false;}};w.prototype.showNoResults=function(){"use strict";var x=t._("Friend not found.");if(p.is_work_user)x=t._("Co-worker not found.");this.hideLoadingIndicator();j.setContent(this.content,j.create('div',{className:"noResults _3-9a"},x));};w.prototype.hide=function(){"use strict";this.clearContent();return v.hide.call(this);};w.prototype.next=function(){"use strict";v.next.call(this);if(k.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView1.scrollIntoView(this.selected,false);};w.prototype.prev=function(){"use strict";v.prev.call(this);if(k.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView1.scrollIntoView(this.selected,false);};w.prototype.setMaxHeight=function(x){"use strict";o.set(this.$ChatTypeaheadView0.wrap,'max-height',x+'px');};w.prototype.render=function(x,y,z){"use strict";if(k.ScrollableSidebarTypeaheadGK)var aa=this.value!==x||this.$ChatTypeaheadView1.isScrolledToBottom();if(!y.length){if(x&&x.length>1)this.showLoadingIndicator();}else this.hideLoadingIndicator();v.render.call(this,x,y,z);if(k.ScrollableSidebarTypeaheadGK&&aa)this.$ChatTypeaheadView1.scrollToBottom(false);};e.exports=w;},null);
__d("legacy:ChatTypeaheadBehavior",["ChatTypeaheadBehavior"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.chatTypeahead=function(h){h.enableBehavior(g);};},3);
__d("P2PTriggersUtils",["CurrentEnvironment","MercuryIDs","P2PGKValues"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=/\$((\d{1,3}(,\d{3})*)|\d+)(\.\d{1,2})?(?=\s|\.\s|\,\s|$|\.$|\,$|\?|\!|\")/,k={canSeeTriggers:function(l){if(!i.P2PEnabled)return false;if(h.isGroupChat(l))if(g.messengerdotcom&&!i.P2PGroupSendMessengerDotCom){return false;}else if(g.facebookdotcom&&!i.P2PGroupSendWWW)return false;return true;},getMatches:function(l){return l.match(j);}};e.exports=k;},null);
__d("MessengerURIConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={COMPOSE_SUBPATH:'/new',GROUPS_PATH:'/groups',PEOPLE_PATH:'/people',THREAD_PREFIX:'/t/',GROUP_PREFIX:'group-',RESERVED_WORDS:['groups','people','new','messenger','t']};e.exports=g;},null);
__d("MessengerURISerializer",["MessengerStateProcessor","MessengerURIConstants","MessengerView","URI","WWWBase"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l='/?$',m={serialize:function(v){var w=new j(k.uri);v=g.preprocess(v);switch(v.masterView){case i.MASTER.GROUPS:w.setPath(h.GROUPS_PATH);break;case i.MASTER.PEOPLE:w.setPath(h.PEOPLE_PATH);break;}if(v.detailView===i.DETAIL.COMPOSE){w.setPath(w.getPath()+h.COMPOSE_SUBPATH);}else if(v.threadKey)w.setPath(w.getPath()+h.THREAD_PREFIX+t(v.threadKey));return w;},deserialize:function(v){var w={},x=v.getPath();if(x.match('^'+h.GROUPS_PATH)){w.masterView=i.MASTER.GROUPS;}else if(x.match('^'+h.PEOPLE_PATH)){w.masterView=i.MASTER.PEOPLE;}else w.masterView=i.MASTER.RECENT;if(x.match(h.COMPOSE_SUBPATH+l)){w.detailView=i.DETAIL.COMPOSE;}else{var y=n(x);if(y&&!r(y)){w.threadKey=u(y);w.detailView=i.DETAIL.THREAD;}}return g.postprocess(w);}};function n(v){var w=v.match(h.THREAD_PREFIX+'([^/]+)'+l);return w&&w[1];}var o=h.RESERVED_WORDS.join('|'),p=new RegExp('^('+o+')$'),q=new RegExp('^\\.('+o+')$');function r(v){return !!v.match(p);}function s(v){return !!v.match(q);}function t(v){v=r(v)?'.'+v:v;return j.encodeComponent(v);}function u(v){v=j.decodeComponent(v);return s(v)?v.substr(1):v;}e.exports=m;},null);
__d("MessengerActions",["MessengerDispatcher","MessengerURISerializer","MessengerView","URI","goURI","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=l({CHANGE_FOLDER:null,HIDE_DIALOG:null,REPLACE_STATE:null,SHOW_DIALOG:null}),n={Types:m,changeDetailView:function(p){o(function(q){if(q.detailView!==p)return {detailView:p};});},changeMasterView:function(p){o(function(q){if(q.masterView!==p)return {masterView:p};});},selectThread:function(p){o(function(q){if(q.activeThreadID!==p)return {activeThreadID:p,detailView:i.DETAIL.THREAD};});},changeState:function(p){g.dispatch({type:m.REPLACE_STATE,nextState:p});},showDialog:function(p,q){g.dispatch({type:n.Types.SHOW_DIALOG,dialogClass:p,dialogProps:q});},hideDialog:function(p){g.dispatch({type:n.Types.HIDE_DIALOG,dialogClass:p});},changeFolder:function(p){g.dispatch({type:n.Types.CHANGE_FOLDER,folder:p});}};function o(p){var q=h.deserialize(new j(window.location.href)),r=p(q);if(r)k(h.serialize(Object.assign(q,r)));}e.exports=n;},null);
__d("P2PActions",["ChatOpenTab","MessengerActions","P2PActionConstants","P2PDispatcher"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k={updateCreditCards:function(l){j.dispatch({type:i.CREDIT_CARDS_UPDATED,data:l});},ignoreCreditCardChannelEvents:function(){j.dispatch({type:i.CHANNEL_EVENTS_IGNORED});},allowCreditCardChannelEvents:function(){j.dispatch({type:i.CHANNEL_EVENTS_ALLOWED});},addCreditCard:function(l){j.dispatch({type:i.CREDIT_CARD_ADDED,data:l});},addCreditCardError:function(l){j.dispatch({type:i.CREDIT_CARD_ADDED_ERROR,data:l});},updatePresetCreditCard:function(l){j.dispatch({type:i.PRESET_CREDIT_CARD_UPDATED,data:l});},updatePresetCreditCardError:function(l){j.dispatch({type:i.PRESET_CREDIT_CARD_UPDATED_ERROR,data:l});},updateCreditCard:function(l){j.dispatch({type:i.CREDIT_CARD_UPDATED,data:l});},updateCreditCardError:function(l){j.dispatch({type:i.CREDIT_CARD_UPDATED_ERROR,data:l});},deleteCreditCard:function(l){j.dispatch({type:i.CREDIT_CARD_DELETED,data:l});},deleteCreditCardError:function(l){j.dispatch({type:i.CREDIT_CARD_DELETED_ERROR,data:l});},verifyCreditCard:function(l){j.dispatch({type:i.CREDIT_CARD_VERIFIED,data:l});},verifyCreditCardError:function(l){j.dispatch({type:i.CREDIT_CARD_VERIFIED_ERROR,data:l});},updateTransfers:function(l){j.dispatch({type:i.TRANSFERS_UPDATED,data:l});},updateTransfersError:function(l){j.dispatch({type:i.TRANSFERS_UPDATED_ERROR,data:l});},updateNUXTransfers:function(l){j.dispatch({type:i.NUX_TRANSFERS_UPDATED,data:l});},transferAdded:function(l){j.dispatch({type:i.TRANSFER_ADDED,data:l});},transferAddedError:function(l){j.dispatch({type:i.TRANSFER_ADDED_ERROR,data:l});},transferUpdated:function(l){j.dispatch({type:i.TRANSFER_UPDATED,data:l});},transferUpdatedError:function(l){j.dispatch({type:i.TRANSFER_UPDATED_ERROR,data:l});},transferAccepted:function(){j.dispatch({type:i.TRANSFER_ACCEPTED});},transferDeclined:function(l){j.dispatch({type:i.TRANSFER_DECLINED,data:l});},chatSendViewOpened:function(l){function m(){j.dispatch({type:i.CHAT_SEND_VIEW_OPENED,data:l});}if(g.canOpenTab()){g.openThread(l.threadID,null,null,m);}else{h.selectThread(l.threadID);m();}},chatSendViewClosed:function(l){j.dispatch({type:i.CHAT_SEND_VIEW_CLOSED,data:l});},binNumberValidated:function(l){j.dispatch({type:i.BIN_NUMBER_VALIDATED,data:l});},binNumberValidatedError:function(l){j.dispatch({type:i.BIN_NUMBER_VALIDATED_ERROR,data:l});},friendsListUpdated:function(l){j.dispatch({type:i.FRIENDS_LIST_UPDATED,data:l});},userEligibilityUpdated:function(l){j.dispatch({type:i.USER_ELIGIBILITY_UDPATED,data:l});},showDialog:function(l,m){j.dispatch({type:i.DIALOG_SHOWN,data:{dialogClass:l,dialogProps:m}});},hideDialog:function(){j.dispatch({type:i.DIALOG_CLOSED});},bannerStatesUpdated:function(l){j.dispatch({type:i.BANNER_STATES_UPDATED,data:l});},bannerDismissed:function(l){j.dispatch({type:i.BANNER_DISMISSED,data:l});},bannerCompleted:function(l){j.dispatch({type:i.BANNER_COMPLETED,data:l});},moneypennyTransferCreated:function(l){j.dispatch({type:i.MONEYPENNY_TRANSFER_CREATED,data:l});},moneypennyTransferCreatedError:function(l){j.dispatch({type:i.MONEYPENNY_TRANSFER_CREATED_ERROR,data:l});},productItemBannerUpdated:function(l){j.dispatch({type:i.PRODUCT_ITEM_BANNER_UPDATED,data:l});},productItemBannerDismissed:function(l){j.dispatch({type:i.PRODUCT_ITEM_BANNER_DISMISSED,data:l});},extensiveTransferDetailsLoaded:function(l){j.dispatch({type:i.EXTENSIVE_TRANSFER_DETAILS_UPDATED,data:l});}};e.exports=k;},null);
__d("P2PAPIUtils",["CreditCardFormParam","fbt","guid"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={getRandomDigits:function(k){return Math.random().toString().slice(2,2+k);},genRequestID:function(){return 'id:'+i()+':'+Date.now();},genOfflineThreadingID:function(){return Date.now()+''+j.getRandomDigits(6);},getUncaughtErrorMessage:function(){return (h._("Sorry, something went wrong. Please try again later."));},prepareCardMutationData:function(k){var l={},m=k[g.CARD_NUMBER].replace(/ /g,'');l[g.CARD_NUMBER]=m;if(typeof k[g.CARD_EXPIRATION]==='string'){var n=k[g.CARD_EXPIRATION].split('/');l[g.MONTH]=n[0];l[g.YEAR]=n[1];l[g.CARD_EXPIRATION]={};l[g.CARD_EXPIRATION][g.MONTH]=l[g.MONTH];l[g.CARD_EXPIRATION][g.YEAR]=l[g.YEAR];}else{l[g.MONTH]=k[g.CARD_EXPIRATION][g.MONTH];l[g.YEAR]=k[g.CARD_EXPIRATION][g.YEAR];}return Object.assign({},k,l);}};e.exports=j;},null);
__d("XP2PBannerDismissalsUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/banner_dismissals\/_update\/",{banner_type:{type:"String",required:true}});},null);
__d("XP2PBannerStatesController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/banner_states\/",{});},null);
__d("XP2PBannerViewsUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/banner_views\/_update\/",{banner_type:{type:"String",required:true}});},null);
__d("XP2PCardBINValidateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/card_bin\/validate\/",{bin_number:{type:"String",required:true}});},null);
__d("XP2PCreditCardDeleteController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_delete\/",{});},null);
__d("XP2PCreditCardUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_update\/",{});},null);
__d("XP2PCreditCardCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_create\/",{});},null);
__d("XP2PCreditCardVerifyController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_verify\/",{});},null);
__d("XP2PCreditCardsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/",{type:{type:"Int",defaultValue:1}});},null);
__d("XP2PExtensiveTransferDetailsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transaction\/details\/",{id:{type:"String",required:true}});},null);
__d("XP2PFriendPickerController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/friend_picker\/",{limit:{type:"Int",defaultValue:100},query:{type:"String"}});},null);
__d("XMoneypennyPaymentsCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/moneypenny\/payments\/_create\/",{});},null);
__d("XP2PPasswordProtectionStatusController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/",{});},null);
__d("XP2PPasswordProtectionStatusUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/_update\/",{});},null);
__d("XP2PPresetCreditCardSetController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/preset_credit_card\/_set\/",{});},null);
__d("XP2PProductItemBannerController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/product_item_banner\/",{other_user_id:{type:"String",required:true}});},null);
__d("XP2PTransactionsCampaignCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/campaign\/_create\/",{});},null);
__d("XP2PTransactionsCancelController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_cancel\/",{});},null);
__d("XP2PTransactionsCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_create\/",{});},null);
__d("XP2PTransactionsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/",{since:{type:"Int"}});},null);
__d("XP2PTransactionsDeclineController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_decline\/",{});},null);
__d("XP2PUserEligibilityController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/user_eligibility\/",{user_ids:{type:"StringVector",required:true}});},null);
__d("P2PAPI",["AsyncRequest","CreditCardFormParam","P2PActions","P2PAPIUtils","P2PPasswordProtectionParam","P2PPaymentCampaignNames","P2PPaymentCreditCardsTypes","P2PTransferParam","ImmutableObject","URI","XP2PBannerDismissalsUpdateController","XP2PBannerStatesController","XP2PBannerViewsUpdateController","XP2PCardBINValidateController","XP2PCreditCardDeleteController","XP2PCreditCardUpdateController","XP2PCreditCardCreateController","XP2PCreditCardVerifyController","XP2PCreditCardsController","XP2PExtensiveTransferDetailsController","XP2PFriendPickerController","XMoneypennyPaymentsCreateController","XP2PPasswordProtectionStatusController","XP2PPasswordProtectionStatusUpdateController","XP2PPresetCreditCardSetController","XP2PProductItemBannerController","XP2PTransactionsCampaignCreateController","XP2PTransactionsCancelController","XP2PTransactionsCreateController","XP2PTransactionsController","XP2PTransactionsDeclineController","XP2PUserEligibilityController","emptyFunction","isEmpty"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){b.__markCompiled&&b.__markCompiled();'use strict';var oa={getAllCreditCards:function(){var pa=(y.getURIBuilder()).getURI();new g().setData({type:m.SENDING}).setURI(pa).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(qa){var ra=qa.getPayload();if(!ra.error)i.updateCreditCards(ra);}.bind(this)).send();},createTransaction:function(pa){var qa=(ia.getURIBuilder()).getURI(),ra={},sa=pa.formData,ta=pa.success||ma,ua=pa.error||ma;ra[h.CREDENTIAL_ID]=sa[h.CREDENTIAL_ID];ra.amount=sa.amount;ra.receiver_id=sa.receiverId;ra.offline_threading_id=j.genOfflineThreadingID();ra.group_thread_fbid=sa.group_thread_fbid;new g().setData(ra).setMethod('POST').setURI(qa).setAllowCrossPageTransition(true).setHandler(function(va){var wa=va?va.getPayload():{};if(wa.error){ua(wa.error);}else{ta(wa);this.getAllCreditCards();}}.bind(this)).setErrorHandler(function(){ua({message:j.getUncaughtErrorMessage()});}.bind(this)).send();},addCreditCard:function(pa){i.ignoreCreditCardChannelEvents();var qa=(w.getURIBuilder()).getURI().getPath(),ra=new p('/ajax/payment/token_proxy.php').addQueryData('tpe',qa);pa=j.prepareCardMutationData(pa);var sa=new o(pa);new g().setData(pa).setMethod('POST').setURI(ra).setHandler(function(ta){var ua=ta.getPayload(),va={};if(!ua.errors){va[h.CREDENTIAL_ID]=ua[h.CREDENTIAL_ID];va.isPreset=ua.isPreset;va.isVerified=ua.isVerified;va.passwordProtection=ua.passwordProtection;sa=o.set(sa,va);i.addCreditCard(sa);if(ua.isPreset)i.transferAccepted();}else i.addCreditCardError(Object.assign({requestID:sa.requestID},ua));i.allowCreditCardChannelEvents();}.bind(this)).setErrorHandler(function(){i.addCreditCardError({requestID:sa.requestID,errors:{general:{message:j.getUncaughtErrorMessage()}}});i.allowCreditCardChannelEvents();}.bind(this)).send();},getTransactions:function(pa){pa=pa||{};var qa={},ra=pa,sa=(ja.getURIBuilder()).getURI(),ta=new o(ra);if(ra.since)qa.since=ra.since;return new g().setData(qa).setURI(sa).setMethod('GET').setReadOnly(true).setHandler(function(ua){var va=ua.getPayload();if(!va.error){i.updateTransfers(va);}else i.updateTransfersError(Object.assign({requestID:ta.requestID},va));}.bind(this)).setErrorHandler(function(){i.updateTransfersError({error:{message:j.getUncaughtErrorMessage()},requestID:ta.requestID});}.bind(this)).send();},getExtensiveTransferDetailsByID:function(pa){var qa=(z.getURIBuilder()).setString('id',pa).getURI();new g().setURI(qa).setMethod('GET').setReadOnly(true).setHandler(function(ra){var sa=ra.getPayload();if(!sa.error)i.extensiveTransferDetailsLoaded(sa);}.bind(this)).send();},getNUXTransactions:function(){var pa=(new Date()),qa=Math.round((pa.setDate(pa.getDate()-15))/1000),ra=(ja.getURIBuilder()).getURI();return new g().setData({since:qa}).setURI(ra).setMethod('GET').setReadOnly(true).setHandler(function(sa){var ta=sa.getPayload();if(!ta.error)i.updateNUXTransfers(ta);}.bind(this)).send();},updatePresetCreditCard:function(pa){var qa=(ea.getURIBuilder()).getURI();new g().setData(pa).setURI(qa).setMethod('POST').setHandler(function(ra){var sa=ra.getPayload();if(!sa.error){i.updatePresetCreditCard(Object.assign({},sa,{requestID:pa.requestID}));i.transferAccepted();}else i.updatePresetCreditCardError(Object.assign({},sa,{requestID:pa.requestID}));}.bind(this)).setErrorHandler(function(){i.updatePresetCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:pa.requestID});}.bind(this)).send();},updateCreditCard:function(pa){i.ignoreCreditCardChannelEvents();var qa=(v.getURIBuilder()).getURI().getPath(),ra=new p('/ajax/payment/token_proxy.php').addQueryData('tpe',qa);pa=j.prepareCardMutationData(pa);var sa=new o(pa);new g().setData(pa).setMethod('POST').setURI(ra).setHandler(function(ta){var ua=ta.getPayload();if(!ua.errors){i.updateCreditCard(sa);}else i.updateCreditCardError(Object.assign({},ua,{requestID:sa.requestID}));i.allowCreditCardChannelEvents();}.bind(this)).setErrorHandler(function(){i.updateCreditCardError({errors:{general:{message:j.getUncaughtErrorMessage()}},requestID:sa.requestID});i.allowCreditCardChannelEvents();}.bind(this)).send();},deleteCreditCard:function(pa){var qa=(u.getURIBuilder()).getURI();new g().setData(pa).setMethod('POST').setURI(qa).setHandler(function(ra){var sa=ra.getPayload();if(!sa.error){i.deleteCreditCard(Object.assign({},sa,{requestID:pa.requestID}));}else i.deleteCreditCardError(Object.assign({},sa,{requestID:pa.requestID}));}.bind(this)).setErrorHandler(function(){i.deleteCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:pa.requestID});}.bind(this)).send();},getPasswordProtectionSetting:function(pa){var qa=(ca.getURIBuilder()).getURI(),ra=pa.success||ma,sa=pa.error||ma;new g().setURI(qa).setMethod('GET').setReadOnly(true).setHandler(function(ta){var ua=ta?ta.getPayload():[];if(ua.error){sa();}else ra(ua);}.bind(this)).setErrorHandler(function(){sa();}.bind(this)).send();},setPasswordProtectionSetting:function(pa){var qa=(da.getURIBuilder()).getURI(),ra=pa.formData,sa=pa.success||ma,ta=pa.error||ma,ua={};ua[k.STATUS]=ra[k.STATUS];new g().setData(ua).setURI(qa).setMethod('POST').setHandler(function(va){var wa=va?va.getPayload():{};if(wa.error){ta(wa.error);}else sa();}.bind(this)).setErrorHandler(function(){ta();}.bind(this)).send();},declineTransaction:function(pa){var qa=(ka.getURIBuilder()).getURI(),ra=pa.formData,sa=pa.success||ma,ta=pa.error||ma,ua={};ua[n.TRANSFER_ID]=ra[n.TRANSFER_ID];new g().setData(ua).setURI(qa).setMethod('POST').setHandler(function(va){var wa=va?va.getPayload():{},xa={};if(wa.error){ta(wa.error);}else{sa();xa[n.TRANSFER_ID]=ua[n.TRANSFER_ID];i.transferDeclined(xa);}}.bind(this)).setErrorHandler(function(){ta();}.bind(this)).send();},cancelTransaction:function(pa){var qa=(ha.getURIBuilder()).getURI(),ra=pa.formData,sa=pa.success||ma,ta=pa.error||ma,ua={};ua[n.TRANSFER_ID]=ra[n.TRANSFER_ID];new g().setData(ua).setURI(qa).setMethod('POST').setHandler(function(va){var wa=va?va.getPayload():{};if(wa.error){ta(wa.error);}else sa();}.bind(this)).setErrorHandler(function(){ta();}.bind(this)).send();},verifyCreditCard:function(pa){var qa=(x.getURIBuilder()).getURI().getPath(),ra=new p('/ajax/payment/token_proxy.php').addQueryData('tpe',qa);new g().setData(pa).setMethod('POST').setURI(ra).setHandler(function(sa){var ta=sa.getPayload();if(!ta.error){i.verifyCreditCard(Object.assign({},ta,{requestID:pa.requestID}));}else i.verifyCreditCardError(Object.assign({},ta,{requestID:pa.requestID}));}.bind(this)).setErrorHandler(function(){i.verifyCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:pa.requestID});}.bind(this)).send();},validateBINNumber:function(pa){pa=pa||{};var qa=new o(pa),ra=(t.getURIBuilder()).setString('bin_number',pa.binNumber).getURI();return new g().setURI(ra).setMethod('GET').setReadOnly(true).setHandler(function(sa){var ta=sa.getPayload();if(!ta.error){i.binNumberValidated(Object.assign({},ta,{requestID:pa.requestID}));}else i.binNumberValidatedError(Object.assign({},ta,{requestID:qa.requestID}));}.bind(this)).send();},getUserEligibility:function(pa){pa=pa||{};var qa=(la.getURIBuilder()).setStringVector('user_ids',pa.userIDs).getURI();return new g().setURI(qa).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ra){var sa=ra.getPayload();if(!sa.error)i.userEligibilityUpdated(sa);}.bind(this)).send();},getFriendsList:function(pa,qa){var ra=(aa.getURIBuilder()).setInt('limit',pa).setString('query',qa).getURI();return new g().setURI(ra).setMethod('GET').setReadOnly(true).setHandler(function(sa){var ta=sa.getPayload();if(!ta.error)i.friendsListUpdated(ta);}.bind(this)).send();},getBannerStates:function(){var pa=(r.getURIBuilder()).getURI();new g().setURI(pa).setMethod('GET').setReadOnly(true).setHandler(function(qa){var ra=qa.getPayload();if(!ra.error)i.bannerStatesUpdated(ra);}.bind(this)).send();},incrementBannerViews:function(pa){var qa=(s.getURIBuilder()).setString('banner_type',pa).getURI();new g().setMethod('POST').setURI(qa).send();},incrementBannerDismissals:function(pa){var qa;i.bannerDismissed(pa);qa=(q.getURIBuilder()).setString('banner_type',pa).getURI();new g().setMethod('POST').setURI(qa).send();},createMoneypennyTransfer:function(pa){var qa=(ba.getURIBuilder()).getURI();new g().setMethod('POST').setURI(qa).setData({item_id:pa.item_id,credential_id:pa.credential_id,amount:pa.amount,external_request_id:pa.external_request_id}).setHandler(function(ra){var sa=ra.getPayload();if(!sa.error){i.moneypennyTransferCreated(Object.assign({},sa,{requestID:pa.requestID}));this.getAllCreditCards();}else i.moneypennyTransferCreatedError(Object.assign({},sa,{requestID:pa.requestID}));}.bind(this)).setErrorHandler(function(){i.moneypennyTransferCreatedError({error:{message:j.getUncaughtErrorMessage()},requestID:pa.requestID});}).send();},createFinancialIncentivesTransfer:function(pa){var qa=(ga.getURIBuilder()).getURI(),ra=pa.success||ma,sa=pa.error||ma,ta={};ta[h.CREDENTIAL_ID]=pa.credential_id;ta.external_request_id=j.genOfflineThreadingID();ta.campaign_name=l.SEVIPER;new g().setData(ta).setURI(qa).setMethod('POST').setHandler(function(ua){var va=ua.getPayload();if(va.error){sa(va.error);}else ra();}).send();},getProductItemBannerData:function(pa){pa=pa||{};var qa=(fa.getURIBuilder()).setString('other_user_id',pa.otherUserID).getURI();return new g().setURI(qa).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ra){var sa=ra.getPayload();if(!sa.error&&!na(sa))i.productItemBannerUpdated(sa);}.bind(this)).send();}};e.exports=oa;},null);
__d("P2PUserEligibilityStore",["P2PActionConstants","EventEmitter","MercuryIDs","P2PAPI","P2PDispatcher"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l,m;for(var n in h)if(h.hasOwnProperty(n))p[n]=h[n];var o=h===null?null:h.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=h;function p(){h.call(this);m={};l=k.register(this.onEventDispatched.bind(this));}p.prototype.onEventDispatched=function(q){var r=q.data,s=q.type;switch(s){case g.USER_ELIGIBILITY_UDPATED:this.handleEligibilityUpdated(r);this.emit('change');break;}};p.prototype.getEligibilityByUserIDs=function(q){var r=[],s,t,u={};for(var v=0;v<q.length;v++){t=q[v];s=m[t];if(s===(void 0)){m[t]=false;r.push(t);}u[t]=m[t];}if(r.length)j.getUserEligibility({userIDs:r});return u;};p.prototype.getEligibilityByUserID=function(q){var r=this.getEligibilityByUserIDs([q]);return r[q];};p.prototype.getEligibilityByThreadID=function(q){return (this.getEligibilityByUserID(i.getUserIDFromThreadID(q)));};p.prototype.handleEligibilityUpdated=function(q){for(var r=0;r<q.length;r++)m[q[r].user_id]=q[r].p2p_eligible;};e.exports=new p();},null);
__d("P2PAmountUtils",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g=10000,h={isAmountOverLegalLimit:function(i){return parseFloat(this.sanitizeAmount(i))>=g;},isAmountZero:function(i){return parseFloat(this.sanitizeAmount(i))===0;},isValidSendAmount:function(i){return !this.isAmountOverLegalLimit(i)&&!this.isAmountZero(i);},sanitizeAmount:function(i){return i.replace(/[^0-9\.]+/g,'');}};e.exports=h;},null);
__d("DOMP2PTrigger",["CurrentEnvironment","JSXDOM","P2PAmountUtils","P2PTriggersUtils","TransformTextToDOMMixin","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={MAX_ITEMS:40,match:function(n){var o=j.getMatches(n);if(!o||!o.length)return false;var p=o[0];if(!i.isValidSendAmount(p))return false;var q=o.index;return {startIndex:q,endIndex:q+p.length,element:this._element(p)};},_element:function(n){return (h.a({href:"#",className:(("_35i0")+(g.facebookdotcom?' '+"_4g4e":'')),"data-p2p-trigger":n},n));}};e.exports=Object.assign(m,k);},null);
__d("p2pTriggerJSXDOMToString",["DOMEmoji","DOMEmote","DOMP2PTrigger","JSXDOM","transformTextToDOM"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=function(m,n,o,p){var q=[];if(p)q.push(i);if(n)q.push(g);if(o)q.push(h);return (j.span(null,k(m,q))).innerHTML;};e.exports=l;},null);
__d("P2PTriggers.react",["DOM","Event","MercuryIDs","P2PActions","P2PUserEligibilityStore","StoreAndPropBasedStateMixin","React","nullthrows","p2pTriggerJSXDOMToString"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=m,q=p.PropTypes,r=m.createClass({displayName:"P2PTriggers",mixins:[l(k)],propTypes:{renderEmoji:q.bool,renderEmoticons:q.bool,text:q.string.isRequired,threadID:q.string.isRequired},getInitialState:function(){return {amount:''};},statics:{calculateState:function(s){var t=i.isGroupChat(s.threadID)||k.getEligibilityByThreadID(s.threadID);return {isThreadEligible:t};}},_clickListeners:(null),componentDidMount:function(){this._clickListeners=[];this.bindClickListeners();},componentWillUnmount:function(){this.unbindClickListeners();},bindClickListeners:function(){var s=n(this._clickListeners);if(!s.length){var t=g.scry(m.findDOMNode(this),'[data-p2p-trigger]');for(var u=0,v=t.length;u<v;u++)s.push(h.listen(t[u],'click',this.handleTriggerClick));}},unbindClickListeners:function(){var s;if(this._clickListeners){for(var t=0,u=this._clickListeners.length;t<u;t++){s=this._clickListeners[t];if(s)s.remove();}this._clickListeners=[];}},componentDidUpdate:function(s,t){if(!t.isThreadEligible&&this.state.isThreadEligible)this.bindClickListeners();},getAmountFromTriggerClickEvent:function(s){var t=s.target.getAttribute('data-p2p-trigger')||'';return t.replace(/[^0-9\.]+/g,'');},handleTriggerClick:function(s){s.preventDefault();var t=this.getAmountFromTriggerClickEvent(s);this.setState({amount:t});this.openSendView();},openSendView:function(){j.chatSendViewOpened({threadID:this.props.threadID,amount:this.state.amount});},render:function(){var s=o(this.props.text,this.props.renderEmoji,this.props.renderEmoticons,this.state.isThreadEligible);return (m.createElement("span",{dangerouslySetInnerHTML:{__html:s}}));}});e.exports=r;},null);
__d("TextWithEntitiesAndP2P.react",["BaseTextWithEntities.react","Link.react","P2PTriggers.react","React"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=j.createClass({displayName:"TextWithEntitiesAndP2P",_renderText:function(l){return (j.createElement(i,{text:l,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji,threadID:this.props.threadID}));},_renderRange:function(l,m){if(this.props.interpolator){return this.props.interpolator(l,m);}else return (j.createElement(h,{href:m.entity},l));},render:function(){return (j.createElement(g,j.__spread({},this.props,{textRenderer:this._renderText,rangeRenderer:this._renderRange,ranges:this.props.ranges,imageRanges:this.props.imageRanges,aggregatedRanges:this.props.aggregatedRanges,text:this.props.text})));}});e.exports=k;},null);
__d("getURLRanges",["URI","URLScraper"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(j,k){k=k||0;var l=h.match(j);if(!l)return [];var m=l;if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(l)))m='http://'+l;if(!g.isValidURI(m))return [];k+=j.indexOf(l);var n=l.length,o=[{offset:k,length:l.length,entity:{url:m}}];return o.concat(i(j.substr(k+n),k+n));}e.exports=i;},null);
__d("MercuryMessageBody.react",["EmoticonsList","React","Link.react","P2PTriggersUtils","ReactComponentWithPureRenderMixin","SupportedEmoji","TextWithEntities.react","TextWithEntitiesAndP2P.react","URI","URLMatcher","cancelAnimationFrame","cx","fbt","getURLRanges","isFacebookURI","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=h,x=w.PropTypes,y=h.createClass({displayName:"MercuryMessageBody",mixins:[k],propTypes:{body:x.string,ranges:x.array,threadID:x.string},getInitialState:function(){return {richText:false};},_shouldRenderP2PTriggers:false,componentDidMount:function(){this._raf=v(this.setIsRichText);},targetBlankLinkInterpolator:function(z,aa){if(aa.entity&&aa.entity.url){var ba=new o(aa.entity.url);if(u(ba)&&!ba.getFragment())aa.entity.url=ba.addQueryData({__mref:'message_bubble'}).toString();}return (h.createElement(i,{href:aa.entity.url,shimhash:aa.entity.shimhash,target:"_blank"},z));},setIsRichText:function(){delete this._raf;var z=this.props,aa=z.body,ba=z.ranges;aa=aa||'';this._shouldRenderP2PTriggers=!!(this.props.threadID&&j.canSeeTriggers(this.props.threadID)&&j.getMatches(aa));if((ba&&ba.length)||g.noncapturingRegexp.test(aa)||l.findEmoji(aa)||p.match(aa)||this._shouldRenderP2PTriggers)this.setState({richText:true});},componentWillUnmount:function(){this._raf&&q(this._raf);},render:function(){var z=this.props.body||'',aa;if(z.startsWith('?OTR'))return (h.createElement("span",{className:"_89h"},s._("[encrypted message]")));z=z.replace(/\s+$/,'');if(z.length===0)return null;if(!this.state.richText)return h.createElement("span",{className:this.props.className},z);var ba=this.props.ranges;if(ba==undefined)ba=t(z);aa={className:this.props.className,interpolator:this.targetBlankLinkInterpolator,text:z,ranges:ba,renderEmoticons:true,renderEmoji:true};if(this._shouldRenderP2PTriggers){return (h.createElement(n,h.__spread({},aa,{threadID:this.props.threadID})));}else return (h.createElement(m,h.__spread({},aa)));}});e.exports=y;},null);
__d("XGamesGripperNoteUpdaterController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/async\/games\/gripper_note_viewed\/",{});},null);
__d("SidebarAppTickerResizer",["Animation","Arbiter","AsyncRequest","ChatSidebar","CSS","cx","debounce","DOMQuery","Event","SimpleDrag","TickerController","$","queryThenMutateDOM","XGamesGripperNoteUpdaterController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=1e-07,u=1,v=85,w=173,x=300,y=46,z=90,aa=82,ba=150;function ca(da,ea,fa,ga,ha){"use strict";this.$SidebarAppTickerResizer0=r('pagelet_ticker');this.$SidebarAppTickerResizer1=r('pagelet_canvas_nav_content');this.$SidebarAppTickerResizer2=this.$SidebarAppTickerResizer0.parentNode;this.$SidebarAppTickerResizer3=ha;this.$SidebarAppTickerResizer1.style.height=fa;this.$SidebarAppTickerResizer4(da,ea);if(fa===null)if(ga!==null){this.$SidebarAppTickerResizer5();this.$SidebarAppTickerResizer6(this.$SidebarAppTickerResizer7());}else h.subscribe('AppsDivebar/show-apps',this.$SidebarAppTickerResizer5.bind(this));if(!ha){this.$SidebarAppTickerResizer8();k.hide(da);}h.subscribe('ChatSidebarDropdown/closeTicker',this.$SidebarAppTickerResizer8.bind(this));h.subscribe('ChatSidebarDropdown/openTicker',this.$SidebarAppTickerResizer9.bind(this));h.subscribe('sidebar/show',this.$SidebarAppTickerResizera.bind(this));if(ga){var ia=n.scry(document.body,'#pagelet_ticker')[0],ja=ia&&ia.parentNode,ka,la=function(){if(!k.shown(ja))return;var ma=b('XGamesGripperNoteUpdaterController').getURIBuilder().getURI();new i().setURI(ma).send();ga.show();if(ka)ka.unsubscribe();};if(ja&&k.shown(ja)){la();}else ka=h.subscribe('ticker/show',la);}this.$SidebarAppTickerResizerb=m(this.$SidebarAppTickerResizer5.bind(this),200);o.listen(window,'resize',this.$SidebarAppTickerResizerb);h.inform('Ticker/resized');}ca.prototype.$SidebarAppTickerResizera=function(){"use strict";q.show(this.$SidebarAppTickerResizer0);};ca.prototype.$SidebarAppTickerResizer5=function(da){"use strict";s(function(){this.$SidebarAppTickerResizerc();}.bind(this),function(){var ea=Math.round(parseFloat(this.$SidebarAppTickerResizer0.style.height));if(ea>Math.round(this.$SidebarAppTickerResizerd())||this.$SidebarAppTickerResizere&&this.$SidebarAppTickerResizere>u){var fa=(this.$SidebarAppTickerResizere/this.$SidebarAppTickerResizerf)*100,ga=this.$SidebarAppTickerResizerg(0,this.$SidebarAppTickerResizerd()-fa);if(!(da&&da.type==='resize'))this.$SidebarAppTickerResizerh(ga);j.resize();}}.bind(this));};ca.prototype.$SidebarAppTickerResizerd=function(){"use strict";if(!this.$SidebarAppTickerResizer3)return 0;if(!j.isVisible())return z;return Math.min(z,(this.$SidebarAppTickerResizerf-this.$SidebarAppTickerResizeri-aa)*100/this.$SidebarAppTickerResizerf);};ca.prototype.$SidebarAppTickerResizer4=function(da,ea){"use strict";var fa=new p(da);fa.subscribe('start',this.$SidebarAppTickerResizerj.bind(this));fa.subscribe(['update','end'],this.$SidebarAppTickerResizerk.bind(this));var ga=new p(ea);ga.subscribe('start',this.$SidebarAppTickerResizerj.bind(this));ga.subscribe('update',this.$SidebarAppTickerResizerl.bind(this));ga.subscribe('end',this.$SidebarAppTickerResizerm.bind(this));};ca.prototype.$SidebarAppTickerResizerj=function(da,event){"use strict";this.$SidebarAppTickerResizern=event.clientY;this.$SidebarAppTickerResizerc();this.$SidebarAppTickerResizero();};ca.prototype.$SidebarAppTickerResizerc=function(){"use strict";this.$SidebarAppTickerResizeri=this.$SidebarAppTickerResizer1.offsetTop;this.$SidebarAppTickerResizerp=this.$SidebarAppTickerResizer0.offsetHeight;this.$SidebarAppTickerResizerf=this.$SidebarAppTickerResizer2.offsetHeight;this.$SidebarAppTickerResizere=this.$SidebarAppTickerResizer1.offsetHeight;this.$SidebarAppTickerResizerq=this.$SidebarAppTickerResizere;};ca.prototype.$SidebarAppTickerResizero=function(){"use strict";k.addClass(this.$SidebarAppTickerResizer2,"_4vfq");};ca.prototype.$SidebarAppTickerResizerr=function(){"use strict";k.removeClass(this.$SidebarAppTickerResizer2,"_4vfq");};ca.prototype.$SidebarAppTickerResizerk=function(da,event){"use strict";var ea=(this.$SidebarAppTickerResizere/this.$SidebarAppTickerResizerf)*100,fa=this.$SidebarAppTickerResizerg(event.clientY-this.$SidebarAppTickerResizern,this.$SidebarAppTickerResizerd()-ea);if(da=='end'){this.$SidebarAppTickerResizerr();this.$SidebarAppTickerResizerh(fa);}j.resize();};ca.prototype.$SidebarAppTickerResizerl=function(da,event){"use strict";var ea=-this.$SidebarAppTickerResizere,fa=this.$SidebarAppTickerResizer7()-this.$SidebarAppTickerResizere,ga=this.$SidebarAppTickerResizers(event.clientY-this.$SidebarAppTickerResizern,ea,fa);this.$SidebarAppTickerResizerg(-ga,this.$SidebarAppTickerResizerd());this.$SidebarAppTickerResizerq=this.$SidebarAppTickerResizere+ga;this.$SidebarAppTickerResizerq=Math.max(u,this.$SidebarAppTickerResizerq);this.$SidebarAppTickerResizer1.style.height=this.$SidebarAppTickerResizerq+'px';};ca.prototype.$SidebarAppTickerResizerm=function(da,event){"use strict";var ea=this.$SidebarAppTickerResizerq,fa=this.$SidebarAppTickerResizeru(this.$SidebarAppTickerResizerq),ga=this.$SidebarAppTickerResizerg(this.$SidebarAppTickerResizere-fa,this.$SidebarAppTickerResizerd());if(this.$SidebarAppTickerResizere!=fa){this.$SidebarAppTickerResizer6(fa);this.$SidebarAppTickerResizerh(ga);}new g(this.$SidebarAppTickerResizer1).from('height',ea).to('height',fa).duration(x).go();};ca.prototype.$SidebarAppTickerResizerg=function(da,ea){"use strict";var fa=this.$SidebarAppTickerResizerp+da,ga=(fa/this.$SidebarAppTickerResizerf)*100;ga=Math.max(t,Math.min(ea,ga));this.$SidebarAppTickerResizer0.style.height=ga+'%';if(ga!=t){k.removeClass(this.$SidebarAppTickerResizer0,'hidden_elem');this.$SidebarAppTickerResizera();}return ga;};ca.prototype.$SidebarAppTickerResizeru=function(da){"use strict";var ea=this.$SidebarAppTickerResizerv(),fa=this.$SidebarAppTickerResizer7();return (da<(fa-y))?((da<(ea-y))?u:ea):fa;};ca.prototype.$SidebarAppTickerResizerv=function(){"use strict";return v;};ca.prototype.$SidebarAppTickerResizer7=function(){"use strict";return w;};ca.prototype.$SidebarAppTickerResizerw=function(da){"use strict";var ea=this.$SidebarAppTickerResizer7();return (da<0)?u:(da>ea?ea:da);};ca.prototype.$SidebarAppTickerResizers=function(da,ea,fa){"use strict";return (da<ea)?ea:((da>fa)?fa:da);};ca.prototype.$SidebarAppTickerResizerh=function(da){"use strict";new i('/ajax/feed/ticker/resize').setData({height:''+da}).setMethod('POST').send();h.inform('Ticker/resized');};ca.prototype.$SidebarAppTickerResizer6=function(da){"use strict";new i('/ajax/feed/apps/resize').setData({height:''+da}).setMethod('POST').send();};ca.prototype.$SidebarAppTickerResizerx=function(da){"use strict";var ea=this.$SidebarAppTickerResizerp,fa=this.$SidebarAppTickerResizerf*da/100;new g(this.$SidebarAppTickerResizer0).from('height',ea).to('height',fa).duration(ba).ondone(function(){this.$SidebarAppTickerResizer0.style.height=da+'%';this.$SidebarAppTickerResizerh(da===0?'0.0':da);j.resize();}.bind(this)).go();};ca.prototype.$SidebarAppTickerResizer8=function(){"use strict";this.$SidebarAppTickerResizerc();this.$SidebarAppTickerResizerx(0);};ca.prototype.$SidebarAppTickerResizer9=function(){"use strict";this.$SidebarAppTickerResizer0.style.height='40px';q.show(this.$SidebarAppTickerResizer0,function(){this.$SidebarAppTickerResizerc();var da=((this.$SidebarAppTickerResizerf-this.$SidebarAppTickerResizeri-aa-this.$SidebarAppTickerResizere)*50/this.$SidebarAppTickerResizerf);this.$SidebarAppTickerResizerx(da);}.bind(this));};e.exports=ca;},null);
__d("ChatAnimatedGifs",["URI"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={shouldHideBody:function(i){if(!i.has_attachment)return false;for(var j=0;j<i.attachments.length;j++){var k=i.attachments[j];if(k.preview_url){var l=h.getRawUrlFromSafeUrl(k.preview_url);if(i.body==l)return true;}}return false;},getRawUrlFromSafeUrl:function(i){return new g(i).getQueryData().url;}};e.exports=h;},null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=function(k,l){this._userID=k;this._logger=h.create('blackbird');this._getState=function(){if(g.isOnline())return i.allows(this._userID)?j.NORMAL:j.BLOCKED;return j.OFFLINE;};this._togglePrivacy=function(){var m=this._getState();switch(this._getState()){case j.OFFLINE:if(g.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});g.goOnline(function(){if(!i.allows(this._userID)){if(this._getState()!==j.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case j.BLOCKED:i.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case j.NORMAL:i.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout(function(){var m=function(){l&&l(this._getState());}.bind(this);m();this._subscribeToken=i.subscribe('privacy-changed',m);}.bind(this),0);};j.OFFLINE='offline';j.BLOCKED='blocked';j.NORMAL='normal';Object.assign(j.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&i.unsubscribe(this._subscribeToken);}});e.exports=j;},null);
__d("ChatDateBreak.react",["ChatConfig","React","Timestamp.react","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=h,n=m.PropTypes,o=h.createClass({displayName:"ChatDateBreak",propTypes:{date:n.instanceOf(Date).isRequired},shouldComponentUpdate:function(p){return this.props.date.getTime()!==p.date.getTime();},render:function(){var p=this.props.date,q;if(g.get('webmessenger_chat_tab_redesign')){q=k(this.props.date,{today:'g:ia',withinWeek:'D g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});return (h.createElement("time",{className:l(this.props.className,"_5w-5")},h.createElement("span",{className:"_5w-6"},q)));}q=k(p,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'});var r=Math.round(p.getTime()/1000);return (h.createElement("div",h.__spread({},this.props,{className:l(this.props.className,"_5w-5")}),h.createElement("div",{className:"_5w-6"},h.createElement(i,{time:r,verbose:q,text:q}))));}});e.exports=o;},null);
__d("ChatAuthorPhotoBlock.react",["MercuryParticipants","React","cx","fbt","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=h,n=m.PropTypes,o=86400000,p=h.createClass({displayName:"ChatAuthorPhotoBlock",propTypes:{authorID:n.string.isRequired,className:n.string,hideName:n.bool,hidePhoto:n.bool,timestamp:n.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(q){if(q.authorID!=this.state.author.id)this.updateAuthor(q.authorID);},render:function(){return (h.createElement("div",h.__spread({},this.props,{className:l(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (h.createElement("div",{className:"_5ys-",ref:"name"},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var q=null;if(this.props.timestamp){var r=this._getFormat(this.props.timestamp);q=k(new Date(this.props.timestamp),r);}var s=j._("{name} {time}",[j.param("name",this.state.author.name),j.param("time",q)]);return (h.createElement("a",{"aria-label":s,className:"_5ys_","data-hover":"tooltip","data-tooltip-position":"left",href:this.state.author.href||'#',ref:"link"},h.createElement("img",{src:this.state.author.image_src,ref:"image"})));}},updateAuthor:function(q){g.get(q,function(r){this.isMounted()&&this.setState({author:r});}.bind(this));},_getFormat:function(q){if(Date.now()-this.props.timestamp<o){return 'g:ia';}else if((new Date()).getFullYear()===(new Date(q).getFullYear())){return 'M jS, g:ia';}else return 'M j, Y g:ia';}});e.exports=p;},null);
__d("MessageBubbleMixin",["DOMDimensions","React"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=2,j={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(k){if(k.maxWidth!==this.props.maxWidth||k.body!==this.props.body||(!k.attachments&&this.props.attachments))this._restyleBubble(k);},_restyleBubble:function(k){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var l=h.findDOMNode(this.refs.bubble);if(k.maxWidth!==this.props.maxWidth||g.getElementDimensions(l).width>this.props.maxWidth){var m=this.props.maxWidth;this.setState({bubbleWidth:m},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var k=h.findDOMNode(this.refs.bubble),l=g.getElementDimensions(k).width,m=h.findDOMNode(this.refs.content),n=(m)?(g.getElementDimensions(m).width+g.measureElementBox(h.findDOMNode(this.refs.contentWrapper),'width',true,false,false)):0,o=n+i;if(n>0&&o<this.props.maxWidth&&l-o-this.getBoxWidth()>0)this.setState({bubbleWidth:o});}};e.exports=j;},null);
__d("ChatBubble.react",["ChatConfig","DOMDimensions","MercuryMessageBody.react","MessageBubbleMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=null,q=k.createClass({displayName:"ChatBubble",mixins:[j],propTypes:{attachments:o.node,body:o.string,maxWidth:o.number.isRequired,threadID:o.string},_renderContent:function(){if(!this.props.body)return null;return (k.createElement("div",{className:"_d97",ref:"contentWrapper"},k.createElement("span",{className:"_5yl5",ref:"content"},k.createElement(i,{body:this.props.body,ranges:this.props.ranges,threadID:this.props.threadID}))));},render:function(){return (k.createElement("div",k.__spread({},this.props,{className:m((("_5w1r")+(g.get('webmessenger_chat_tab_redesign')?' '+"_3_om":'')),this.props.className),ref:"bubble",style:{maxWidth:this.props.maxWidth,width:this.state.bubbleWidth}}),this._renderContent(),this.props.attachments));},contentWraps:function(){var r=k.findDOMNode(this.refs.content),s=r.getClientRects(),t=h.getElementDimensions(r).height;return (s&&s.length>1&&s[0].height<t);},getBoxWidth:function(){if(!p)p=h.measureElementBox(k.findDOMNode(this.refs.bubble),'width',true,true,false);return p;}});e.exports=q;},null);
__d("ChatMessage.react",["BootloadedComponent.react","ChatAnimatedGifs","ChatAuthorPhotoBlock.react","ChatBubble.react","ChatConfig","CSS","ImmutableObject","JSResource","MercuryAttachment","MercuryAttachmentType","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercuryMessageInfo","MercuryShareStyleMap","MercuryDisplayTimeFilterMessageRenderer","React","XUISpinner.react","cx","isRTL","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=w,ca=ba.PropTypes,da=w.createClass({displayName:"ChatMessage",propTypes:{message:ca.instanceOf(m).isRequired,maxBubbleWidth:ca.number.isRequired,onAttachmentLoad:ca.func,onStickerClick:ca.func},componentDidMount:function(){l.conditionClass(w.findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var fa=this.props.message;return (t.isInbound(fa)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(fa,ga){return fa.message!==this.props.message;},render:function(){var fa=this.props.message,ga=o.get(fa).length>0,ha=t.isInbound(fa),ia=r.isGroupChat(fa.thread_id),ja=z(fa.body),ka=q.hasErrorStatus(fa),la=(("_5wd4")+(ha?' '+"_1nc7":'')+(!ha?' '+"_1nc6":'')+(ga?' '+"_2_-t":'')+(ha&&ia?' '+"_5ysy":'')+(ka?' '+"_1zcs":'')+(ja?' '+"direction_rtl":'')+(!ja?' '+"direction_ltr":''));if(k.get('webmessenger_chat_tab_redesign'))return (w.createElement("div",{className:aa(this.props.className,la)},this._renderInner(),this._renderUndertext()));return (w.createElement(i,w.__spread({},this.props,{authorID:fa.author,className:aa(this.props.className,la),hideName:!ha||!ia,hidePhoto:!ha,timestamp:fa.timestamp}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){var fa=this.props.message;if(fa.is_filtered_content)return (w.createElement("div",{className:"_5wd9 uiBoxYellow clearfix",ref:"inner"},v.renderFilteredContent(fa)));return (w.createElement("div",{className:"_5wd9",ref:"inner"},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (w.createElement("div",{className:"_3ry4",ref:"undertext"},w.createElement(s,{className:"_5wda clearfix",message:this.props.message,ref:"status"}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?w.createElement(g,{bootloadPlaceholder:w.createElement("span",null),bootloadLoader:n('MercurySpoofWarning.react'),authorID:this.props.message.author,className:"_5wdb"}):null);},_getAttachmentPlaceholder:function(){return (w.createElement("div",{style:{padding:'20px',text_align:'center'}},w.createElement(x,null)));},_renderAttachments:function(fa){var ga=this.props.message,ha=fa=='inside'?'attachmentsInside':'attachmentsOutside',ia=o.get(ga).filter(function(ja){var ka=o.isBubblePreferred(ja);if(!k.get('webmessenger_chat_tab_redesign'))ka=ka||ga.body;return (ka&&fa==='inside')||(!ka&&fa==='outside');});if(ia.length>0)return (w.createElement(g,{bootloadPlaceholder:this._getAttachmentPlaceholder(),bootloadLoader:n('MercuryAttachments.react'),className:((fa==='outside'?"_3e7u":'')+(!!ga.body?' '+"_16ys":'')+(k.get('webmessenger_chat_tab_redesign')?' '+"_n4o":'')),isChat:true,message:ga,attachments:ia,ref:ha,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,maxWidth:this.props.maxBubbleWidth}));},_renderBubble:function(){var fa=this.props.message,ga=fa.body,ha=this._renderAttachments('inside'),ia=t.isInbound(fa);if(h.shouldHideBody(fa))ga='';if(ga||ha)return (w.createElement("div",{className:(("_5wde")+(k.get('webmessenger_chat_tab_redesign')?' '+"_n4o":''))},w.createElement(j,{attachments:ha,body:ga,className:(("_5wdf")+(ea(fa,ia)?' '+"_3okg":'')),maxWidth:this.props.maxBubbleWidth,ranges:fa.ranges,ref:"bubble",threadID:fa.thread_id})));}});function ea(fa,ga){if(k.get('webmessenger_chat_tab_redesign'))return false;var ha=o.get(fa);if(!fa.body&&ha)return !ha.some(function(ia){if(ia.attach_type!==p.SHARE||!ia.share)return false;var ja=u.getStyleFactory(ia.share);if(ja){var ka=ja.factory;return (ka.requiresNoBubbleTail&&ka.requiresNoBubbleTail(ia,ga));}return false;});return true;}e.exports=da;},null);
__d("MercuryLogMessage.react",["DOM","Event","ImmutableObject","MercuryLogMessageRenderer","MercuryConfig","React","cx","emptyFunction","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=l,r=q.PropTypes,s=l.createClass({displayName:"MercuryLogMessage",propTypes:{maxWidth:r.number,message:r.instanceOf(i).isRequired,onImageLoad:r.func},getDefaultProps:function(){return {onImageLoad:n};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(t){j.renderText(t.message,function(u){this.setState({messageText:u});}.bind(this));},shouldComponentUpdate:function(t,u){return (this.state.messageText!=u.messageText||t.maxWidth!==this.props.maxWidth);},componentDidUpdate:function(){var t=l.findDOMNode(this.refs.attachment);j.renderAttachmentLegacy(t,this.props.message);g.scry(t,'img').forEach(function(u){var v=h.listen(u,'load',function(){this.props.onImageLoad(u);v.remove();}.bind(this));}.bind(this));},render:function(){return (l.createElement("div",l.__spread({},this.props,{className:p(this.props.className,"_5ye6"),style:Object.assign({},this.props.style,this._getStyle()),title:o(new Date(this.props.message.timestamp),'g:ia')}),k.ChatTabMessengerStyle?null:j.renderIcon(this.props.message),l.createElement("div",{className:"_5ye7"},k.ChatTabMessengerStyle?j.renderIcon(this.props.message):null,this.state.messageText),l.createElement("div",{className:"_5ye8",ref:"attachment"})));},_getStyle:function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;}});e.exports=s;},null);
__d("ChatMessageGroup.react",["immutable","ImmutableObject","MercuryParticipants","ChatDateBreak.react","ChatMessage.react","cx","fbt","React","StoreAndPropBasedStateMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=n,q=p.PropTypes,r=new h({name:'',href:'#',image_src:''}),s=n.createClass({displayName:"ChatMessageGroup",mixins:[o(i)],propTypes:{activeMessageID:q.string,author:q.string,hasDateBreak:q.bool,isCanonical:q.bool,isFromViewer:q.bool,isPageMessage:q.bool,maxBubbleWidth:q.number,messages:q.instanceOf(g.List).isRequired,onAttachmentLoad:q.func},statics:{calculateState:function(u){return {participants:t(u)};}},shouldComponentUpdate:function(u,v){return (this.props.activeMessageID!==u.activeMessageID||this.props.isFromViewer!==u.isFromViewer||!g.is(this.props.messages,u.messages)||!g.is(this.state.participants,v.participants));},render:function(){return (n.createElement("div",{className:"_4tdt"},this._renderProfileColumn(),this._renderName(),n.createElement("div",{className:"_4tdv"},this._renderMessages())));},_renderProfileColumn:function(){if(this.props.isFromViewer)return null;var u=this.state.participants.get(this.props.author)||r,v=m._("{name}",[m.param("name",u.name)]);return (n.createElement("a",{"aria-label":v,className:"_4tdw","data-hover":"tooltip","data-tooltip-position":"left",href:u.href,ref:"link"},n.createElement("img",{src:u.image_src,ref:"image"})));},_renderName:function(){if(this.props.isCanonical||this.props.isFromViewer)return null;var u=this.state.participants.get(this.props.messages.first().author);if(!u)return null;return (n.createElement("div",{className:"_4tdx"},u.short_name));},_renderMessages:function(){var u=this.props.messages.size,v=[];this.props.messages.forEach(function(w,x,y){var z=w.message_id===this.props.activeMessageID;if(z&&!(x===0&&this.props.hasDateBreak))v.push(n.createElement(j,{date:new Date(w.timestamp),key:'db:'+w.message_id}));v.push(n.createElement(k,{isFromViewer:this.props.isFromViewer,key:w.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:w,nextTimestamp:this._getNextTimestamp(y,u,x),onAttachmentLoad:this.props.onAttachmentLoad}));}.bind(this));return v;},_getNextTimestamp:function(u,v,w){return (w<v-1)?u.get(w+1).timestamp:this.props.nextTimestamp;}});function t(u){return g.Map().withMutations(function(v){u.readReceipts.forEach(function(w,x){v.set(x,i.getOrFetch(x));});v.set(u.author,i.getOrFetch(u.author));});}e.exports=s;},null);
__d("MessengerDomIDs",["uniqueID"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h={CONVERSATION:g()};e.exports=h;},null);
__d("MessageList.react",["immutable","MercuryActionType","MercuryIDs","MercuryMessageGroup","MercuryShareAttachmentRenderLocations","MessengerDomIDs","ReactComponentWithPureRenderMixin","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=n,q=p.PropTypes,r=1000*60*60,s=n.createClass({displayName:"MessageList",mixins:[m],propTypes:{DateBreak:q.func.isRequired,deliveryTimestamp:q.number.isRequired,isCanonical:q.bool,isPageMessage:q.bool,location:q.string.isRequired,LogMessage:q.func.isRequired,MessageGroup:q.func.isRequired,messages:q.instanceOf(g.List).isRequired,onAttachmentLoad:q.func,readReceipts:q.instanceOf(g.OrderedMap).isRequired,viewer:q.string.isRequired},getInitialState:function(){return {activeMessageID:null,messageGroups:j.calculateMessageGroups(this.props.messages,this.props.location)};},componentWillReceiveProps:function(y){if(y.messages!==this.props.messages)this.setState({messageGroups:j.calculateMessageGroups(y.messages,y.location)});},render:function(){var y=this.props,z=y.DateBreak,aa=y.location,ba=y.LogMessage,ca=y.MessageGroup,da=[],ea=this.state.activeMessageID,fa=this.state.messageGroups,ga=fa.length,ha=this.props.readReceipts,ia=ha.last()||0,ja=i.getParticipantIDFromUserID(this.props.viewer);for(var ka=0;ka<ga;ka++){var la=(ka>0)?fa[ka-1]:null,ma=(la&&la.length>0)?la[la.length-1]:null,na=fa[ka],oa=na[0],pa=na[na.length-1],qa=false;if(!ma||oa.timestamp-ma.timestamp>r){qa=true;da.push(n.createElement(z,{date:new Date(oa.timestamp),key:'db:'+oa.message_id}));}if(oa.action_type==h.LOG_MESSAGE){da.push(n.createElement(ba,{className:aa===k.CHAT?"_5w0o":null,key:oa.message_id,message:oa,onImageLoad:this.props.onAttachmentLoad,viewer:this.props.viewer}));continue;}na=g.List(na);var ra=u(fa,ga,ka),sa=!w(ha,na,ra),ta=v(ia,oa),ua=x(this.props.deliveryTimestamp,pa);da.push(n.createElement(ca,{activeMessageID:t(ea,na),author:na.first().author,deliveryTimestamp:ua,hasDateBreak:qa,isCanonical:this.props.isCanonical,isFromViewer:ja===oa.author,isPageMessage:this.props.isPageMessage,key:'mg:'+oa.message_id,lastReadTimestamp:ta,maxBubbleWidth:this.props.maxBubbleWidth,messages:na,nextTimestamp:ra,onAttachmentLoad:this.props.onAttachmentLoad,onMessageDeselect:this._handleMessageDeselect,onMessageSelect:this._handleMessageSelect,readReceipts:sa?ha:g.OrderedMap()}));}return (n.createElement("div",{id:aa===k.MESSENGER?l.CONVERSATION:null},da));},_handleMessageDeselect:function(y){this.setState(function(z){return {activeMessageID:z.activeMessageID===y?null:z.activeMessageID};});},_handleMessageSelect:function(y){this.setState({activeMessageID:y});}});function t(y,z){return z.find(function(aa){return aa.message_id===y;})?y:null;}function u(y,z,aa){return (aa<z-1)?y[aa+1][0].timestamp:Infinity;}function v(y,z){return z.timestamp>y?y:Infinity;}function w(y,z,aa){return (z.isEmpty()||y.last()<z.first().timestamp||y.first()>=aa);}function x(y,z){return z.timestamp>y?y:Infinity;}e.exports=s;},null);
__d("ChatConversation.react",["ChatConfig","ChatDateBreak.react","ChatMessage.react","immutable","MercuryActionType","MercuryLogMessage.react","MercuryShareAttachmentRenderLocations","React","cx","invariant","ChatMessageGroup.react","MessageList.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q,r;if(g.get('webmessenger_chat_tab_redesign')){q=b('ChatMessageGroup.react');r=b('MessageList.react');}var s=n,t=s.PropTypes,u=1000*60*60,v=n.createClass({displayName:"ChatConversation",propTypes:{contextBanner:t.object,isCanonical:t.bool.isRequired,maxBubbleWidth:t.number.isRequired,messages:t.instanceOf(j.List).isRequired,onAttachmentLoad:t.func,onStickerClick:t.func,viewer:t.string.isRequired},componentWillReceiveProps:function(w){p(w.maxBubbleWidth===this.props.maxBubbleWidth);},render:function(){if(g.get('webmessenger_chat_tab_redesign'))return (n.createElement("div",null,this.props.contextBanner,n.createElement(r,{DateBreak:h,deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:m.CHAT,LogMessage:l,maxBubbleWidth:this.props.maxBubbleWidth,MessageGroup:q,messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,readReceipts:j.OrderedMap(),viewer:this.props.viewer})));var w=this.props.messages.toArray(),x=[];for(var y=0;y<w.length;y++){var z=w[y],aa=(y>0)?w[y-1]:null;if(!aa||z.timestamp-aa.timestamp>u)x.push(n.createElement(h,{date:new Date(z.timestamp),key:'db:'+z.message_id}));if(z.action_type==k.LOG_MESSAGE){x.push(n.createElement(l,{className:"_5w0o",key:z.message_id,message:z,onImageLoad:this.props.onAttachmentLoad}));}else x.push(n.createElement(i,{key:z.message_id,message:z,maxBubbleWidth:this.props.maxBubbleWidth,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick}));}return (n.createElement("div",null,this.props.contextBanner,x));}});e.exports=v;},null);
__d("MercuryTypingAnimation.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"MercuryTypingAnimation",propTypes:{color:k.oneOf(['light','dark']),noAnimation:k.bool},getDefaultProps:function(){return {color:'dark',noAnimation:false};},render:function(){var m=(("_4a0v")+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":'')+(this.props.noAnimation?' '+"_374p":''));return (g.createElement("div",{className:i(this.props.className,m)},g.createElement("div",{className:"_4b0g"},g.createElement("div",{className:"_5pd7"}),g.createElement("div",{className:"_5pd7"}),g.createElement("div",{className:"_5pd7"}))));}});e.exports=l;},null);
__d("ChatTypingIndicator.react",["ChatAuthorPhotoBlock.react","ChatConfig","MercuryParticipants","MercuryTypingAnimation.react","ReactComponentWithPureRenderMixin","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=l,p=o.PropTypes,q=l.createClass({displayName:"ChatTypingIndicator",mixins:[k],propTypes:{userID:p.string,showName:p.bool},render:function(){var r=this.props,s=r.userID,t=r.showName;if(h.get('webmessenger_chat_tab_redesign'))return (l.createElement("div",{className:"_4tdt"},this._renderPhoto(s),l.createElement("div",{className:(("_5wd4")+(' '+"_1nc7")+(' '+"_2cnu")+(t?' '+"_5ysy":''))},l.createElement("div",{className:(("_5wd9")+(h.get('webmessenger_chat_tab_redesign')?' '+"_n4o":''))},l.createElement("div",{className:(("_5w1r")+(' '+"_5wdf")+(h.get('webmessenger_chat_tab_redesign')?' '+"_3_om":''))},l.createElement(j,{className:"_5x7x",noAnimation:!h.get('chat_react_typing_animation'),ref:"bubble"}))))));return (l.createElement(g,{authorID:s,className:(("_5wd4")+(' '+"_1nc7")+(t?' '+"_5ysy":'')),hideName:!t},l.createElement("div",{className:"_5wd9"},l.createElement(j,{className:"_3e2s",noAnimation:!h.get('chat_react_typing_animation'),ref:"bubble"}))));},getBubble:function(){return this.refs.bubble;},_renderPhoto:function(r){var s=i.getNow(r),t=n._("{name}",[n.param("name",s.name)]);return (l.createElement("a",{"aria-label":t,className:"_4tdw","data-hover":"tooltip","data-tooltip-position":"left",href:s.href||'#',ref:"link"},l.createElement("img",{src:s.image_src,ref:"image"})));}});e.exports=q;},null);
__d("ChatTypingIndicators.react",["ChatTypingIndicator.react","DOM","MercuryIDs","MercuryThreadInformer","MercuryTypingReceiver","MercuryParticipants","React","SubscriptionsHandler","TooltipData","createObjectFrom","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s=m,t=s.PropTypes,u=m.createClass({displayName:"ChatTypingIndicators",propTypes:{indicatorClass:t.func,indicatorsWillShow:t.func,indicatorsDidShow:t.func,rootClassName:t.string,threadID:t.string.isRequired,viewer:t.string.isRequired},getDefaultProps:function(){return {indicatorClass:g,indicatorsWillShow:q,indicatorsDidShow:q};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){var v=j.getForFBID(this.props.viewer),w=k.getForFBID(this.props.viewer);this._subscriptions=new n();this._subscriptions.addSubscriptions(w.addRetroactiveListener('state-changed',this.typingStateChanged),v.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(v){if(v.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(v,w){if(w.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();l.getMulti(this.state.typingUserIDs,function(v){if(this.isMounted())this.state.typingUserIDs.forEach(function(w){var x=v[w],y=this.refs[w].getBubble();if(y)o.set(m.findDOMNode(y),this.renderTooltip(x.short_name),'above','left');}.bind(this));}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var v=i.isGroupChat(this.props.threadID);return (m.createElement("div",{className:this.props.rootClassName},this.state.typingUserIDs.map(function(w){return this._renderTypingIndicator(w,!!v);}.bind(this))));},_renderTypingIndicator:function(v,w){var x=this.props.indicatorClass;return (m.createElement(x,{key:v,ref:v,showName:w,userID:v}));},renderTooltip:function(v){var w=h.create('span');m.render(m.createElement("span",null,r._("{name} is typing...",[r.param("name",v)])),w);return w;},typingStateChanged:function(v){if(this.props.threadID in v)this.setState({typingUserIDs:v[this.props.threadID].slice().sort()});},messagesReceived:function(v,w){if(this.props.threadID in w){var x=w[this.props.threadID],y=p(x.map(function(z){return z.author;}));this.setState({typingUserIDs:this.state.typingUserIDs.filter(function(z){return !y[z];}).sort()});}}});e.exports=u;},null);
__d("MercuryMessageList",["immutable","LogHistory","Map","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h.getInstance('mercury_message_list');function l(n){this.$MercuryMessageList0=g.List(n||[]);this.$MercuryMessageList1();}l.prototype.append=function(n){var o;this.$MercuryMessageList0=(o=this.$MercuryMessageList0).push.apply(o,n);this.$MercuryMessageList1();m('append',n);};l.prototype.prepend=function(n){var o;this.$MercuryMessageList0=(o=this.$MercuryMessageList0).unshift.apply(o,n);this.$MercuryMessageList1();m('prepend',n);};l.prototype.update=function(n){var o=n.filter(function(p){return this.contains(p);}.bind(this));if(o.length===0)return;this.$MercuryMessageList0=this.$MercuryMessageList0.withMutations(function(p){o.forEach(function(q){var r=this.$MercuryMessageList2.get(q.message_id);if(r!==(void 0))p.set(r,q);}.bind(this));}.bind(this));m('update',o);};l.prototype.reorder=function(n){this.$MercuryMessageList0=g.List(n);this.$MercuryMessageList1();m('reorder',n);};l.prototype.at=function(n){return this.$MercuryMessageList0.get(n);};l.prototype.contains=function(n){return this.$MercuryMessageList2.has(n.message_id);};l.prototype.toArray=function(){return this.$MercuryMessageList0.toArray();};l.prototype.toMap=function(){return new i(g.Seq(this.$MercuryMessageList0).map(function(n){return [n.message_id,n];}));};l.prototype.$MercuryMessageList1=function(){this.$MercuryMessageList2=new i(g.Seq(this.$MercuryMessageList0).map(function(n,o){return [n.message_id,o];}));};function m(event,n){j(function(){k.debug(event,{messageIDs:n.map(function(o){return o.message_id;})});},0);}e.exports=l;},null);
__d("MercuryMessageStore",["MercuryAPIArgsSource","LogHistory","MercuryViewer","MercuryMessageList","SubscriptionsHandler","MercuryThreadlistConstants","mixInEventEmitter","setImmediate","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=b('MercuryMessages').get(),q=b('MercuryThreadInformer').get(),r=b('MercuryThreads').get(),s=h.getInstance('mercury_message_store');function t(v,w){this.$MercuryMessageStore0=v;this.$MercuryMessageStore1=new j();this.$MercuryMessageStore2=1;this.$MercuryMessageStore3=null;this.$MercuryMessageStore4=0;this.$MercuryMessageStore5=w||l.RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore6=new k();this.$MercuryMessageStore6.addSubscriptions(q.subscribe('messages-received',function(x,y){return this.$MercuryMessageStore8(y);}.bind(this)),q.subscribe('messages-updated',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore9(y[this.$MercuryMessageStore0]);}.bind(this)),q.subscribe('messages-reordered',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStorea();}.bind(this)));s.debug('constructed',{threadID:this.$MercuryMessageStore0});this.$MercuryMessageStoreb();}t.prototype.setNewThreadID=function(v){this.$MercuryMessageStorec=v;};t.prototype.destroy=function(){this.$MercuryMessageStore6&&this.$MercuryMessageStore6.release();s.debug('destroyed',{threadID:this.$MercuryMessageStore0});};t.prototype.subscribe=function(v){return this.addRetroactiveListener('updated',v);};t.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return false;this.$MercuryMessageStoreb();return true;};t.prototype.hasFetchedAll=function(){if(p.hasLoadedExactlyNMessages(this.$MercuryMessageStore0,this.$MercuryMessageStore4)&&p.hasLoadedAllMessages(this.$MercuryMessageStore0))return true;return r.isNewEmptyLocalThread(this.$MercuryMessageStore0);};t.prototype.$MercuryMessageStoreb=function(){var v=this.$MercuryMessageStore4+this.$MercuryMessageStore5*this.$MercuryMessageStore2;s.debug('fetching',{threadID:this.$MercuryMessageStore0,limit:v});p.getThreadMessagesRange(this.$MercuryMessageStore0,0,v,this.$MercuryMessageStored.bind(this),null,g.MERCURY);if(this.$MercuryMessageStore2<10)this.$MercuryMessageStore2+=1;if(p.hasLoadedNMessages(this.$MercuryMessageStore0,v))n(function(){this.$MercuryMessageStorea();}.bind(this));};t.prototype.$MercuryMessageStored=function(v){if(v&&v.length){this.$MercuryMessageStore3=v[0].timestamp;this.$MercuryMessageStore4=v.length;s.debug('fetched',{threadID:this.$MercuryMessageStore0,earliestMessageTimestamp:this.$MercuryMessageStore3,count:this.$MercuryMessageStore4});}else if(v&&!v.length&&!this.$MercuryMessageStore4)this.$MercuryMessageStoree(t.THREAD_IS_EMPTY);};t.prototype.$MercuryMessageStore8=function(v){var w=[],x=v[this.$MercuryMessageStore0];if(x&&x.length)w=w.concat(x);if(this.$MercuryMessageStorec){var y=v[this.$MercuryMessageStorec];if(y&&y.length){w=w.concat(y);this.$MercuryMessageStorec=null;}}if(w.length){this.$MercuryMessageStore1.append(w);this.$MercuryMessageStore4+=w.length;var z=w.every(function(aa){return aa.author!=i.getID();});this.$MercuryMessageStoree(t.MESSAGES_RECEIVED,{allFromOthers:z});}};t.prototype.$MercuryMessageStore9=function(v){this.$MercuryMessageStore1.update(p.getMessagesFromIDs(Object.keys(v)));this.$MercuryMessageStoref();this.$MercuryMessageStoree(t.MESSAGES_CHANGED);};t.prototype.$MercuryMessageStorea=function(){if(!this.$MercuryMessageStore3)return;this.$MercuryMessageStore1.reorder(p.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore0,this.$MercuryMessageStore3));this.$MercuryMessageStoref();this.$MercuryMessageStoree(t.MESSAGES_REORDERED);};t.prototype.$MercuryMessageStoree=function(v,w){var x=this.$MercuryMessageStore1.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',Object.assign({messages:x,eventType:v},w));u(this.$MercuryMessageStore0,v,x);};t.prototype.$MercuryMessageStoref=function(){var v=this.$MercuryMessageStore1.at(0);if(v)this.$MercuryMessageStore3=v.timestamp;};function u(v,w,x){o(function(){s.debug('update:'+w,{threadID:v,messageIDs:x.map(function(y){return y.message_id;})});},0);}Object.assign(t,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});m(t,{updated:true});e.exports=t;},null);
__d("ChatTabMessagesView",["Animation","Arbiter","BanzaiLogger","CSS","ChatConversation.react","ChatPerfInstrumentation","ChatTabViewEvents","ChatTypingIndicators.react","ChatWelcomeMessage","CurrentUser","DOM","Event","immutable","MercuryLastMessageIndicator.react","LiveTimer","MercuryIDs","MercuryViewer","MercuryMessageStore","MessengerContextBannerBootloader","MessengerHotLikePreviewEvents","React","ReactComponentRenderer","MercuryShareAttachmentRenderLocations","Scroll","ServerTime","StickerActions","StickerState","StickerStoreController","Style","SubscriptionsHandler","UserAgent_DEPRECATED","arrayContains","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){b.__markCompiled&&b.__markCompiled();'use strict';var oa=70,pa=null,qa=20;function ra(ta){if(pa===null){var ua=ta.childNodes[0];ia.set(ta,'overflow','scroll');pa=ua.clientWidth-oa;ia.set(ta,'overflow','');}return pa;}function sa(ta,ua,va,wa,xa,ya,za,ab,bb){this.loadingIcon=xa;this.threadID=ta;this.sheetController=ua;this.scrollContainer=va;this.conversationElem=wa;this.contextBannerEligible=bb;this.contextBannerElem=null;this.tabView=ab;u.restart(ea.get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;function cb(){m.inform('interaction-with-tab',ta);}this._subscriptions=new ja();this._subscriptions.addSubscriptions(h.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),r.listen(this.scrollContainer,'mousedown',cb));if(ka.firefox()){var db=('WheelEvent' in window)?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(db,cb,false);}else this._subscriptions.addSubscriptions(r.listen(this.scrollContainer,'mousewheel',cb));this._subscriptions.addSubscriptions(r.listen(this.scrollContainer,'scroll',na(this.scrolling,50,this)));var eb;aa.render(aa.createElement(n,{threadID:this.threadID,indicatorsWillShow:function(){return eb=this.isScrolledToBottom();}.bind(this),indicatorsDidShow:function(){return eb&&this.scrollToBottom(true);}.bind(this),viewer:p.getID()}),za);var fb;this.lastMessageIndicatorNode=ya;this.lastMessageIndicator=aa.render(aa.createElement(t,{threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return fb=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return fb&&this.scrollToBottom(true);}.bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}Object.assign(sa.prototype,{initializeConversation:function(){this._store=new x(this.threadID);this._conversation=new ba(k,this.conversationElem);this._conversation.setProps({isCanonical:v.isCanonical(this.threadID),maxBubbleWidth:ra(this.scrollContainer),messages:s.List(),onAttachmentLoad:function(ta){var ua=this.scrollContainer,va=da.getTop(ua)+ua.clientHeight;if(va+ta>=ua.scrollHeight)this.scrollToBottom();}.bind(this),onStickerClick:this._onStickerClick.bind(this),viewer:p.getID()});this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),z.addListener(z.START,function(ta,ua){if(this.threadID!==ua)return;this._likePreview=ta;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.scrollToBottom();clearInterval(this._scrollToBottomInterval);this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}.bind(this)),z.addListener(z.STOP,function(ta){if(this.threadID!==ta)return;this._likePreview=null;}.bind(this)),z.addListener(z.FINISH_ANIMATION,function(ta){clearInterval(this._scrollToBottomInterval);}.bind(this)),z.addListener(z.REMOVE,function(ta){if(this.threadID!==ta)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}.bind(this)));},_updateMessageFromStore:function(ta){if(ta.eventType==x.MESSAGES_RECEIVED&&ta.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(ta.eventType==x.MESSAGES_REORDERED){this._loadingMoreMessages=false;j.hide(this.loadingIcon);}var ua=this.isScrolledToBottom(),va=this._getLoadingHeight(),wa=this.scrollContainer.scrollHeight,xa=da.getTop(this.scrollContainer);this._messages=ta.messages;var ya=o.getWelcomeMessage(this.threadID);if(ya)this._messages.push(ya);this._conversation.setProps({messages:this._getNormalizedMessages()},function(){if(ua||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(ta.eventType==x.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-wa-va+xa);if(!this._initialLoadFinished){this._initialLoadFinished=true;l.logCHAT_CONVERSATION_TTI();}if(this._store.hasFetchedAll()&&this.contextBannerEligible)this.renderContextBanner(this.threadID);}.bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(ta.eventType==x.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(this._messages)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();if(ta.eventType==x.MESSAGES_CHANGED)this._checkToAnimateSticker();},setShouldScrollToBottom:function(ta){this._shouldScrollToBottom=ta;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){j.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&da.getTop(this.scrollContainer);},destroy:function(){q.scry(this.conversationElem,'.stickerContainer').forEach(function(ta){return aa.unmountComponentAtNode(ta);});this.unmountContextBanner();aa.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();aa.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(ta){if(!ga.shouldShowStickerReplyNUX()||!ta.length)return false;var ua=ta[ta.length-1];if(ua.author===w.getID())return false;if(ua.has_attachment)return ua.attachments.some(function(va){return va.attach_type==='sticker';});return false;},isScrolledToBottom:function(ta){var ua=this.scrollContainer;ta=ta||qa;return da.getTop(ua)+ua.clientHeight>=ua.scrollHeight-ta;},isScrolledNearTop:function(){return da.getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},scrollToBottom:function(ta){this.scrollToPosition(this.scrollContainer.scrollHeight,ta);},scrollToPosition:function(ta,ua){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(ua===true){this._scrollTopAnimation=(new g(this.scrollContainer)).to('scrollTop',ta).ease(g.ease.end).duration(400).go();}else da.setTop(this.scrollContainer,ta);},_onStickerClick:function(ta,ua){if(!ta)return;i.log('StickersLoggerConfig',{event:'click_sticker',packid:ta,stickerid:ua});var va=this.tabView;ga.onTrayDataReady(function(){if(la(ga.getPackIDsInTray(),ta)){var wa=ga.getPack(ta);if(wa&&wa.isPromoted)fa.addPack(ta);va.setStickersFlyoutPackID(ta);}else ha.showStore(ta);});},_checkToAnimateSticker:function(){var ta=ma(this.scrollContainer);h.inform('chatScrolled/'+this.threadID,{scrollTop:da.getTop(this.scrollContainer),top:ta.y,viewHeight:ta.height});},setNewThreadID:function(ta){this._store.setNewThreadID(ta);},_getNormalizedMessages:function(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(ta){return !ta.is_like_preview;});return s.List(this._messages);},renderContextBanner:function(ta,ua){y.getBootloadedComponent(ta,ca.CHAT,function(va){ia.set(this.conversationElem,'padding-top','80px');this._conversation.setProps({contextBanner:va});}.bind(this),ua,function(va){ia.set(this.conversationElem,'padding-top',va+'px');}.bind(this));},unmountContextBanner:function(){if(this._conversation)this._conversation.setProps({contextBanner:null});}});e.exports=sa;},null);
__d("ChatTabOfficeStatus",["fbt","formatDate","CSS"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=1,k=2,l=3,m={update:function(n,o){if(!n||!o||!o.officeStatus)return;this._updateIcon(n,o);this._updateTooltip(n,o);},_updateIcon:function(n,o){i.removeClass(n,'officeStatusNone');i.removeClass(n,'officeStatusAvailable');i.removeClass(n,'officeStatusSporadic');i.removeClass(n,'officeStatusOutOfOffice');switch(o.officeStatus){case j:i.addClass(n,'officeStatusAvailable');break;case k:i.addClass(n,'officeStatusSporadic');break;case l:i.addClass(n,'officeStatusOutOfOffice');break;default:i.addClass(n,'officeStatusNone');break;}},_updateTooltip:function(n,o){var p='';switch(o.officeStatus){case j:p+=g._("AVAILABLE");p+='\n';break;case k:p+=g._("SPORADIC");p+='\n';break;case l:p+=g._("OFF THE GRID");p+='\n';break;default:p+=g._("UNKNOWN");p+='\n';break;}if(o.officeStatusComment)p+=o.officeStatusComment;if(o.officeStatusLocation)p+=' ('+o.officeStatusLocation+')';if(o.officeStatusComment||o.officeStatusLocation)p+='\n';if(o.officeStatusEndDate){var q=h(o.officeStatusEndDate,'M d, Y');p+=g._("Until {date}",[g.param("date",q)]);}n.setAttribute('aria-label',p);n.setAttribute('data-hover','tooltip');}};e.exports=m;},null);
__d("ChatAddToThreadButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"ChatAddToThreadButton",mixins:[h],propTypes:{isFBAtWork:n.bool,onClick:n.func,shown:n.bool},render:function(){var p=this.props.isFBAtWork?l._("Add more co-workers to chat"):l._("Add more friends to chat"),q=j.getTrackingInfo(j.types.ADD_TO_THREAD);return (i.createElement(g,{"aria-label":p,className:(("addToThread")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-ft":q,"data-hover":"tooltip","data-tooltip-alignv":"top",onClick:this.props.onClick}));}});e.exports=o;},null);
__d("ChatArchiveWarning.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatArchiveWarning",mixins:[h],propTypes:{isFBAtWork:m.bool,shown:m.bool},render:function(){var o=this.props.isFBAtWork?k('images/chat/tab/archive-grey.png'):k('images/chat/tab/archive.png');return (i.createElement(g,{src:o,className:(("titanArchiveWarning")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-hover":"tooltip","data-tooltip-alignh":"center","aria-label":"All employee-to-employee conversations will be archived"}));}});e.exports=n;},null);
__d("ChatCloseButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatCloseButton",mixins:[h],propTypes:{onClick:m.func,onKeyUp:m.func,onMouseDown:m.func,active:m.bool},getDefaultProps:function(){return {active:false};},render:function(){var o=j.getTrackingInfo(j.types.CLOSE_BUTTON),p=k._("Press Esc to close"),q=k._("Close tab");return (i.createElement(g,{"aria-label":this.props.active?p:q,className:"close button","data-ft":o,"data-hover":"tooltip","data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown}));}});e.exports=n;},null);
__d("ChatPhotoUploader.react",["Bootloader","Image.react","InlineBlock.react","Link.react","MercuryConfig","Promise","React","SubscriptionsHandler","cx","emptyFunction","fbt","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();'use strict';var t=m,u=t.PropTypes,v=m.createClass({displayName:"ChatPhotoUploader",propTypes:{actionURI:u.string,allowCrossPage:u.bool,disabled:u.bool,imageClassName:u.string,imagesOnly:u.bool,linkClassName:u.string,onSubmit:u.func,onAllUploadsComplete:u.func,onLastUploadFail:u.func,onLastUploadCancel:u.func,onUploadError:u.func},getDefaultProps:function(){return {actionURI:k.upload_url,allowCrossPage:true,disabled:false,imageClassName:"_509w",imagesOnly:true,linkClassName:'',onSubmit:p,onAllUploadsComplete:p,onLastUploadFail:p,onLastUploadCancel:p};},shouldComponentUpdate:function(w,x){return w.actionURI!=this.props.actionURI||w.disabled!==this.props.disabled;},componentDidUpdate:function(w,x){if(this._uploader)this._uploader.setAllowCrossPage(this.props.allowCrossPage);},componentWillUnmount:function(){if(!this.isUploading()||!this.props.allowCrossPage)this._cleanup();},render:function(){var w=this.props.imagesOnly?q._("Add Photos"):q._("Add Files");return (m.createElement("form",{action:this.props.actionURI,className:"_vzk",title:w,method:"post",onClick:function(x){x.stopPropagation();if(this.props.disabled)x.preventDefault();}.bind(this),ref:"form"},m.createElement("input",{type:"hidden",name:"attach_id",ref:"attachID"}),m.createElement("input",{type:"hidden",name:"images_only",value:this.props.imagesOnly}),m.createElement(i,{onClick:this._bootloadChatAutoSendPhotoUploader,className:"_m _4q60 _3rzn"},m.createElement(j,{className:s("_4q61 _5f0v _509v",this.props.linkClassName)},m.createElement(h,{className:this.props.imageClassName,src:r('/images/chat/chat_camera_icon.png'),alt:q._("Camera")})),m.createElement("input",{disabled:this.props.disabled,type:"file",className:"_n",name:"attachment[]",multiple:"true",accept:this.props.imagesOnly?'image/*':'*',ref:"input",title:w}))));},_handleSubmit:function(w,x){this.props.onSubmit(w,x);},_handleAllUploadsCompleted:function(w,x){this.props.onAllUploadsComplete(w,x);if(!this.isMounted())this._cleanup();},_handleLastUploadFailed:function(w,x){this.props.onLastUploadFail(w,x);if(!this.isMounted())this._cleanup();},_handleLastUploadCanceled:function(w,x){this.props.onLastUploadCancel(w,x);if(!this.isMounted())this._cleanup();},_handleUploadError:function(){this.props.onUploadError();if(!this.isMounted())this._cleanup();},isUploading:function(){return (this._uploader&&this._uploader.isUploading()||this._uploaderPromiseIsResolving);},_bootloadChatAutoSendPhotoUploader:function(){if(!this._uploaderPromise){this._uploaderPromiseIsResolving=true;this._uploaderPromise=new l(function(w){g.loadModules(["ChatAutoSendPhotoUploader"],function(x){this._uploaderPromiseIsResolving=false;this._uploader=new x(m.findDOMNode(this.refs.form),m.findDOMNode(this.refs.input),m.findDOMNode(this.refs.attachID));this._uploader.setAllowCrossPage(this.props.allowCrossPage);this._subscriptions=new n();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled),this._uploader.subscribe('file-upload-error',this._handleUploadError));w(this._uploader);}.bind(this));}.bind(this));}return this._uploaderPromise;},uploadFile:function(w){this._bootloadChatAutoSendPhotoUploader().then(function(x){x.uploadFile(w);});},uploadURL:function(w){this._bootloadChatAutoSendPhotoUploader().then(function(x){x.uploadURL(w);});},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();}});e.exports=v;},null);
__d("StickerContextualDialog.react",["ContextualLayerAutoFlipHorizontal","ReactAbstractContextualDialog","ReactLayer","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=47,l=i.createClass(h.createSpec({addedBehaviors:[g],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:k,length:16}}}));l.WIDTH={NORMAL:312,WIDE:400};e.exports=l;},null);
__d("ChatStickerButton.react",["BootloadedComponent.react","Link.react","JSResource","ReactComponentWithPureRenderMixin","React","ReactLayeredComponentMixin","StickerActions","StickerContextualDialog.react","StickerStateStore","StoreAndPropBasedStateMixin","XUISpinner.react","cx","emptyFunction","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();'use strict';var v=k,w=v.PropTypes,x=278,y=k.createClass({displayName:"ChatStickerButton",_clickGuard:(false),mixins:[j,l,p(o)],propTypes:{className:w.string,ContextualDialogClass:w.func.isRequired,disabled:w.bool,flyoutClassName:w.string,flyoutWidth:w.number,onStickerSelect:w.func.isRequired,onEmoticonSelect:w.func.isRequired,onFlyoutShown:w.func,onFlyoutHidden:w.func,threaadID:w.string},statics:{calculateState:function(z){var aa=o.getState();return {shown:aa.showTray&&z.threadID===aa.threadID};}},getDefaultProps:function(){return {ContextualDialogClass:n,disabled:false,flyoutWidth:x,onStickerSelect:s,onEmoticonSelect:s};},componentWillUnmount:function(){if(this.state.shown)this._hideFlyout();},render:function(){return (k.createElement(h,{className:u(this.props.className,((this.state.shown?"open":''))),onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:t._("Choose a sticker or emoticon"),ref:"link"},k.createElement("i",{className:"_4l9x"})));},renderLayers:function(){var z=this.props.ContextualDialogClass;return {contextualDialog:k.createElement(z,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBlur:this._hideFlyout,position:"above",shown:this.state.shown,width:this.props.flyoutWidth},k.createElement(g,{bootloadPlaceholder:k.createElement("div",{style:{padding:'30px',textAlign:'center'}},k.createElement(q,{size:"large"})),bootloadLoader:i('StickersFlyout.react'),className:this.props.flyoutClassName,onShown:function(aa){if(this.props.onFlyoutShown)this.props.onFlyoutShown(aa);}.bind(this),onHidden:function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,shown:this.state.shown}))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(z){z&&z.stopPropagation();if(this._clickGuard||this.props.disabled){this._clickGuard=false;return;}m.showStickerTray(this.props.threadID);},_hideFlyout:function(){m.hideStickerTray();},_handleStickerSelected:function(z){this.props.onStickerSelect(z);},_handleEmoticonSelected:function(z){this._hideFlyout();this.props.onEmoticonSelect(z);}});e.exports=y;},null);
__d("ChatFileUploaderMixin",["SubscriptionsHandler","React"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=h,j=i.PropTypes,k={propTypes:{attachmentsShelf:j.object,onFileUploaderMounted:j.func,onUploadFinished:j.func,onUpdateAttachmentsShelf:j.func,onSubmit:j.func},setUpSubscriptionsHandler:function(l){this._uploader=l;this._subscriptions=new g();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();if(!this.props.uploaderIsFromHigherLevel)this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};e.exports=k;},null);
__d("ChatFileUploader.react",["ChatFileUploaderMixin","InlineBlock.react","MercuryConfig","React","cx","createCancelableFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=j.createClass({displayName:"ChatFileUploader",mixins:[g],getDefaultProps:function(){return {uploaderIsFromHigherLevel:true};},shouldComponentUpdate:function(){return false;},componentDidMount:function(){this._uploaderCallback=l(this.setUpSubscriptionsHandler);this.props.initFileUploaderFn(j.findDOMNode(this.refs.form),j.findDOMNode(this.refs.input),j.findDOMNode(this.refs.attachID)).then(this._uploaderCallback);},componentWillUnmount:function(){if(this._uploaderCallback)this._uploaderCallback.cancel();},render:function(){return (j.createElement("form",{ref:"form",action:i.upload_url,method:"post"},j.createElement("input",{type:"hidden",ref:"attachID",name:"attach_id"}),j.createElement(h,{className:"_m _4q60 itemLabel"},j.createElement("input",{type:"file",className:"_n",name:"attachment[]",multiple:"true",ref:"input"}),j.createElement("span",{className:"_4q61 itemAnchor"},m._("Add Files...")))));}});e.exports=n;},null);
__d("ChatTabMenu.react",["AsyncDialog","AsyncRequest","Bootloader","ChatFileUploader.react","ChatPrivacyActionController","ChatTabActions","Dialog","MercuryConfig","MercuryIDs","MercuryLogMessageType","MercuryMessengerBlockingUtils","MercuryParticipants","MercuryThreadMuter","MercuryViewer","MercurySourceType","NFXChatHeadGK","Promise","ReactComponentWithPureRenderMixin","React","PopoverMenu.react","ReactMenu","MenuSeparator.react","Run","Toggler","TrackingNodes","URI","WebMessengerDeleteThreadDialog","WebMessengerThreadPermalinks","XNFXStartForMessageThreadController","NotificationSettingsDialog","MessengerNotificationSettingsGKModule","cx","fbt","goURI","MercuryMessageObject","MercuryThreadIDMap","MercuryThreadActions","MercuryThreads","MercuryMessageActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){b.__markCompiled&&b.__markCompiled();'use strict';var oa=b('MercuryMessageObject').get(),pa=b('MercuryThreadIDMap').get(),qa=b('MercuryThreadActions').get(),ra=b('MercuryThreads').get(),sa=b('MercuryMessageActions').get(),ta=aa.Item,ua=y,va=ua.PropTypes,wa=y.createClass({displayName:"ChatTabMenu",_privacyActionController:(undefined),_fileUploaderPromise:(undefined),mixins:[x],propTypes:{attachmentsShelf:va.object,nameConversationFunc:va.func,isGroupChat:va.bool,isEmptyChat:va.bool,hasMessageBlocked:va.bool,onFileUploaderMounted:va.func,onSubmit:va.func,onUpdateAttachmentsShelf:va.func,onUploadFinished:va.func,otherUserID:va.string,sheetController:va.object.isRequired,showAddFriend:va.func,threadID:va.string.isRequired},getInitialState:function(){return {url:null,privacyText:'',muted:false};},getDefaultProps:function(){return {show:true,isMuted:false,hasSwitchToWork:false};},componentDidMount:function(){ha.getThreadURI(this.props.threadID,function(xa){this.isMounted()&&this.setState({url:xa});}.bind(this));if(!this.props.isGroupChat)this._privacyActionController=new k(o.getUserIDFromThreadID(this.props.threadID),function(xa){return this._updatePrivacyLink(xa);}.bind(this));},componentDidUpdate:function(xa,ya){if(this.props.isMuted&&!xa.isMuted){this.props.sheetController.openThreadIsMutedTabSheet();}else if(!this.props.isMuted&&xa.isMuted)this.props.sheetController.closeThreadIsMutedTabSheet();if(this.props.hasMessageBlocked){this.props.sheetController.openMessageBlockedTabSheet();}else this.props.sheetController.closeMessageBlockedTabSheet();},_initFileUploader:function(xa,ya,za){if(this._fileUploaderPromise){this._fileUploaderPromise.then(function(ab){ab.updateElements(xa,ya,za);});}else this._fileUploaderPromise=new w(function(ab,bb){ca.onAfterLoad(function(){i.loadModules(["MercuryFileUploader"],function(cb){var db=new cb(this.props.attachmentsShelf,xa,ya,za);ab(db);}.bind(this));}.bind(this));}.bind(this));return this._fileUploaderPromise;},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();this._fileUploaderPromise&&this._fileUploaderPromise.then(function(xa){xa.destroy();});},_unmuteThread:function(){qa.unmute(this.props.threadID);da.hide();},_togglePrivacyFunc:function(){this._privacyActionController&&this._privacyActionController.togglePrivacy();},_renderFileUploader:function(){return (y.createElement(ta,{className:"_37_x"},y.createElement(j,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,initFileUploaderFn:this._initFileUploader,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.state.url)return (y.createElement(ta,{onclick:function(){return na(this.state.url);}.bind(this)},ma._("See Full Conversation")));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (y.createElement(ta,{onclick:this.props.showAddFriend},ma._("Add Friends to Chat...")));},_renderTogglePrivacy:function(){if(!this.props.isGroupChat&&this.state.privacyText)return (y.createElement(ta,{onclick:this._togglePrivacyFunc},this.state.privacyText));return null;},_renderNotificationSettings:function(){if(ka.inGK){var xa=ja.show.bind(null,this.props.threadID);return (y.createElement(ta,{onclick:xa},ma._("Notification Settings...")));}return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var xa=s.showMuteChangeDialog.bind(null,this.props.threadID,null);return (y.createElement(ta,{onclick:xa},ma._("Mute Conversation...")));}else return (y.createElement(ta,{onclick:this._unmuteThread},ma._("Unmute Conversation")));},_renderDeleteConversation:function(){return (y.createElement(ta,{onclick:this._deleteConversation},ma._("Delete Conversation...")));},_renderReportSpam:function(){if(!this.props.isGroupChat)return (y.createElement(ta,{onclick:this._reportSpamClicked},ma._("Report as Spam or Abuse...")));return null;},_blockMessagesItem:function(){if(!this.props.isGroupChat&&q.gk_result&&!this.props.hasMessageBlocked)return (y.createElement(ta,{onclick:this._messageBlockedClicked},ma._("Block Messages...")));if(!this.props.isMultichat&&q.gk_result&&this.props.hasMessageBlocked)return (y.createElement(ta,{onclick:this._messageUnblockedClicked},ma._("Unblock Messages...")));return null;},_renderCreateGroup:function(){if(this.props.isGroupChat)return (y.createElement(ta,{onclick:this._createGroupClicked},ma._("Create Group")));return null;},_renderSwitchToWork:function(){if(this.props.hasSwitchToWork)return (y.createElement(ta,{onclick:this._switchToWorkUserClicked},ma._("Move to Work Account")));return null;},_renderConversationName:function(){if(this.props.isGroupChat&&this.state.url)return (y.createElement(ta,{onclick:this.props.nameConversationFunc},ma._("Edit Conversation Name")));return null;},_renderLeaveConversation:function(){if(this.props.isGroupChat)return (y.createElement(ta,{onclick:this._unsubscribeLinkClicked},ma._("Leave Conversation...")));return null;},_renderEnableDesktopNotifications:function(){if(n.DesktopNotificationsGK&&"Notification" in window&&window.Notification.permission!=="granted")return (y.createElement(ta,{onclick:this._enableDesktopNotif},ma._("Enable Desktop Notifications")));return null;},_renderPeopleList:function(){if(this.props.isGroupChat&&this.state.url)return (y.createElement(ta,{onclick:this._showParticipants},ma._("Edit Participants...")));return null;},render:function(){var xa=this._renderReportSpam(),ya=this._blockMessagesItem(),za=this._renderCreateGroup(),ab=y.createElement(aa,{className:(("chatReact")+(!this.props.show?' '+"hidden_elem":''))},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),y.createElement(ba,null),this._renderNotificationSettings(),this._renderSwitchToWork(),this._renderMuteConversation(),this._renderDeleteConversation(),this._renderLeaveConversation(),(xa||ya)?(y.createElement(ba,null)):null,ya,xa,za?(y.createElement(ba,null)):null,za,this._renderEnableDesktopNotifications()),bb=ma._("Options"),cb=ea.getTrackingInfo(ea.types.DROPDOWN_BUTTON);return (y.createElement(z,{menu:ab},y.createElement("a",{"data-ft":cb,"data-hover":"tooltip","aria-label":bb,"data-tooltip-alignh":"center",className:(("button")+(this.props.isEmptyChat?' '+"hidden_elem":''))})));},getFileUploaderPromise:function(){return this._fileUploaderPromise;},_updatePrivacyLink:function(xa){var ya;if(xa==k.OFFLINE){ya=ma._("Go online");this.setState({privacyText:ya});return;}if(this.props.isGroupChat||this.props.otherUserID===undefined)return;var za='fbid:'.concat(this.props.otherUserID);r.get(za,function(ab){if(!ab.is_friend){ya=null;}else if(xa==k.BLOCKED){ya=ma._("Turn On Chat for {name}",[ma.param("name",ab.short_name)]);}else ya=ma._("Turn Off Chat for {name}",[ma.param("name",ab.short_name)]);this.setState({privacyText:ya});}.bind(this));},_showParticipants:function(){pa.getFBIDFromClientID(this.props.threadID,function(xa){g.send(new h(new fa('/ajax/browser/dialog/multichat_members/').addQueryData({id:xa})));});},_unsubscribeLinkClicked:function(){var xa=[];xa.push({name:'unsubscribe',label:ma._("Leave Conversation"),handler:function(){return this._unsubscribeToThread();}.bind(this)});xa.push(m.CANCEL);new m().setTitle(ma._("Leave Conversation?")).setBody(ma._("You will stop receiving messages from this conversation and people will see that you left.")).setButtons(xa).show();},_unsubscribeToThread:function(){if(!ra.isEmptyLocalThread(this.props.threadID)){var xa=oa.constructLogMessageObject(u.CHAT_WEB,this.props.threadID,p.UNSUBSCRIBE,{removed_participants:[t.getID()]});sa.send(xa);}l.closeTab(this.props.threadID,'unsubscribed');return true;},_deleteConversation:function(){ga.show(this.props.threadID);},_reportSpamClicked:function(){var xa=new fa('/ajax/chat/report.php').addQueryData({id:this.props.otherUserID}).addQueryData({src:'top_report_link'});if(v.result)xa=ia.getURIBuilder().setString('thread_fbid',this.props.otherUserID).setEnum('location','www_chat_head').getURI();g.send(new h(xa));},_messageBlockedClicked:function(){qa.blockMessages(this.props.threadID);},_messageUnblockedClicked:function(){qa.unblockMessages(this.props.threadID);},_createGroupClicked:function(){ra.getThreadMeta(this.props.threadID,function(xa){if(!xa.is_canonical){var ya=new fa('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),za=xa.participants.map(function(ab){return o.getUserIDFromParticipantID(ab);}).filter(function(ab){return ab;});ya.addQueryData({members:za});if(xa.name)ya.addQueryData({name:xa.name});g.send(new h(ya));}});},_switchToWorkUserClicked:function(){var xa=[];xa.push({name:'move',label:ma._("Move Conversation"),handler:function(){return this._switchToWork();}.bind(this)});xa.push(m.CANCEL);new m().setTitle(ma._("Move Conversation to Work Account?")).setBody(ma._("Do you want to move this conversation so that it shows in your work account instead?")).setButtons(xa).show();},_switchToWork:function(){if(!ra.isEmptyLocalThread(this.props.threadID)){var xa=oa.constructLogMessageObject(u.CHAT_WEB,this.props.threadID,p.SWITCH_TO_WORK,{removed_participants:[t.getID()]});sa.send(xa);}l.closeTab(this.props.threadID,'unsubscribed');return true;},_enableDesktopNotif:function(){a.Notification.requestPermission();}});e.exports=wa;},null);
__d("ChatTabSheetListener",["ChatPrivacyActionController","MercuryIDs","MercuryParticipants","MercuryThreadInformer","MercuryThreads","MercuryViewer"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n,o){this.$ChatTabSheetListener0=o;this.$ChatTabSheetListener1=n;this.$ChatTabSheetListener2=h.getUserIDFromThreadID(this.$ChatTabSheetListener1);j.get().subscribe('threads-updated',function(){return this.$ChatTabSheetListener3();}.bind(this));if(this.$ChatTabSheetListener2)this.$ChatTabSheetListener4=new g(this.$ChatTabSheetListener2,function(p){return this.$ChatTabSheetListener5(p);}.bind(this));}m.prototype.destroy=function(){this.$ChatTabSheetListener4&&this.$ChatTabSheetListener4.destroy();};m.prototype.$ChatTabSheetListener3=function(){var n=k.get();n.getThreadMeta(this.$ChatTabSheetListener1,function(o){var p=l.getID(),q=o.participants.filter(function(r){return r!==p;});(q.length<1&&!n.isNewEmptyLocalThread(this.$ChatTabSheetListener1))?this.$ChatTabSheetListener0.openNoRecipientsSheet():this.$ChatTabSheetListener0.closeNoRecipientsSheet();}.bind(this));};m.prototype.$ChatTabSheetListener5=function(n){switch(n){case g.OFFLINE:this.$ChatTabSheetListener0.closeUserBlockedSheet();this.$ChatTabSheetListener0.openOfflineSheet();break;case g.NORMAL:this.$ChatTabSheetListener0.closeUserBlockedSheet();this.$ChatTabSheetListener0.closeOfflineSheet();break;case g.BLOCKED:this.$ChatTabSheetListener0.closeOfflineSheet();i.get(h.getParticipantIDFromUserID(this.$ChatTabSheetListener2),function(o){o.is_friend?this.$ChatTabSheetListener0.openUserBlockedSheet():this.$ChatTabSheetListener0.closeUserBlockedSheet();}.bind(this));break;}};e.exports=m;},null);
__d("ChatTabSheetController",["Bootloader","ChatTabSheetListener","Deferred","MercuryIDs"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=function(l,m,n,o){this._threadID=l;this._rootElement=m;this._tabElement=n;this._view=o;this._deferred=new i();this._isLoading=false;this._listener=new h(this._threadID,this);};Object.assign(k.prototype,{openAddFriendsSheet:function(){this._load(function(){this._addFriendsTabSheet.open();}.bind(this));},openMessageBlockedTabSheet:function(){this._load(function(){this._threadIsMessageBlockedSheet.open();}.bind(this));},getAddFriendsParticipants:function(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function(l){this._load(function(){this._nameConversationTabSheet.open(l);}.bind(this));},openReadOnlySheet:function(){this._load(function(){this._readOnlyTabSheet.open();}.bind(this));},openNewMessagesSheet:function(){this._load(function(){this._newMessagesTabSheet.open();}.bind(this));},openUploadWarningTabSheet:function(){this._load(function(){this._uploadWarningTabSheet.open();}.bind(this));},openThreadIsMutedTabSheet:function(){this._load(function(){this._threadIsMutedTabSheet.open();}.bind(this));},openEmployeeAwaySheet:function(){this._load(function(){this._employeeAwaySheet.open();}.bind(this));},openOfflineSheet:function(){this._load(function(){this._offlineTabSheet.open();}.bind(this));},openUserBlockedSheet:function(){this._load(function(){this._userBlockedTabSheet.open();}.bind(this));},openNoRecipientsSheet:function(){this._load(function(){this._noRecipientsTabSheet.open();}.bind(this));},closeAddFriendsSheet:function(){this._lazy(function(){this._addFriendsTabSheet.close();}.bind(this));},closeAutomaticNameConversationSheet:function(){this._lazy(function(){if(this._nameConversationTabSheet&&this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();}.bind(this));},closeMessageBlockedTabSheet:function(){this._lazy(function(){this._threadIsMessageBlockedSheet.close();}.bind(this));},closeThreadIsMutedTabSheet:function(){this._lazy(function(){this._threadIsMutedTabSheet.close();}.bind(this));},closeNewMessagesSheet:function(){this._lazy(function(){this._newMessagesTabSheet.close();}.bind(this));},closeUploadWarningTabSheet:function(){this._lazy(function(){this._uploadWarningTabSheet.close();}.bind(this));},closeOfflineSheet:function(){this._lazy(function(){this._offlineTabSheet.close();}.bind(this));},closeUserBlockedSheet:function(){this._lazy(function(){this._userBlockedTabSheet.close();}.bind(this));},onClickMessagesBlockedSheet:function(l){this._lazy(function(){this._unblockMessagesSub=this._threadIsMessageBlockedSheet.subscribe('clicked',l);}.bind(this));},closeNoRecipientsSheet:function(){this._lazy(function(){this._noRecipientsTabSheet.close();}.bind(this));},onClickNewMessagesSheet:function(l){this._lazy(function(){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',l);}.bind(this));},onClickThreadIsMutedSheet:function(l){this._lazy(function(){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',l);}.bind(this));},onResize:function(l){this._lazy(function(){this._sheetView.subscribe('resize',l);}.bind(this));},onTokensChanged:function(l){this._lazy(function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',l);}.bind(this));},onEscape:function(l){this._lazy(function(){this._addFriendsTabSheet.subscribe('esc-pressed',l);}.bind(this));},destroy:function(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();},_load:function(l){this._bootload();this._deferred.then(l);},_lazy:function(l){this._deferred.then(l);},_bootload:function(){if(this._isLoading)return;this._isLoading=true;g.loadModules(["ChatAddFriendsTabSheet","ChatEmployeeAwaySheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMessageBlockedSheet","ChatThreadIsMutedTabSheet","ChatUploadWarningTabSheet","ChatUserBlockedTabSheet","MercurySheetView"],function(l,m,n,o,p,q,r,s,t,u,v,w){this._sheetView=new w(this._threadID,this._rootElement,this._tabElement);var x=this._threadID,y=this._rootElement,z=this._sheetView,aa=this._view;this._addFriendsTabSheet=new l(x,y,z,aa);this._employeeAwaySheet=new m(x,y,z);this._nameConversationTabSheet=new n(x,y,z);this._newMessagesTabSheet=new o(x,y,z);this._offlineTabSheet=new q(x,y,z);this._readOnlyTabSheet=new r(x,y,z);this._threadIsMessageBlockedSheet=new s(x,y,z);this._threadIsMutedTabSheet=new t(x,y,z);this._uploadWarningTabSheet=new u(x,y,z);this._userBlockedTabSheet=new v(x,y,z);if(!j.getUserIDFromThreadID(this._threadID))this._noRecipientsTabSheet=new p(x,y,z);this._deferred.resolve();}.bind(this));}});e.exports=k;},null);
__d("ChatTitleLink.react",["Link.react","MercuryThreadTitle.react","React","TrackingNodes","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatTitleLink",propTypes:{href:m.string,isNewThread:m.bool,thread:m.object,viewer:m.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (i.createElement(g,{"aria-level":"3",className:(("titlebarText")+(this.props.href===null?' '+"noLink":'')),"data-ft":j.getTrackingInfo(j.types.TITLE),"data-hover":"tooltip",href:this.props.href},i.createElement(h,{ref:"threadTitle",isNewThread:this.props.isNewThread,thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));}});e.exports=n;},null);
__d("ChatVideoCallButton.react",["Link.react","React","TrackingNodes","FBRTCCallabilityStore","StoreAndPropBasedStateMixin","MercuryIDs","MercuryParticipants","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=h,p=o.PropTypes,q=h.createClass({displayName:"ChatVideoCallButton",mixins:[k(j,m)],statics:{calculateState:function(r){var s=l.getParticipantIDFromUserID(r.userID),t=m.getOrFetch(s);return {user:t,isCallable:j.isCallable(r.userID)};}},propTypes:{onClick:p.func,onKeyUp:p.func,shown:p.bool,isAudio:p.bool},getClassName:function(){return ((!this.props.isAudio?"_1fu3":'')+(this.props.isAudio?' '+"_1fu4":'')+(this.state.isCallable?' '+"_1kza":'')+(' '+"button")+(!this.props.shown?' '+"hidden_elem":''));},getTooltipLabel:function(){var r=this.state.user;if(!r)return undefined;if(this.props.isAudio){return j.voiceCallButtonTooltip(this.props.userID,r.short_name);}else return j.callButtonTooltip(this.props.userID,r.short_name);},render:function(){var r=i.getTrackingInfo((this.props.isAudio)?i.types.VIDEOCHAT:i.types.VOICECHAT),s=JSON.stringify({videochat:'call_clicked_bhat_tab'});return (h.createElement(g,{"aria-label":this.getTooltipLabel(),className:this.getClassName(),"data-ft":r,"data-gt":s,"data-hover":"tooltip","data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp}));}});e.exports=q;},null);
__d("MessengerHotLikeButton.react",["ImmutableObject","Keys","KeyStatus","Link.react","MercurySourceType","MessengerHotLikePreviewEvents","MessengerHotLikeUtils","ReactComponentWithPureRenderMixin","React","StickerActions","StickerConstants","cx","fbt","MercuryMessageObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();'use strict';var t=b('MercuryMessageObject').get(),u=o,v=u.PropTypes,w=o.createClass({displayName:"MessengerHotLikeButton",mixins:[n],componentDidMount:function(){this._subscription=l.addListener(l.FINISH_ANIMATION,function(x,y){if(x===this.props.threadID)this.props.sendSticker(y);}.bind(this));},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},propTypes:{closeStickerTrayLegacy:v.func,sendSticker:v.func.isRequired,threadID:v.string,disabled:v.bool},render:function(){return (o.createElement(j,{"aria-label":s._("Send a Like"),className:this.props.className,disabled:this.props.disabled,onClick:this._handleClickEvent,onMouseDown:this._handleMouseDown,onMouseLeave:this._cancelSend,onMouseUp:this._handleMouseUp,title:s._("Send a Like")},o.createElement("i",{className:"_2y9i _30yy"})));},_handleMouseDown:function(x){if(this.props.disabled||this._pressedSince){x.preventDefault();x.stopPropagation();}if(this.props.disabled||x.button!==0)return;p.hideStickerTray();this.props.closeStickerTrayLegacy&&this.props.closeStickerTrayLegacy();this._pressedSince=Date.now();this._informPreviewStart();this._preparePop();},_handleMouseUp:function(){if(!this.props.threadID)return;if(!this._pressedSince)return;this._pressedSince=0;this._cancelPop();this._informPreviewStop();},_informPreviewStart:function(){l.emit(l.START,this._getFakeMessage(),this.props.threadID);},_informPreviewStop:function(){l.emit(l.STOP,this.props.threadID);},_informPreviewPop:function(){l.emit(l.POP,this.props.threadID);},_getFakeMessage:function(){var x=t.constructStickerMessageObject(q.HOT_LIKE_SMALL_STICKER_ID,k.MESSENGER_WEB,this.props.threadID);t.normalizeNewMessage(x);x.is_like_preview=true;x.like_preview_since=this._pressedSince;x.body='';return new g(x);},_preparePop:function(){this._cancelPop();this._popTimeout=setTimeout(this._informPreviewPop,m.SizeTimes.large);},_cancelSend:function(){if(this._pressedSince){this._pressedSince=0;this._cancelPop();this._informPreviewPop();}},_cancelPop:function(){clearTimeout(this._popTimeout);},_handleClickEvent:function(x){x.stopPropagation();if(this.props.disabled)return;if(i.getKeyDownCode()===h.RETURN)this.props.sendSticker(m.getStickerIDForTime(1));}});e.exports=w;},null);
__d("P2PBannerStore",["EventEmitter","P2PActionConstants","P2PAPI","P2PDispatcher","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l,m={},n=false,o=false;for(var p in g)if(g.hasOwnProperty(p))r[p]=g[p];var q=g===null?null:g.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=g;function r(){g.call(this);l=j.register(this.onEventDispatched.bind(this));}r.prototype.onEventDispatched=function(s){var t=s.type,u=s.data;switch(t){case h.BANNER_STATES_UPDATED:this.handleBannerStatesUpdated(u);this.emit('change');break;case h.BANNER_DISMISSED:this.handleBannerDismissed(u);this.emit('change');break;case h.BANNER_COMPLETED:this.handleBannerCompleted(u);this.emit('change');break;}};r.prototype.handleBannerStatesUpdated=function(s){n=true;m=s;};r.prototype.handleBannerDismissed=function(s){var t=this.getBannerState(s);t.hasBeenDismissed=true;};r.prototype.shouldShowBanner=function(s){var t;if(!o){i.getBannerStates();o=true;return false;}if(!n)return false;t=this.getBannerState(s);return (t.eligible&&!t.hasBeenDismissed);};r.prototype.handleBannerCompleted=function(s){var t=this.getBannerState(s);t.eligible=false;};r.prototype.getBannerState=function(s){var t=m[s];k(t);return t;};e.exports=new r();},null);
__d("P2PProductItemBannerStore",["CurrentUser","EventEmitter","ImmutableObject","Map","MercuryIDs","P2PActionConstants","P2PAPI","P2PDispatcher","P2PGKValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p,q=new j();for(var r in h)if(h.hasOwnProperty(r))t[r]=h[r];var s=h===null?null:h.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=h;function t(){h.call(this);p=n.register(this.onEventDispatched.bind(this));}t.prototype.onEventDispatched=function(u){var v=u.type,w=u.data;switch(v){case l.PRODUCT_ITEM_BANNER_UPDATED:this.handleProductItemBannerUpdated(w);this.emit('change');break;case l.PRODUCT_ITEM_BANNER_DISMISSED:this.handleBannerDismissed(w);this.emit('change');break;}};t.prototype.handleProductItemBannerUpdated=function(u){q.set(this.getOtherUserIDForProduct(u),new i(u));};t.prototype.handleBannerDismissed=function(u){var v,w;q.forEach(function(x,y){if(x.p2pPlatformItemId===u){v=x;w=y;}});if(v){if(this.isViewerSellerForProduct(v)){v=i.set(v,{shouldShowToSeller:false});}else if(this.isViewerBuyerForProduct(v))v=i.set(v,{shouldShowToBuyer:false});q.set(w,v);}};t.prototype.shouldShowBanner=function(u){var v;if(!o.P2PPlatformProductItemBanner||!u)return false;v=this.getProductItemByOtherUserID(u);if(!v){q.set(u,new i({}));m.getProductItemBannerData({otherUserID:u});return false;}return !!((this.isViewerSellerForProduct(v)&&v.shouldShowToSeller)||(this.isViewerBuyerForProduct(v)&&v.shouldShowToBuyer));};t.prototype.isViewerSellerForProduct=function(u){return u.sellerID===g.getID();};t.prototype.isViewerBuyerForProduct=function(u){return u.buyerID===g.getID();};t.prototype.getOtherUserIDForProduct=function(u){return (this.isViewerSellerForProduct(u)?u.buyerID:u.sellerID);};t.prototype.getProductItemByOtherUserID=function(u){return q.get(u);};t.prototype.getThreadIDFromProductItem=function(u){var v=this.getOtherUserIDForProduct(u);return k.getThreadIDFromUserID(v);};e.exports=new t();},null);
__d("MessengerDialogButton.react",["MessengerButton.react","ReactComponentWithPureRenderMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"MessengerDialogButton",mixins:[h],propTypes:{action:m.oneOf(['button','cancel','confirm'])},render:function(){var o=this.props,p=o.action,q=o.className,r=(function(s,t){var u={},v=Object.prototype.hasOwnProperty;if(s==null)throw new TypeError();for(var w in s)if(v.call(s,w)&&!v.call(t,w))u[w]=s[w];return u;})(o,{action:1,className:1});return (i.createElement(g,i.__spread({className:k(q,(("_5ixy")+(p==='button'?' '+"layerButton":'')+(p==='cancel'?' '+"layerCancel":'')+(p==='confirm'?' '+"layerConfirm":'')))},r)));}});e.exports=n;},null);
__d("P2PButton.react",["CurrentEnvironment","MessengerDialogButton.react","React","XUIButton.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i.createClass({displayName:"P2PButton",render:function(){var l=g.messengerdotcom,m=l?h:j,n=this.props.type;if(!n)n=this.props.use==='confirm'?'primary':'secondary';var o=l?'default':this.props.use,p=Object.assign({},this.props,{type:n,use:o});return (i.createElement(m,i.__spread({},p),this.props.children));}});e.exports=k;},null);
__d("MessengerText.react",["ReactComponentWithPureRenderMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MessengerText",mixins:[g],propTypes:{type:l.oneOf(['primary','secondary']).isRequired,size:l.oneOf(['small'])},render:function(){return (h.createElement("div",h.__spread({},this.props,{className:j((("_39r5")+(this.props.type==='primary'?' '+"_39r6":'')+(this.props.type==='secondary'?' '+"_39r7":'')+(this.props.size==='small'?' '+"_39r8":'')),this.props.className)}),this.props.children));}});e.exports=m;},null);
__d("P2PText.react",["CurrentEnvironment","MessengerText.react","React","XUIGrayText.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"P2PText",propTypes:{type:l.oneOf(['primary','secondary']).isRequired},render:function(){var n=g.messengerdotcom,o=n?h:j,p=this.props,q=p.type,r=this.props;if(!n){r=Object.assign({},this.props,{display:this.props.display||'block',shade:q==='primary'?'dark':'light',size:this.props.size||'small'});}else{r=Object.assign({},this.props,{size:'small'});delete r.size;}return (i.createElement(o,i.__spread({},r),this.props.children));}});e.exports=m;},null);
__d("P2PProductItemChatThreadBanner.react",["BackgroundImage.react","Image.react","Layout.react","LineClamp.react","Link.react","P2PActions","P2PButton.react","P2PProductItemBannerStore","P2PText.react","ReactComponentWithPureRenderMixin","React","cx","fbt","xuiglyph"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=i.Column,v=i.FillColumn,w=q,x=w.PropTypes,y=q.createClass({displayName:"P2PProductItemChatThreadBanner",mixins:[p],propTypes:{item:x.object.isRequired},handleDismissClick:function(z){z.preventDefault();l.productItemBannerDismissed(this.props.item.p2pPlatformItemId);},handleSoldClick:function(z){z.preventDefault();},handlePayClick:function(z){z.preventDefault();var aa=this.props.item,ba=n.getThreadIDFromProductItem(aa);l.chatSendViewOpened({threadID:ba,amount:aa.price,platformItemID:aa.p2pPlatformItemId});},renderActionColumn:function(){var z=this.props.item,aa,ba="_4xl6";if(z.isAvailable)if(n.isViewerSellerForProduct(z)){aa=q.createElement(u,{className:ba},q.createElement(m,{label:s._("Sold"),onClick:this.handleSoldClick,use:"confirm"}));}else aa=q.createElement(u,{className:ba},q.createElement(m,{label:s._("Pay"),onClick:this.handlePayClick,use:"confirm"}));return aa;},renderItemSoldText:function(){if(!this.props.item.isAvailable)return (s._("(SOLD)"));},render:function(){var z=this.props.item,aa=this.renderItemSoldText();return (q.createElement("div",{className:"_319c"},q.createElement(i,null,q.createElement(u,null,q.createElement(k,{href:z.refURL||'#'},q.createElement(g,{backgroundPosition:"50% 50%",backgroundSize:"cover",height:45,src:z.image,width:45}))),q.createElement(v,null,q.createElement(j,{lines:1,lineHeight:45},q.createElement(o,{className:"_2pis",display:"inline",type:aa?'secondary':'primary'},aa,aa?' ':null,z.name))),this.renderActionColumn(),q.createElement(u,{className:"_4xl7"},q.createElement(h,{className:"_4xl8",onClick:this.handleDismissClick,src:t({name:'cross',shade:'light',size:'small'})})))));}});e.exports=y;},null);
__d("P2PLogger",["BanzaiLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h='P2PPaymentLoggerConfig',i={log:function(j,k){k=Object.assign({event:j},k);g.log(h,k);}};e.exports=i;},null);
__d("P2PChatThreadBanner.react",["Image.react","Layout.react","P2PAPI","P2PLogger","P2PPaymentLoggerEvent","React","Set","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=h.FillColumn,q=h.Column,r=new m(),s=l,t=s.PropTypes,u=l.createClass({displayName:"P2PChatThreadBanner",propTypes:{bannerType:t.string.isRequired,bodyText:t.string,loggerEventFlow:t.string.isRequired,onClick:t.func,titleText:t.string.isRequired},componentDidMount:function(){var v=this.props.bannerType;if(!r.has(v)){r.add(v);this.log(k.UI_ACTN_CHAT_THREAD_BANNER_VIEWED,{});i.incrementBannerViews(this.props.bannerType);}},log:function(v,w){j.log(v,Object.assign({www_event_flow:this.props.loggerEventFlow},w));},handleClick:function(v){v.stopPropagation();if(this.props.onClick)this.props.onClick();this.log(k.UI_ACTN_CHAT_THREAD_BANNER_CLICKED,{});i.incrementBannerDismissals(this.props.bannerType);},handleClose:function(v){v.stopPropagation();this.log(k.UI_ACTN_CHAT_THREAD_BANNER_DISMISSED,{});i.incrementBannerDismissals(this.props.bannerType);},render:function(){var v;if(this.props.bodyText)v=l.createElement("div",{className:"_1w2e"},this.props.bodyText);return (l.createElement("div",{className:"_1w2f",onClick:this.handleClick},l.createElement("div",{className:"_3jht",onClick:this.handleClose},l.createElement(g,{className:"_47dg",height:9,src:o('/images/p2p/chat-thread-banner-close.png'),width:9})),l.createElement(h,null,l.createElement(q,{className:"_1w2g"},l.createElement(g,{className:"_1w2h",height:15,src:o('/images/p2p/thread-banner-dollar.png'),width:15})),l.createElement(p,{className:"_1w2i"},l.createElement("div",{className:(("_1w2j")+(!!v?' '+"_1w2k":''))},this.props.titleText),v))));}});e.exports=u;},null);
__d("P2PSendMoneyNUXChatThreadBanner.react",["P2PActions","P2PChatThreadBanner.react","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i,k=j.PropTypes,l=i.createClass({displayName:"P2PSendMoneyNUXChatThreadBanner",propTypes:{bannerType:k.string.isRequired,bodyText:k.string,loggerEventFlow:k.string.isRequired,threadID:k.string.isRequired,titleText:k.string.isRequired},handleClick:function(){g.chatSendViewOpened({threadID:this.props.threadID});},render:function(){return (i.createElement(h,i.__spread({},this.props,{onClick:this.handleClick})));}});e.exports=l;},null);
__d("P2PReceiverNUXChatThreadBanner.react",["P2PBannerType","P2PPaymentLoggerEventFlow","P2PSendMoneyNUXChatThreadBanner.react","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=j,m=l.PropTypes,n=j.createClass({displayName:"P2PReceiverNUXChatThreadBanner",propTypes:{threadID:m.string.isRequired},render:function(){return (j.createElement(i,{bannerType:g.RECEIVER_NUX,bodyText:k._("It's free and secure."),loggerEventFlow:h.UI_FLOW_RECEIVER_NUX_CHAT_THREAD_BANNER,threadID:this.props.threadID,titleText:k._("You Can Send Money to Friends!")}));}});e.exports=n;},null);
__d("P2PSenderNUXChatThreadBanner.react",["P2PBannerType","P2PPaymentLoggerEventFlow","P2PSendMoneyNUXChatThreadBanner.react","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=j,m=l.PropTypes,n=j.createClass({displayName:"P2PSenderNUXChatThreadBanner",propTypes:{threadID:m.string.isRequired},render:function(){return (j.createElement(i,{bannerType:g.SENDER_NUX,bodyText:k._("It's free and secure."),loggerEventFlow:h.UI_FLOW_SENDER_NUX_CHAT_THREAD_BANNER,threadID:this.props.threadID,titleText:k._("Now You Can Send Money!")}));}});e.exports=n;},null);
__d("P2PChatThreadBannerContainer.react",["P2PBannerStore","P2PBannerType","P2PProductItemBannerStore","P2PProductItemChatThreadBanner.react","P2PReceiverNUXChatThreadBanner.react","P2PSenderNUXChatThreadBanner.react","StoreAndPropBasedStateMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=n,p=o.PropTypes,q=n.createClass({displayName:"P2PChatThreadBannerContainer",mixins:[m(g,i)],propTypes:{otherUserID:p.string,threadID:p.string},statics:{calculateState:function(r){return {productItemBannerShown:i.shouldShowBanner(r.otherUserID),receiverNUXBannerShown:g.shouldShowBanner(h.RECEIVER_NUX),senderNUXBannerShown:g.shouldShowBanner(h.SENDER_NUX)};}},renderReceiverNUXBanner:function(){if(!this.props.threadID)return null;return (n.createElement(k,{threadID:this.props.threadID}));},renderSenderNUXBanner:function(){if(!this.props.threadID)return null;return (n.createElement(l,{threadID:this.props.threadID}));},renderProductItemBanner:function(){var r=this.props.otherUserID,s;if(r)s=i.getProductItemByOtherUserID(r);if(!s)return null;return (n.createElement(j,{item:s}));},render:function(){var r;if(this.state.productItemBannerShown){r=this.renderProductItemBanner();}else if(this.state.senderNUXBannerShown){r=this.renderSenderNUXBanner();}else if(this.state.receiverNUXBannerShown)r=this.renderReceiverNUXBanner();return (n.createElement("div",null,r));}});e.exports=q;},null);
__d("P2PAbstractSendMoneyButton.react",["React","TooltipLink.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g,l=k.PropTypes,m=g.createClass({displayName:"P2PAbstractSendMoneyButton",propTypes:{isDialogOpen:l.bool.isRequired,isDisabled:l.bool.isRequired,isMessenger:l.bool.isRequired,onClick:l.func.isRequired,onMouseOver:l.func,recipientName:l.string},_clickGuard:(false),render:function(){return (g.createElement(h,{alignH:"center",className:((this.props.isDialogOpen?"open":'')+(this.props.isDisabled?' '+"disabled":'')+(!this.props.isMessenger?' '+"_5uqy":'')+(this.props.isMessenger?' '+"_3ggc":'')),href:"#",onClick:this._handleClick,onMouseDown:this._prepareForClick,onMouseOver:this.props.onMouseOver,position:"above",title:this._getLinkTitle(),tooltip:this._getDisabledTitle()},g.createElement("i",{className:"_5s8l"})));},_getLinkTitle:function(){if(this.props.isDisabled)return null;return (j._("Send Money"));},_getDisabledTitle:function(){if(!this.props.isDisabled)return null;return (j._("{receiverName} isn't able to receive money right now.",[j.param("receiverName",this.props.recipientName)]));},_prepareForClick:function(){this._clickGuard=this.props.isDialogOpen;},_handleClick:function(n){n.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.props.onClick();}});e.exports=m;},null);
__d("P2PSendMoneyButton.react",["Bootloader","CurrentEnvironment","DeferredComponent.react","P2PAbstractSendMoneyButton.react","React","Run","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=h.messengerdotcom,q=k.createClass({displayName:"P2PSendMoneyButton",propTypes:{isNewEmptyLocalThread:o.bool,isGroupChat:o.bool,onTrigger:o.func,participants:o.arrayOf(o.object),threadID:o.string,threadFBID:o.string},getDefaultProps:function(){return {participants:[]};},render:function(){return (k.createElement(i,k.__spread({deferredComponent:r,deferredPlaceholder:this._renderPlaceholder()},this.props)));},_renderPlaceholder:function(){return (k.createElement(j,{isDialogOpen:false,isDisabled:true,isMessenger:p,onClick:m,onMouseOver:s,recipientName:this._getRecipientName()}));},_getRecipientName:function(){var t=this.props.participants;if(!this.props.isGroupChat&&t&&t.length>0)return t[0].short_name;return null;}});function r(t){l.onAfterLoad(function(){g.loadModules(["P2PSendMoneyButtonImpl.react"],t);});}function s(){g.loadModules(["P2PSendMoneyButtonImpl.react"],m);}e.exports=q;},null);
__d("P2PSendMoneyDialogStore",["P2PActionConstants","EventEmitter","P2PDispatcher"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j,k;for(var l in h)if(h.hasOwnProperty(l))n[l]=h[l];var m=h===null?null:h.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=h;function n(){h.call(this);k={};j=i.register(this.onEventDispatched.bind(this));}n.prototype.onEventDispatched=function(o){var p=o.data,q=o.type;switch(q){case g.CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(p);this.emit('change');break;case g.CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(p);this.emit('change');break;}};n.prototype.getStateByThreadID=function(o){return k[o];};n.prototype.handleChatSendViewOpened=function(o){k[o.threadID]={amount:o.amount,groupSendRecipient:o.groupSendRecipient,groupSendReceiptDetails:o.groupSendReceiptDetails,groupThreadFBID:o.groupThreadFBID,platformItemID:o.platformItemID,sendMoneyDialogShown:true};};n.prototype.handleChatSendViewClosed=function(o){k[o.threadID]={amount:'',groupSendRecipient:null,groupSendReceiptDetails:null,groupThreadFBID:'',platformItemID:null,sendMoneyDialogShown:false};};e.exports=new n();},null);
__d("XPagesMercuryIndicatorController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});},null);
__d("PagesMercuryChatTabIndicatorHandler",["Animation","AsyncRequest","AvailableListConstants","DOM","FBID","MercuryIDs","XPagesMercuryIndicatorController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();n.tryCreateHandler=function(o,p,q){"use strict";if(!p)return null;var r=l.getUserIDFromThreadID(o);if(!r||k.isUser(r))return null;return new n(r,p,q);};function n(o,p,q){"use strict";this.$PagesMercuryChatTabIndicatorHandler0=false;this.$PagesMercuryChatTabIndicatorHandler1=p;this.$PagesMercuryChatTabIndicatorHandler2=false;this.$PagesMercuryChatTabIndicatorHandler3=false;this.$PagesMercuryChatTabIndicatorHandler4=q;this.$PagesMercuryChatTabIndicatorHandler5=false;this.$PagesMercuryChatTabIndicatorHandler6=o;}n.prototype.checkResponsiveness=function(){"use strict";if(this.$PagesMercuryChatTabIndicatorHandler2)return;var o=m.getURIBuilder().getURI();this.$PagesMercuryChatTabIndicatorHandler2=true;new h().setURI(o).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler6}).setHandler(function(p){this.$PagesMercuryChatTabIndicatorHandler2=false;var q=p.payload;if(q.responsiveness)this.$PagesMercuryChatTabIndicatorHandler7(q.responsiveness,q.enableTimeSwitch);}.bind(this)).send();};n.prototype.hideIndicator=function(){"use strict";this.$PagesMercuryChatTabIndicatorHandler8(false);};n.prototype.hideIndicatorAndPreventFutureShow=function(){"use strict";this.$PagesMercuryChatTabIndicatorHandler8(true);};n.prototype.$PagesMercuryChatTabIndicatorHandler8=function(o){"use strict";if(this.$PagesMercuryChatTabIndicatorHandler1&&this.$PagesMercuryChatTabIndicatorHandler3)new g(this.$PagesMercuryChatTabIndicatorHandler1).to('height',0).duration(100).hide().checkpoint(1,function(){this.$PagesMercuryChatTabIndicatorHandler3=false;if(o)this.$PagesMercuryChatTabIndicatorHandler5=true;}.bind(this)).go();};n.prototype.showIndicator=function(){"use strict";if(this.$PagesMercuryChatTabIndicatorHandler1&&!this.$PagesMercuryChatTabIndicatorHandler3&&this.$PagesMercuryChatTabIndicatorHandler4===i.OFFLINE&&this.$PagesMercuryChatTabIndicatorHandler9){j.setContent(this.$PagesMercuryChatTabIndicatorHandler1,this.$PagesMercuryChatTabIndicatorHandler9);new g(this.$PagesMercuryChatTabIndicatorHandler1).show().to('height',20).duration(100).checkpoint(1,function(){this.$PagesMercuryChatTabIndicatorHandler3=true;}.bind(this)).go();}};n.prototype.getEnableTimeSwitch=function(){"use strict";return this.$PagesMercuryChatTabIndicatorHandler0;};n.prototype.notifyPageOnlineStatusChanged=function(o){"use strict";this.$PagesMercuryChatTabIndicatorHandler4=o;if(!this.$PagesMercuryChatTabIndicatorHandler0)return;switch(o){case i.ACTIVE:this.hideIndicator();break;default:this.showIndicator();break;}};n.prototype.$PagesMercuryChatTabIndicatorHandler7=function(o,p){"use strict";this.$PagesMercuryChatTabIndicatorHandler9=o;this.$PagesMercuryChatTabIndicatorHandler0=p;this.showIndicator();};e.exports=n;},null);
__d("SelectionPosition",["Event","InputSelection","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this.$SelectionPosition0=k;this.$SelectionPosition1={start:0,end:0};this.$SelectionPosition2=new i();this.$SelectionPosition3=false;this.updatePos();this.enable();}j.prototype.getPos=function(){"use strict";return Object.assign({},this.$SelectionPosition1);};j.prototype.setPos=function(k,l){"use strict";this.$SelectionPosition1={start:k,end:l};this.restore();};j.prototype.updatePos=function(){"use strict";this.$SelectionPosition1=h.get(this.$SelectionPosition0);};j.prototype.restore=function(){"use strict";h.set(this.$SelectionPosition0,this.$SelectionPosition1.start,this.$SelectionPosition1.end);};j.prototype.enable=function(){"use strict";if(!this.$SelectionPosition3){this.$SelectionPosition2.addSubscriptions(g.listen(this.$SelectionPosition0,'keyup',this.updatePos.bind(this)),g.listen(this.$SelectionPosition0,'click',this.updatePos.bind(this)));this.$SelectionPosition3=true;}};j.prototype.disable=function(){"use strict";if(this.$SelectionPosition3){this.$SelectionPosition2.release();this.$SelectionPosition3=false;}};e.exports=j;},null);
__d("XStickerReplyNUXController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/tooltip\/",{});},null);
__d("ChatTabView",["AsyncRequest","AsyncSignal","AvailableList","AvailableListConstants","BanzaiODS","BootloadedComponent.react","Bootloader","CSS","ChatAddToThreadButton.react","ChatArchiveWarning.react","ChatBehavior","ChatCloseButton.react","ChatConfig","ChatEmployeeAwayWarning","ChatOpenTab","ChatPhotoUploader.react","ChatQuietLinks","ChatStickerButton.react","ChatTabActions","ChatTabMenu.react","ChatTabMessagesView","ChatTabOfficeStatus","ChatTabSheetController","ChatTabViewEvents","ChatTabViewInstances","ChatTitleLink.react","ChatVideoCallButton.react","ChatVisibility","MercuryConstants","CurrentLocale","CurrentUser","DOM","DOMEvent","DOMQuery","DeferredComponent.react","Dialog","Dock","DragDropTarget","EmoticonUtils","EmoticonsList","Event","FBID","FBRTCCallabilityStore","Focus","ImmutableObject","Input","JSResource","Keys","Locale","LogHistory","MercuryConfig","MercuryIDs","MercuryMessengerBlockingUtils","MercuryParticipants","MercuryShareAttachmentRenderLocations","MercurySourceType","MercuryThreadInfo","MercuryTypingAnimation.react","MercuryThreadTitle.react","MercuryViewer","MessengerHotLikeButton.react","MessagingTag","NubController","P2PChatThreadBannerContainer.react","P2PGKValues","P2PSendMoneyButton.react","P2PSendMoneyDialogStore","PagesMercuryChatTabIndicatorHandler","Parent","PhotosUploadWaterfall","PresenceStatus","Promise","React","ReactComponentRenderer","Run","Scroll","SelectionPosition","StickerActions","StickerConstants","StickerState","Style","SubscriptionsHandler","SyntheticMouseEvent","ChatTabTemplates","TextAreaControl","Toggler","TooltipData","TypingDetectorController","URLScraper","URI","UserAgent_DEPRECATED","WaterfallIDGenerator","WebMessengerDeleteThreadDialog","WebMessengerThreadPermalinks","XStickerReplyNUXController","XUISpinner.react","cancelAnimationFrame","createCancelableFunction","csx","cx","emptyFunction","fbt","getActiveElement","isEmpty","requestAnimationFrame","requireWeak","setIntervalAcrossTransitions","ChatReactInput","MercuryBlockedParticipants","MercuryTypingReceiver","MercuryMessageActions","MercuryMessages","MercuryMessageObject","MercuryThreadIDMap","MercuryServerRequests","MercuryThreadInformer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,ad,bd,cd,dd,ed,fd,gd,hd,id){b.__markCompiled&&b.__markCompiled();'use strict';var jd=b('ChatReactInput').module,kd=b('MercuryBlockedParticipants').get(),ld=b('MercuryTypingReceiver').get(),md=b('MercuryMessageActions').get(),nd=b('MercuryMessages').get(),od=b('MercuryMessageObject').get(),pd=b('MercuryThreadIDMap').get(),qd=b('MercuryServerRequests').get(),rd=b('MercuryThreadInformer').get(),sd=b('MercuryThreadActions').get(),td=b('MercuryThreads').get(),ud,vd=new zb(function(ye){hd('P2PTransferStore',function(ze){ud=ze;ye(ze);});}),wd=/^\s*$/,xd=ea,yd,zd=10,ae=960,be=db.getInstance('chat_tab_view');function ce(ye,ze){var af=la.create('div');ze=ze&&ze.filter(function(df){return df!=nb.getID();});if(fd(ze))return oc.remove(ye);var bf=ze.length,cf=bf-zd;if(cf>1)ze=ze.slice(0,zd);hb.getMulti(ze,function(df){for(var ef in df){var ff=df[ef],gf=lc[':fb:mercury:chat:multichat-tooltip-item'].build();la.setContent(gf.getNode('name'),ff.name);var hf=fb.getUserIDFromParticipantID(ef),jf=hf&&yb.get(hf)==j.ACTIVE;n.conditionShow(gf.getNode('icon'),jf);n.conditionClass(gf.getNode('name'),'tooltipItemWithIcon',jf);la.appendContent(af,gf.getRoot());}if(cf>1){var kf=dd._("and {number of hidden chat participants} more.",[dd.param("number of hidden chat participants",cf)]);la.appendContent(af,la.create('div',{},kf));}oc.set(ye,af,'above');});}var de={},ee=null,fe=false;function ge(ye,ze,af){if(af){de[ye]=ze;if(!ee)ee=id(he,600);}else{n.removeClass(ze,'highlightTitle');delete de[ye];}}function he(){for(var ye in de){var ze=de[ye];if(ze.parentNode){n.conditionClass(ze,'highlightTitle',fe);}else delete de[ye];}fe=!fe;if(!Object.keys(de).length){clearInterval(ee);ee=null;}}function ie(ye){var ze=fb.tokenize(ye);switch(ze.type){case 'user':return lc[':fb:mercury:chat:user-tab'].build();}return lc[':fb:mercury:chat:multichat-tab'].build();}function je(ye){var ze=ye._getInputValue(),af=ye._fileUploader,bf=af?af.getAttachments():[];if(pe(ye))le(ye,ze,bf,function(cf){cf=xe(cf,af);md.send(cf,function(df){var ef=td.getThreadMetaNow(df);if(eb.CoreGraphEnabled&&ef&&ef.folder===pb.PENDING)sd.movePendingToInbox(df);});af&&af.removeAttachments();if(ye._sharePreview)ye._sharePreview.setProps({share:null,uri:null});if(!s.get('chat_react_input'))ye._getNode('input').value='';ye._typingDetector&&ye._typingDetector.resetState();ye._messagesView&&ye._messagesView.setShouldScrollToBottom(true);});}function ke(ye,ze){if(ze===0)return;re(ye,xb.POST_PUBLISHED,{count:ze});ye._waterfallID=tc.generate();}function le(ye,ze,af,bf){td.getThreadMeta(ye._threadID,function(cf){if(cf&&cf.is_canonical&&!kb.canReply(cf)&&gb.gk_result){ye._showMessageBlockedDialog(cf);return;}var df=jb.CHAT_WEB,ef=od.constructUserGeneratedMessageObject(ze,df,ye._threadID);if(af.length>0){ef.has_attachment=true;ef.raw_attachments=af;}if(ye._sharePreview){var ff=ye._sharePreview.component.getShareData();if(ff){ef.has_attachment=true;ef.shareable_attachment=ff;}}if(td.isNewEmptyLocalThread(ye._threadID)){var gf=ye._sheetController.getAddFriendsParticipants();ye._sheetController.closeAddFriendsSheet();if(gf===null||gf.length===0)return;gf=gf.filter(function(kf){return kf!=nb.getID();});if(gf.length===0){ef.thread_id=fb.getThreadIDFromUserID(ka.getID());}else if(gf.length===1){ef.thread_id=fb.getThreadIDFromParticipantID(gf[0]);}else sd.addParticipants(ye._threadID,gf);}if(td.isEmptyLocalThread(ye._threadID)){ef.threading_id=fb.tokenize(ye._threadID).value;var hf=td.getThreadMetaNow(cf.thread_id);ef.specific_to_list=Array.from(hf.participants);}if(typeof ef!='undefined')ef.signatureID=ye._signatureID;ef.ui_push_phase=ia.UIPushPhase;bf(ef);if(ye._threadID!==ef.thread_id&&!ye._photoUploader.isUploading()){var jf=ye._getInputValue();y.closeTab(ye._threadID);u.openThread(ef.thread_id,'ChatTabView',null,ze?cd:function(kf){return kf.appendTextToInput(jf);});}});}function me(ye){ye._blocked=true;ye._sheetController.openUploadWarningTabSheet();}function ne(ye){return !!(ye._fileUploader&&(ye._fileUploader.isUploading()||ye._photoUploader.isUploading()||(ye._sharePreview&&ye._sharePreview.component.isLoading())));}function oe(ye){return ((ye._fileUploader&&ye._fileUploader.isUploading())||ye._sharePreviewLoading);}function pe(ye){var ze=ye._getInputValue();if(!wd.test(ze))return true;if(ye._fileUploader&&(ye._fileUploader.getAttachments().length>0||ye._fileUploader.getImageFiles().length>0||ye._fileUploader.getAnimatedImageFiles().length>0||ye._fileUploader.getVideoFiles().length>0||ye._fileUploader.getAudioFiles().length>0||ye._fileUploader.getFiles().length>0))return true;if(ye._sharePreview&&ye._sharePreview.component.getShareData())return true;return false;}function qe(ye){ye._nubController.flyoutContentChanged();var ze=ye._getNode('attachmentShelf');dc.setTop(ze,ze.scrollHeight);}function re(ye,ze,af){xb.sendSignal(Object.assign({qn:ye._waterfallID,step:ze,uploader:xb.APP_CHAT},(af||{})));}function se(ye,ze,af,bf,cf){var df,ef,ff;if(ze)qd.ensureThreadIsFetched(ze);this._threadID=ye;this._signatureID=af;this._eventListeners=[];this._onlineStatus=j.OFFLINE;this._tabTemplate=ie(ye);this._tabElem=this._tabTemplate.getRoot();if(cf&&cf.getTabElem()){this.insertBefore(cf);}else this.appendTo(bf);this._stickersFlyoutShown=false;this._messagesView=null;this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._pagesMessageIndicator=this._getNode('pagesMessageIndicator');this._waterfallID=tc.generate();this._subscriptionsHandler=new jc();this._initializeSheetController();var gf=[cd,this._initializeHotLike.bind(this),this._initializeHeader.bind(this),this._initializeUIListeners.bind(this),this._initializeAutoSendPhotoUploader.bind(this),this._initializeTitleHREF.bind(this),this._initializeP2P.bind(this),this._initializeInput.bind(this),this._initializeStickers.bind(this),this._initializeContentSearch.bind(this),function(){td.getThreadMeta(this._threadID,function(kf){this._updateMutingSettings(kf);this._updateMessageBlockSettings(kf);}.bind(this));w.removeEmptyHrefs(this._tabElem);}.bind(this),function(){this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);}.bind(this),this._initializeUnloadListeners.bind(this),this._initializeDragDropTarget.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this)];vd.then(this._onP2PTransferStoreLoaded.bind(this));if(s.get('chat_defer_initialization',false)){var hf=function(kf){if(!kf.length){delete this._initFrame;return;}var lf=kf.shift();this._initFrame=gd(function(){hf(kf);});lf();}.bind(this);hf(gf);}else{var jf;for(df=gf,ef=Array.isArray(df),ff=0,df=ef?df:df[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ef){if(ff>=df.length)break;jf=df[ff++];}else{ff=df.next();if(ff.done)break;jf=ff.value;}jf();}}xd.set(ye,this);this._logOpenTab();}function te(ye){if(ye._photoUploader.isUploading())re(ye,xb.CANCEL_DURING_UPLOAD);}function ue(){var ye,ze,af,bf;for(ye=xd.values(),ze=Array.isArray(ye),af=0,ye=ze?ye:ye[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ze){if(af>=ye.length)break;bf=ye[af++];}else{af=ye.next();if(af.done)break;bf=af.value;}bf.updateAvailableStatus();bf.updateMultichatTooltip();}}function ve(){var ye,ze,af,bf;for(ye=xd.values(),ze=Array.isArray(ye),af=0,ye=ze?ye:ye[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ze){if(af>=ye.length)break;bf=ye[af++];}else{af=ye.next();if(af.done)break;bf=af.value;}bf.updateCallLink();}}i.subscribe(j.ON_AVAILABILITY_CHANGED,ue);wa.addListener(ve);q.subscribe(q.ON_CHANGED,function(){var ye,ze,af,bf;for(ye=xd.keys(),ze=Array.isArray(ye),af=0,ye=ze?ye:ye[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ze){if(af>=ye.length)break;bf=ye[af++];}else{af=ye.next();if(af.done)break;bf=af.value;}td.getThreadMeta(bf,function(cf){xd.get(bf)._updateUnreadCount(cf);});}});ld.addRetroactiveListener('state-changed',function(ye){for(var ze in ye){var af=ye[ze]&&ye[ze].length,bf=xd.get(ze);bf&&bf.showTypingIndicator(af);}});rd.subscribe('threads-updated',function(ye,ze){var af,bf,cf,df;for(af=xd.keys(),bf=Array.isArray(af),cf=0,af=bf?af:af[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(bf){if(cf>=af.length)break;df=af[cf++];}else{cf=af.next();if(cf.done)break;df=cf.value;}var ef=xd.get(df);ze[df]&&ef.updateTab();if(ef._newThreadIDFromPhotoUpload&&!ef._photoUploader.isUploading()&&ze[ef._newThreadIDFromPhotoUpload]){y.closeTab(ef._threadID);u.openThread(ef._newThreadIDFromPhotoUpload,'ChatTabView');ef._newThreadIDFromPhotoUpload=null;}}});rd.subscribe('threads-deleted',function(ye,ze){var af,bf,cf,df;for(af=xd.keys(),bf=Array.isArray(af),cf=0,af=bf?af:af[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(bf){if(cf>=af.length)break;df=af[cf++];}else{cf=af.next();if(cf.done)break;df=cf.value;}ze[df]&&y.closeTab(df,'thread_deleted');}});Object.assign(se.prototype,{getThreadID:function(){return this._threadID;},getTabElem:function(){return this._tabElem;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(ye){setTimeout((function(){this._sheetController.openNameConversationSheet(ye);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return n.shown(this._tabElem);},setVisibleState:function(ye,ze){var af=n.shown(this._tabElem),bf=n.hasClass(this._tabElem,'opened');n.conditionShow(this._tabElem,ye);n.conditionClass(this._tabElem,'opened',ze);if(!(af&&bf)&&ye&&ze){if(!this._messagesView){var cf=fb.tokenize(this._threadID);this._messagesView=new aa(this._threadID,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,eb.ShowContextBanner&&cf.type==='user');}this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();}},focus:function(){if(n.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var ye=ed();return wb.byClass(ye,"_50mz")===this._tabElem;},hasEmptyInput:function(){return wd.test(this._getInputValue());},getInputElem:function(){if(s.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return null;return ac.findDOMNode(this._chatInput);}else return this._getNode('input');},setStickersFlyoutPackID:function(ye){if(this._stickerButton){this._setPackIDReact(ye);}else this._setPackIDLegacy(ye);},loadShareFromParams:function(ye,ze){this._getSharePreview().then(function(af){af.setProps({share:{params:ze,type:ye},uri:null});});},_linkDropped:function(ye){this._getSharePreview().then(function(ze){ze.setProps({share:null,uri:ye});});},_filesDropped:function(ye){if(this._fileUploader){this._fileUploader.addDroppedFiles(ye);}else{var ze=this._reactChatTabMenu.component.getFileUploaderPromise();if(ze)ze.then(function(af){af.addDroppedFiles(ye);});}},_setPackIDLegacy:function(ye){var ze=this._stickersFlyout;if(!this._stickersFlyoutToggler||!ze||!ze.component.isMounted())return;fc.selectPack(ye);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(ye){if(!this._stickerButton.isMounted())return;fc.selectPack(ye);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(ye){this._stickerButton.showFlyout();this._stickersFlyoutShown=ye;},_toggleStickersFlyoutShownLegacy:function(ye){if(ye){nc.show(this._stickersFlyoutToggler);}else nc.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=ye;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(yd)return;var ye=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new g(wc.getURIBuilder().getURI()).setRelativeTo(ye).setData({thread_id:this._threadID}).setHandler(function(ze){hc.clearShowStickerReplyNUX();}).send();},insertBefore:function(ye){la.insertBefore(ye.getTabElem(),this._tabElem);},appendTo:function(ye){la.appendContent(ye,this._tabElem);},nextTabIs:function(ye){var ze=ye&&ye.getTabElem();return this._tabElem.nextSibling==ze;},getScrollTop:function(){return dc.getTop(la.find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function(ye){dc.setTop(la.find(this._tabElem,'.fbNubFlyoutBody.scrollable'),ye);},destroy:function(){this._initFrame&&yc(this._initFrame);this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();ac.unmountComponentAtNode(this._getNode('animationContainer'));ac.unmountComponentAtNode(this._getNode('menuContainer'));if(s.get('chat_react_header')){if(this._addToThreadButton){this._addToThreadButton.unmount();this._addToThreadButton=null;}if(this._archiveWarning){this._archiveWarning.unmmount();this._archiveWarning=null;}if(this._videoCallButton){this._videoCallButton.unmmount();this._videoCallButton=null;}if(this._closeButton){this._closeButton.unmount();this._closeButton=null;}if(this._title){this._title.unmount();this._title=null;}}if(this._sharePreview){this._sharePreview.unmount();this._sharePreview=null;}try{ac.unmountComponentAtNode(this._getNode('photoUploaderContainer'));}catch(ye){k.bumpEntityKey('chat.web','chattab.unmount_failed');}if(s.get('chat_react_sticker_button')){ac.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else{this._stickersFlyout.unmount();this._stickersFlyout=null;}this._subscriptionsHandler&&this._subscriptionsHandler.release();if(s.get('chat_react_input')){ac.unmountComponentAtNode(this._getNode('inputContainer'));}else za.reset(this._getNode('input'));if(this._getNode('hotLikeContainer'))ac.unmountComponentAtNode(this._getNode('hotLikeContainer'));ac.unmountComponentAtNode(this._getNode('name'));if(!s.get('chat_react_header'))ac.unmountComponentAtNode(this._getNode('titlebarText'));if(this._orionTriggerContainer){if(this._orionTrigger)this._orionTrigger.unmount();this._orionTriggerContainer=null;this._orionTrigger=null;}if(this._p2pChatThreadBannerContainer){ac.unmountComponentAtNode(this._p2pChatThreadBannerContainer);this._p2pChatThreadBannerContainer=null;}this._unsubscribeP2PSendMoneyDialogStore();this._unsubscribeP2PTransferStore();la.remove(this._tabElem);xd["delete"](this._threadID);qa.unregisterNubController(this._nubController);},updateAvailableStatus:function(){td.getThreadMeta(this._threadID,function(ye){var ze=j.OFFLINE,af=this._getCanonicalUserID();if(af){ze=yb.get(af);}else{var bf=ye.participants.map(function(df){return fb.getUserIDFromParticipantID(df);});ze=yb.getGroup(bf);}if(!ha.isOnline())ze=j.OFFLINE;this.updateCallLink();n.conditionClass(this._tabElem,"_5238",ze===j.ACTIVE);n.conditionClass(this._tabElem,"_5239",ze===j.MOBILE);var cf=this._getNode('presenceIndicator');this._onlineStatus=ze;this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.notifyPageOnlineStatusChanged(ze);switch(ze){case j.ACTIVE:cf.setAttribute('alt',dd._("Online"));break;case j.MOBILE:cf.setAttribute('alt',dd._("Mobile"));break;default:cf.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){td.getThreadMeta(this._threadID,function(ye){var ze,af,bf,cf=[this._getNode('name')];if(!s.get('chat_react_header')){cf.push(this._getNode('titlebarText'));}else if(this._title)this._title.setProps({thread:ye},function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.component.getTitle());}.bind(this));var df;for(ze=cf,af=Array.isArray(ze),bf=0,ze=af?ze:ze[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(af){if(bf>=ze.length)break;df=ze[bf++];}else{bf=ze.next();if(bf.done)break;df=bf.value;}ac.render(ac.createElement(mb,{isNewThread:td.isNewEmptyLocalThread(this._threadID),thread:ye,useAndSeparator:true,useShortName:!ye.is_canonical,viewer:ka.getID()}),df);}this._updateControls(ye);this._updateMessageBlockSettings(ye);this._updateMutingSettings(ye);this._updateUnreadCount(ye);this.updateMultichatTooltip();this._updateArchiveWarning(ye);this._updateEmployeeAwayWarning(ye);this._updateOfficeStatus(ye);this._updateNewThread(ye);this._updateNameConversationSheet(ye);this._updateReadOnlySheet(ye);this._updateSwitchToWork(ye);}.bind(this));},_updateNameConversationSheet:function(ye){if(kb.canReply(ye)&&!ye.name&&!ye.is_canonical&&!ye.name_conversation_sheet_dismissed&&!ye.has_email_participant&&!ye.read_only&&!td.isEmptyLocalThread(ye.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(ye){var ze=kb.showComposer(ye),af=kb.canReply(ye),bf=td.isEmptyLocalThread(ye.thread_id);if(!af&&!ze&&!bf)this._sheetController.openReadOnlySheet();},updateSignatureID:function(ye){this._signatureID=ye;},_updateMessageBlockSettings:function(ye){this._updateMenuPropsSafe({hasMessageBlocked:kd.isMessageBlocked(ye)});},_updateMutingSettings:function(ye){var ze=kb.isMuted(ye);this._updateMenuPropsSafe({isMuted:ze});},_updateMenuPropsSafe:function(ye){if(this._reactChatTabMenu&&this._reactChatTabMenu.component&&this._reactChatTabMenu.component.isMounted())this._reactChatTabMenu.setProps(ye);},_updateArchiveWarning:function(ye){if(ka.isEmployee())hb.getMulti(ye.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateEmployeeAwayWarning:function(ye){t.updateEmployeeAwayWarning(ye,function(){this._sheetController.openEmployeeAwaySheet();}.bind(this),function(){});},_updateOfficeStatus:function(ye){var ze=this._getNode('officeStatus');if(!ze||fb.isGroupChat(ye.thread_id))return;var af=fb.getParticipantIDFromUserID(ye.canonical_fbid);hb.get(af,function(bf){ba.update(ze,bf);});},_updateSwitchToWork:function(ye){if(ka.isEmployee()&&ka.hasWorkUser()&&fb.isGroupChat(ye.thread_id)){hb.getMulti(ye.participants,function(ze){var af=this._isEmployeesOnly(ze);this._updateMenuPropsSafe({hasSwitchToWork:af});}.bind(this));}else this._updateMenuPropsSafe({hasSwitchToWork:false});},_updateControls:function(ye,ze,af){var bf=false;if(ye&&ye.thread_id){var cf=fb.tokenize(ye.thread_id);if(cf.type==='user'){var df=cf.value;bf=!va.isUser(df);}}var ef=kb.showComposer(ye)&&(!fd(ye.participants)||!!ze);n.conditionShow(this._inputContainerNode,ef);n.conditionShow(this._iconsContainerNode,ef);this._updateMenuPropsSafe({isEmptyChat:td.isNewEmptyLocalThread(ye.thread_id),show:ef});if(bf)this._updateMenuPropsSafe({showAddFriend:null});var ff=ef&&!bf;if(s.get('chat_react_header')){this._addToThreadButton&&this._addToThreadButton.setProps({shown:ff});}else n.conditionShow(this._getNode('addToThreadLink'),ff);if(af&&af.length===1&&eb.ShowContextBanner&&eb.ShowContextBannerNullState){this._messagesView&&this._messagesView.renderContextBanner(null,af[0].info&&af[0].info.uid);}else this._messagesView&&this._messagesView.unmountContextBanner();this._resizeInputContainer();this._updateOrionTrigger();},_updateOrionTrigger:function(){if(this._orionTrigger){this._setOrionTriggerProps();}else this._renderOrionTrigger();},_setOrionTriggerProps:function(){this.getParticipantIDsForOrionNUX(function(ye,ze){hb.getMulti(ye,function(af){var bf=[],cf,df=td.isNewEmptyLocalThread(this._threadID);for(var ef in af){cf=this._getUserIdFromParticipantID(ef);if(cf!==ka.getID())bf.push(ya.set(af[ef],{userID:cf}));}this._orionTrigger.setProps(Object.assign({participants:bf,isNewEmptyLocalThread:df,isGroupChat:fb.isGroupChat(this._threadID)&&!df,threadID:this._threadID,threadFBID:ze},ub.getStateByThreadID(this._threadID)));}.bind(this));}.bind(this));},_getUserIdFromParticipantID:function(ye){return fb.getUserIDFromParticipantID(ye);},_onP2PSendMoneyDialogStoreChange:function(){this._updateOrionTrigger();},_unsubscribeP2PSendMoneyDialogStore:function(){if(this._sendMoneyDialogStoreSub){this._sendMoneyDialogStoreSub.remove();this._sendMoneyDialogStoreSub=null;}},_onP2PTransferStoreChange:function(){this._renderOrionTrigger();if(this._canP2PSend())this._unsubscribeP2PTransferStore();},_unsubscribeP2PTransferStore:function(){if(this._transferStoreSub){this._transferStoreSub.remove();this._transferStoreSub=null;}},_isP2PEnabled:function(){return sb.P2PEnabled;},_canP2PSend:function(){return (this._isP2PEnabled()||(ud&&ud.hasTransfers())||(ud&&ud.hasAccepted()));},_renderOrionTrigger:function(){if(fb.isGroupChat(this._threadID)&&!sb.P2PGroupSendWWW)return false;var ye=this._getCanonicalUserID();if(this._canP2PSend()&&ye!==ka.getID()){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=new bc(tb,this._orionTriggerContainer);this._orionTrigger.setProps({onTrigger:this._orionTriggered.bind(this)});n.addClass(this._inputContainerNode,"_11d6");this._setOrionTriggerProps();}},getParticipantIDsForOrionNUX:function(ye){var ze=this._sheetController.getAddFriendsParticipants(),af=this._getCanonicalUserID();if(af){ye([fb.getParticipantIDFromUserID(af)]);}else if(td.isNewEmptyLocalThread(this._threadID)&&ze){ye(ze);}else td.getThreadMeta(this._threadID,function(bf){ye(bf.participants,bf.thread_fbid);}.bind(this));},_resizeInputContainer:function(){var ye=this._tabElem.clientWidth,ze=2,af=ye-(this._inputContainerNode.clientWidth+ze),bf=cb.isRTL()?'left':'right';ic.set(this._iconsContainerNode,bf,af+'px');if(!s.get('chat_react_input'))mc.getInstance(this._getNode('input')).update();},_updateNewThread:function(ye){if(td.isNewEmptyLocalThread(ye.thread_id))this.showAddFriend();},_isEmployeesOnly:function(ye){for(var ze in ye)if(!ye[ze].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(ye){var ze=this._isEmployeesOnly(ye),af=s.get('chat_react_header'),bf=af?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(bf){if(this._titlebarTooltipAnchor)n.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',ze);if(af){this._archiveWarning&&this._archiveWarning.setProps({shown:ze});}else n.conditionShow(bf,ze);}},updateMultichatTooltip:function(){td.getThreadMeta(this._threadID,function(ye){if(!ye.is_canonical){var ze;if(s.get('chat_react_header')){ze=ac.findDOMNode(this._title.component);}else ze=this._titlebarTooltipAnchor;ce(ze,ye.participants);}}.bind(this));},_getNode:function(ye){return this._tabTemplate.getNode(ye);},_getCanonicalUserID:function(){return fb.getUserIDFromThreadID(this._threadID);},_listen:function(ye,event,ze,af){var bf=this._getNode(ye);if(bf){this._eventListeners.push(ua.listen(bf,event,ze.bind(this)));}else if(!af)throw new Error('Could not find node "'+ye+'"');},_closePreClicked:function(ye){this._closeMouseDown=true;},_closeClicked:function(ye){te(this);y.closeTab(this._threadID);if(ye instanceof kc){ye.stopPropagation();return;}ye.kill();},_closeEnter:function(ye){if(ye.keyCode===bb.RETURN)this._closeClicked(ye);},_nubClicked:function(ye){ye.kill();return da.inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===bb.RETURN||event.keyCode===bb.SPACE){da.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===bb.ESC){this._handleEscape();if(s.get('chat_react_input'))event=new ma(event);event.kill();}else if(event.keyCode===bb.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var ye=da.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(s.get('chat_react_input'))event=new ma(event);!ye&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}te(this);if(this.hasEmptyInput()){da.inform('esc-pressed',this._threadID);}else{var ye=dd._("Are you sure you want to close this chat window?"),ze=dd._("You haven't sent your message."),af=new pa().setTitle(ye).setBody(ze).setButtons([pa.CLOSE,pa.CANCEL]).setHandler(da.inform.bind(da,'esc-pressed',this._threadID,null)).setModal(true).show(),bf=af.getButtonElement('yes');bf&&xa.set(bf);}},_titleClicked:function(event){var ye=event.getTarget();if(!wb.byClass(ye,'titlebarText')&&!wb.byClass(ye,'uiSelector')&&!wb.byClass(ye,'addToThread')&&!wb.byClass(ye,'optionMenu')&&!wb.byClass(ye,'videoicon')&&!wb.byClass(ye,'phoneicon')&&!wb.byClass(ye,"_1fu3")&&!wb.byClass(ye,"_1fu4")&&!wb.byClass(ye,'close')){event.kill();y.lowerTab(this._threadID);this.focus();}},_callEnter:function(ye){if(ye.keyCode===bb.RETURN)this._callClicked(ye);},_callClicked:function(ye){if(ye.target)ye.target.blur();var ze=this._getCanonicalUserID();if(this._videoCallLinkEnabled){var af;if(ye.target&&(n.hasClass(ye.target,'phoneicon')||n.hasClass(ye.target,"_1fu4"))){af='chat_tab_voice_icon';}else af='chat_tab_icon';da.inform('video-call-clicked',{threadID:this._threadID,userID:ze,clickSource:af,audioOnly:af==='chat_tab_voice_icon'});}if(s.get('chat_react_header')){ye.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_getUserParticipants:function(ye){var ze=[];ye.forEach(function(af){var bf=fb.getUserIDFromParticipantID(af);bf&&ze.push(bf);});return ze;},_enableDesktopNotif:function(){Notification.requestPermission();},_inputPasted:function(event){if(sc.chrome()){var ye=event.clipboardData||event.originalEvent.clipboardData;if(!ye||!ye.items||ye.items.length<1)return;var ze=ye.items[0].type;if(ze!=='image/png')return;if(ye.items[0].getAsFile){var af=ye.items[0].getAsFile();this._photoUploader.uploadFile(af);}}},_focusInput:function(){if(s.get('chat_react_input')){this._chatInput&&this._chatInput.isMounted()&&this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){n.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._closeMouseDown=false;this._setCloseTooltip(true);da.inform('focus-tab',this._threadID);},_blurTab:function(){n.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(ye){if(s.get('chat_react_header')){this._closeButton&&this._closeButton.setProps({active:ye});return;}var ze=this._getNode('titlebarCloseButton'),af=ye?dd._("Press Esc to close"):dd._("Close tab");oc.set(ze,af,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===bb.RETURN&&!event.shiftKey){if(oe(this)){me(this);event.kill&&event.kill();return;}je(this);event.kill&&event.kill();return;}if(event.keyCode===bb.DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();y.lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function(ye){var ze=this._getCanonicalUserID();if(!ze)return;var af='fbid:'+ze;hb.get(af,function(bf){m.loadModules(["MessageBlockedDialog"],function(cf){cf.show(ye.thread_id,ye.can_reply,kd.isMessageBlocked(ye),bf.short_name);});});},_initializeInput:function(){if(!s.get('chat_react_input')){var ye=this._inputContainerNode.clientHeight;mc.getInstance(this._getNode('input')).subscribe('resize',function(){var ze=this._inputContainerNode.clientHeight;if(ze!=ye)this._nubController.flyoutContentChanged();ye=ze;}.bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(sc.firefox()&&ja.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else this._chatInput=ac.render(ac.createElement(jd,{initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onAddMention:this._onAddMention.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:this._toggleStickersFlyoutShownLegacy.bind(this,true),resizeFn:function(ze){ic.set(this._getNode('inputContainer'),'height',ze+'px');this._nubController.flyoutContentChanged();}.bind(this),uploadPhotoFn:function(ze){this._photoUploader&&this._photoUploader.uploadFile(ze);}.bind(this)}),this._getNode('chatInputContainer'));},_initializeSharePreview:function(ye,ze){ua.listen(ye,'keyup',function(){var af=ze?ze():ye.value;if(!af.length){this._urlScraper.reset();delete this._urlScraperData;}}.bind(this));this._urlScraper=new qc(ye,ze);this._urlScraper.subscribe('match',function(af,bf){this._urlScraperData=bf;this._getSharePreview().then(function(cf){var df=this._urlScraperData;cf.setProps({share:null,uri:(df&&df.url)});}.bind(this));}.bind(this));},_getSharePreview:function(){if(!this._sharePreview&&!this._sharePreviewPromise){this._sharePreviewLoading=true;this._sharePreviewPromise=new zb(function(ye){m.loadModules(["MercurySharePreview.react"],function(ze){this._sharePreview=new bc(ze,this._getNode('shareAttachmentShelf'));this._sharePreview.setProps({imageSize:{width:ae,height:ae},location:ib.CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:function(){qe(this);this._unblockSend();}.bind(this)});this._sharePreviewLoading=false;ye(this._sharePreview);}.bind(this));}.bind(this));}return this._sharePreviewPromise;},_initializeThingsWithInputFn:function(ye,ze){this._initializeSharePreview(ye,ze);td.getThreadMeta(this._threadID,function(af){if(eb.CoreGraphEnabled&&af&&af.folder===pb.PENDING){n.hide(this._getNode('footer'));var bf=la.create('div');la.appendContent(this._getNode('chatConv'),bf);ac.render(ac.createElement(l,{bootloadPlaceholder:ac.createElement("div",{style:{height:27}}),bootloadLoader:ab('ChatPendingActions.react'),onDeleteClick:function(cf){uc.show(this._threadID);}.bind(this),onReplyClick:function(cf){la.remove(bf);n.show(this._getNode('footer'));this._updateControls(af);}.bind(this)}),bf);}pd.getFBIDFromClientID(this._threadID,function(cf){this._typingDetector=new pc(this._getCanonicalUserID(),ye,'mercury-chat',null,cf,ze);}.bind(this));}.bind(this));},_getInputValue:function(){if(s.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return '';return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},appendTextToInput:function(ye){if(s.get('chat_react_input')){if(this._chatInput&&this._chatInput.isMounted())this._chatInput.appendText(ye);}else this._getNode('input').value+=ye;},_hasUnfinishedPost:function(){return pe(this)||ne(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){sd.markRead(this._threadID);sd.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(ye){this.tryMarkAsRead();if(wb.byTag(ye.getTarget(),'a')||la.getSelection())return;this.focus();},_inputContainerClicked:function(ye){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function(){if(!this._pagesMessageIndicator)return;n.hide(this._pagesMessageIndicator);this._pagesMessageIndicatorHandler=vb.tryCreateHandler(this._threadID,this._pagesMessageIndicator,this._onlineStatus);this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.checkResponsiveness();},showTypingIndicator:function(ye){this._renderTypingIndicator();n.conditionClass(this._tabElem,"_54m8",ye);},_renderTypingIndicator:function(){var ye=n.hasClass(this._tabElem,'highlightTab')?'light':'dark';ac.render(ac.createElement(lb,{color:ye}),this._getNode('animationContainer'));},_updateUnreadCount:function(ye){var ze=ye.unread_count;if(typeof ze!='undefined'){var af=!!ze&&(!q.showsTabUnreadUI||q.showsTabUnreadUI()),bf=this._getNode('numMessages');n.conditionShow(bf,af);n.conditionClass(this._tabElem,'highlightTab',af);this._renderTypingIndicator();ge(this._threadID,this._tabElem,af);la.setContent(bf,ze);}},updateCallLink:function(){var ye=this._getCanonicalUserID();if(!ye||ye===ka.getID()||!va.isUser(ye)){if(s.get('chat_react_header')){if(this._videoCallButton)this._videoCallButton&&this._videoCallButton.setProps({shown:false});if(this._voiceCallButton)this._voiceCallButton.isMounted()&&this._voiceCallButton.setProps({shown:false});}else{var ze=this._getNode('videoCallLink');if(ze)n.hide(ze);var af=this._getNode('voiceCallLink');if(af)n.hide(af);}this._videoCallLinkEnabled=false;return;}this._videoCallLinkEnabled=wa.isCallable(ye);if(!s.get('chat_react_header')){n.conditionClass(this._tabElem,"_4hwz",this._videoCallLinkEnabled);hb.get(fb.getParticipantIDFromUserID(ye),function(bf){wa.callButtonTooltip(ye,bf.short_name);this._setCallButtonTooltips(ye,bf.short_name);}.bind(this));}},_setCallButtonTooltips:function(ye,ze){var af=wa.callButtonTooltip(ye,ze),bf=wa.voiceCallButtonTooltip(ye,ze);oc.set(this._getNode('videoCallLink'),af);var cf=this._getNode('voiceCallLink');if(cf)oc.set(cf,bf);},_initializeSheetController:function(){this._sheetController=new ca(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onClickMessagesBlockedSheet(function(){sd.unblockMessages(this._threadID);this.focus();}.bind(this));this._sheetController.onClickNewMessagesSheet(function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();}.bind(this));this._sheetController.onClickThreadIsMutedSheet(function(){sd.unmute(this._threadID);this.focus();}.bind(this));this._sheetController.onTokensChanged(function(ye,ze){td.getThreadMeta(this._threadID,function(af){this._updateControls(af,ze.token_count,ze.tokens);}.bind(this));}.bind(this));this._nubController=new qb().init(this._tabElem);this._sheetController.onResize(function(){this._nubController.flyoutContentChanged();}.bind(this));this._nubController.subscribe('resize',function(){this._resizeInputContainer();}.bind(this));},_initializeHeader:function(){this._initializeReactMenu(this._getNode('fileAttachmentShelf'));this._initializeArchiveWarning();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._initializeCloseButton();this._initializeTitle();},_initializeReactMenu:function(ye){var ze=fb.isGroupChat(this._threadID),af=td.isNewEmptyLocalThread(this._threadID),bf=this._sheetController.openAddFriendsSheet.bind(this._sheetController);this._reactChatTabMenu=new bc(z,this._getNode('menuContainer'));this._reactChatTabMenu.setProps({sheetController:this._sheetController,onFileUploaderMounted:this.setFileUploader.bind(this),nameConversationFunc:function(){return this.showNameConversation();}.bind(this),isGroupChat:ze,isEmptyChat:af,showAddFriend:bf,threadID:this._threadID,otherUserID:this._getCanonicalUserID(),attachmentsShelf:ye,onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:qe.bind(this,this),onSubmit:this._focusInput.bind(this)});},_initializeArchiveWarning:function(){if(s.get('chat_react_header')){this._archiveWarning=new bc(p,this._getNode('archiveContainer'));this._archiveWarning.setProps({isFBAtWork:s.IsWorkUser,shown:true});}},_initializeAddToThreadButton:function(){if(s.get('chat_react_header')){this._addToThreadButton=new bc(o,this._getNode('addToThreadContainer'));this._addToThreadButton.setProps({isFBAtWork:s.get('IsWorkUser',false),onClick:this._addFriendLinkClicked.bind(this),shown:true});}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){if(!fb.getUserIDFromThreadID(this._threadID))return;if(s.get('chat_react_header')){var ye=this._getCanonicalUserID();this._videoCallButton=new bc(ga,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({shown:true,isAudio:false,userID:ye,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});this._voiceCallButton=new bc(ga,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({shown:true,isAudio:true,userID:ye,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});}else{this._listen('videoCallLink','click',this._callClicked,true);this._listen('videoCallLink','keyup',this._callEnter,true);if(this._getNode('voiceCallLink')){this._listen('voiceCallLink','click',this._callClicked,true);this._listen('voiceCallLink','keyup',this._callEnter,true);}}},_initializeCloseButton:function(){if(s.get('chat_react_header')){this._closeButton=new bc(r,this._getNode('closeButtonContainer'));this._closeButton.setProps({onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)});}else{this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);}},_initializeTitle:function(){if(s.get('chat_react_header')){var ye=td.getThreadMetaNow(this._threadID);this._title=new bc(fa,this._getNode('titleContainer'));this._title.setProps({isNewThread:td.isNewEmptyLocalThread(this._threadID),thread:ye,viewer:ka.getID()});}},_initializeTitleHREF:function(){vc.getThreadURI(this._threadID,function(ze){return this._setTitleHref(ze);}.bind(this));if(!fb.getUserIDFromThreadID(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var ye=this._getCanonicalUserID();if(this._getCanonicalUserID())hb.get(fb.getParticipantIDFromUserID(ye),function(ze){if(ze.href)this._setTitleHref(ze.href);}.bind(this));},_initializeUIListeners:function(){if(this._pagesMessageIndicator)this._listen('scrollingArea','scroll',function(event){var ye=event.target;if(ye.scrollHeight-ye.offsetHeight!==ye.scrollTop)this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.hideIndicatorAndPreventFutureShow();}.bind(this));this._listen('closeButton','click',this._closeClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===bb.TAB){this._focusInput();event.kill();}if(event.keyCode===bb.ESC)this._handleEscape();}.bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFileUploader:function(ye){this._fileUploader=ye;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=ac.render(ac.createElement(v,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_initializeStickers:function(){this._stickersFlyoutToggler=this._getNode('emoticons');if(hc.shouldShowStickerSearchNUX())this._listen('emoticons','click',function(){if(hc.shouldShowStickerSearchNUX()){fc.selectPack(gc.SEARCH_PACK_ID);hc.clearShowStickerSearchNUX();}},true);if(s.get('chat_react_sticker_button')){this._stickerButton=ac.render(ac.createElement(x,{className:"_4vui",flyoutAlignment:"left",onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),threadID:this._threadID}),this._getNode('stickerButtonContainer'));k.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var ye=this._getNode('stickers');if(ye)var ze=new zb(function(bf){this._stickersFlyout=new bc(oa,ye);this._stickersFlyout.setProps({deferredPlaceholder:ac.createElement("div",{style:{padding:'30px',textAlign:'center'}},ac.createElement(xc,{size:"large"})),deferredComponent:function(cf){bf(cf);},onStickerSelect:function(cf){this._stickerSelected(cf);}.bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)});}.bind(this)),af=nc.listen('show',this._stickersFlyoutToggler,function(){nc.unsubscribe(af);ze.then(function(bf){m.loadModules(["StickersFlyout.react"],bf);});});}},_initializeContentSearch:function(){var ye=this._getNode('contentSearchContainer');if(ye){this._contentSearchButton=ac.render(ac.createElement(l,{bootloadPlaceholder:ac.createElement("div",{style:{height:27}}),bootloadLoader:ab('ChatContentSearchButton.react'),className:"_4vui",getInput:function(){return this.getInputElem();}.bind(this),getQuery:function(){return this._getInputValue();}.bind(this),onSelect:function(ze,af){var bf=this.getInputElem();bf&&bf.select&&bf.select();if(ze.platformFBID.toString()===eb.MessengerAppID){this._stickerSelected(ze.resultID.toString());}else{this._photoUploader&&this._photoUploader.uploadURL({attribution_app_id:ze.platformFBID,external_image_url:ze.source.url,preview_url:ze.media.preview?ze.media.preview.url:ze.media.thumbnail.url,source:ze.source});this._messagesView&&this._messagesView.scrollToBottom();}}.bind(this)}),ye);n.addClass(this._inputContainerNode,"_35li");k.bumpEntityKey('chat.web','content_search_button.mounting_attempted');}},_initializeDragDropTarget:function(){var ye=na.scry(this._tabElem,"._1ia");if(ye&&ye.length>0){this._dropTarget=new ra(ye[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}},_initializeP2PChatThreadBannerContainer:function(){var ye=na.scry(this._tabElem,"._2hc2");if(ye&&ye.length>0){this._p2pChatThreadBannerContainer=ye[0];ac.render(ac.createElement(rb,{otherUserID:fb.getUserIDFromThreadID(this._threadID),threadID:this._threadID}),this._p2pChatThreadBannerContainer);}},_initializeP2P:function(){this._sendMoneyDialogStoreSub=ub.addListener('change',this._onP2PSendMoneyDialogStoreChange.bind(this));if(this._isP2PEnabled())this._renderOrionTrigger();},_onP2PTransferStoreLoaded:function(){if(!this._isP2PEnabled()){this._transferStoreSub=ud.addListener('change',this._onP2PTransferStoreChange.bind(this));}else this._renderOrionTrigger();},_initializeHotLike:function(){if(this._getNode('hotLikeContainer')){ac.render(ac.createElement(ob,{className:"_3s0d",closeStickerTrayLegacy:function(){return nc.hide(this._stickersFlyoutToggler);}.bind(this),sendSticker:this._stickerSelected.bind(this),threadID:this._threadID}),this._getNode('hotLikeContainer'));n.addClass(this._inputContainerNode,"_n4k");}},_initializeUnloadListeners:function(){this._checkUnsentMessages=zc(function(){if(this._hasUnfinishedPost())return dd._("You haven't sent your message yet. Do you want to leave without sending?");if(nd.getNumberLocalMessages(this._threadID))return dd._("Your message is still being sent. Are you sure you want to leave?");return null;}.bind(this));cc.onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=zc(te.bind(null,this));cc.onUnload(this._logUnsentPhotos);},_handlePUSubmit:function(ye,ze){re(this,xb.UPLOAD_START,ze);le(this,'',[],function(af){if(this._threadID!==af.thread_id){this._newThreadIDFromPhotoUpload=af.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(af.thread_id);}af.content_attachment=null;md.addAttachmentPlaceholder(af,ze.upload_id,ze);}.bind(this));we('submit',ze);this._focusInput();},_handlePULastUploadFailed:function(ye,ze){re(this,xb.CLIENT_ERROR,ze);we('failed',ze);md.cancelAttachmentPlaceholder(ze.upload_id,ze);var af=dd._("Photo Upload Failed"),bf=dd._("Please try again. Make sure you are uploading a valid photo.");new pa().setTitle(af).setBody(bf).setButtons(pa.OK).show();},_handlePULastUploadCanceled:function(ye,ze){re(this,xb.CANCEL_DURING_UPLOAD,ze);we('canceled',ze);md.cancelAttachmentPlaceholder(ze.upload_id,ze);},_handlePUAllUploadsCompleted:function(ye,ze){re(this,xb.ALL_UPLOADS_DONE,ze);we('completed',ze);md.confirmAttachmentPlaceholder(ze.upload_id,ze);var af=ze.image_ids.length||ze.attachments.length;ke(this,af);},_stickerSelected:function(ye){le(this,'',[],function(ze){ze.has_attachment=true;ze.sticker_id=ye;md.send(ze);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(ye){var ze=ta.symbols[ye];if(!ze)return;if(s.get('chat_react_input')){this._chatInput.insertEmoticon(ze);return;}this._selectionPosition=this._selectionPosition||new ec(this._getNode('input'));var af=mc.getInstance(this._getNode('input')),bf=af.getValue(),cf=sa.insertEmoticon(ze,bf,this._selectionPosition.getPos());af.setValue(cf.result);this._selectionPosition.setPos(cf.start,cf.end);},_orionTriggered:function(){le(this,'',[],function(ye){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){n.addClass(this._getNode('emoticonIndicator'),'nux');yd=false;},_onFlyoutShown:function(ye){if(s.get('chat_react_sticker_button')){var ze=this._stickersFlyout.props.packID;if(ze!==gc.SEARCH_PACK_ID)this.focus();}ye();this._stickersFlyoutShown=true;},_searchStickers:function(ye,ze){this._stickersFlyout&&this._stickersFlyout.setProps({packID:gc.SEARCH_PACK_ID,trigger:ye},ze);},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();},_setTitleHref:function(ye){if(s.get('chat_react_header')){this._title&&this._title.setProps({href:ye});}else{var ze=this._getNode('titlebarText');ze.setAttribute('href',ye);ze.removeAttribute('rel');n.removeClass(ze,'noLink');}},_onAddMention:function(ye){this._linkDropped((new rc(ye.getURI())).getQualifiedURI().toString());},_unblockSend:function(){if(!this._blocked||oe(this))return;this._blocked=false;je(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function(){new h('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();}});function we(ye,ze){be.debug('photo_uploader:'+ye,Object.assign({},ze));}function xe(ye,ze){if(!ze)return ye;var af=ze.getImageFiles();if(af.length>0){ye.image_ids=af;ye.has_attachment=true;}var bf=ze.getAnimatedImageFiles();if(bf.length>0){ye.gif_ids=bf;ye.has_attachment=true;}var cf=ze.getVideoFiles();if(cf.length>0){ye.video_ids=cf;ye.has_attachment=true;}var df=ze.getAudioFiles();if(df.length>0){ye.audio_ids=df;ye.has_attachment=true;}var ef=ze.getFiles();if(ef.length>0){ye.file_ids=ef;ye.has_attachment=true;}return ye;}e.exports=se;},null);
__d("ChatTabTypeaheadDataSource",["MercuryTypeaheadConstants","MercuryTypeaheadDataSource"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l){"use strict";l=l||{};l.maxResults=g.COMPOSER_CHATTAB_MAX;h.call(this,l);this.$ChatTabTypeaheadDataSource0=true;}k.prototype.buildData=function(l){"use strict";var m=[],n=[],o=[],p=[],q=[];l.forEach(function(r){var s=j.getEntry.call(this,r);switch(s.render_type){case g.FRIEND_TYPE:m.push(r);break;case g.THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource0)n.push(r);break;case g.NON_FRIEND_TYPE:o.push(r);break;case g.FB4C_TYPE:p.push(r);break;case g.PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource0)q.push(r);break;default:this.logQuery({event:'chat_tab_render_type_error'});break;}},this);return j.buildData.call(this,m.concat(p,n,q,o));};k.prototype.query=function(l,m,n,o){"use strict";this.logQuery({event:'query_chat_tab',query:l});return j.query.call(this,l,m,n,o);};k.prototype.respond=function(l,m,n){"use strict";var o=j.respond.call(this,l,m,n);this.logResponse({event:'query_response_chat_tab',response_query:l,response_uids:m});return o;};k.prototype.setShowThreads=function(l){"use strict";this.$ChatTabTypeaheadDataSource0=l;};e.exports=k;},null);