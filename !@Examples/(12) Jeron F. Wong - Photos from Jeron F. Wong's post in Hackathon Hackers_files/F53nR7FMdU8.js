/*!CK:1453075901!*//*1438953015,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["G2ghA"]); }

__d("loadImage",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';function g(h,i){var j=new Image();j.onload=function(){i(j.width,j.height,j);};j.src=h;}e.exports=g;},null);
__d("PhotoResizeMath",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={getScaledPhotoDimensions:function(h,i,j,k,l){var m=h/i,n=j/k;if(j&&k&&l==='stretch')return {width:j,height:k};if((!j&&k)||((l==='contain')!==(m>=n)))return {width:k*m,height:k};if(j)return {width:j,height:j/m};return {width:h,height:i};}};e.exports=g;},null);
__d("PixelzFocus",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';var g={search:function(h,i){var j=0,k=h.length-1;while(j<=k){var l=j+Math.floor((k-j)/2),m=h[l];if(m>i){k=l-1;}else if(m<i){j=l+1;}else return l;}return Math.min(j,k);},forceSpecificPoint:function(h,i,j){var k=1e-09,l=g.search(h,i-j-k)+1,m=g.search(h,i+j);return h.slice(l,m+1);},findBiggestSets:function(h,i){var j=[],k=-1;for(var l=0;l<h.length;++l){var m=h[l],n=l,o=g.search(h,m+i),p=o-n;if(p>k)j=[];if(p>=k){k=p;j.push({low:n,high:o});}}return j;},getBestSet:function(h,i,j){var k=-1,l=null;for(var m=0;m<i.length;++m){var n=i[m],o=h[n.low],p=h[n.high],q=o+(p-o)/2,r=Math.min(o-(q-j),(q+j)-p);if(r>k){k=r;l=n;}}return l;},getFocusFromSet:function(h,i){var j=h[i.low],k=h[i.high];return j+(k-j)/2;},clampFocus:function(h,i){var j=i/2,k=1-(i/2);if(h<j)return j;if(h>k)return k;return h;},convertFromCenterToCSS:function(h,i){if(Math.abs(1-i)<1e-05)return 0;return (h-i/2)/(1-i);},convertFromCSSToCenter:function(h,i){return h*(1-i)+i/2;},getVisible:function(h,i){if(h<i)return h/i;return i/h;},getHidden:function(h,i){return 1-g.getVisible(h,i);},focusHorizontally:function(h,i){return h<i;},convertVectorFromCenterToCSS:function(h,i,j){var k=g.focusHorizontally(i,j),l;if(k){l=h.x/100;}else l=h.x/100;var m=g.convertFromCenterToCSS(l,g.getVisible(i,j));if(k){return {x:m,y:0};}else return {x:0,y:m};},getCropRect:function(h,i,j){var k=g.focusHorizontally(i,j),l=g.getVisible(i,j);if(k){var m=(1-l)*h.x;return {left:m,top:0,width:l,height:1};}else{var n=(1-l)*h.y;return {left:0,top:n,width:1,height:l};}}};e.exports=g;},null);
__d("Pixelz.react",["arrayContains","cx","loadImage","joinClasses","React","PhotoResizeMath","PixelzFocus"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=k.createClass({displayName:"Pixelz",propTypes:{width:o.number,height:o.number,resizeMode:o.oneOf(['contain','cover','stretch']),alt:o.string,letterbox:o.bool,borderRadius:o.number,insetBorderColor:o.string,animated:o.bool,upscale:o.bool,cropRect:function(q,r,s){var t=q[r],u='Invalid prop `'+r+'` supplied to `'+s+'`, expected a rectangle with values normalized '+'between 0 and 1.';if(t.left<0||t.top<0||t.width<0||t.height<0||t.left+t.width>1||t.top+t.height>1)return new Error(u);},focus:function(q,r,s){var t=q[r],u='Invalid prop `'+r+'` supplied to `'+s+'`, expected either a {x, y, type} vector where type '+'is `css` or `center` or an array of {x, y} vectors. All the vectors '+'have with values normalized between 0 and 1.';if(Array.isArray(t)){for(var v=0;v<t.length;++v)if(!(t[v].x>=0&&t[v].x<=1)||!(t[v].y>=0&&t[v].y<=1))return new Error(u);}else{if(!t.type)t.type='css';if(!(t.x>=0&&t.x<=1)||!(t.y>=0&&t.y<=1)||!g(['center','css'],t.type))return new Error(u);}}},getDefaultProps:function(){return {resizeMode:'cover',alt:'',letterbox:true,upscale:true,cropRect:{width:1,height:1,top:0,left:0},focus:{x:.5,y:.5,type:'css'}};},getInitialState:function(){return {srcDimensions:{}};},getSrcDimensions:function(){var q=this.props.src,r=this.state.srcDimensions[q];if(r)return r;i(q,function(s,t){var u={};u[q]={width:s,height:t};this.isMounted()&&this.setState({srcDimensions:u});}.bind(this));return null;},getCropSrcDimensions:function(){var q=this.getSrcDimensions();return {width:q.width*this.props.cropRect.width,height:q.height*this.props.cropRect.height};},getUpscaleCropDimensions:function(){var q=this.getCropSrcDimensions();return l.getScaledPhotoDimensions(q.width,q.height,this.props.width,this.props.height,this.props.resizeMode);},getCropDimensions:function(){var q=this.getUpscaleCropDimensions(),r=this.getCropSrcDimensions();if(!this.props.upscale)return {width:Math.min(q.width,r.width),height:Math.min(q.height,r.height)};return q;},getCropAspectRatio:function(){var q=this.getCropDimensions();return q.width/q.height;},getContainerDimensions:function(){if(this.props.letterbox&&this.props.width&&this.props.height)return {width:this.props.width,height:this.props.height};return this.getCropDimensions();},getContainerAspectRatio:function(){var q=this.getContainerDimensions();return q.width/q.height;},getContainerPosition:function(){return {left:0,top:0};},getFocus:function(){var q=this.props.focus;if(!Array.isArray(q)&&q.type==='css')return {x:q.x,y:q.y};var r=this.getContainerAspectRatio(),s=this.getCropAspectRatio(),t=m.getVisible(r,s),u=m.focusHorizontally(r,s),v;if(!Array.isArray(q)){v=m.convertFromCenterToCSS(u?q.x:q.y,t);}else{var w=q.map(function(z){return u?z.x:z.y;});w.sort();var x=m.findBiggestSets(w,t),y=m.getBestSet(w,x,t);v=m.getFocusFromSet(w,y);}return {x:u?v:.5,y:u?.5:v};},getCropPosition:function(){var q=this.getCropDimensions(),r=this.getContainerDimensions(),s=this.getFocus();return {left:s.x*(r.width-q.width),top:s.y*(r.height-q.height)};},getScaleDimensions:function(){var q=this.getCropDimensions();return {width:q.width/this.props.cropRect.width,height:q.height/this.props.cropRect.height};},getScalePosition:function(){var q=this.getScaleDimensions();return {left:-q.width*this.props.cropRect.left,top:-q.height*this.props.cropRect.top};},getClipCropRectangle:function(){var q=this.getContainerDimensions(),r=this.getCropDimensions(),s=this.getContainerPosition(),t=this.getCropPosition(),u=Math.max(s.left,t.left),v=Math.max(s.top,t.top),w=Math.min(s.top+q.height,t.top+r.height),x=Math.min(s.left+q.width,t.left+r.width);return {left:u,top:v,width:x-u,height:w-v};},getClipCropPosition:function(){var q=this.getClipCropRectangle();return {left:q.left,top:q.top};},getClipCropDimensions:function(){var q=this.getClipCropRectangle();return {width:q.width,height:q.height};},getClipScalePosition:function(){var q=this.getScalePosition(),r=this.getClipCropPosition(),s=this.getCropPosition();return {left:q.left+(s.left-r.left),top:q.top+(s.top-r.top)};},getClipScaleDimensions:function(){return this.getScaleDimensions();},areDimensionsEqual:function(q,r){return q.width===r.width&&q.height===r.height;},shouldAddAllNodesAndStyles:function(){return this.props.animated;},hasCrop:function(){if(this.shouldAddAllNodesAndStyles())return true;var q=this.getContainerDimensions(),r=this.getClipCropDimensions(),s=this.getClipScaleDimensions();if(this.areDimensionsEqual(q,r)||this.areDimensionsEqual(r,s))return false;return true;},hasContainer:function(){if(this.shouldAddAllNodesAndStyles()||this.hasInsetBorder())return true;var q=this.getContainerDimensions(),r=this.getClipScaleDimensions();if(this.areDimensionsEqual(q,r))return false;return true;},hasInsetBorder:function(){return this.shouldAddAllNodesAndStyles()||this.props.insetBorderColor;},applyPositionStyle:function(q,r){if(this.shouldAddAllNodesAndStyles()||r.left)q.left=Math.round(r.left);if(this.shouldAddAllNodesAndStyles()||r.top)q.top=Math.round(r.top);},applyDimensionsStyle:function(q,r){q.width=Math.round(r.width);q.height=Math.round(r.height);},applyBorderRadiusStyle:function(q){if(this.shouldAddAllNodesAndStyles()||this.props.borderRadius)q.borderRadius=this.props.borderRadius||0;},getScaleStyle:function(){var q={},r=this.getClipCropDimensions(),s=this.getClipScaleDimensions();if(this.shouldAddAllNodesAndStyles()||!this.areDimensionsEqual(r,s)){this.applyPositionStyle(q,this.getClipScalePosition());}else this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipScaleDimensions());this.applyBorderRadiusStyle(q);return q;},getCropStyle:function(){var q={};this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipCropDimensions());this.applyBorderRadiusStyle(q);return q;},getInsetBorderStyle:function(){var q={borderColor:this.props.insetBorderColor||'transparent'};this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipCropDimensions());this.applyBorderRadiusStyle(q);return q;},getContainerStyle:function(){var q={};this.applyDimensionsStyle(q,this.getContainerDimensions());this.applyBorderRadiusStyle(q);return q;},getScale:function(){var q=this.getScaleStyle(),r=q.width,s=q.height;q=Object.assign({},q);delete q.width;delete q.height;return (k.createElement("img",k.__spread({},this.props,{alt:this.props.alt,className:j(this.props.className,(("_56wb")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''))),src:this.props.src,style:Object.assign({},(this.props.style||{}),q),width:r,height:s})));},getCrop:function(){var q=this.getScale();if(!this.hasCrop())return q;return (k.createElement("div",{className:(("_56ma")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getCropStyle()},q));},getInsetBorder:function(){if(!this.hasInsetBorder())return null;return (k.createElement("div",{className:(("_56lv")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getInsetBorderStyle()}));},getContainer:function(){var q=this.getCrop();if(!this.hasContainer())return q;var r=this.getInsetBorder();return (k.createElement("div",{className:(("_56jj")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getContainerStyle()},q,r));},render:function(){var q=this.getSrcDimensions();if(!q)return k.createElement("span",null);return this.getContainer();}});e.exports=p;},null);
__d("XComposerPhotoUploader",["AsyncUploadRequest","FileInputUploader","JSLogger","PhotosMimeType","PhotosUploadID","createArrayFromMixed","curry","emptyFunction","performanceNow"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';function p(q){this.$XComposerPhotoUploader0=q.uploadData||{};this.$XComposerPhotoUploader1=q.uploadEndpoint;this.$XComposerPhotoUploader2=q.retryLimit;this.$XComposerPhotoUploader3=q.concurrentLimit;this.$XComposerPhotoUploader4=q.resizer;this.$XComposerPhotoUploader5=q.onUploadEnqueued||n;this.$XComposerPhotoUploader6=q.onUploadsEnqueued||n;this.$XComposerPhotoUploader7=q.onResizeStart||n;this.$XComposerPhotoUploader8=q.onResizeProgress||n;this.$XComposerPhotoUploader9=q.onResizeSuccess||n;this.$XComposerPhotoUploadera=q.onResizeFailure||n;this.$XComposerPhotoUploaderb=q.onUploadSent||n;this.$XComposerPhotoUploaderc=q.onUploadStart||n;this.$XComposerPhotoUploaderd=q.onUploadProgress||n;this.$XComposerPhotoUploadere=q.onUploadSuccess||n;this.$XComposerPhotoUploaderf=q.onUploadFailure||n;this.$XComposerPhotoUploaderg=i.create('composer');}p.prototype.upload=function(q){var r=Object.assign({},this.$XComposerPhotoUploader0),s=null;if(!this.$XComposerPhotoUploaderh(q)){var t=k.getNewID();q.uploadID=t;r.upload_id=t;this.$XComposerPhotoUploader5({uploadID:t,fileName:q.value.split('/').pop().split('\\').pop()});}else{s=l(q.files);s.forEach(function(w){if(!w.uploadID)w.uploadID=k.getNewID();this.$XComposerPhotoUploader5({uploadID:w.uploadID,fileName:w.name});}.bind(this));}this.$XComposerPhotoUploader6();var u=new h(q).setURI(this.$XComposerPhotoUploader1).setData(r).setAllowCrossOrigin(true).setNetworkErrorRetryLimit(this.$XComposerPhotoUploader2).setUploadInParallel(true);if(s&&s.length>0){u.setFiles({farr:s});if(this.$XComposerPhotoUploader4)u.setPreprocessHandler(this.$XComposerPhotoUploaderi.bind(this));if(this.$XComposerPhotoUploader3)u.setConcurrentLimit(this.$XComposerPhotoUploader3);}u.subscribe('progress',function(w,x){return this.$XComposerPhotoUploaderd(this.$XComposerPhotoUploaderk(x,q),x);}.bind(this));u.subscribe('failure',function(w,x){return this.$XComposerPhotoUploaderf(this.$XComposerPhotoUploaderk(x,q),x,s);}.bind(this));u.subscribe('start',function(w,x){return this.$XComposerPhotoUploaderc(this.$XComposerPhotoUploaderk(x,q),x);}.bind(this));u.subscribe('success',function(w,x){return this.$XComposerPhotoUploadere(this.$XComposerPhotoUploaderk(x,q),x);}.bind(this));try{u.send();this.$XComposerPhotoUploaderb(q);}catch(v){this.$XComposerPhotoUploaderg.error('error_send_unpublished_files',v);throw v;}};p.prototype.getAsyncUploadRequest=function(q,r){var s=new g().setData(Object.assign({},r&&r.data,this.$XComposerPhotoUploader0)).setFiles({farr:q}).setAllowCrossOrigin(true).setURI(this.$XComposerPhotoUploader1);if(this.$XComposerPhotoUploader3)s.setLimit(this.$XComposerPhotoUploader3);if(this.$XComposerPhotoUploader4)s.setPreprocessHandler(this.$XComposerPhotoUploaderi.bind(this));s.subscribe('start',function(t,u){return this.$XComposerPhotoUploaderc(u.getFile().uploadID,{upload:u});}.bind(this));s.subscribe('progress',function(t,u){return this.$XComposerPhotoUploaderd(u.getFile().uploadID,{upload:u,event:u.getProgressEvent()});}.bind(this));s.subscribe('success',function(t,u){return this.$XComposerPhotoUploadere(u.getFile().uploadID,{upload:u,response:u.getResponse()});}.bind(this));s.subscribe('failure',function(t,u){return this.$XComposerPhotoUploaderf(u.getFile().uploadID,{upload:u,response:u.getResponse()},q);}.bind(this));return s;};p.prototype.$XComposerPhotoUploaderk=function(q,r){if(q.upload){return q.upload.getFile().uploadID;}else return r.uploadID;};p.prototype.$XComposerPhotoUploaderi=function(q,r){var s=q.getFile();if(!s||!j(s.type).isJpeg())return r(q);var t=o();this.$XComposerPhotoUploader7(s);this.$XComposerPhotoUploader4.resizeBlob(s,function(u,v,w){v=v||s;if(u){var x=o()-t;this.$XComposerPhotoUploadera(s,v,u,x);return r(q);}v.uploadID=s.uploadID;v.filename=s.name;q.setFile(v);this.$XComposerPhotoUploader9(s,v,w,o()-t);r(q);}.bind(this),m(this.$XComposerPhotoUploader8,s.uploadID));};p.prototype.$XComposerPhotoUploaderh=function(q){return !!q.files&&g.isSupported();};e.exports=p;},null);
__d("updatePhotoProgressBar",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();'use strict';function g(h,event){if(event.loaded!=event.total){h.setPosition(50*event.loaded/event.total);}else{h.setPosition(50);h.setTarget(100,2000);}}e.exports=g;},null);
__d("BanzaiScribe",["Banzai"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(j){return {log:function(k,l,m){var n=[l];if(m!=null)n.push(m);g.post('scribe:'+k,n,j);}};}var i=h({});i.create=h;e.exports=i;},null);
__d("SamplingPolicyBase",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(){"use strict";throw 'Tried to instantiate SamplingPolicyBase';}g.prototype.getName=function(){"use strict";return this.name;};g.prototype.isSampled=function(){"use strict";if(typeof(this.sampled)=='undefined')this.sampled=this.decideIfSampled();return this.sampled;};e.exports=g;},null);
__d("FbtraceForcedByServerPolicy",["FbtraceForcedByServer","SamplingPolicyBase"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i;function j(){this.name='FbtraceForcedByServerPolicy';}j.get=function(){if(typeof(i)=='undefined')i=new j();return i;};function k(){return g.forced;}Object.assign(j.prototype,h.prototype,{decideIfSampled:k});e.exports=j;},null);
/**
 * @generated SignedSource<<623c7cbcff19956af736c3d064fc689d>>
 *
 * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 * !! This file is a check-in of a static_upstream project!      !!
 * !!                                                            !!
 * !! You should not modify this file directly. Instead:         !!
 * !! 1) Use `fjs use-upstream` to temporarily replace this with !!
 * !!    the latest version from upstream.                       !!
 * !! 2) Make your changes, test them, etc.                      !!
 * !! 3) Use `fjs push-upstream` to copy your changes back to    !!
 * !!    static_upstream.                                        !!
 * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 *
 * Copyright (C) 2010 by Johannes Baagoe <baagoe@baagoe.org>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * @providesModule Alea
 * @preserve-header
 */__d("Alea",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(){var i=4022871197,j=function(k){k=k.toString();for(var l=0;l<k.length;l++){i+=k.charCodeAt(l);var m=.02519603282416938*i;i=m>>>0;m-=i;m*=i;i=m>>>0;m-=i;i+=m*4294967296;}return (i>>>0)*2.3283064365386963e-10;};j.version='Mash 0.9';return j;}function h(){return (function(i){var j=0,k=0,l=0,m=1;if(i.length===0)i=[new Date()];var n=new g();j=n(' ');k=n(' ');l=n(' ');for(var o=0;o<i.length;o++){j-=n(i[o]);if(j<0)j+=1;k-=n(i[o]);if(k<0)k+=1;l-=n(i[o]);if(l<0)l+=1;}n=null;var p=function(){var q=2091639*j+m*2.3283064365386963e-10;j=k;k=l;l=q-(m=q|0);return l;};p.version='Alea 0.9';p.args=i;return p;}(Array.prototype.slice.call(arguments)));}e.exports=h;},null);
__d("Random",["Alea","ServerNonce"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=b('ServerNonce').ServerNonce,i=g(h),j={random:i,uint32:function(){return Math.floor(i()*4294967296);}};e.exports=j;},null);
__d("guardFunction",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h,i,j){return function(){if(h.apply(j||this,arguments))i.apply(j||this,arguments);};}e.exports=g;},null);
__d("Fbtrace",["Arbiter","BanzaiScribe","ErrorUtils","FbtraceForcedByServer","FbtraceForcedByServerPolicy","Random","SiteData","guardFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',p='AAAAAAAAAAA';for(var q in Error)if(Error.hasOwnProperty(q))s[q]=Error[q];var r=Error===null?null:Error.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=Error;function s(ha){Error.call(this,ha);}function t(ha){i.reportError(new s(ha));}function u(){var ha=function(){var ka=0,la=0,ma='';for(var na=10;na>=0;na--){if(ka<6){la=l.uint32();ka=32;}if(na===0)la=la&7;ma=o.charAt(la&63)+ma;la>>=6;ka-=6;}return ma;},ia,ja;for(ia=3;ia>0;ia--){ja=ha();if(ja!=p)return ja;}t('failed to generate valid Fbtrace id');return p;}function v(){Object.assign(this,v);}Object.assign(v,{isOn:function(){return false;},replySend:function(ha,ia){},requestSend:function(ha,ia,ja){ba(ha,ia);return {metadata:function(){return (void 0);},replyReceive:function(ka){}};}});var w=new v();function x(ha,ia,ja){if(!ha)throw {name:'ArgumentError',message:'no valid service name specified'};if(!ia)throw {name:'ArgumentError',message:'no valid version specified'};var ka=h,la=0,ma=u(),na=u(),oa=aa(ma),pa={service:ha,version:ia},qa=function(va){if(typeof(va)=='undefined')return 'undefined';if(typeof(va)!='string')va=qa(JSON.stringify(va));return va;},ra=function(va){var wa='';for(var xa in va){if(wa.length>0)wa+='\x02';wa+=qa(xa)+'\x03'+qa(va[xa]);}return wa;},sa=function(va,wa,event,xa,ya){la++;return [ya,la,ma,va,wa,qa(event),ra(xa)].join('\x01');},ta=function(va,wa,event,xa,ya){if(!ya&&typeof(ya)=='undefined')ya=Date.now()*1000;var za=sa(va,wa,event,xa,ya);ka.log('fbtrace',za,oa);},ua=function(){return na;};ta(p,na,'#rqrecv',Object.assign(ja||{},pa));Object.assign(this,x,{replySend:function(va,wa){wa=Object.assign({},wa,pa,{success:va?'true':'false'});ta(p,na,'#rpsend',wa);},requestSend:function(va,wa,xa){ba(va,wa);var ya=ua(),za=u();xa=Object.assign({},xa,pa,{op:va,'remote:service':wa});ta(ya,za,'#rqsend',xa);return {metadata:function(){return ma+za;},replyReceive:function(ab){ta(ya,za,'#rprecv',Object.assign(ab||{},pa));},parentNode:this};}});}Object.assign(x,{isOn:function(){return true;}});function y(){return w;}function z(ha,ia,ja){ja=ja||{};ja.init=true;var ka=k.get();if(ka.isSampled()){return new x(ha,ia,ja);}else return new v();}function aa(ha){var ia=ha.charAt(ha.length-1);return o.indexOf(ia)%32;}function ba(ha,ia){if(!ha)throw {name:'ArgumentError',message:'no valid operation specified'};if(!ia)throw {name:'ArgumentError',message:'no valid remote:service specified'};}function ca(ha,ia){var ja=w,ka;w=ha;try{ka=ia();}finally{w=ja;}return ka;}var da=function(ha,ia){var ja=y(),ka=ia.request,la=false;if(!ja.isOn()&&j.forced&&/\/upload\/(?:composer|photos)\/|\/ajax\/composerx\/attachment\/media\//.test(ka.uri.toString())){ja=z('photo_upload_kludge',String(m.revision||'dev'),{policy:'PhotoUpload'});la=true;}if(ja.isOn()){var ma=la?{policy:'PhotoUpload'}:{};if(ka.userActionId)ma.user_action_id=ka.userActionId;var na=ja.requestSend(ka.uri.toString(),'www',ma);ka.fbtraceRemoteNode=na;ka.transport.setRequestHeader('X-Fbtrace-Meta',na.metadata());}},ea=function(ha,ia){ia.request.fbtraceRemoteNode.replyReceive({is_last:ia.response.is_last,success:true});setTimeout(function(){ia.request.fbtraceRemoteNode.parentNode.replySend(true,{});},0);},fa=function(ha,ia){ia.request.fbtraceRemoteNode.replyReceive({is_last:ia.response.is_last,success:false,error_code:ia.response.error,error_summary:ia.response.errorSummary,error_description:ia.response.errorDescription});setTimeout(function(){ia.request.fbtraceRemoteNode.parentNode.replySend(false,{});},0);},ga=function(ha,ia){return ia.request.fbtraceRemoteNode;};g.subscribe('AsyncRequest/will_send',da);g.subscribe('AsyncRequest/response',n(ga,ea));g.subscribe('AsyncRequest/error',n(ga,fa));e.exports={defaultNode:y,requestReceive:z,withDefaultNode:ca};},null);
__d("PhotosMultiUploadInput",["Arbiter","Animation","AsyncUploadRequest","ComposerWaterfallEvent","ComposerXController","ComposerXDragDropUtils","ComposerXMarauderLogger","ComposerXMediaUploadHandler","CSS","Dialog","DOM","DragDropTarget","Event","JpegResizer","Parent","PhotosMimeType","PhotosUploadID","PhotosUploadWaterfallXMixin","PUWApplications","PUWMethods","PUWSteps","ProgressBar","Tooltip","WaterfallIDGenerator","XComposerPhotoUploader","$","csx","cx","mixin","performanceNow","fbt","updatePhotoProgressBar","Fbtrace"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){b.__markCompiled&&b.__markCompiled();var ma=1366052;b("Fbtrace");function na(wa,xa,ya,za){"use strict";this._grid=ta.getInstance(za.gridID);this._grid.setProgressBarMarkup(wa).setVideoIconMarkup(xa).setConfig(za);ya.getInput().multiple=(za.maxselect!=1)&&i.isSupported();ya.subscribe('change',function(ab,event){if(event.getTarget().value)this._grid.doFileUpload(ya);}.bind(this));if(!this._grid.sessionStarted){this._grid.sessionStarted=true;this._grid.logStep(aa.CLIENT_FLOW_BEGIN,{custom_tags:{high_quality:za.initWithHighQuality}});}this._grid.logStep(aa.CLIENT_SELECT_BEGIN);g.inform('PhotosMultiUploadInput/loaded/'+za.gridID,null,g.BEHAVIOR_PERSISTENT);}na.prototype.getGrid=function(){"use strict";return this._grid;};na.prototype.onQualitySettingChanged=function(wa){"use strict";this._grid.setQuality(wa);};Object.assign(na,{imageUploadDone:function(wa,xa,ya,za,ab){oa[wa].imageUploadDone(xa,ya,za,ab);},addCameraImage:function(wa,xa,ya){oa[wa].addCameraImage(xa,ya);},initDragDrop:function(wa,xa){g.inform('PhotosMultiUploadInput/initDragDrop/'+wa,{dragDropArea:xa},g.BEHAVIOR_PERSISTENT);},imageUploadFail:function(wa,xa){oa[wa].removeLoadingIndicator(xa.getFile().uploadID);},doFileUpload:function(wa,xa){oa[wa].doFileUpload(xa);},onFilesDrop:function(wa,xa){oa[wa].onFilesDrop(xa);},getWaterfallID:function(wa){return ta.getInstance(wa).getWaterfallID();},clearSession:function(wa){oa[wa].clearSession();},getConfig:function(wa){return oa[wa].getConfig();}});var oa={},pa=0,qa=ia(x);for(var ra in qa)if(qa.hasOwnProperty(ra))ta[ra]=qa[ra];var sa=qa===null?null:qa.prototype;ta.prototype=Object.create(sa);ta.prototype.constructor=ta;ta.__superConstructor__=qa;function ta(wa){"use strict";qa.call(this);this._loadingIndicators={};this._numRemainingFiles=0;this._progressBarMarkup=null;this._videoIconMarkup=null;this._gridID=wa;this._dragDropTarget=null;this._submitListener=null;this._fileInputInstances=[];this._uploadTimers={};this._sessionsStarted=false;this._waterfallID=null;this._resizer=null;this._numUploadsSucceeded=0;this._numUploadsFailed=0;this._uploadIDToFileUpload={};this._failedUploadIDs={};g.subscribe('multi-upload/video-removed/'+this._gridID,function(){q.remove(this._videoIconMarkup);this._submitListener&&this._submitListener.remove();this._submitListener=null;this._fileInputInstances.forEach(function(xa){xa.clear();});}.bind(this));g.subscribe('multi-upload/image-removed/'+this._gridID,function(){this._logComposerWaterfallEvent(j.PHOTO_REMOVE);}.bind(this));g.subscribe('PhotosMultiUploadInput/initDragDrop/'+this._gridID,function(xa,ya){this.initDragDrop(ya.dragDropArea);}.bind(this));g.subscribe('AttachmentsPhotoEditor/logPhotoEditorLaunched'+this._gridID,function(xa,ya){this.logStep(aa.CLIENT_PHOTO_EDIT_BEGIN);}.bind(this));g.subscribe('AttachmentsPhotoEditor/newImage'+this._gridID,this._onEditedImage.bind(this));}ta.prototype.getWaterfallID=function(){"use strict";if(!this._waterfallID)this._waterfallID=da.generate();return this._waterfallID;};ta.prototype.getWaterfallAppName=function(){"use strict";return y.WEB_COMPOSER;};ta.prototype.getLoadingIndicator=function(wa){"use strict";var xa=this._loadingIndicators[wa];return xa;};ta.prototype.initDragDrop=function(wa){"use strict";this._dragDropTarget&&this._dragDropTarget.disable();this._dragDropTarget=new r(wa).setOnFilesDropCallback(function(xa){this.onFilesDrop(xa,z.DRAGDROP);}.bind(this)).setFileFilter(l.filterImages).enable();};ta.prototype.setConfig=function(wa){"use strict";this._config=wa;this._isHighQuality=(wa.hasOwnProperty('initWithHighQuality'))?wa.initWithHighQuality:true;if(!t.isSupported()){this.logStep(aa.CLIENT_PROCESS_UNAVAILABLE);}else if(this._config.useResizer){this._resizer=new t(this._config.maxselect===1?1:t.DEFAULT_POOL_SIZE);this._resizer.setHighQuality(this._isHighQuality);}if(!this._waterfallID)this._waterfallID=wa.waterfallID;this._concurrentLimit=wa.concurrentLimit;return this;};ta.prototype.setProgressBarMarkup=function(wa){"use strict";this._progressBarMarkup=wa;return this;};ta.prototype.setVideoIconMarkup=function(wa){"use strict";this._videoIconMarkup=wa;var xa=q.find(wa,"._3ev");s.listen(xa,'click',this._onVideoRemoved.bind(this));return this;};ta.prototype.setQuality=function(wa){"use strict";this._isHighQuality=wa;this._resizer&&this._resizer.setHighQuality(wa);this.logStep(aa.CLIENT_QUALITY_SWITCH,{custom_tags:{high_quality:this._isHighQuality}});};ta.prototype.imageUploadDone=function(wa,xa,ya,za){"use strict";this._numUploadsSucceeded++;var ab=this.getLoadingIndicator(xa);if(!ab)return;if(q.contains(document.body,ab.getRoot()))q.replace(ab.getRoot(),wa);var bb={};bb[xa]=ya;this._informImagesAdded(bb,za);this._markUploadAsFinished();this._loadingIndicators[xa]=null;};ta.prototype.addCameraImage=function(wa,xa){"use strict";this.insertIntoGrid(wa);this._informImagesAdded({'0':xa},{});this.logStep(aa.CLIENT_ATTACH_PHOTO,{method:z.CAMERA,fbid:xa});};ta.prototype._informImagesAdded=function(wa,xa){"use strict";g.inform(['multi-upload/images-added/'+this._gridID,'multi-upload/images-added'],{fbids:wa,tagInfo:{exifLocation:xa}});g.inform('composer/updateViewerLocationEstimate',xa);};ta.prototype._generateLoadingIndicatorForPhoto=function(wa){"use strict";this._generateLoadingIndicator(wa.uploadID);};ta.prototype._generateLoadingIndicator=function(wa){"use strict";this._numRemainingFiles++;var xa=this._progressBarMarkup.cloneNode(true);s.listen(xa,'click',this._clickHandler.bind(this,wa));this.insertIntoGrid(xa);this._loadingIndicators[wa]=new ba(xa);};ta.prototype._generateUploadIDsAndLoadingIndicators=function(wa){"use strict";for(var xa=0;xa<wa.length;xa++){if(!wa[xa].uploadID)wa[xa].uploadID=w.getNewID();this._generateLoadingIndicator(wa[xa].uploadID);}};ta.prototype._clickHandler=function(wa,xa){"use strict";var ya=xa.target,za="_639";if(u.byClass(ya,za))if(this._failedUploadIDs[wa]){this.removeLoadingIndicator(wa);}else this.fileUploadCanceled(wa,this._uploadIDToFileUpload[wa]);var ab="_2zo7";if(u.byClass(ya,ab)){o.hide(q.find(this.getLoadingIndicator(wa).getRoot(),"._2zo5"));this._retryFileUpload(this._uploadIDToFileUpload[wa].getFile());this._failedUploadIDs[wa]=false;}var bb="_2zo8";if(u.byClass(ya,bb))this.removeLoadingIndicator(wa);};ta.prototype.fileUploadFailure=function(wa,xa,ya){"use strict";this._numUploadsFailed++;this._failedUploadIDs[wa]=true;var za=Date.now()-this._uploadTimers[wa],ab=0;if(xa.upload)ab=xa.upload.getRetryCount?xa.upload.getRetryCount():0;var bb=xa.response.getErrorDescription(),cb=xa.response.getError();if(cb===ma)bb=JSON.stringify(ya);this.logStep(aa.CLIENT_TRANSFER_FAIL,{dt:za,error_code:cb,error_info:bb,bytes:xa.upload.getFile().size,auto_retry_count:ab,custom_tags:{high_quality:this._isHighQuality,manual_retry:!!xa.upload.getFile().manuallyRetried}});if(this._config.useNewErrorUI){var db=xa.response.isTransient()||xa.response.getError()==1004||xa.response.getError()==1006,eb=db&&this._uploadIDToFileUpload[wa];this._showNewUploadFailedMessage(wa,xa.upload.getFile().name||xa.upload.getFile().filename||'',xa.response.getErrorSummary(),xa.response.getErrorDescription(),eb,xa.upload.getFile());this._markUploadAsFinished();}else{this._showUploadFailedMessage(wa);this._fadeOutFileUpload(wa);}};ta.prototype._fadeOutFileUpload=function(wa){"use strict";new h(this.getLoadingIndicator(wa).getRoot()).duration(2000).checkpoint().from('opacity',1).to('opacity',0).duration(1000).ondone(this.removeFileUpload.bind(this,wa)).go();};ta.prototype._showUploadFailedMessage=function(wa){"use strict";o.hide(q.find(this.getLoadingIndicator(wa).getRoot(),"._5l83"));o.show(q.find(this.getLoadingIndicator(wa).getRoot(),"._5l82"));};ta.prototype._showNewUploadFailedMessage=function(wa,xa,ya,za,ab,bb){"use strict";var cb=this.getLoadingIndicator(wa).getRoot();o.hide(q.find(cb,"._5l83"));o.show(q.find(cb,"._2zo5"));var db=q.find(cb,"._2zo6");q.setContent(db,xa);var eb=q.find(cb,"._2zo5");ca.set(eb,ya+': '+za);if(ab){var fb=q.find(cb,"._2zo7");o.show(fb);}else{var gb=q.find(cb,"._2zo8");o.show(gb);}};ta.prototype._finishUploadBatch=function(){"use strict";g.inform('multi-upload/images-upload-completed/'+this._gridID);if(this._numUploadsFailed>0){this.logStep(aa.CLIENT_TRANSFER_BATCH_FAIL,{volume:this._numUploadsFailed,batch_size:this._numUploadsSucceeded+this._numUploadsFailed});}else this.logStep(aa.CLIENT_TRANSFER_BATCH_SUCCESS,{volume:this._numUploadsSucceeded});this._numUploadsSucceeded=0;this._numUploadsFailed=0;};ta.prototype.fileUploadCanceled=function(wa,xa){"use strict";xa&&xa.abort();var ya={latency:Date.now()-this._uploadTimers[wa]};if(xa&&xa.getFile())ya.bytes=xa.getFile().size;this.logStep(aa.CLIENT_TRANSFER_CANCEL,ya);this.removeFileUpload(wa);};ta.prototype.removeFileUpload=function(wa){"use strict";this.removeLoadingIndicator(wa);this._markUploadAsFinished();};ta.prototype._markUploadAsFinished=function(){"use strict";this._numRemainingFiles=Math.max(0,this._numRemainingFiles-1);if(this._numRemainingFiles===0)this._finishUploadBatch();};ta.prototype.getVideoOrPhotoUploadCallback=function(wa,xa){"use strict";var ya=this;return function(za){if(za){var ab=u.byTag(fa(ya._gridID),'form'),bb=k.getComposerID(ab),cb=new n(bb);cb.handleVideoSelected(wa);}else if(xa){ya._photosSelected(wa);}else new p().setBody(ka._("Sorry, you can only select video files.")).setTitle(ka._("Unsupported File")).setModal(true).setButtons(p.OK).show();};};ta.prototype.doFileUpload=function(wa){"use strict";var xa=false,ya=false;switch(this._config.supportedFileTypes){case 'photos':ya=true;break;case 'videos':xa=true;break;case 'both':xa=ya=true;break;}this._submitListener&&this._submitListener.remove();var za=this.getVideoOrPhotoUploadCallback(wa,ya);if(xa){n.isVideoOrAnimatedGifAsync(wa,za);}else za(false);};ta.prototype.getConfig=function(){"use strict";return this._config;};ta.prototype._resizeUpload=function(wa,xa){"use strict";var ya=wa.getFile();if(!ya||!v(ya.type).isJpeg())return xa(wa);var za=ja();this.logStep(aa.CLIENT_PROCESS_BEGIN,{bytes:ya.size,custom_tags:{high_quality:this._isHighQuality}});this._resizer.resizeBlob(ya,function(ab,bb,cb){bb=bb||ya;if(ab){this.logStep(aa.CLIENT_PROCESS_FAIL,{dt:ja()-za,bytes:bb.size,error_code:ab.code,error_info:ab.message,custom_tags:{high_quality:this._isHighQuality}});return xa(wa);}bb.uploadID=ya.uploadID;bb.filename=ya.name;wa.setFile(bb);this.logStep(aa.CLIENT_PROCESS_SUCCESS,{dt:ja()-za,media_data_size:ya.size,bytes:bb.size,custom_tags:{high_quality:this._isHighQuality,skipped_resizing:cb}});xa(wa);}.bind(this),this._onResizeProgress.bind(this,ya.uploadID));};ta.prototype._onResizeStart=function(wa){"use strict";this.logStep(aa.CLIENT_PROCESS_BEGIN,{bytes:wa.size,custom_tags:{high_quality:this._isHighQuality}});};ta.prototype._onResizeFail=function(wa,xa,ya,za){"use strict";this.logStep(aa.CLIENT_PROCESS_FAIL,{dt:za,bytes:xa.size,error_code:ya.code,error_info:ya.message,custom_tags:{high_quality:this._isHighQuality}});};ta.prototype._onResizeSuccess=function(wa,xa,ya,za){"use strict";this.logStep(aa.CLIENT_PROCESS_SUCCESS,{dt:za,media_data_size:wa.size,bytes:xa.size,custom_tags:{high_quality:this._isHighQuality,skipped_resizing:ya}});};ta.prototype._isExceedMaxSelect=function(wa){"use strict";return this._config.maxselect>1&&wa>this._config.maxselect;};ta.prototype._showTooManyPhotosDialog=function(){"use strict";new p().setTitle(ka._("Too Many Photos")).setBody(ka._({"*":"Sorry, you can only add {maxselect} photos to a message. If you'd like, you can add photos to additional messages."},[ka.param("maxselect",this._config.maxselect,[0])])).setButtons(p.OK).setModal(true).show();};ta.prototype._photosSelected=function(wa){"use strict";var xa=wa.getInput(),ya=ua(xa);if(this._isExceedMaxSelect(ya)){this._showTooManyPhotosDialog();return;}this._onBeforeAddUploadedImages();this._upload(wa,ya);};ta.prototype._upload=function(wa,xa){"use strict";var ya=wa.getInput(),za=this._config.uploadData;if(this._config.waterfallID)za.qn=this._config.waterfallID;var ab=function(){g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:xa});}.bind(this),bb=new ea({uploadEndpoint:this._config.photoEndpoint,uploadData:za,retryLimit:this._config.retryLimit,concurrentLimit:this._config.concurrentLimit,resizer:this._resizer,onUploadEnqueued:this._generateLoadingIndicatorForPhoto.bind(this),onUploadsEnqueued:ab,onUploadSent:function(){return wa.clear();},onResizeStart:this._onResizeStart.bind(this),onResizeProgress:this._onResizeProgress.bind(this),onResizeSuccess:this._onResizeSuccess.bind(this),onResizeFailure:this._onResizeFail.bind(this),onUploadStart:this._onFileUploadStart.bind(this),onUploadProgress:this._onUploadProgress.bind(this),onUploadSuccess:this._onFileUploadSuccess.bind(this),onUploadFailure:this.fileUploadFailure.bind(this)});bb.upload(ya);this.logStep(aa.CLIENT_SELECT_SUCCESS,{times_selected:pa++,volume:xa,method:'file_selector'});};ta.prototype._onVideoRemoved=function(){"use strict";this._dragDropTarget&&this._dragDropTarget.enable();g.inform('multi-upload/video-removed/'+this._gridID);};ta.prototype.removeLoadingIndicator=function(wa){"use strict";var xa=this.getLoadingIndicator(wa);xa&&q.remove(xa.getRoot());delete this._loadingIndicators[wa];};ta.prototype._onFileUploadStart=function(wa,xa){"use strict";this._uploadIDToFileUpload[wa]=xa.upload;var ya=q.find(this.getLoadingIndicator(wa).getRoot(),"._639");o.show(ya);this._uploadTimers[wa]=Date.now();var za={custom_tags:{high_quality:this._isHighQuality}};if(xa.upload&&xa.upload.getFile())za.size=xa.upload.getFile().size;this.logStep(aa.CLIENT_TRANSFER_BEGIN,za);this._logComposerWaterfallEvent(j.PHOTO_ADD);};ta.prototype._onUploadProgress=function(wa,xa){"use strict";var ya=this.getLoadingIndicator(wa);if(!ya||this._failedUploadIDs[wa])return;this._showProgressBar(ya);o.removeClass(ya.getRoot(),"_5v_0");la(ya,xa.event);};ta.prototype._onResizeProgress=function(wa,event){"use strict";var xa=this.getLoadingIndicator(wa);if(!xa)return;this._showProgressBar(xa);o.addClass(xa.getRoot(),"_5v_0");xa.setPosition(100*event.written/event.total);};ta.prototype._showProgressBar=function(wa){"use strict";o.hide(q.find(wa.getRoot(),"._2om"));o.show(q.find(wa.getRoot(),"._5e4h"));};ta.prototype._onFileUploadSuccess=function(wa,xa){"use strict";var ya=Date.now()-this._uploadTimers[wa],za={dt:ya};if(xa.upload){za.bytes=xa.upload.getFile().size;za.auto_retry_count=xa.upload.getRetryCount?xa.upload.getRetryCount():0;za.custom_tags={high_quality:this._isHighQuality,manual_retry:!!xa.upload.getFile().manuallyRetried};}this.logStep(aa.CLIENT_TRANSFER_SUCCESS,za);this._logComposerWaterfallEvent(j.PHOTO_ADD_SUCCESS);};ta.prototype._logComposerWaterfallEvent=function(event){"use strict";if(!u.byClass(fa(this._gridID),"_119"))return;m.logEvent(event,this._getComposerID());};ta.prototype._getComposerID=function(){"use strict";return k.getComposerID(this._gridID);};ta.prototype._getAsyncUploadRequest=function(wa){"use strict";var xa=new ea({uploadEndpoint:this._config.photoEndpoint,uploadData:this._config.uploadData,concurrentLimit:this._config.concurrentLimit,onUploadStart:this._onFileUploadStart.bind(this),onUploadProgress:this._onUploadProgress.bind(this),onUploadSuccess:this._onFileUploadSuccess.bind(this),onUploadFail:this.fileUploadFailure.bind(this)});return xa.getAsyncUploadRequest(wa);};ta.prototype._onEditedImage=function(wa,xa){"use strict";this._onBeforeAddUploadedImages();this.logStep(aa.CLIENT_SELECT_BEGIN);this._generateUploadIDsAndLoadingIndicators([xa.blob]);var ya=this._getGridItemElementByFBID(xa.fbid);if(ya){var za=this._loadingIndicators[xa.blob.uploadID].getRoot();q.insertBefore(ya,za);}g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:1,method:z.EDITOR});var ab=this._getAsyncUploadRequest([xa.blob]);ab.setData(Object.assign({},this._config.uploadData,{original_fbid:xa.fbid,xy_tags:xa.xyTags,stickers:xa.stickers,text_overlays:xa.textOverlays,has_crop:xa.hasCrop,has_filter:xa.hasFilter}));ab.send();this.logStep(aa.CLIENT_SELECT_SUCCESS,{volume:1,method:z.EDITOR});this.logStep(aa.CLIENT_PHOTO_EDIT_SUCCESS);};ta.prototype._getGridItemElementByFBID=function(wa){"use strict";var xa=q.scry(fa(this._gridID),".fbVaultGridItem");for(var ya=0;ya<xa.length;ya++)if(xa[ya].dataset.originalfbid==wa)return xa[ya];return null;};ta.prototype.onFilesDrop=function(wa,xa){"use strict";if(this._isExceedMaxSelect(wa.length)){this._showTooManyPhotosDialog();return;}this._onBeforeAddUploadedImages();this.logStep(aa.CLIENT_SELECT_BEGIN);this._generateUploadIDsAndLoadingIndicators(wa);g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:wa.length,method:xa||z.DRAGDROP});var ya=this._getAsyncUploadRequest(wa);if(this._resizer)ya.setPreprocessHandler(this._resizeUpload.bind(this));ya.send();this.logStep(aa.CLIENT_SELECT_SUCCESS,{volume:wa.length,method:xa||z.DRAGDROP});};ta.prototype._retryFileUpload=function(wa){"use strict";this._numRemainingFiles++;g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:1});this.logStep(aa.CLIENT_TRANSFER_MANUAL_RETRY);wa.manuallyRetried=true;var xa=this._getAsyncUploadRequest([wa]);xa.send();};ta.prototype._onBeforeAddUploadedImages=function(){"use strict";if(!this.sessionStarted)this.logStep(aa.CLIENT_FLOW_BEGIN);if(this._config.maxselect==1)g.inform('multi-upload/composer-reset/'+this._gridID);this.sessionStarted=true;};ta.prototype.clearSession=function(){"use strict";this.sessionStarted=false;};ta.prototype.insertIntoGrid=function(wa){"use strict";var xa=q.scry(fa(this._gridID),"._577")[0];if(xa){q.insertBefore(xa,wa);}else q.prependContent(fa(this._gridID),wa);};ta.prototype._getUploadID=function(wa,xa){"use strict";if(wa.upload){return wa.upload.getFile().uploadID;}else return xa.uploadID;};ta.getInstance=function(wa){"use strict";oa[wa]=oa[wa]||new ta(wa);return oa[wa];};function ua(wa){if(!va(wa))return 1;return wa.files.length;}function va(wa){return !!wa.files&&i.isSupported();}e.exports=na;},null);
__d("TimelineMapScrollableArea",["Animation","ArbiterMixin","CSS","DOM","Event","Run","Scroll","SimpleDrag","Style","Vector","$","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(t,u){t&&this.init(q(t),u);}Object.assign(s.prototype,h,{init:function(t,u){u=u||{};this._elem=t;this._wrap=j.find(t,'div.fbScrollableAreaWrap');this._body=j.find(this._wrap,'div.fbScrollableAreaBody');this._track=j.find(t,'div.fbScrollableAreaTrack');this._gripper=j.find(this._track,'div.fbScrollableAreaGripper');this._options=u;this.adjustGripper();this._listeners=[k.listen(this._wrap,'scroll',this._handleScroll.bind(this))];if(u.fade!==false)this._listeners.push(k.listen(t,'mouseenter',r(this.adjustGripper,this)),k.listen(t,'mouseenter',r(this.showScrollbar,this)),k.listen(t,'mousemove',this._handleMousemove.bind(this)),k.listen(t,'mouseout',r(this.hideScrollbar,this)));if(u.fade!==(void 0))this._listeners.push(k.listen(this._track,'click',this.clickToScroll.bind(this)));if(u.verticalscroll)this._listeners.push(k.listen(this._wrap,'mousewheel',this.mouseWheel.bind(this)),k.listen(this._wrap,'DOMMouseScroll',this.mouseWheel.bind(this)));this.initDrag();if(!u.persistent)l.onLeave(this.destroy.bind(this));},getRoot:function(){return this._elem;},initDrag:function(){var t=new n(this._gripper);t.subscribe('start',function(u,event){if(!((event.which&&event.which===1)||(event.button&&event.button===1)))return;this.inform('dragstart');var v=p.getEventPosition(event).x,w=this._gripper.offsetLeft,x=t.subscribe('update',function(z,aa){var ba=p.getEventPosition(aa).x-v,ca=this._elem.clientWidth,da=this._body.offsetWidth,ea=this._track.offsetWidth,fa=ca/da*ea,ga=da-this._wrap.offsetWidth,ha=w+ba,ia=ea-fa;ha=Math.max(Math.min(ha,ia),0);var ja=ha/ia*ga;m.setLeft(this._wrap,ja);}.bind(this)),y=t.subscribe('end',function(){t.unsubscribe(x);t.unsubscribe(y);this.inform('dragend');}.bind(this));}.bind(this));},adjustGripper:function(){var t=this._elem.clientWidth,u=this._body.offsetWidth,v=this._track.offsetWidth,w=t/u*v;if(w<v){o.set(this._gripper,'width',w+'px');var x=m.getLeft(this._wrap)/u*v;o.set(this._gripper,'left',x+'px');i.show(this._gripper);}else i.hide(this._gripper);this._checkContentBoundaries();return this;},_checkContentBoundaries:function(){var t=m.getLeft(this._wrap),u=this._wrap.scrollWidth-this._wrap.clientWidth;i.conditionClass(this._elem,'contentBefore',t>0);i.conditionClass(this._elem,'contentAfter',t<u);},destroy:function(){this._listeners.forEach(function(t){t.remove();});this._listeners.length=0;},_handleMousemove:function(event){var t=p.getElementPosition(this._track).y,u=p.getElementDimensions(this._track).y;if(Math.abs(t+u/2-p.getEventPosition(event).y)<25){this.showScrollbar(false);}else this.hideScrollbar();},_handleScroll:function(event){this.adjustGripper();if(this._options.fade!==false)this.showScrollbar();},hideScrollbar:function(){if(!this._scrollbarVisible)return this;this._scrollbarVisible=false;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}this._hideTimeout=setTimeout(function(){if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this._scrollbarAnimation=new g(this._track).from('opacity',1).to('opacity',0).duration(250).ondone(i.addClass.bind(null,this._track,'invisible_elem')).go();}.bind(this),750);return this;},showScrollbar:function(t){if(this._scrollbarVisible)return this;this._scrollbarVisible=true;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this.adjustGripper();o.set(this._track,'opacity',1);i.removeClass(this._track,'invisible_elem');if(t!==false)this.hideScrollbar();return this;},clickToScroll:function(event){var t=p.getEventPosition(event).x,u=this._elem.clientWidth,v=this._body.offsetWidth,w=this._track.offsetWidth,x=u/v*w,y=p.getElementPosition(this._gripper);if(t>=y.x&&t<=y.x+x)return;var z=t<y.x?-1:1,aa=this._wrap.offsetWidth*.8*z;this.scrollBy(aa);},scrollBy:function(t){this.setScroll(m.getLeft(this._wrap)+t);},getMaxBodyOffset:function(){return this._body.offsetWidth-this._wrap.offsetWidth;},setScroll:function(t){var u=t;u=Math.max(Math.min(u,this.getMaxBodyOffset()),0);m.setLeft(this._wrap,u);},scrollIntoView:function(t){var u=this._wrap.clientWidth,v=t.offsetWidth,w=m.getLeft(this._wrap),x=w+u,y=t.offsetLeft,z=y+v;if(y<w||u<v){this.setScroll(y);}else if(z>x)this.setScroll(w+(z-x));},mouseWheel:function(event){if(this.getMaxBodyOffset()<=0)return;var t=0;if(event.wheelDelta){var u=event.wheelDelta;if(event.wheelDeltaX&&event.wheelDeltaY)u=Math.abs(event.wheelDeltaX)>Math.abs(event.wheelDeltaY)?event.wheelDeltaX:event.wheelDeltaY;t=-u*10/40;}else if(event.detail)t=event.detail*10;this.scrollBy(t);event.prevent();}});e.exports=a.TimelineMapScrollableArea||s;},null);
__d("WebMessengerStateConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={STATE_CHANGE_EVENT:'state-changed',DETAIL:{COMPOSE_MAIN:'compose-main',COMPOSE_TYPEAHEAD_RESULTS:'compose-typeahead-results',COMPOSE_ALL_PEOPLE_RESULTS:'compose-all-people-results',RECENT_MESSAGES:'recent-messages',SEARCH_CONTEXT:'search-context',SEARCH_SNIPPET:'search-snippet',SEARCH_THREAD_SNIPPET:'search-thread-snippet',SHARED_PHOTOS:'shared-photos'},MASTER:{RECENT_THREADS:'recent-threads',SEARCH:'search'},MESSAGE_ACTION:{DELETE:'delete'}};e.exports=g;},null);
__d("MessagingConst",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={APP_ID:313785040330,XD_MESSAGE:{SANDBOX_READY:'sandbox_ready',SET_CONTENT:'set_content',HTML_SIZE:'html_size',REFRESH_SIZE:'refresh_size'},SHINGLE_SCROLL_TRIGGER:5,EVENTS:{MESSAGE_SENT:'messaging/message_sent'},initConstants:function(h){Object.assign(g,h);}};e.exports=g;},null);
__d("UntrustedLink",["DOM","Event","URI","UserAgent_DEPRECATED"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l,m,n,o){this.dom=l;this.url=l.href;this.hash=m;this.func_get_params=o||function(){return {};};h.listen(this.dom,'click',this.onclick.bind(this));h.listen(this.dom,'mousedown',this.onmousedown.bind(this));h.listen(this.dom,'mouseup',this.onmouseup.bind(this));h.listen(this.dom,'mouseout',this.onmouseout.bind(this));this.onmousedown(h.$E(n));}k.bootstrap=function(l,m,n,o){if(l.__untrusted)return;l.__untrusted=true;new k(l,m,n,o);};k.prototype.getRewrittenURI=function(){var l=Object.assign({u:this.url,h:this.hash},this.func_get_params(this.dom)),m=new i('/l.php').setSubdomain('www');if(new i(this.url).getProtocol()=='https'){return m.setQueryData(l).setProtocol('https');}else return m.setQueryData(l).setProtocol('http');};k.prototype.onclick=function(){setTimeout((function(){this.setHref(this.url);}).bind(this),100);this.setHref(this.getRewrittenURI());};k.prototype.onmousedown=function(l){if(l.button==2)this.setHref(this.getRewrittenURI());};k.prototype.onmouseup=function(){this.setHref(this.getRewrittenURI());};k.prototype.onmouseout=function(){this.setHref(this.url);};k.prototype.setHref=function(l){if(j.ie()<9){var m=g.create('span');g.appendContent(this.dom,m);this.dom.href=l;g.remove(m);}else this.dom.href=l;};e.exports=k;},null);
__d("WebMessengerDetailViewRecentMessagesControl",["Event","Animation","CSS","WebMessengerDetailViewUnreadMessagesNotice","DOM","Arbiter","MercuryLastMessageIndicator.react","MercuryListUpdateRenderer","MercuryAPIArgsSource","MercuryConfig","MercuryThreadlistConstants","MercuryViewer","MercuryMessageGroup","WebMessengerMessagesSelection","MessagingTag","MessengerContextBannerBootloader","React","ReactComponentRenderer","MercuryShareAttachmentRenderLocations","WebMessengerStateConstants","WebMessengerStateManager","Style","WebMessengerTemplates","WebMessengerThreadMessagesRenderer","UserActivity","WebMessengerConstants","WebMessengerInfoBoxRenderer","WebMessengerMessageIDFinder","WebMessengerSubscriptionsHandler","cx","debounce","formatDate","ge","fbt","MercuryMessages","MercuryThreadInformer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){b.__markCompiled&&b.__markCompiled();var oa=b('MercuryMessages').get(),pa=b('MercuryThreadInformer').get(),qa=b('MercuryThreadActions').get(),ra=b('MercuryThreads').get();function sa(lb,mb,nb,ob,pb,qb,rb,sb){"use strict";this._manager=lb;this._rootElement=mb;this._loadingSpinner=nb;this._noSelectedConversation=ob;this._newMessageLink=pb;this._showUnreadLink=qb;this.contextBanner=rb;k.empty(this._rootElement);this._pagerExponent=-1;var tb=ca[':fb:web-messenger:read-view:recent-messages'].build();k.setContent(this._rootElement,tb.getRoot());this._selectedConversationView=tb.getRoot();this._messageList=tb.getNode('messagelist');this._loadMoreButton=tb.getNode('loadMoreButton');this._loadMoreLink=tb.getNode('loadMoreLink');this._loadMoreCount=tb.getNode('loadMoreCount');this._loadingMoreCount=tb.getNode('loadingMoreCount');this._indicatorNode=tb.getNode('lastMessageIndicator');this._unseenMessagesNotice=new j(this._manager);this._unseenMessagesNotice.setNoticeContextNode(sb);this._active=false;this._state=null;this._threadID=null;this._bugReportingEnabled=false;this._currentCountMap={};this._olderMessageID={};this._loadMessagesInFlight={};da.setupSelectionListener(this._messageList);this._manager.addScrollCallback(ka(kb.bind(null,this),500));ia.addSubscriptions(g.listen(this._loadMoreLink,'click',cb.bind(null,this)),pa.subscribe('messages-reordered',function(ub,vb){var wb=this._threadID&&vb[this._threadID];if(wb)ya(this);}.bind(this)),pa.subscribe('messages-updated',function(ub,vb){var wb=this._threadID&&vb[this._threadID];if(wb)var xb=Object.keys(wb),yb=xb.length&&wb[xb[0]];if(wb&&yb)ya(this,vb[this._threadID]);}.bind(this)),pa.subscribe('messages-updated',kb.bind(null,this)),pa.subscribe('messages-received',function(ub,vb){if(this._threadID&&vb[this._threadID])bb(this,vb);}.bind(this)),pa.subscribe('thread-read-changed',function(ub,vb){if(vb[this._threadID])hb(this,vb[this._threadID]);}.bind(this)),this._manager.subscribe('scrolledNearTop',function(){this._active&&cb(this);}.bind(this)));}sa.prototype.hideView=function(){"use strict";this._active=false;i.hide(this._rootElement);i.hide(this._loadingSpinner);i.hide(this._noSelectedConversation);i.hide(this.contextBanner);this._unseenMessagesNotice.hideView();this._manager._flexArea.setBottomAligned(false);};sa.prototype.updateView=function(){"use strict";this._unseenMessagesNotice.updateView();this._active=true;this._manager._flexArea.setBottomAligned(true);i.show(this._rootElement);if(this.contextBanner)i.show(this.contextBanner);var lb=ua(this);va(this);t.clear();if(lb){wa(this);}else fb(this);};sa.prototype.renderContextBanner=function(lb,mb){"use strict";if(this.contextBanner&&!this.contextBannerElem)v.bootload(lb,y.WEB_INBOX,function(nb){this.contextBannerElem=nb;ba.set(this._rootElement,'padding-top','80px');k.prependContent(this.contextBanner,this.contextBannerElem);i.show(this.contextBanner);}.bind(this),mb);};sa.prototype.unmountContextBanner=function(){"use strict";if(this.contextBannerElem){w.unmountComponentAtNode(this.contextBannerElem);this.contextBannerElem=null;k.empty(this.contextBanner);}};sa.prototype.destroy=function(){"use strict";ta(this);this._unseenMessagesNotice.destroy();w.unmountComponentAtNode(this._indicatorNode);this.unmountContextBanner();};function ta(lb){lb._messagesSubscription&&oa.unsubscribe(lb._messagesSubscription.subscriber_id,lb._messagesSubscription.thread_id);lb._messagesSubscription=null;}function ua(lb){var mb=aa.getCurrentStateData();if(!lb._threadID||lb._threadID!=mb.thread_id)return true;return false;}function va(lb){var mb=aa.getCurrentStateData();lb._state=aa.getCurrentDetailState();lb._threadID=mb.thread_id;lb._selectionEnabled=!!mb.message_action;lb._bugReportingEnabled=mb.bug_reporting_enabled;da.updateSelection(lb._messageList);i.conditionClass(lb._messageList,'bugReportingEnabled',lb._bugReportingEnabled);}function wa(lb){k.scry(lb._rootElement,'.stickerContainer').forEach(function(mb){return w.unmountComponentAtNode(mb);});k.empty(lb._messageList);lb.unmountContextBanner();i.show(lb._loadingSpinner);i.hide(lb._loadMoreButton);ta(lb);lb._pagerExponent=-1;w.unmountComponentAtNode(lb._indicatorNode);if(lb._lastMessageIndicator){lb._lastMessageIndicator.unmount();delete lb._lastMessageIndicator;}if(lb._threadID){i.show(lb._selectedConversationView);i.hide(lb._noSelectedConversation);lb._manager._flexArea.showAtTop(false);if(!lb._olderMessageID[lb._threadID]){xa(lb);}else ya(lb);lb._manager.scrollToBottom(false);}else{jb(lb);i.hide(lb._selectedConversationView);i.show(lb._noSelectedConversation);i.hide(lb._loadingSpinner);lb._manager._flexArea.showAtTop(true);}}function xa(lb){lb._loadMessagesInFlight[lb._threadID]=true;lb._currentCountMap[lb._threadID]=fa.INITIAL_MESSAGES_LIMIT;i.hide(lb._loadMoreButton);var mb=oa.getThreadMessagesRange(lb._threadID,0,lb._currentCountMap[lb._threadID],za.bind(null,lb),null,o.WEBMESSENGER);if(mb){lb._messagesSubscription={subscriber_id:mb,thread_id:lb._threadID};}else ya(lb);}function ya(lb,mb){if(!lb._threadID||!lb._olderMessageID[lb._threadID])return;var nb=oa.getThreadMessagesSinceTimestamp(lb._threadID,ib(lb._olderMessageID[lb._threadID]));if(nb.length>lb._currentCountMap[lb._threadID])lb._currentCountMap[lb._threadID]=nb.length;ab(lb,nb,mb);}function za(lb,mb){lb._loadMessagesInFlight[lb._threadID]=false;if(mb&&mb.length){var nb=mb[0].timestamp,ob=lb._olderMessageID[lb._threadID]?ib(lb._olderMessageID[lb._threadID]):null;if(!ob||nb<ob)lb._olderMessageID[lb._threadID]=mb[0].message_id;}}function ab(lb,mb,nb){i.hide(lb._loadingSpinner);i.conditionShow(lb._loadMoreButton,!oa.hasLoadedAllMessages(lb._threadID));var ob=ra.getThreadMetaNow(lb._threadID);if(ob){var pb=ob.message_count-mb.length;pb=(pb<0)?0:pb;k.setContent(lb._loadMoreCount,pb);k.setContent(lb._loadingMoreCount,pb);}if(ob&&ob.is_canonical&&p.ShowContextBanner&&oa.hasLoadedAllMessages(lb._threadID))lb.renderContextBanner(lb._threadID);var qb=function(yb){var zb,ac=ma('wm:'+yb);if(ac)zb=ha.findAll(ac);return zb||[];},rb=[],sb=s.calculateMessageGroups(mb),tb={},ub=[];sb.forEach(function(yb){var zb=yb[0].message_id,ac=false;if(nb){ac=yb.some(function(cc){return cc.message_id in nb;});if(!ac){rb=qb(zb);ac=rb.some(function(cc){return cc in nb;});}}if(!ac){rb=qb(zb);if(yb.length==rb.length){for(var bc=0;bc<yb.length;bc++)if(yb[bc].message_id!=rb[bc]){ac=true;break;}}else ac=true;}if(ac)tb[zb]=1;ub.push('wm:'+zb);});var vb=function(yb){return !tb[sb[yb][0].message_id];},wb=function(yb){var zb=sb[yb],ac=da.renderMessageGroup(zb);if(yb==ub.length-1)lb._messageGroup=ac;return ac.getRoot();},xb=function(yb){return da.renderMessageSeparatorForIndex(sb,yb);};n.updateList(lb._messageList,ub,vb,wb,xb);lb._lastMessage=mb[mb.length-1];eb(lb);fb(lb);lb._manager.poke();}function bb(lb,mb){var nb=mb[lb._threadID],ob=lb._manager._flexArea.getScrollableArea(),pb=ob.getScrollHeight();nb.forEach(function(sb){sb.timestamp_relative=la(new Date(sb.timestamp),'g:ia');var tb=s.canAppendMessageToLastGroup(lb._lastMessage,sb);if(!tb){lb._messageGroup=da.renderMessageGroup([sb]);var ub=sb.timestamp,vb=lb._lastMessage?lb._lastMessage.timestamp:0,wb=fa.READ_VIEW_SEPARATOR_TIME_LIMIT;if(!vb||ub-vb>=wb){var xb=da.renderMessageSeparator(sb);k.appendContent(lb._messageList,xb);}k.appendContent(lb._messageList,lb._messageGroup.getRoot());}else da.appendMessageToGroup(lb._messageGroup,sb);if(sb.author!=r.getID())i.addClass(lb._messageGroup.getRoot(),'unreadHighlight');lb._lastMessage=sb;});lb._manager._flexArea.poke();var qb=ob.getScrollHeight(),rb=ob.getScrollTop();lb._unseenMessagesNotice.updateOnMessagesReceived(pb,qb,rb,mb);eb(lb);if(lb._manager.isScrolledToBottom())fb(lb);}function cb(lb){i.addClass(lb._loadMoreButton,'async_saving');if(lb._loadMessagesInFlight[lb._threadID])return;lb._loadMessagesInFlight[lb._threadID]=true;lb._pagerExponent=Math.min(lb._pagerExponent+1,fa.EXPONENTIAL_PAGER_MAX_CYCLES);var mb=Math.pow(2,lb._pagerExponent),nb=lb._currentCountMap[lb._threadID]+(mb*q.WEBMESSENGER_MORE_MESSAGES_COUNT);ta(lb);var ob=oa.getThreadMessagesRange(lb._threadID,0,nb,function(pb){i.removeClass(lb._loadMoreButton,'async_saving');lb._currentCountMap[lb._threadID]=nb;za(lb,pb);lb._loadMessagesInFlight[lb._threadID]=false;},null,o.WEBMESSENGER);if(ob){lb._messagesSubscription={subscriber_id:ob,thread_id:lb._threadID};}else ya(lb);}function db(lb){if(!lb._lastMessageIndicator){var mb;lb._lastMessageIndicator=new x(m,lb._indicatorNode);lb._lastMessageIndicator.setProps({threadID:lb._threadID,className:"_510o",indicatorWillShow:function(){return mb=lb._manager.isScrolledToBottom();},indicatorDidShow:function(){return mb&&lb._manager.scrollToBottom(true);}});}return lb._lastMessageIndicator;}function eb(lb,mb){db(lb).setProps({lastMessage:lb._lastMessage});}function fb(lb){if(ea.isActive(5000)){gb(lb);}else ea.subscribeOnce(gb.bind(null,lb));}function gb(lb){if(!lb._threadID||!lb._active)return;qa.markRead(lb._threadID);var mb=k.scry(lb._messageList,'.unreadHighlight');mb.forEach(function(nb){i.removeClass(nb,'unreadHighlight');i.addClass(nb,'unreadFading');new h(nb).from('background','#eceff5').to('background','#fff').from('borderColor','#d6d6d6').to('borderColor','#fff').ease(h.ease.both).duration(1500).ondone(function(){i.removeClass(nb,'unreadFading');ba.set(nb,'background','');ba.set(nb,'borderColor','');}).go();});}function hb(lb,mb){if(!mb.mark_as_read)return;var nb=k.scry(lb._messageList,'.unreadHighlight');for(var ob=0;ob<nb.length;ob++){var pb=nb[ob],qb=ha.findAll(pb),rb=oa.getMessagesFromIDs(qb);if(rb[rb.length-1].timestamp<mb.timestamp)i.removeClass(pb,'unreadHighlight');}}function ib(lb){var mb=oa.getMessagesFromIDs([lb])[0];return mb?mb.timestamp:0;}function jb(lb){if(lb._builtNoSelectionBox)return;var mb=function(){var ob=aa.getCurrentStateData(),pb=Object.assign({},ob);aa.updateDetailState(z.DETAIL.COMPOSE_MAIN,Object.assign(pb,{start:true,thread_id:(void 0)}));},nb=function(){var ob=aa.getCurrentStateData(),pb=Object.assign({},ob);aa.updateMasterState(z.MASTER.RECENT_THREADS,Object.assign(pb,{folder:u.INBOX,filter:u.UNREAD}));};k.setContent(lb._noSelectedConversation,ga.render(na._("No Conversation Selected"),[{text:na._("New Message"),handler:mb},{text:na._("Show Unread"),handler:nb}]));lb._builtNoSelectionBox=true;}function kb(lb){var mb=lb._manager._flexArea.getScrollableArea(),nb=lb._manager.getFlexAreaBoundingClientRect();l.inform('messengerScrolled/'+lb._threadID,{scrollTop:mb.getScrollTop(),top:nb.y,viewHeight:nb.height});}e.exports=sa;},null);
__d("MercuryDataSources",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={},h={add:function(i,j){g[i]=j;},get:function(i){!g[i];return g[i];}};e.exports=h;},null);
__d("WebMessengerAddPeopleToConversationDialog",["ContextualTypeaheadView","Dialog","DOM","MercuryAPIArgsSource","MercuryDataSources","MercuryIDs","MercuryLogMessageType","MercurySourceType","MercuryTypeahead","MercuryTypeaheadConstants","MercuryTypeaheadRenderer","WebMessengerTemplates","WorkModeConfig","fbt","MercuryMessageObject","MercuryMessageActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=b('MercuryMessageObject').get(),v=b('MercuryMessageActions').get(),w=b('MercuryThreads').get(),x={show:function(z){var aa=t._("Add People"),ba={};ba[p.FRIEND_TYPE]={uid:p.FRIEND_TYPE,type:p.HEADER_TYPE,disabled:true};ba[p.NON_FRIEND_TYPE]={uid:p.NON_FRIEND_TYPE,text:t._("Other People"),type:p.HEADER_TYPE};var ca=new o(k.get('MercuryRecipientsDataSource'),g);ca.setViewOption('renderer',q);ca.setViewOption('typeObjects',ba);var da=s.is_work_user?t._("Add co-workers to this chat"):t._("Add friends to this chat");ca.setPlaceholder(da);var ea=[];ea.push({name:'subscribe',label:aa,handler:y.bind(null,z,ca)});ea.push(h.CANCEL);var fa=r[':fb:web-messenger:add-people-dialog'].build(),ga=new h().setTitle(aa).setBody(fa.getRoot()).setButtons(ea).showLoading();w.getThreadMeta(z,function(ha){ca.setFullWidthView(fa.getNode('participantsTypeahead'));ca.setExcludedParticipantsFromThreadMeta(ha);ca.build();i.appendContent(fa.getNode('participantsTypeahead'),ca.getElement());ga.show();ca.focus();},j.WEBMESSENGER);}};function y(z,aa){var ba=aa.getTokens(),ca=ba.map(function(da){return l.getParticipantIDFromUserID(da.getValue());});if(!ca.length)return false;v.send(u.constructLogMessageObject(n.TITAN_WEB,z,m.SUBSCRIBE,{added_participants:ca}),null,j.WEBMESSENGER);return true;}e.exports=x;},null);
__d("WebMessengerEditFilteringSettingDialog",["AsyncDialog","AsyncRequest","MercuryConstants","DOM","csx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l='/ajax/mercury/edit_filtering_type.php',m='/ajax/mercury/change_filtering_type.php',n={show:function(){var o=function(q){var r=q.getRoot(),s=j.find(r,"._cq6").checked,t=j.find(r,"._cq7").checked,u='';if(s){u=i.MessagingFilteringType.MODERATE;}else if(t)u=i.MessagingFilteringType.STRICT;new h(m).setData({filtering_type:u}).send();q.hide();},p=function(q){q.subscribe('confirm',o.bind(null,q));q.show();};g.send(new h(l),p);}};e.exports=n;},null);
__d("WebMessengerMasterViewTabBarControl",["JSXDOM","Arbiter","CSS","DOM","Event","Ellipsizer","WebMessengerMenuFolderControl","MercuryConfig","MercuryFilters","MercuryFolders","MercuryThreadlistConstants","MessagingFilteringNux","MessagingTag","WebMessengerStateConstants","WebMessengerStateManager","WebMessengerTabbedFolderControl","WebMessengerTemplates","WebMessengerEditFilteringSettingDialog","WebMessengerEvents","WebMessengerSubscriptionsHandler","WebMessengerMercury","csx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();function da(ka,la,ma){"use strict";this._manager=ka;this._rootElement=la;this._rootTopContentElement=ma;this._threadInformer=aa.getThreadInformer();this._unreadState=aa.getUnreadState();j.empty(this._rootElement);var na=w[':fb:web-messenger:master-view:tab-bar'].build(),oa=w[':fb:web-messenger:master-view:top-content'].build();j.setContent(this._rootElement,na.getRoot());j.setContent(this._rootTopContentElement,oa.getRoot());this._tabList=na.getRoot();this._moreMenu=na.getNode('moreMenu');this._topContentCont=oa.getRoot();this._topContent=oa.getNode('masterViewTopContentHolder');this._closeButton=oa.getNode('masterViewTopContentCloseButton');this._closeButtonCont=oa.getNode('masterViewTopContentCloseCont');this._state=null;this._folder=null;this._filter=null;this._query=null;this._threadID=null;this._folders=p.getSupportedFolders();this._foldersToHeader={};this._filters=o.getSupportedFilters();this._filtersToHeader={};this._otherMarkAllRead=g.a({href:"#"},ca._("Mark All as Read"));this._unreadMarkAllRead=g.a({href:"#"},ca._("Mark All as Read"));this._otherEditSettings=g.a({href:"#"},ca._("Edit Preferences"));var pa=[];this._filters.forEach(function(sa){var ta=ia.bind(null,this,s.INBOX,sa);switch(sa){case s.UNREAD:this._filtersToHeader[sa]=this._filtersToHeader[sa]||new m(ca._("Unread"),this._moreMenu,ta);break;}}.bind(this));this._folders.forEach(function(sa){var ta=ia.bind(null,this,sa,o.ALL),ua=ia.bind(null,this,sa,s.UNREAD);switch(sa){case s.INBOX:var va=n.CoreGraphEnabled?ca._("Recent"):ca._("Inbox");this._foldersToHeader[sa]=this._foldersToHeader[sa]||new v(va,pa,ta,ua);break;case s.OTHER:if(n.CoreGraphEnabled){this._foldersToHeader[sa]=this._foldersToHeader[sa]||new m(ca._("Filtered"),this._moreMenu,ta);}else this._foldersToHeader[sa]=this._foldersToHeader[sa]||new v(ca._("Other"),pa,ta);break;case s.ACTION_ARCHIVED:this._foldersToHeader[sa]=this._foldersToHeader[sa]||new m(ca._("Archived"),this._moreMenu,ta);break;case s.SPAM:if(n.CoreGraphEnabled)break;this._foldersToHeader[sa]=this._foldersToHeader[sa]||new m(ca._("Spam"),this._moreMenu,ta);break;case s.PENDING:if(!n.CoreGraphEnabled)break;this._foldersToHeader[sa]=this._foldersToHeader[sa]||new v(ca._("Message Requests"),pa,ta);break;}}.bind(this));j.prependContent(this._tabList,pa);var qa=j.scry(this._tabList,"._6xt");qa.push(na.getNode('moreMenuLabel'));this._ellipsizer=new l(qa);ea(this);var ra=ia.bind(null,this,s.INBOX,o.ALL);h.subscribe(r.ACCEPTED_EVENT,ha.bind(null,this));z.addSubscriptions(this._threadInformer.subscribe('unread-updated',ja.bind(null,this)),k.listen(this._otherMarkAllRead,'click',function(){this._unreadState.markFolderAsRead(s.OTHER);}.bind(this)),k.listen(this._unreadMarkAllRead,'click',function(){this._unreadState.markFolderAsRead(s.INBOX);}.bind(this)),k.listen(this._otherEditSettings,'click',function(){x.show();}),k.listen(this._closeButton,'click',ra));}da.prototype.updateView=function(){"use strict";var ka=ga(this);fa(this);if(ka)ha(this);ea(this);};da.prototype.getOtherFolderLabel=function(){"use strict";var ka=s.OTHER,la=this._foldersToHeader[ka];if(!la||!la._template)return null;return la._template.getNode('folderLabel');};da.prototype.destroy=function(){"use strict";for(var ka in this._foldersToHeader)this._foldersToHeader[ka]&&this._foldersToHeader[ka].destroy();for(var la in this._filtersToHeader)this._filtersToHeader[la]&&this._filtersToHeader[la].destroy();};function ea(ka){var la=85;j.scry(ka._tabList,"._1r").forEach(function(ma){la+=ma.offsetWidth;});ka._ellipsizer.confineWithin(ka._rootElement.offsetWidth-la,1.3);}function fa(ka){var la=u.getCurrentStateData();ka._state=u.getCurrentMasterState();ka._folder=la.folder;ka._filter=la.filter;ka._query=la.query;}function ga(ka){if(!ka._state||!ka._folder)return true;var la=u.getCurrentStateData();if(ka._folder!=la.folder)return true;if(ka._filter!=la.filter)return true;return false;}function ha(ka){var la=false,ma;ka._folders.forEach(function(na){var oa=ka._filter==s.UNREAD,pa=na==ka._folder&&(ka._filter==o.ALL||oa),qa,ra;switch(na){case s.INBOX:if(oa){var sa=g.strong(null,ca._("Unread")),ta=g.strong(null,ca._("Inbox")),ua=ca._("{unread} messages in {inbox}",[ca.param("unread",sa),ca.param("inbox",ta)]);qa=g.div(null,ua,' \u00b7 ',ka._unreadMarkAllRead);ra=true;}break;case s.OTHER:if(n.CoreGraphEnabled)break;var va='';if(n.filtering_active)va=g.span(null,ka._otherEditSettings,' \u00b7 ');qa=g.div(null,g.p(null,g.strong(null,ca._("Tip:")+' '),ca._("See a message from someone you know? Just reply or click Move to Inbox from the Actions menu.")),va,ka._otherMarkAllRead);r.tryShow(ka.getOtherFolderLabel());break;}if(pa){ma=na;i.conditionShow(ka._closeButtonCont,ra);}else ka._foldersToHeader[na].setSelected(false);if(pa&&qa){la=true;j.setContent(ka._topContent,qa);}});ka._filters.forEach(function(na){var oa=ka._folder==s.INBOX&&na==ka._filter;ka._filtersToHeader[na].setSelected(oa);});ma&&ka._foldersToHeader[ma].setSelected(true);i.conditionShow(ka._topContentCont,la);ja(ka);ka._manager.draw();}function ia(ka,la,ma){var na=ka._state==t.MASTER.SEARCH;if(na||ka._folder!=la||ka._filter!=ma){var oa=Object.assign({},u.getCurrentStateData()),pa=u.getCurrentDetailState();if(pa!==t.DETAIL.SEARCH_SNIPPET&&pa!==t.DETAIL.SEARCH_CONTEXT)delete oa.query;u.updateMasterState(t.MASTER.RECENT_THREADS,Object.assign(oa,{folder:la,filter:ma}));}y.focusComposer();return false;}function ja(ka){for(var la in ka._foldersToHeader){if(la==s.ACTION_ARCHIVED)continue;var ma=ka._unreadState.exceedsMaxCount(la)?q.MAX_UNREAD_COUNT+'+':ka._unreadState.getUnreadCount(la),na=[ka._foldersToHeader[la].getCountBadge()];if(la==s.INBOX)ka._filters.forEach(function(oa){na.push(ka._filtersToHeader[oa].getCountBadge());});na.forEach(function(oa){if(ma)j.setContent(oa,ca._("({unread_count})",[ca.param("unread_count",ma)]));i.conditionShow(oa,ma);});}ea(ka);}e.exports=da;},null);
__d("WebMessengerTypeaheadDataSource",["MercuryExpandableDataSource","MercuryIDs","MercuryParticipants","MercuryTypeaheadConstants","WebMessengerStateManager"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();for(var l in g)if(g.hasOwnProperty(l))n[l]=g[l];var m=g===null?null:g.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=g;function n(q){"use strict";q=q||{};q.kanaNormalization=true;g.call(this,q,j.COMPOSER_THREADS_INITIAL_LIMIT,j.COMPOSER_SHOW_MORE_LIMIT);this.setMaxResults(j.COMPOSER_WM_MAX);}n.prototype.bootstrap=function(){"use strict";if(!m.bootstrap.call(this))this.fetchEntryBigProfilePic();};n.prototype.updateBootstrapData=function(){"use strict";m.updateBootstrapData.call(this);this.fetchEntryBigProfilePic();};n.prototype.buildData=function(q){"use strict";var r=[],s=[],t=[],u=[],v=[];q.forEach(function(x){var y=m.getEntry.call(this,x);switch(y.render_type){case j.FRIEND_TYPE:if(r.length<j.COMPOSER_FRIENDS_MAX)r.push(x);break;case j.THREAD_TYPE:var z=y.mercury_thread.thread_fbid;y.uid=z;m.setEntry.call(this,z,y);if(o().length===0)s.push(z);break;case j.NON_FRIEND_TYPE:if(t.length<j.COMPOSER_NON_FRIENDS_MAX)t.push(x);break;case j.FB4C_TYPE:if(u.length<j.COMPOSER_FB4C_MAX)u.push(x);break;case j.PAGE_TYPE:if(v.length<j.COMPOSER_PAGES_MAX&&o().length===0)v.push(x);break;}},this);var w=r.concat(u,s,v,t);return m.buildData.call(this,w);};n.prototype.query=function(q,r,s){"use strict";this.value=q;if(!m.query.call(this,q,r,s)){if(this.getState('loaded_all_threads_per_query')[q]==null)this.getState('loaded_all_threads_per_query')[q]=true;this.getState('loaded_initial_per_query')[q]=true;}this.logQuery({event:'query_web_messenger',query:q});};n.prototype.respond=function(q,r,s){"use strict";var t=m.respond.call(this,q,r,s);this.logResponse({event:'query_response_web_messenger',response_query:q,response_uids:r});return t;};n.prototype.getQueryData=function(q,r){"use strict";var s=m.getQueryData.call(this,q,r);s.existing_token_ids=o();return s;};n.prototype.fetchHandler=function(q,r){"use strict";this.getState('loaded_all_threads_per_query')[r.value]=q.getPayload().end_of_threads;this.getState('loaded_initial_per_query')[r.value]=true;m.fetchHandler.call(this,q,r);};n.prototype.hasLoadedInitialResults=function(q){"use strict";if(q===(void 0))q=this.value;return this.getState('loaded_initial_per_query')[q]||(q&&q.length<=1);};n.prototype.hasLoadedAllResults=function(q){"use strict";if(q===(void 0))q=this.value;return this.getState('loaded_all_threads_per_query')[q];};n.prototype.fetchEntryBigProfilePic=function(){"use strict";var q=this.getCachedShortProfileIDs().map(function(r){return h.getParticipantIDFromUserID(r);});i.getBigImageMulti(q,p.bind(this));};n.prototype.loadMore=function(){"use strict";this.setMaxResults(this.buildQueryResults(this.value).length+(j.COMPOSER_SHOW_MORE_LIMIT*2));m.loadMore.call(this);};function o(){var q=k.getCurrentStateData();return (q.participants||[]).map(function(r){return h.tokenize(r).value;});}function p(q){for(var r in q)if(q.hasOwnProperty(r)){var s=this.getEntry(h.getUserIDFromParticipantID(r));if(s)s.photo=q[r];}if(this.value)this.query(this.value);}e.exports=n;},null);
__d("MessagesEmoticons.react",["Grid.react","React","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=g.GridItem,m=h,n=m.PropTypes,o=8,p={smile:k._("smile"),frown:k._("frown"),tongue:k._("tongue"),grin:k._("grin"),gasp:k._("gasp"),wink:k._("wink"),pacman:k._("pacman"),grumpy:k._("grumpy"),unsure:k._("unsure"),cry:k._("cry"),kiki:k._("kiki"),glasses:k._("glasses"),sunglasses:k._("sunglasses"),heart:k._("heart"),devil:k._("devil"),angel:k._("angel"),squint:k._("squint"),confused:k._("confused"),upset:k._("upset"),colonthree:k._("colonthree"),like:k._("like")},q=h.createClass({displayName:"MessagesEmoticons",propTypes:{onEmoticonSelect:n.func},getDefaultProps:function(){return {onEmoticonSelect:j};},getEmoticons:function(){return Object.keys(p).map(function(r){return (h.createElement(l,{key:r},h.createElement("div",{className:"panelCell"},h.createElement("a",{"aria-label":p[r],className:'emoticon emoticon_'+r,onClick:function(){return this.props.onEmoticonSelect(r);}.bind(this)}))));}.bind(this));},render:function(){return (h.createElement("div",{className:"emoticonsTable"},h.createElement(g,{cols:o,alignv:"middle",alignh:"center",spacing:"pam"},this.getEmoticons())));}});e.exports=q;},null);
__d("MercurySearchThreadResults",["KeyedCallbackManager","MercuryAPIArgsSource","MercurySingletonMixin","MercuryThreadlistConstants","MercuryThreadIDMap","RangedCallbackManager","MercuryServerDispatcher","MercuryServerPayloadPreprocessor"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=new g(),p=j.WEBMESSENGER_THREAD_COUNT,q=j.WEBMESSENGER_MORE_COUNT;function r(s){"use strict";this.$MercurySearchThreadResults0=s;this.$MercurySearchThreadResults1=n.getForFBID(this.$MercurySearchThreadResults0);this.$MercurySearchThreadResults2=k.getForFBID(this.$MercurySearchThreadResults0);m.registerEndpoints({'/ajax/mercury/search_threads.php':{request_user_id:s,mode:m.IMMEDIATE,handler:function(t){this.handleUpdate(t);}.bind(this)}});}r.prototype.getThreadlist=function(s,t){"use strict";if(s){var u=o.executeOrEnqueue(s,function(x){var y=x.getAllResources(),z=x.hasReachedEndOfArray();t(y,z);}),v=o.getUnavailableResources(u),w=h.WEBMESSENGER;if(v.length)this.$MercurySearchThreadResults3({client:w,query:s,offset:0,limit:p+1});return u;}};r.prototype.isExhausted=function(s){"use strict";var t=o.getResource(s);return t?t.hasReachedEndOfArray():false;};r.prototype.getCachedThreadlist=function(s){"use strict";var t=o.getResource(s);return t?t.getAllResources():null;};r.prototype.cacheThreadlist=function(s,t){"use strict";o.getResource(s);var u=new l();u.addResourcesWithoutSorting(t,0);u.setReachedEndOfArray();o.setResource(s,u);};r.prototype.getMoreThreadlist=function(s,t){"use strict";if(s){var u=o.getResource(s);if(u){var v=u.getCurrentArraySize(),w=q,x=u.executeOrEnqueue(0,v+w,function(){var z=u.getAllResources(),aa=u.hasReachedEndOfArray();t(z,aa);}),y=u.getUnavailableResources(x);if(y.length)this.$MercurySearchThreadResults3({query:s,offset:v,limit:w+1});return x;}}};r.prototype.handleUpdate=function(s){"use strict";if(s.mercury_payload)this.$MercurySearchThreadResults1.handleUpdate(s.mercury_payload);var t=s.search_threads||{};for(var u in t){var v=t[u]||[],w=v.map(function(y){return this.$MercurySearchThreadResults2.getClientIDFromFBIDNow(y);}.bind(this)),x=o.getResource(u);if(x){this.$MercurySearchThreadResults4(x,w,q+1);}else{x=new l();this.$MercurySearchThreadResults4(x,w,p+1);o.setResource(u,x);}}};r.prototype.unsubscribe=function(s,t){"use strict";if(t){var u=o.getResource(t);if(u){u.unsubscribe(s);}else o.unsubscribe(s);}};r.prototype.setInitialCount=function(s){"use strict";p=s;};r.prototype.$MercurySearchThreadResults4=function(s,t,u){"use strict";var v=s.getCurrentArraySize(),w=t.length<u;if(!w)t.pop();s.addResourcesWithoutSorting(t,v);if(w)s.setReachedEndOfArray();};r.prototype.$MercurySearchThreadResults3=function(s){"use strict";s.client=h.WEBMESSENGER;s.index='fbid';m.trySend('/ajax/mercury/search_threads.php',s,null,this.$MercurySearchThreadResults0);};Object.assign(r,i);e.exports=r;},null);
__d("Autosize",["CSS","cx","DOM","Style"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=['fontFamily','fontStyle','fontVariant','fontWeight','letterSpacing','textDecoration','textIndent','textTransform','whiteSpace','wordSpacing','wordWrap'],l=/^[0-9]+$/;function m(r){var s=r.cloneNode(true);g.addClass(s,"_4g");var t=r.clientWidth-j.getFloat(r,'paddingLeft')-j.getFloat(r,'paddingRight');j.set(s,'width',t+'px');var u=r.clientHeight-j.getFloat(r,'paddingTop')-j.getFloat(r,'paddingBottom');j.set(s,'height',u+'px');i.insertAfter(r,s);return s;}function n(r,s,t,u,v){var w=r.style.fontSize,x=r.style.height;j.set(r,"height","auto");if(s!==null){var y=r.style.width;j.set(r,"width","auto");}var z=0,aa=v.length-1;while(z<aa){var ba=Math.ceil((z+aa)/2);j.set(r,"font-size",v[ba]+u);if((t!==null&&r.scrollHeight>t)||(s!==null&&r.scrollWidth>s)){aa=ba-1;}else z=ba;}r.style.fontSize=w;r.style.height=x;if(s!==null)r.style.width=y;return v[z]+u;}function o(r,s,t,u,v,w){var x=r.style.fontSize,y=r.style.height;j.set(r,"height","auto");if(s!==null){var z=r.style.width;j.set(r,"width","auto");}j.set(r,"font-size",w+u);if((t===null||r.scrollHeight<=t)&&(s===null||r.scrollWidth<=s)){r.style.fontSize=x;r.style.height=y;if(s!==null)r.style.width=z;return w+u;}j.set(r,"font-size",v+u);if((t!==null&&r.scrollHeight>t)||(s!==null&&r.scrollWidth>s)){r.style.fontSize=x;r.style.height=y;if(s!==null)r.style.width=z;return v+u;}while(v+1<w){var aa=Math.ceil((v+w)/2);j.set(r,"font-size",aa+u);if((t!==null&&r.scrollHeight>t)||(s!==null&&r.scrollWidth>s)){w=aa;}else v=aa;}r.style.fontSize=x;r.style.height=y;if(s!==null)r.style.width=z;return v+u;}function p(r,s){this._wrap=r;this._attr=s;if(this._attr.sizes){var t=this._attr.sizes;for(var u=1,v=t.length;u<v;u++){if(t[u-1]<=t[u])continue;t.sort(function(x,y){return x-y;});break;}}else if(s.min>s.max){var w=s.min;s.min=s.max;s.max=w;}this.fit();}p.prototype.fit=function(r,s){var t=this._wrap;if(!t.clientWidth){q.push(this);return;}var u=m(t);if(typeof r==="undefined")r=this._attr.width;if(l.test(r)){u.style.width=r+"px";}else if(r!==null&&r!=="auto")u.style.width=r;if(typeof s==="undefined")s=this._attr.height;if(l.test(s)){u.style.height=s+"px";}else if(s!==null&&s!=="auto")u.style.height=s;var v=null;if(!this._attr.wrap)v=u.clientWidth;var w=null;if(this._attr.wrap||s!==null)w=u.clientHeight;var x;if(this._attr.sizes){x=n(u,v,w,"px",this._attr.sizes);}else x=o(u,v,w,"px",this._attr.min,this._attr.max);i.remove(u);j.set(t,"font-size",x);g.removeClass(t,"invisible_elem");};var q=[];p.onNodeInserted=function(){var r=q;q=[];r.forEach(function(s){s.fit();});};e.exports=p;},null);
__d("FileFormResetOnSubmit",["DOMQuery","Event","emptyFunction"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(l,m){var n=h.listen(l,'change',i.thatReturnsFalse,h.Priority.URGENT);try{m();}catch(o){throw o;}finally{n.remove();}}function k(l){"use strict";this._form=l;}k.prototype.enable=function(){"use strict";var l=this._reset.bind(this);this._subscription=this._form.subscribe('submit',function(){setTimeout(l,0);});};k.prototype.disable=function(){"use strict";this._subscription.unsubscribe();this._subscription=null;};k.prototype._reset=function(){"use strict";var l=this._form.getRoot();j(l,function(){var m=g.scry(l,'input[type="file"]');m.forEach(function(n){n.value='';});});};e.exports=k;},null);
__d("TabIndexDelegator",["CSS","DOM","Event","Focus","JSXDOM"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(m,n){"use strict";this._placeholder=n||k.button(null);this._placeholder.setAttribute('aria-hidden',true);g.addClass(this._placeholder,'accessible_elem');this._listener=i.listen(this._placeholder,'click',function(){m.click();});j.relocate(this._placeholder,m);this.enable();}l.prototype.enable=function(){"use strict";g.show(this._placeholder);};l.prototype.disable=function(){"use strict";g.hide(this._placeholder);};l.prototype.getPlaceholder=function(){"use strict";return this._placeholder;};l.prototype.destroy=function(){"use strict";this._listener.remove();h.remove(this._placeholder);};e.exports=l;},null);
__d("BasePhotoUploader",["Arbiter","ArbiterMixin","CSS","DOM","PhotosMultiUploadInput","VaultEditableGrid","TimelineMapScrollableArea","mixin","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t,u){"use strict";p.call(this);new m(t,{verticalscroll:true});this.$BasePhotoUploader0=t;this.$BasePhotoUploader1=this.$BasePhotoUploader2();this.$BasePhotoUploader3=false;this.$BasePhotoUploader4=null;u.addSubscriptions(g.subscribe('multi-upload/images-added/'+this.$BasePhotoUploader0.id,function(v,w){var x=Object.assign({},w.fbids);Object.assign(this.$BasePhotoUploader1,x);this.$BasePhotoUploader5();this.inform('upload-completed',{fbids:o(x)});}.bind(this)),g.subscribe('multi-upload/image-removed/'+this.$BasePhotoUploader0.id,function(v,w){for(var x in this.$BasePhotoUploader1)if(this.$BasePhotoUploader1[x]===w){delete this.$BasePhotoUploader1[x];break;}this.$BasePhotoUploader5();}.bind(this)),g.subscribe('multi-upload/images-upload-start/'+this.$BasePhotoUploader0.id,function(v,w){i.show(this.$BasePhotoUploader0);this.$BasePhotoUploader3=true;this.inform('dom-updated');this.inform('upload-started',w);}.bind(this)),g.subscribe('multi-upload/composer-reset/'+this.$BasePhotoUploader0.id,this.clear.bind(this)),g.subscribe('multi-upload/all-images-removed/'+this.$BasePhotoUploader0.id,this.$BasePhotoUploader6.bind(this)),g.subscribe('multi-upload/images-upload-completed/'+this.$BasePhotoUploader0.id,function(v){this.$BasePhotoUploader3=false;this.inform('all-uploads-completed');this.$BasePhotoUploader5();}.bind(this)));i.conditionShow(this.$BasePhotoUploader0,Object.keys(this.$BasePhotoUploader1).length);}s.prototype.getSelectedFBIDs=function(){"use strict";var t=Object.keys(this.$BasePhotoUploader1).sort();return t.map(function(u){return this.$BasePhotoUploader1[u];}.bind(this));};s.prototype.isUploading=function(){"use strict";return this.$BasePhotoUploader3;};s.prototype.clear=function(){"use strict";var t=l.getInstance(this.$BasePhotoUploader0.id);t&&t.removeImages();};s.prototype.getWaterfallID=function(){"use strict";return k.getWaterfallID(this.$BasePhotoUploader0.id);};s.prototype.$BasePhotoUploader6=function(){"use strict";this.$BasePhotoUploader1={};this.$BasePhotoUploader3=false;i.hide(this.$BasePhotoUploader0);this.inform('all-uploads-completed');this.inform('dom-updated');};s.prototype.$BasePhotoUploader2=function(){"use strict";var t={},u=-10000;j.scry(this.$BasePhotoUploader0,'input[type="hidden"]').forEach(function(v){if(v.name.match('composer_vault_images')){t[u]=v.value;u--;}});return t;};s.prototype.$BasePhotoUploader5=function(){"use strict";i.conditionShow(this.$BasePhotoUploader0,Object.keys(this.$BasePhotoUploader1).length>0);this.inform('dom-updated');};s.prototype.setCurrentMethod=function(t){"use strict";this.$BasePhotoUploader4=t;};s.prototype.getCurrentMethod=function(){"use strict";return this.$BasePhotoUploader4;};e.exports=s;},null);
__d("FormSubmitOnChange",["Event","submitForm"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this._form=j;}i.prototype.enable=function(){"use strict";this._listener=g.listen(this._form.getRoot(),'change',this._submit.bind(this));};i.prototype.disable=function(){"use strict";this._listener.remove();this._listener=null;};i.prototype._submit=function(){"use strict";h(this._form.getRoot());};Object.assign(i.prototype,{_listener:null});e.exports=i;},null);