/*!CK:3148819040!*//*1438923530,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["DwG28"]); }

__d("MessageThreadViewSource",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={UNSPECIFIED:"unspecified",LEGACY:"legacy",LEGACY_MESSAGES_PREVIEW:"legacy_messages_preview",REFRESH_SPRINGBOARD:"springboard",REFRESH_MESSAGETAB:"message_tab",REFRESH_PERMALINK:"permalink",REFRESH_HIGHLANDER_JEWEL:"highlander_jewel",REFRESH_SEARCH_TYPEAHEAD:"search_typeahead",MTOUCH_MESSAGE_TAB:"mtouch_message_tab",MBASIC_MESSAGE_TAB:"mbasic_message_tab"};},null);
__d("PagesMessengerThreadDialogLink.react",["AsyncDialog","AsyncRequest","Link.react","MessageThreadViewSource","PagesMessagingConst","ReactComponentWithPureRenderMixin","React","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=m,p=o.PropTypes,q=m.createClass({displayName:"PagesMessengerThreadDialogLink",mixins:[l],propTypes:{threadID:p.string.isRequired,viewer:p.string.isRequired,folder:p.string},getInitialState:function(){return {permalinkURI:'#'};},componentDidMount:function(){this._getPermalinkURI(this.props);},componentWillReceiveProps:function(r){if(r.threadID!==this.props.threadID||r.folder!==this.props.folder)this._getPermalinkURI(r);},render:function(){return (m.createElement(i,{className:this.props.className,href:"#",onClick:this._handleClick,role:"button"},this.props.children));},_handleClick:function(r){r.preventDefault();g.send(new h(this.state.permalinkURI).setRelativeTo(r.target));},_getPermalinkURI:function(r){this.setState(this.getInitialState());var s=r.threadID,t=r.viewer,u=r.folder;d(['MercuryThreadIDMap'],function(v){var w=v.getForFBID(t);w.getFBIDFromClientID(s,function(x){this.isMounted()&&this.setState({permalinkURI:new n(k.LOAD_MESSAGE_THREAD_URI).setQueryData({pageid:t,threadid:s,threadElementID:x,folder:u,source:j.REFRESH_HIGHLANDER_JEWEL}).toString()});}.bind(this));}.bind(this));}});e.exports=q;},null);
__d("MercuryJewelCountControl",["Arbiter","MercuryDispatcher","MercuryThreadInformer","MercuryUnseenState","UserActivity"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(m){"use strict";var n=h.get(),o=i.get();this.$MercuryJewelCountControl2=j.get();this.render();n.subscribe('model-update-completed',function(p,q){this.$MercuryJewelCountControl4(false);}.bind(this));o.subscribe('unseen-updated',function(){return this.render();}.bind(this));this.$MercuryJewelCountControl5=m;this.$MercuryJewelCountControl5.subscribe('marked-seen',function(){this.$MercuryJewelCountControl4(true);}.bind(this));}l.prototype.render=function(){"use strict";g.inform('jewel/count-updated',{jewel:'mercurymessages',count:this.$MercuryJewelCountControl2.getUnseenCount()},g.BEHAVIOR_STATE);};l.prototype.$MercuryJewelCountControl4=function(m){"use strict";if(m||(this.$MercuryJewelCountControl5.isOpen()&&k.isActive()))this.$MercuryJewelCountControl2.markAsSeen();};l.constructStores=function(){"use strict";j.get();};e.exports=l;},null);
__d("P2PJewelBanner.react",["Image.react","Layout.react","Link.react","React","TooltipLink.react","XUIGrayText.react","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=h.FillColumn,r=h.Column,s=j,t=s.PropTypes,u=j.createClass({displayName:"P2PJewelBanner",propTypes:{actionURI:t.oneOfType([t.string,t.object]).isRequired,actionText:t.string.isRequired,bodyText:t.oneOfType([t.string,t.object]).isRequired,icon:t.oneOf(['warning','coin']),isDismissable:t.bool,onClick:t.func.isRequired,onClose:t.func,titleText:t.string.isRequired},getDefaultProps:function(){return {actionURI:'#',isDismissable:false,onClick:n,onClose:n};},getImagePath:function(){var v=this.props.icon;if(v==="warning"){return p("/images/p2p/receiver-risk-notification.png");}else return p("/images/p2p/receiver-nux-notification.png");},handleCloseClick:function(v){v.stopPropagation();if(this.props.onClose)this.props.onClose();},renderCloseButton:function(){return (j.createElement(k,{alignH:"center",className:"_47d8",href:"#",onClick:this.handleCloseClick,position:"above",tooltip:o._("Dismiss")},j.createElement(g,{className:"_47dg",height:7,src:p('/images/p2p/jewel-banner-close.png'),width:7})));},render:function(){var v;if(this.props.isDismissable)v=this.renderCloseButton();return (j.createElement("div",{className:"_5d0n",onClick:this.props.onClick},v,j.createElement(h,null,j.createElement(r,{className:"_5d0o"},j.createElement(g,{className:"_5d0q",height:28,src:this.getImagePath(),width:28})),j.createElement(q,{className:"_47di"},j.createElement(l,{display:"block",shade:"medium",weight:"bold"},this.props.titleText),j.createElement(l,{display:"block",shade:"medium"},this.props.bodyText),j.createElement(i,{className:"_5d0t",href:this.props.actionURI,target:"_blank"},this.props.actionText)))));}});e.exports=u;},null);
__d("P2PPendingPushFailJewelBanner.react",["P2PJewelBanner.react","P2PTransferParam","XP2PTransactionDetailController","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=j,m=l.PropTypes,n=j.createClass({displayName:"P2PPendingPushFailJewelBanner",propTypes:{transfer:m.object.isRequired},getActionText:function(){return k._("Update Card");},render:function(){var o=this.props.transfer;return (j.createElement(g,{actionText:k._("Update Card"),bodyText:k._("It looks like your card is expired or invalid. Please update it to get {currency}{amount} from {sender_name}.",[k.param("currency",o.currency),k.param("amount",o.amount),k.param("sender_name",o.sender.name)]),icon:"warning",actionURI:(i.getURIBuilder()).setString('id',o[h.TRANSFER_ID]).getURI(),titleText:k._("Update Your Card")}));}});e.exports=n;},null);
__d("P2PTimeBasedAcceptMessage.react",["React","fbt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g,j=i.PropTypes,k=g.createClass({displayName:"P2PTimeBasedAcceptMessage",propTypes:{transfer:j.object.isRequired},render:function(){var l=this.props.transfer,m=l.creationTime*1000,n=(1000*60*60*24),o=Date.now(),p=(o-m)/n,q=Math.max(14-Math.floor(p),1),r;if(p<=5){r=h._("Add a debit card and it'll go straight to your bank.");}else if(p<=11){r=h._("This money will be sent back in {days left} days. Add a debit card to accept it.",[h.param("days left",q)]);}else r=h._({"day":"You have {days left} day to add a debit card before the money is sent back to {sender_name}.","days":"You have {days left} days to add a debit card before the money is sent back to {sender_name}."},[h.param("days left",q),h['enum'](q===1?'day':'days',{day:"day",days:"days"}),h.param("sender_name",l.sender.name)]);return g.createElement("div",null,r);}});e.exports=k;},null);
__d("P2PPendingRecipientNUXJewelBanner.react",["P2PAcceptMoneyDialog.react","P2PActions","P2PCreditCardStore","P2PJewelBanner.react","P2PTimeBasedAcceptMessage.react","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=l,o=n.PropTypes,p=l.createClass({displayName:"P2PPendingRecipientNUXJewelBanner",propTypes:{transfer:o.object.isRequired},getInitialState:function(){return {creditCards:i.getAll()};},creditCardStoreSub:(null),componentDidMount:function(){this.creditCardStoreSub=i.addListener('change',this.onCreditCardStoreChange);},componentWillUnmount:function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}},onCreditCardStoreChange:function(){var q={creditCards:i.getAll()};if(this.isMounted())this.setState(q);},handleClick:function(){this.showAcceptMoneyDialog();},showAcceptMoneyDialog:function(){h.showDialog(g,{creditCards:this.state.creditCards,onClose:h.hideDialog,transfer:this.props.transfer});},renderTimeBasedMessage:function(){return (l.createElement(k,{transfer:this.props.transfer}));},render:function(){var q=this.props.transfer;if(!i.isCreditCardsFetchComplete())return null;return (l.createElement(j,{actionText:m._("Add Debit Card"),bodyText:this.renderTimeBasedMessage(),icon:"coin",onClick:this.handleClick,titleText:m._("Accept {currency}{amount} from {sender_name}.",[m.param("currency",q.currency),m.param("amount",q.amount),m.param("sender_name",q.sender.name)])}));}});e.exports=p;},null);
__d("P2PPendingRecipientVerificationJewelBanner.react",["P2PJewelBanner.react","P2PTransferParam","P2PVerificationFlowHelper","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=j,m=l.PropTypes,n=j.createClass({displayName:"P2PPendingRecipientVerificationJewelBanner",propTypes:{transfer:m.object.isRequired},handleClick:function(){i.startVerificationFlow(this.props.transfer[h.TRANSFER_ID],false);},render:function(){return (j.createElement(g,{actionText:k._("Confirm Info"),bodyText:k._("To accept the money {sender_name} sent you, please confirm your information.",[k.param("sender_name",this.props.transfer.sender.name)]),icon:"warning",onClick:this.handleClick,titleText:k._("Please Confirm Your Info")}));}});e.exports=n;},null);
__d("P2PJewelBannerContainer.react",["CurrentUser","P2PPendingPushFailJewelBanner.react","P2PPendingRecipientNUXJewelBanner.react","P2PPendingRecipientVerificationJewelBanner.react","P2PTransferParam","P2PTransferStatus","P2PTransferStore","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=n.createClass({displayName:"P2PJewelBannerContainer",getInitialState:function(){return {dialogComponent:null,transfer:m.getNUXTransfer()};},transferStoreSub:(null),componentDidMount:function(){this.transferStoreSub=m.addListener('change',this.onTransferStoreChange);},componentWillUnmount:function(){if(this.transferStoreSub){this.transferStoreSub.remove();this.transferStoreSub=null;}},onTransferStoreChange:function(){this.setState({transfer:m.getNUXTransfer()});},shouldShowTransferBanner:function(){var q=this.state.transfer;return !!(q&&q.receiver.id==g.getID());},renderTransferBanner:function(){var q=this.state.transfer,r=q[k.STATUS];switch(r){case l.PENDING_RECIPIENT_NUX:return (n.createElement(i,{transfer:q}));case l.PENDING_RECIPIENT_VERIFICATION:return (n.createElement(j,{transfer:q}));case l.PENDING_PUSH_FAIL:return (n.createElement(h,{transfer:q}));}},render:function(){var q;if(this.shouldShowTransferBanner())q=this.renderTransferBanner();return (n.createElement("div",{className:"_1xfk"},q));}});e.exports=p;},null);
__d("MercuryThreadlistContainer.react",["Bootloader","immutable","MercuryAPIArgsSource","MercuryFilters","MercuryThreadlistConstants","P2PJewelBannerContainer.react","React","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=m,p=o.PropTypes,q='search',r=m.createClass({displayName:"MercuryThreadlistContainer",propTypes:{ChildClass:p.func.isRequired,folder:p.string.isRequired,showCount:p.bool,showPresence:p.bool,threadCount:p.number,viewer:p.string.isRequired},getInitialState:function(){return {isLoading:true,isSearching:false,threads:h.Map()};},componentDidMount:function(){g.loadModules(["MercuryOrderedThreadlist","MercuryThreadInformer","MercuryThreads"],function(s,t,u){this._threadlist=s.getForFBID(this.props.viewer);this._threads=u.getForFBID(this.props.viewer);this._informer=t.getForFBID(this.props.viewer);this._subscriptions=new n();this._subscriptions.addSubscriptions(this._informer.subscribe('threadlist-updated',function(v,w){this._updateThreads(this.props.folder,this.props.filter);}.bind(this)));this._handleFolderChange(this.props.folder,this.props.filter);}.bind(this));},componentWillReceiveProps:function(s){if(s.folder!==this.props.folder||s.filter!==this.props.filter)this._handleFolderChange(s.folder,s.filter);},componentWillUnmount:function(){this._cancelThreadsCallback();this._cancelThreadlistCallback();this._subscriptions&&this._subscriptions.release();},render:function(){var s=this.props,t=s.ChildClass,u=s.folder,v=s.filter,w=(function(y,z){var aa={},ba=Object.prototype.hasOwnProperty;if(y==null)throw new TypeError();for(var ca in y)if(ba.call(y,ca)&&!ba.call(z,ca))aa[ca]=y[ca];return aa;})(s,{ChildClass:1,folder:1,filter:1}),x=this.state.isSearching?this.state.threads.get(q)||[]:this.state.threads.get(u)||[];return (m.createElement(t,m.__spread({},w,{isLoaded:!!this._threadlist&&this._threadlist.hasLoadedThreadlist(u,v),isLoading:this.state.isLoading,isSearching:this.state.isSearching,onLoadMoreRequest:this._loadMoreThreads,onQuery:this._handleQuery,onSearchResults:this._handleSearchResults,p2pJewelBannerContainer:this._renderP2PJewelBannerContainer(),threads:x})));},_renderP2PJewelBannerContainer:function(){return (m.createElement(l,null));},_handleFolderChange:function(s,t){if(!this._hasInitialThreads(s,t)){this._loadThreads(s,t,this.props.threadCount||(k.JEWEL_THREAD_COUNT+1));}else if(this.state.isLoading){this.setState({isLoading:false},function(){this._updateThreads(s,t);}.bind(this));}else this._updateThreads(s,t);},_loadMoreThreads:function(){if(!this.state.isSearching&&!this.state.isLoading&&!this._threadlist.hasLoadedThreadlist(this.props.folder,this.props.filter))this._loadThreads(this.props.folder,this.props.filter,this._getThreadCount(this.props.folder)+k.JEWEL_MORE_COUNT+1);},_loadThreads:function(s,t,u){if(!this._threadlist)return;this._cancelThreadlistCallback();this.setState({isLoading:true},function(){var v=this._threadlist.getFilteredThreadlist(k.RECENT_THREAD_OFFSET,u,s,t||j.ALL,function(w){return this.setState({isLoading:false});}.bind(this),true,i.JEWEL);this._threadlistSub={subscriberID:v,folder:s,filter:t};}.bind(this));},_updateThreads:function(s,t,u){if(!this._threadlist||!this._threads)return;this._cancelThreadsCallback();var v=u||this._threadlist.getAvailableThreadlistNow(s,t);this._threadsSub=this._threads.getMultiThreadMeta(v,function(w){this.setState({threads:this.state.threads.set(s,v.map(function(x){return w[x];}))});}.bind(this));},_hasInitialThreads:function(s,t){return !!(this._threadlist&&(this._threadlist.getThreadCount(s,t)>=k.JEWEL_THREAD_COUNT+1||this._threadlist.hasLoadedThreadlist(s,t)));},_getThreadCount:function(s){var t=this.state.threads.get(s);return t?t.length:0;},_cancelThreadsCallback:function(){this._threads&&this._threadsSub&&this._threads.unsubscribe(this._threadsSub);},_cancelThreadlistCallback:function(){this._threadlist&&this._threadlistSub&&this._threadlist.unsubscribe(this._threadlistSub.subscriberID,this._threadlistSub.folder,this._threadlistSub.filter);},_handleSearchResults:function(s,t){this.setState({isLoading:t,searchThreads:[]},function(){return this._updateThreads(q,j.ALL,s);}.bind(this));},_handleQuery:function(s){this.setState({isSearching:!!s});}});e.exports=r;},null);
__d("MercuryThreadlistRowContainer.react",["immutable","ImmutableObject","MercuryParticipants","React","StoreAndPropBasedStateMixin","shallowEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"MercuryThreadlistRowContainer",mixins:[k(i)],propTypes:{ChildClass:n.func.isRequired,thread:n.instanceOf(h).isRequired,viewer:n.string.isRequired},statics:{calculateState:function(p){return {participants:g.Map(g.Seq(p.thread.participants).map(function(q){return [q,i.getOrFetch(q)];}))};}},shouldComponentUpdate:function(p,q){return (!l(p,this.props)||!g.is(q.participants,this.state.participants));},render:function(){var p=this.props,q=p.ChildClass,r=(function(s,t){var u={},v=Object.prototype.hasOwnProperty;if(s==null)throw new TypeError();for(var w in s)if(v.call(s,w)&&!v.call(t,w))u[w]=s[w];return u;})(p,{ChildClass:1});return (j.createElement(q,j.__spread({},r,{participants:this.state.participants})));}});e.exports=o;},null);
__d("MercuryPresenceIndicator.react",["Arbiter","AvailableListConstants","MercuryIDs","PresenceStatus","ReactComponentWithPureRenderMixin","React","SubscriptionsHandler","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=l,q=p.PropTypes,r=l.createClass({displayName:"MercuryPresenceIndicator",mixins:[k],propTypes:{threadID:q.string.isRequired},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(g.subscribe(h.ON_AVAILABILITY_CHANGED,function(){return this.forceUpdate();}.bind(this)));},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();},render:function(){var s=this._getPresence();return (l.createElement("span",{className:this._getClasses(s)},l.createElement("span",{className:"accessible_elem"},this._getLabel(s))));},_getPresence:function(){if(!i.isCanonical(this.props.threadID)){return null;}else{var s=i.getUserIDFromThreadID(this.props.threadID);return j.get(s);}},_getClasses:function(s){return (("presenceIndicator")+(i.isGroupChat(this.props.threadID)?' '+"groupThread":'')+(s==h.ACTIVE?' '+"presenceActive":'')+(s==h.MOBILE?' '+"presenceMobile":''));},_getLabel:function(s){switch(s){case h.ACTIVE:return (o._("Active"));case h.MOBILE:return (o._("Mobile"));default:return null;}}});e.exports=r;},null);
__d("MercurySeenIndicator.react",["MercuryDelayedRoger","MercuryIDs","React","SubscriptionsHandler","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"MercurySeenIndicator",propTypes:{thread:m.object.isRequired,viewer:m.string.isRequired},componentDidMount:function(){this._subscriptions=new j();this._subscriptions.addSubscriptions(g.subscribe('state-changed',function(o,p){p[this.props.thread.thread_id]&&this.forceUpdate();}.bind(this)));},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();},render:function(){var o=this._separateParticipants(),p=o.viewer,q=o.others,r=this._viewerLastToReply(p),s=this._seenByAll(q);return (i.createElement("span",{className:(("MercuryRepliedIndicator")+(r?' '+"repliedLast":'')+(r&&s?' '+"seenByAll":''))}));},_separateParticipants:function(){var o=h.getParticipantIDFromUserID(this.props.viewer),p=this.props.thread.participants.filter(function(q){return q!==o;});return {viewer:o,others:p};},_viewerLastToReply:function(o){var p=this.props.thread.participants;return p.length>0&&p[0]===o;},_seenByAll:function(o){var p=this.props.thread.thread_id;return g.getSeenBy(p).length===o.length;}});e.exports=n;},null);
__d("MercuryThreadPermalink.react",["HighlanderFinchGating","Link.react","PagesMessengerThreadDialogLink.react","ReactComponentWithPureRenderMixin","React","WebMessengerThreadPermalinks"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=k,n=m.PropTypes,o=k.createClass({displayName:"MercuryThreadPermalink",mixins:[j],propTypes:{threadID:n.string.isRequired,viewer:n.string.isRequired,folder:n.string,onClick:n.func},getInitialState:function(){return {permalinkURI:'#'};},componentDidMount:function(){this._getPermalinkURI(this.props);},componentWillReceiveProps:function(p){if(p.threadID!==this.props.threadID||p.folder!==this.props.folder)this._getPermalinkURI(p);},render:function(){if(g.HIGHLANDER_FINCH_GATING)return (k.createElement(i,{className:this.props.className,threadID:this.props.threadID,viewer:this.props.viewer,folder:this.props.folder},this.props.children));return (k.createElement(h,{className:this.props.className,href:this.state.permalinkURI,onClick:this.props.onClick,role:"button"},this.props.children));},_getPermalinkURI:function(p){if(g.HIGHLANDER_FINCH_GATING)return;this.setState(this.getInitialState());l.getThreadURI(p.threadID,function(q){return this.isMounted()&&this.setState({permalinkURI:q});}.bind(this),p.folder);}});e.exports=o;},null);
__d("MercuryThreadReadToggle.react",["MercuryThreadActions","ReactComponentWithPureRenderMixin","React","ReadToggle.react","fbt","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"MercuryThreadReadToggle",mixins:[h],propTypes:{threadID:n.string.isRequired,viewer:n.string.isRequired,unreadCount:n.number.isRequired},render:function(){l(this.props.unreadCount>=0);return (i.createElement(j,{isRead:this.props.unreadCount===0,onClick:this._handleClick,readLabel:k._("Mark as Unread"),unreadLabel:k._("Mark as Read")}));},_handleClick:function(p){p.preventDefault();p.stopPropagation();var q=g.getForFBID(this.props.viewer);this.props.unreadCount>0?q.markRead(this.props.threadID):q.markUnread(this.props.threadID);}});e.exports=o;},null);
__d("MercuryThreadSnippet.react",["immutable","MercuryAttachmentSnippet.react","MercuryIDs","React","TextWithEmoticons.react","fbt","shallowEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=j,o=n.PropTypes,p=j.createClass({displayName:"MercuryThreadSnippet",propTypes:{participants:o.instanceOf(g.Map).isRequired,shouldRenderYou:o.bool,thread:o.object.isRequired,viewer:o.string.isRequired},shouldComponentUpdate:function(s,t){return (!m(s,this.props)||!g.is(s.participants,this.props.participants));},render:function(){return (j.createElement("span",{className:this.props.className},this._renderAttachmentIndicator(),this._renderSnippet()));},_renderAttachmentIndicator:function(){if(!this.props.thread.snippet||!q(this.props.thread))return null;return j.createElement("span",{className:"MercuryAttachmentIndicator"});},_renderSnippet:function(){var s=this.props.thread,t=i.getParticipantIDFromUserID(this.props.viewer),u=this._renderInnerSnippet(),v=s.participants.length;if(s.is_subscribed)v--;if(r(s)||!s.snippet_sender)return u;if(s.snippet_sender===t){if(!this.props.shouldRenderYou)return u;return (l._("You: {conversation_snippet}",[l.param("conversation_snippet",u)]));}if(v<=1)return u;var w=this.props.participants.get(s.snippet_sender);if(!w||!w.short_name)return u;return (l._("{name}: {conversation_snippet}",[l.param("name",w.short_name),l.param("conversation_snippet",u)]));},_renderInnerSnippet:function(){var s=this.props.thread,t=s.snippet;if(t&&t.startsWith('?OTR'))return (l._("[encrypted message]"));if(t)return (j.createElement(k,{renderEmoticons:true,renderEmoji:true,text:t.replace(/\r\n|[\r\n]/g,' ')}));if(q(s))return (j.createElement(h,{thread:s,viewer:this.props.viewer}));return null;}});function q(s){return (s.snippet_has_attachment&&s.snippet_attachments&&s.snippet_attachments.length>0);}function r(s){return !s.snippet&&q(s);}e.exports=p;},null);
__d("MercuryThreadTimestamp.react",["ReactComponentWithPureRenderMixin","React","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"MercuryThreadTimestamp",mixins:[g],propTypes:{time:l.number,title:l.string,text:l.string},render:function(){var n=this.props.time;if(!n)return h.createElement("abbr",null);return (h.createElement("abbr",{className:j(this.props.className,'timestamp'),title:this.props.title||(new Date(n)).toLocaleDateString(),"data-utime":n/1000},this.props.text||i(new Date(n),'g:ia')));}});e.exports=m;},null);
__d("MessagesJewelInlineThumbnail.react",["MercuryAttachmentType","React","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=h,k=j.PropTypes,l=h.createClass({displayName:"MessagesJewelInlineThumbnail",propTypes:{thread:k.object.isRequired},render:function(){var m=this._getPhotoAttachments();if(m.length===0)return h.createElement("span",null);var n=m[0].thumbnail_url;if(!n)return h.createElement("span",null);var o=h.createElement("span",{className:"_56hv"},h.createElement("i",{style:{backgroundImage:("url("+n+")")}}));if(m.length>1)o=h.createElement("span",null,h.createElement("span",{className:"_56hy"}),o);return o;},_getPhotoAttachments:function(){var m=this.props.thread;if(!m.snippet_attachments)return [];return m.snippet_attachments.filter(function(n){return n.attach_type===g.PHOTO;});}});e.exports=l;},null);
__d("MessagesJewelThreadListRow.react",["ImageBlock.react","immutable","ImmutableObject","MercuryPresenceIndicator.react","MercurySeenIndicator.react","MercuryThreadImage.react","MercuryThreadPermalink.react","MercuryThreadReadToggle.react","MercuryThreadSnippet.react","MercuryThreadTimestamp.react","MercuryThreadTitle.react","MessagesJewelInlineThumbnail.react","ReactComponentWithPureRenderMixin","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();'use strict';var v=t,w=v.PropTypes,x=t.createClass({displayName:"MessagesJewelThreadListRow",mixins:[s],propTypes:{onClick:w.func,participants:w.instanceOf(h.Map).isRequired,showPresence:w.bool,thread:w.instanceOf(i).isRequired,viewer:w.string.isRequired,wasSeenByAll:w.bool},render:function(){return (t.createElement("li",{className:((this.props.thread.unread_count>0?"jewelItemNew":''))},t.createElement(m,{className:"messagesContent",threadID:this.props.thread.thread_id,viewer:this.props.viewer,folder:this.props.thread.folder,onClick:this.props.onClick},t.createElement(g,{spacing:"medium"},t.createElement("div",{className:"MercuryThreadImage"},t.createElement(l,{thread:this.props.thread,viewer:this.props.viewer})),t.createElement("div",{className:"content"},t.createElement("div",{className:"author"},t.createElement("strong",null,t.createElement(q,{thread:this.props.thread,viewer:this.props.viewer,showUnreadCount:true})),this._renderPresenceIndicator()),t.createElement("div",{className:"snippet preview"},t.createElement(k,{thread:this.props.thread,viewer:this.props.viewer}),t.createElement(o,{participants:this.props.participants,thread:this.props.thread,viewer:this.props.viewer})),t.createElement("div",{className:"time"},t.createElement(p,{time:this.props.thread.timestamp,title:this.props.thread.timestamp_absolute,text:this.props.thread.timestamp_relative}))),t.createElement("div",null,t.createElement(r,{thread:this.props.thread}),t.createElement("div",{className:"x_div"},t.createElement(n,{threadID:this.props.thread.thread_id,viewer:this.props.viewer,unreadCount:this.props.thread.unread_count})))))));},_renderPresenceIndicator:function(){if(!this.props.showPresence)return null;return (t.createElement(j,{threadID:this.props.thread.thread_id}));}});e.exports=x;},null);
__d("MessagesJewelThreadlistRowContainer.react",["ImmutableObject","MercuryDelayedRoger","MercuryThreadlistRowContainer.react","MessagesJewelThreadListRow.react","ReactComponentWithPureRenderMixin","React","StoreAndPropBasedStateMixin","requireWeak"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=l,p=o.PropTypes,q;n('ChatOpenTab',function(s){q=s;});var r=l.createClass({displayName:"MessagesJewelThreadlistRowContainer",mixins:[k,m(h)],propTypes:{thread:p.instanceOf(g).isRequired,viewer:p.string.isRequired},statics:{calculateState:function(s){return {wasSeenByAll:h.wasSeenByAll(s.thread.thread_id)};}},componentDidMount:function(){if(!q)n('ChatOpenTab',function(s){this.forceUpdate();}.bind(this));},render:function(){return (l.createElement(i,{ChildClass:j,onClick:this._handleClick,showPresence:q&&q.canOpenTab(),thread:this.props.thread,viewer:this.props.viewer,wasSeenByAll:this.state.wasSeenByAll}));},_handleClick:function(s){if(s.button===1||s.altKey||s.ctrlKey||s.metaKey||s.shiftKey)return;if(q&&q.canOpenTab()){s.preventDefault();q.openThread(this.props.thread.thread_id,'jewel');}}});e.exports=r;},null);
__d("MessagesJewelThreadList.react",["ImmutableObject","ScrollableArea.react","Link.react","MessagesJewelThreadlistRowContainer.react","React","XUISpinner.react","cx","fbt","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=k,q=p.PropTypes,r=k.createClass({displayName:"MessagesJewelThreadList",propTypes:{isLoaded:q.bool,isLoading:q.bool,onLoadMoreRequest:q.func,p2pJewelBannerContainer:q.element,threads:q.arrayOf(q.instanceOf(g)).isRequired,viewer:q.string.isRequired},render:function(){return (k.createElement(h,{onScroll:o(this._handleScroll,50),ref:"scrollable"},k.createElement("ul",{className:"jewelContent"},this.props.p2pJewelBannerContainer?k.createElement("li",null,this.props.p2pJewelBannerContainer):null,this.props.threads.map(function(s){return k.createElement(j,{key:s.thread_id,thread:s,viewer:this.props.viewer});}.bind(this))),this._renderLoadMoreLink()));},_renderLoadMoreLink:function(){if(this.props.isLoaded)return null;if(this.props.isLoading)return (k.createElement("div",{className:"_v8y"},k.createElement(l,null)));return (k.createElement("div",{className:"_v8y"},k.createElement(i,{href:"#",onClick:this._handleLoadMoreClick},n._("Show Older"))));},_handleScroll:function(){if(this.props.isLoaded)return;var s=this.refs.scrollable.getArea();if(s.getScrollTop()+s.getClientHeight()>=s.getScrollHeight()-1)this.props.onLoadMoreRequest&&this.props.onLoadMoreRequest();},_handleLoadMoreClick:function(s){s.preventDefault();this.props.onLoadMoreRequest&&this.props.onLoadMoreRequest();}});e.exports=r;},null);
__d("MercuryJewelThreadlistControl",["ArbiterMixin","CurrentUser","CSS","DOM","Event","JSLogger","MercuryConfig","MercuryFilters","MercuryThreadlistConstants","MercuryThreadlistContainer.react","MessagesJewelThreadList.react","MessagingTag","React","csx","cx","fbt","MercuryThreadInformer","MercuryUnreadState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=b('MercuryThreadInformer').get(),x=b('MercuryUnreadState').get(),y=l.create('mercury_jewel'),z=m.CoreGraphEnabled?r.PENDING:r.OTHER;function aa(fa){var ga=fa.getFlyout();this._jewelController=fa;this._threadlistContainer=j.find(ga,"._3v_l");this._currentFolder=r.INBOX;this._currentFilter=n.ALL;this._jewelTabLinks={};if(m.MessengerJewelUnread!=='none'){this._jewelTabLinks[r.UNREAD]=j.find(ga,"._5c_s");k.listen(this._jewelTabLinks[r.UNREAD],'click',ba.bind(this,r.INBOX,r.UNREAD));}this._jewelTabCounts={};this._jewelTabLinks[r.INBOX]=j.find(ga,"._1sde");this._jewelTabLinks[z]=j.find(ga,"._1sdf");this._jewelTabCounts[r.INBOX]=j.find(ga,"._1sdg");this._jewelTabCounts[z]=j.find(ga,"._1sdh");this._markAllReadLink=j.find(ga,"._1c1m");k.listen(this._jewelTabLinks[r.INBOX],'click',ba.bind(this,r.INBOX,n.ALL));k.listen(this._jewelTabLinks[z],'click',ba.bind(this,z,n.ALL));k.listen(this._markAllReadLink,'click',function(ha){x.markFolderAsRead(this._currentFolder);ha.kill();}.bind(this));w.subscribe('unread-updated',da.bind(this));if(m.MessengerJewelUnread==='first')ca.call(this);da.bind(this)();this.render();y.bump('opened_threadlist_'+this._currentFolder);}Object.assign(aa.prototype,g);Object.assign(aa.prototype,{render:function(){s.render(s.createElement(p,{ChildClass:q,viewer:h.getID(),folder:this._currentFolder,filter:this._currentFilter}),this._threadlistContainer);}});function ba(fa,ga){if(this._currentFolder!==fa||this._currentFilter!==ga){var ha=(this._currentFilter===n.UNREAD)?r.UNREAD:this._currentFolder,ia=(ga===n.UNREAD)?r.UNREAD:fa;y.bump('opened_threadlist_'+fa);i.addClass(this._jewelTabLinks[ia],"_1sdd");i.removeClass(this._jewelTabLinks[ha],"_1sdd");this._currentFolder=fa;this._currentFilter=ga;this.render();}}function ca(){this._subscription=null;var fa=x.getUnreadCount(r.INBOX);if(fa===0){ba.call(this,r.INBOX,n.ALL);return;}ba.call(this,r.INBOX,n.UNREAD);}function da(){ea.bind(this)(r.INBOX);ea.bind(this)(z);if(m.MessengerJewelUnread==='first'){if(this._jewelController.isOpen()){if(!this._subscription)this._subscription=this._jewelController.subscribeOnce('closed',ca.bind(this));return;}ca.call(this);}}function ea(fa){var ga;if(x.exceedsMaxCount(fa)){ga=o.MAX_UNREAD_COUNT;}else ga=x.getUnreadCount(fa);var ha=this._jewelTabCounts[fa];if(ga>0){if(ga==o.MAX_UNREAD_COUNT)ga+='+';j.setContent(ha,v._("({unread_count})",[v.param("unread_count",ga)]));}else j.setContent(ha,'');}e.exports=aa;},null);
__d("MercuryJewel",["Arbiter","MercuryJewelCountControl","MercuryServerPayloadPreprocessor","MercuryChannelHandler"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();b('MercuryChannelHandler').get().turnOn();var j=false;function k(l,m){"use strict";h.constructStores();i.get().handleUpdate(m);this.$MercuryJewel0=new h(l);if(l.getRoot()&&l.isOpen()){this.$MercuryJewel1(l);}else l.subscribeOnce('opened',this.$MercuryJewel1.bind(this,l));}k.prototype.$MercuryJewel1=function(l){"use strict";if(!j){d(['MercuryJewelThreadlistControl'],function(m){this.$MercuryJewel2=new m(l);}.bind(this));g.inform('mercury-jewel/opened',null,g.BEHAVIOR_PERSISTENT);j=true;}};e.exports=k;},null);
__d("P2PCreditCardNumberFormFieldHelper",["Keys"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h={formatCardNumber:function(i,j,k,l,m){if(k===g.BACKSPACE||k===g.DELETE){var n=(j.split(m).length-1),o=(i.split(m).length-1);if(o!==n)return i;}i=i.replace(/\D/g,'');i=i.substr(0,l[l.length-1]);var p='';for(var q=1;q<l.length;q++){if(l[q]>i.length||(q===l.length-1)){p+=i.slice(l[q-1]);break;}p+=i.slice(l[q-1],l[q])+m;}return p;},getUpdatedCursorPosition:function(i,j,k,l){var m=0,n=0;while(m<k&&m<j.length&&n<i.length)if(j[m]===i[n]){m++;n++;}else if(!/^\d+$/.test(j[m])){m++;}else n++;if(i.substr(n,1)===l)n++;return n;}};e.exports=h;},null);
__d("P2PCreditCardNumberFormField.react",["React","PaymentMethodUtils","P2PCreditCardFormFieldMixin.react","P2PCreditCardNumberFormFieldHelper","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=g.createClass({displayName:"P2PCreditCardFormField",mixins:[i],getIcon:function(){return (g.createElement("div",{className:"_31_w _3_2h"}));},getAutocompleteName:function(){return 'cc-number';},isAmex:function(n){var o=h.getCardType(n||this.state.value);return (o.name==='amex');},getLimit:function(){return this.isAmex()?15:16;},isValAtLimit:function(){var n=this.getLimit(),o=this.state.value.replace(/ /g,'');return o.length===n;},formatValue:function(n,o,p){var q=this.isAmex(n)?[0,4,10,15]:[0,4,8,12,16];return j.formatCardNumber(n,o,p,q,' ');},getUpdatedCursorPosition:function(n,o,p){return j.getUpdatedCursorPosition(n,o,p,' ');},getPlaceholder:function(){return l._("Card Number");},validate:function(n){var o=this.isValidCardType(n);this.setState({errorMessage:!o?l._("Please enter a debit card. Credit cards can't be used."):null});return !!(h.isValidCCNumber(n)&&o);},isValidCardType:function(n){var o=['mc','visa','unknown'],p=h.getCardType(n),q=p?p.name:'',r=o.indexOf(q)>=0;return r;}});e.exports=m;},null);
__d("P2PCreditCardExpDateFormField.react",["React","P2PCreditCardFormFieldMixin.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g.createClass({displayName:"P2PCreditCardExpDateFormField",mixins:[h],getIcon:function(){return (g.createElement("div",{className:"_31_w _31_x"}));},getAutocompleteName:function(){return 'cc-exp';},isValAtLimit:function(){var l=this.state.value;return l.length===this.getLimit();},getLimit:function(){return 5;},getPlaceholder:function(){return (j._("MM\/YY"));},formatValue:function(l,m,n){var o=this.getLimit(),p=String.fromCharCode(n);l=l.replace(/[^0-9\/]+/g,'');var q=l.split('/'),r=q[0],s=q[1];if(s&&s.length===4){l=r+'/'+s.substr(-2);}else l=l.slice(0,o);if(!/^\d+$/.test(p)&&n!==191&&n!==111)return l;l=l.replace(/\D/g,'');if(/^\d$/.test(l)&&(l!=='0'&&l!=='1')){l='0'+l+'/';}else if(l.length>=2&&l.indexOf('/')===-1)l=l.substr(0,2)+'/'+l.substr(2,4);return l;},validate:function(l){var m=l.split('/'),n=(new Date()),o=parseInt(n.getFullYear().toString().substring(2),10),p=parseInt(n.getMonth()+1,10),q=parseInt(m[0],10),r=parseInt(m[1],10);if(l.length!==5||!q||!r||isNaN(q)||isNaN(r)||q<1||q>12)return false;if((r<o)||(r===o&&q<p)||q>12||q<1)return false;return true;}});e.exports=k;},null);
__d("P2PErrorDialog.react",["CurrentEnvironment","Image.react","P2PConfirmationDialog.react","P2PText.react","React","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=k,p=o.PropTypes,q=k.createClass({displayName:"P2PErrorDialog",propTypes:{allowBack:p.bool,onBackClick:p.func,onOKClick:p.func,error:p.object,title:p.string},getDefaultProps:function(){return {allowBack:false,onBackClick:l,onOKClick:l,error:null,title:m._("Problem")};},renderErrorContent:function(){var r=this.props.error;if(r.message.__html){return (k.createElement(j,{dangerouslySetInnerHTML:r.message,type:"primary"}));}else return k.createElement(j,{type:"primary"},r.message);},getImage:function(){if(g.messengerdotcom){return (k.createElement(h,{height:62,width:62,src:n('/images/p2p/confirmation-error-messengerdotcom.png')}));}else return (k.createElement(h,{height:55,width:55,src:n('/images/p2p/confirmation-error.png')}));},render:function(){var r=this.getImage();return (k.createElement(i,{allowBack:this.props.allowBack,behaviors:Object.assign({},this.props.behaviors),centered:this.props.centered,image:r,onBackClick:this.props.onBackClick,onOKClick:this.props.onOKClick,title:this.props.title,width:this.props.width},this.renderErrorContent()));}});e.exports=q;},null);
__d("P2PCreditCardForm.react",["CreditCardFormParam","KappaWrapper","React","P2PAPI","P2PAPIUtils","P2PCreditCardNumberFormField.react","P2PCreditCardExpDateFormField.react","P2PCreditCardCVCFormField.react","P2PCreditCardZipCodeFormField.react","P2PErrorDialog.react","P2PErrorNotice.react","ReactLayeredComponentMixin","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=i,x=w.PropTypes,y=i.createClass({displayName:"P2PCreditCardForm",mixins:[r],propTypes:{asyncRequestState:x.object,cscMaxLength:x.number,editMode:x.bool,onErrorDialogOKClick:x.func,onValidation:x.func,prefilledFormData:x.object,rendersErrorDialog:x.bool,saveErrors:x.object,validateBIN:x.bool},getDefaultProps:function(){return {cscMaxLength:null,editMode:false,onErrorDialogOKClick:t,onValidation:t,prefilledFormData:{},rendersErrorDialog:false,saveErrors:null,validateBIN:false};},getInitialState:function(){var z={};z[g.CARD_NUMBER]={};z[g.CARD_NUMBER].valid=false;z[g.CARD_NUMBER].value=this.props.prefilledFormData[g.CARD_NUMBER]||'';z[g.CARD_EXPIRATION]={};z[g.CARD_EXPIRATION].valid=false;z[g.CARD_EXPIRATION].value=this.props.prefilledFormData[g.CARD_EXPIRATION]||'';z[g.CSC]={};z[g.CSC].valid=false;z[g.CSC].value=this.props.prefilledFormData[g.CSC]||'';z[g.ZIP]={};z[g.ZIP].valid=false;z[g.ZIP].value=this.props.prefilledFormData[g.ZIP]||'';return {binError:'',isValid:false,fields:z,previousBINNumber:'',validateBINRequestID:''};},componentWillMount:function(){h.start(6,3,0);},componentWillReceiveProps:function(z){var aa=z.asyncRequestState,ba=aa?aa[this.state.validateBINRequestID]:null;if(ba){this.setState({validateBINRequestID:''});if(ba.error){this.handleValidateBINNumberError(ba.error);}else this.handleValidateBINNumberSuccess();}},handleValidateBINNumberSuccess:function(){this.setState({binError:''},this.validateForm);},handleValidateBINNumberError:function(z){this.setState({binError:z.message},this.validateForm);},handleCreditCardNumberChange:function(z,aa,ba){if(this.props.validateBIN)this.validateBIN(aa);this.handleFormValueChange(z,aa,ba);},validateBIN:function(z){var aa,ba;z=z.replace(/ /g,'');aa=z.substr(0,6);if(aa!==this.state.previousBINNumber&&aa.length>=6){ba=k.genRequestID();this.setState({validateBINRequestID:ba});j.validateBINNumber({binNumber:aa,requestID:ba});}else if(aa.length<6)this.setState({binError:'',validateBINRequestID:''});this.setState({previousBINNumber:aa});},handleFormValueChange:function(z,aa,ba){var ca=this.state.fields;ca[z]={valid:ba,value:aa};this.validateForm();},validateForm:function(){var z=true,aa=this.state.fields;z=!v(aa).some(function(ba){return !ba.valid;})&&!this.state.binError;this.setState({isValid:z});this.props.onValidation(z,this.serializeFormFields(),this.getFormFieldLoggingData());},serializeFormFields:function(){var z=this.state.fields,aa={};for(var ba in z)if(z.hasOwnProperty(ba))aa[ba]=z[ba].value;return aa;},getFormFieldLoggingData:function(){var z=this.state.fields,aa=z[g.CARD_NUMBER],ba=z[g.CARD_EXPIRATION],ca=z[g.CSC],da=z[g.ZIP],ea={card_number_digits:aa.value.replace(/ /g,'').length,is_card_number_valid:aa.valid,expiration_date_digits:ba.value.replace(/\//,'').length,is_expiration_date_valid:ba.valid,csc_digits:ca.value.length,is_csc_valid:ca.valid,billing_zip_digits:da.value.length,is_billing_zip_valid:da.valid};return {credit_card_validation_data:ea};},getSaveError:function(z){var aa='',ba=this.props.saveErrors;if(ba&&ba.fields&&ba.fields[z])aa=ba.fields[z].message;return aa;},isCreditCardNumberMasked:function(){return this.props.editMode;},isCreditCardNumberFocused:function(){return !this.props.editMode;},isExpFocused:function(){return this.props.editMode;},renderBINError:function(){if(!this.state.binError)return;return (i.createElement(q,{error:{message:this.state.binError}}));},renderGeneralError:function(){var z=this.getGeneralError();if(!z)return;return (i.createElement(q,{error:z}));},getGeneralError:function(){if(this.props.saveErrors&&this.props.saveErrors.general)return this.props.saveErrors.general;return null;},handleErrorOKClick:function(){this.props.onErrorDialogOKClick();},renderLayers:function(){var z=this.getGeneralError();if(!this.props.rendersErrorDialog||!z)return {};return {errorMessageDialog:i.createElement(p,{error:z,onOKClick:this.handleErrorOKClick,title:u._("Problem Saving Card")})};},render:function(){return (i.createElement("form",{className:"_3bez"},!this.props.rendersErrorDialog?this.renderGeneralError():null,this.renderBINError(),i.createElement("div",{className:"_2xxs _2xxt"},i.createElement(l,{reference:g.CARD_NUMBER,onChange:this.handleCreditCardNumberChange,saveError:this.getSaveError(g.CARD_NUMBER)||this.state.binError,value:this.state.fields[g.CARD_NUMBER].value,isMasked:this.isCreditCardNumberMasked(),focused:this.isCreditCardNumberFocused()})),i.createElement("div",{className:"_2xxs _2xxu"},i.createElement(m,{reference:g.CARD_EXPIRATION,focused:this.isExpFocused(),onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CARD_EXPIRATION),value:this.state.fields[g.CARD_EXPIRATION].value}),i.createElement(n,{reference:g.CSC,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.CSC),cscMaxLength:this.props.cscMaxLength,creditCardNumber:this.state.fields[g.CARD_NUMBER].value,value:this.state.fields[g.CSC].value})),i.createElement("div",{className:"_2xxs _2xxv"},i.createElement(o,{reference:g.ZIP,onChange:this.handleFormValueChange,saveError:this.getSaveError(g.ZIP),value:this.state.fields[g.ZIP].value}))));}});e.exports=y;},null);
__d("P2PAddCreditCardDialog.react",["CurrentEnvironment","Link.react","P2PAPI","P2PAPIUtils","P2PCreditCardStore","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PLinkConstants","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();'use strict';var aa=q,ba=aa.PropTypes,ca='fbP2PAddCreditCardDialog_learnMoreSentenceID',da=q.createClass({displayName:"P2PAddCreditCardDialog",propTypes:{cancelButtonText:ba.string,eventFlow:ba.string.isRequired,loggingData:ba.object,loggingObjectID:ba.string,onCancel:ba.func,onSuccess:ba.func,saveButtonText:ba.string,showCancelButton:ba.bool,text:ba.string,title:ba.string},getDefaultProps:function(){return {cancelButtonText:z._("Cancel"),loggingData:{},onCancel:y,onSuccess:y,saveButtonText:z._("Save"),showCancelButton:true,text:z._("Please enter a debit card. Credit cards can't be used."),title:z._("Add Debit Card"),width:g.messengerdotcom?350:288};},getInitialState:function(){return {isValid:false,formData:{},formFieldLoggingData:{},loading:false,requestID:'',saveErrors:null};},onCreditCardStoreChange:function(){var ea=k.getAsyncRequestState(),fa=ea[this.state.requestID];this.setState({asyncRequestState:ea});if(fa){this.setState({requestID:''});if(fa.error){this.handleOnSaveError(fa.error);}else this.handleOnSaveSuccess(fa);}},componentDidMount:function(){this.log(o.UI_ACTN_INITIATE_ADD_CARD);this.creditCardStoreSub=k.addListener('change',this.onCreditCardStoreChange);},componentWillUnmount:function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}},log:function(ea,fa){n.log(ea,Object.assign({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,fa));},onSaveClick:function(){var ea=j.genRequestID();this.setState({loading:true,requestID:ea,saveErrors:null});this.log(o.UI_ACTN_CONFIRM_CARD_DETAILS);i.addCreditCard(Object.assign({requestID:ea},this.state.formData));},handleOnSaveSuccess:function(ea){this.props.onSuccess(ea);this.log(o.UI_ACTN_ADD_CARD_SUCCESS);},handleOnSaveError:function(ea){this.setState({loading:false,saveErrors:ea});this.log(o.UI_ACTN_ADD_CARD_FAIL,{message:ea&&ea.general?ea.general.message:''});},handleValidation:function(ea,fa,ga){this.setState({isValid:ea,formData:fa,formFieldLoggingData:ga});},isSaveButtonDisabled:function(){return this.state.loading||!this.state.isValid;},onToggle:function(ea){if(!ea){this.props.onCancel();this.log(o.UI_ACTN_CANCEL_ADD_CARD,this.state.formFieldLoggingData);}},onCancelClicked:function(){this.onToggle(false);},renderAddCardForm:function(){var ea;if(this.props.showCancelButton)ea=q.createElement(r,{use:"default",size:"medium",label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked});return (q.createElement("div",null,q.createElement(t,null,this.props.title),q.createElement(u,null,q.createElement(w,{type:"primary",className:"_3-96"},this.props.text),q.createElement(l,{asyncRequestState:this.state.asyncRequestState,onValidation:this.handleValidation,saveErrors:this.state.saveErrors,validateBIN:true}),q.createElement(w,{className:"_3-8y",id:ca,type:"secondary"},z._("Your payment info is stored securely."),q.createElement("div",null,q.createElement(h,{"aria-describedby":ca,href:p.addDebitCardHelpURI,target:"_blank"},z._("Learn More"))))),q.createElement(v,{leftContent:this.props.leftContent},ea,q.createElement(r,{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick}))));},render:function(){return (q.createElement(s,{behaviors:this.props.behaviors,layerHideOnBlur:false,ref:"dialog",onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},this.renderAddCardForm(),q.createElement(m,{visible:this.state.loading})));}});e.exports=da;},null);
__d("P2PPasswordProtectionNUXDialog.react",["CurrentEnvironment","Link.react","P2PAPI","P2PErrorDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionParam","P2PPasswordProtectionStatusTypes","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=r,ca=ba.PropTypes,da=r.createClass({displayName:"P2PPasswordProtectionNUXDialog",propTypes:{onComplete:ca.func},getDefaultProps:function(){return {onComplete:z,width:g.messengerdotcom?320:300};},getInitialState:function(){return {saveErrorObject:null,loading:false};},componentWillMount:function(){this.log(n.UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX);},log:function(ea,fa){m.log(ea,Object.assign({www_event_flow:o.UI_FLOW_P2P_SETTINGS},fa));},onSaveClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(q.ENABLED);this.log(n.UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX);},setPasswordProtection:function(ea){var fa={};fa[p.STATUS]=ea;i.setPasswordProtectionSetting({formData:fa,success:this.handleOnSaveSuccess,error:this.handleOnSaveError});},handleOnSaveSuccess:function(){this.setState({loading:false});this.props.onComplete();},handleOnSaveError:function(ea){this.setState({loading:false,saveErrorObject:ea});},isSaveButtonDisabled:function(){return this.state.loading;},isCancelButtonDisabled:function(){return this.state.loading;},onCancelClick:function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(q.DISABLED);this.log(n.UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX);},handleErrorBackClick:function(){this.setState({saveErrorObject:null});},handleErrorOKClick:function(){this.setState({saveErrorObject:null});this.props.onComplete();},render:function(){if(this.state.saveErrorObject)return (r.createElement(j,{allowBack:true,title:aa._("Problem Saving"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}));return (r.createElement(t,{className:((g.messengerdotcom?"_-el":'')),behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:this.props.width},r.createElement(u,{showCloseButton:false},aa._("Use Password?")),r.createElement(v,null,r.createElement(x,{className:"_5sor",type:"primary"},aa._("For additional security, you can enter your Facebook password to send money. You can always update this in {link}.",[aa.param("link",r.createElement(h,{href:k.settingsWWWURI,target:"_blank"},aa._("Settings")))]))),r.createElement(w,null,r.createElement(s,{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:aa._("Not Now"),onClick:this.onCancelClick,size:"medium",use:"default"}),r.createElement(s,{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:aa._("Use Password"),onClick:this.onSaveClick,size:"medium",use:"confirm"})),r.createElement(l,{visible:this.state.loading})));}});e.exports=da;},null);
__d("P2PSuccessDialog.react",["CurrentEnvironment","Image.react","LayerSlowlyFadeOnShow","P2PConfirmationDialog.react","React","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=k,p=o.PropTypes,q=k.createClass({displayName:"P2PSuccessDialog",propTypes:{buttonLabel:p.node,buttonUse:p.string,onOKClick:p.func,onSecondaryClick:p.func,showCloseButton:p.bool,showSecondaryButton:p.bool,secondaryButtonLabel:p.node,secondaryButtonUse:p.string,title:p.string.isRequired},getDefaultProps:function(){return {allowBack:false,buttonLabel:m._("OK"),buttonUse:'default',onOKClick:l,showCloseButton:false,width:g.messengerdotcom?350:300};},getImage:function(){if(g.messengerdotcom){return (k.createElement(h,{height:62,width:62,src:n('/images/p2p/checkmark-messenger.png')}));}else return (k.createElement(h,{height:56,width:56,src:n('/images/p2p/check_mark-sm.png')}));},render:function(){var r=this.getImage();return (k.createElement(j,{behaviors:Object.assign({LayerSlowlyFadeOnShow:i},this.props.behaviors),allowBack:this.props.allowBack,buttonLabel:this.props.buttonLabel,buttonUse:this.props.buttonUse,centered:this.props.centered,image:r,onOKClick:this.props.onOKClick,onSecondaryClick:this.props.onSecondaryClick,showCloseButton:this.props.showCloseButton,showSecondaryButton:this.props.showSecondaryButton,secondaryButtonLabel:this.props.secondaryButtonLabel,secondaryButtonUse:this.props.secondaryButtonUse,title:this.props.title,width:this.props.width},this.props.children));}});e.exports=q;},null);