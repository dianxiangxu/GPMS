(function(z){
'use strict';var l7=function(a,b){a.Ka&&z.zd(a.Ka,"u-hide",b)};var yga=function(a,b){a.Qx=b};var zga=function(a,b){z.bu(a,7);var c=new z.Ft("",1,a.X());b.forEach(function(a){z.Yt(c,z.Eu(a.startOffset,a.endOffset,[a.quoteId],[a.userId]))},a);for(var d=z.zu(c),e=z.Au(c,d),g=0;g<d.length;g++){var h=e[g];if(h.length){for(var k={},m=[],q=0;q<h.length;q++){var t=h[q];k[z.B(t,"creatorIds")]=!0;m.push(t.getName())}h=d[g];q=g<d.length-1?d[g+1]:a.X().length;z.Yt(a,z.Eu(h,q,m,Object.keys(k)))}}};
var m7=function(a){return z.B(a,"replies")};var n7=function(a,b){for(var c=a.X(),d=b;" "==c[d];)d--;var d=c.lastIndexOf(" ",d)+1,e=c.indexOf(" ",d);-1==e&&(e=c.length);return{start:d,end:e,text:c.substring(d,e)}};var Aga=function(a){return function(b,c){var d=n7(b,c);return d.text&&o7.test(d.text)?(z.fu(b,d.start,d.end),z.yu(b,a,d.start),d.start+a.length-c):0}};
var Bga=function(a,b){var c=n7(a,b);z.cu(a,3,function(b){b.Xa()<=c.start&&b.Ua()>=c.end&&"token"==z.B(b,"rel")&&z.wu(a,z.uu(3,c.start,c.end))});c.text&&o7.test(c.text)&&z.Yt(a,z.su(c.start,c.end,"/"+c.text,"","token"));return 0};var Cga=function(a,b){z.jI(a,z.gI,z.jc(b,z.fc(!0)),void 0)};var p7=function(a){var b;b=String(a).replace(/(\r\n|\r|\n)/g,"\x3cbr\x3e");return z.ur(a,z.xr)?(0,z.I)(b,z.vr(a)):b};
var q7=function(a,b,c){for(var d={},e=0;e<a.length;e++){var g=a[e],h=b.call(c,g,e,a);z.ba(h)&&(d[h]||(d[h]=[])).push(g)}return d};var r7=function(a,b,c){z.XA.call(this);if(!a)throw Error("Missing element for TemplateView");this.Ka=a;this.fi=b;this.Mu=c;this.UW="list"+z.la(this);this.RL=""};var s7=function(a,b){a.Uu=b;a.WC="note";a.Sa()&&t7(a);return a};var t7=function(a,b){var c=!!b;if(a.Sa()&&c)for(var c=a.fi.Sc(),d=0;d<c.length;d++){var e=u7(a,c[d]);a.S("after-draw",c[d],e)}};
var v7=function(a,b){var c=a.cM.call(null,b);return a.Uu?(a.Uu[a.WC]=c,c=z.Iy(a.Mu,a.Uu),delete a.Uu[a.WC],String(c)):String(z.Iy(a.Mu,c))};var w7=function(a,b){var c=a.Ka.querySelector("#"+x7(a,b));a.S("before-clear",b,c);c.innerHTML=v7(a,b);a.S("after-draw",b,c)};var u7=function(a,b,c){var d=window.document.createElement("div");d.className=a.RL;d.id=x7(a,b);d.innerHTML=v7(a,b);z.kf(a.Ka,d,"undefined"!=typeof c?c:a.Ka.children.length);return d};
var x7=function(a,b){var c=b.F(),d=b.D();if(!c||!d)throw Error("Unable to generate id "+b);return a.UW+c+d};var y7=function(a){this.Rq=a};var z7=function(a,b){return b?z.vz(a.Rq,b):null};var A7=function(a,b,c){Cga(a.Rq,function(a){var e=a.getAttribute("name");e&&b.call(c,a,e)})};var B7=function(a,b){return z.uf(a.Rq,b)?a.Rq:null};var C7=function(a,b){var c;c=B7(a,b);return(c=z.dz(b,z.gI,c))&&c.getAttribute("name")||null};
var D7=function(a,b,c){(a=z.fI(c,B7(a,c)))&&z.zd(b,"is-darkBackgrounded",z.vd(a,"is-darkBackgrounded"))};var E7=function(a){z.jY.call(this,a);this.xp=Bga;this.$s=Aga;this.view=z.SE};
var F7=function(a,b,c,d,e){z.lP.call(this,b);this.ca=a;this.Ga(new z.dO(c));this.Ga(new z.ZP(!1));this.Ga(new z.dQ);991<=window.innerWidth&&(this.ym=new E7(a),this.Ga(this.ym));this.Ga(new z.pP);this.Ga(new z.XQ(!1));this.Ga(new z.QN(d,!0));this.Hf=!0;this.qh=d;this.ri=a.get("request");this.Z=a.get("dialog");this.IX=e;this.N()};var G7=function(a){a.Yc(a.Ln);a.S("cancel")};var H7=function(a,b,c,d){F7.call(this,a,b,"Leave a note",400,d||null);this.Ia=c;this.L=a.get("routeBuilder")};
var Dga=function(a,b,c){a.zC=b;a.wK=c.text;a.AC=c.image};var Ega=function(a,b,c,d){a.PD=b;a.OD=c;a.BL=d};var I7=function(){return(0,z.I)("This note is only visible to the author, anyone @ mentioned, and publication editors (if any). The author or editors can choose to make it public.")};
var J7=function(a,b,c){b='\x3cdiv class\x3d"js-quotesList u-xs-hide"\x3e'+(a.Lfa?"":z.M(z.DF({vg:!0,title:"Highlights",rd:(0,z.Q)(""+z.M(z.AF({href:(0,z.P)(""+z.O((0,z.Vu)("https://medium.com/the-story/introducing-highlights-a4df69e8ed43"))),moreText:"Learn more",dc:!0},c)))})))+'\x3cul class\x3d"list list--quotes list--short '+(a.NI.length?"":"is-empty")+'"\x3e';for(var d=a.NI,e=d.length,g=0;g<e;g++){for(var h=d[g],k="",m=h.quotes,q=m.length,t=0;t<q;t++)k+=""+m[t].quoteId+(t!=q-1?",":"");k=z.L(k);
b+='\x3cli class\x3d"list-item list-item--inline" data-quote-ids\x3d"'+z.N(k)+'" data-quote-creator-id\x3d"'+z.N(h.user.userId)+'"\x3e'+z.M(z.LD(z.J(a,{user:h.user}),c))+"\x3c/li\x3e"}return(0,z.I)(b+"\x3c/ul\x3e\x3c/div\x3e")};
var Fga=function(a,b,c){return(0,z.I)('\x3cdiv\x3e\x3cdiv class\x3d"buttonSet buttonSet--highlightMenu"\x3e'+z.M(z.wB({action:"quote",source:"quote_popover",icon:"icon--highlighter",U:"button--highlightMenu js-quoteAttributions-pileOn",ec:!0,on:!0,nG:"quote",Pa:!0,Sa:a.Sa},c))+(c.variants.enable_quote_responses&&c.supportsEdit?z.M(z.bC({action:"quote-respond",source:"quote_popover",icon:(0,z.Q)(""+z.M(z.yC({size:"25px"}))),U:"button--highlightMenu",ec:!0,Pa:!0},c)):"")+'\x3cdiv class\x3d"buttonSet-separator"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"js-quoteAttributions-info quoteAttributions-info"\x3e'+
K7(a,0,c)+"\x3c/div\x3e\x3c/div\x3e")};var K7=function(a,b,c){b=z.I;a=a.D3?"Top highlight":(0,z.I)(z.M(z.TF(z.J(a,{fI:!0,y5:!0}),c))+(1==a.df&&a.Sa?" highlighted":""));return b(a)};var Gga=function(a,b,c){return(0,z.I)('\x3cdiv class\x3d"paragraphControls u-noUserSelect"\x3e'+L7(a,0,c)+"\x3c/div\x3e")};
var L7=function(a,b,c){b=z.I;var d='\x3cdiv class\x3d"notesMarker u-noUserSelect '+(0<a.Es&&0==a.Zj?" u-xs-hide":"")+'" data-action\x3d"select-anchor" data-action-value\x3d"'+z.N(a.Ho)+'"\x3e'+M7(a,c)+"\x3c/div\x3e",e,g=""+(1==a.gQ&&(a.eB||a.sB)?a.eB&&a.sB?" highlighted and commented":a.sB?" highlighted":a.eB?" commented":"":""),g=z.L(g);e='\x3cspan class\x3d"paragraphControls-itemText paragraphControls-itemText--social"\x3e';c=""+z.M(z.TF(z.J(a,{social:a.u3,Sa:a.eB||a.sB,df:a.gQ,fI:!0,L4:!0}),c))+
z.G(g);c=(0,z.Q)(c);e+=z.M(z.XF(z.J(a,{text:c})))+"\x3c/span\x3e";a=(0,z.I)(e);return b(d+a)};
var M7=function(a,b){return(0,z.I)("remove"==a.Zj?'\x3cspan class\x3d"notesMarker-icon icon icon--notes"\x3e\x3c/span\x3e\x3cspan class\x3d"icon icon--remove"\x3e\x3c/span\x3e':a.Zj||a.Es?b.variants.enable_quotes&&b.variants.combined_margin_quotes&&0==a.Zj?'\x3cspan class\x3d"notesMarker-icon icon icon--quotes"\x3e\x3c/span\x3e\x3cspan class\x3d"notesMarker-count"\x3e'+z.G(a.Es)+"\x3c/span\x3e":'\x3cspan class\x3d"notesMarker-icon icon icon--notes"\x3e\x3c/span\x3e\x3cspan class\x3d"notesMarker-count u-showOnMobile"\x3e'+z.G(a.Zj)+
'\x3c/span\x3e\x3cspan class\x3d"notesMarker-count u-xs-hide"\x3e'+z.G(a.Zj+a.Es)+"\x3c/span\x3e":'\x3cspan class\x3d"notesMarker-icon icon icon--notesHollow"\x3e\x3c/span\x3e\x3cspan class\x3d"notesMarker-nocount"\x3e+\x3c/span\x3e')};
var Hga=function(a,b,c){return(0,z.I)(z.M(z.vB({U:"button--dismissNotes",action:"dismiss-note",text:(0,z.Q)(""+M7({Zj:"remove"},c))},c))+'\x3cdiv class\x3d"notesList js-notesList"\x3e'+(c.variants.enable_quotes&&c.variants.combined_margin_quotes?z.M(J7({NI:[]},0,c))+z.M(z.DF({title:"Notes",vg:!0,m3:!0})):"")+'\x3cdiv class\x3d"notesItems"\x3e\x3c/div\x3e\x3cdiv class\x3d"newNoteEditor" tabIndex\x3d"-1"\x3e'+z.M(z.vB({U:"button--addNotes",action:"start-note",source:"new_note",ec:!0,title:"Leave a note",
text:(0,z.Q)('\x3cspan class\x3d"icon icon--addCircled icon--addNotes"\x3e\x3c/span\x3e\x3cspan class\x3d"notesAddText"\x3eLeave a note for \x3cspan class\x3d"js-notesPostCreator"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"notesAddCreatorText"\x3eLeave a note\x3c/span\x3e')},c))+(c.isAuthenticated?'\x3cdiv class\x3d"notesEditContainer is-notesEditMode"\x3e\x3cdiv class\x3d"notesAvatar"\x3e'+z.M(z.LD({Ke:!0,user:c.currentUser},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e'+z.G(c.currentUser.name)+
'\x3c/div\x3e\x3cdiv class\x3d"notesItemEditor notesEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+z.M(z.vB({isPrimary:!0,bB:!0,U:"button--editNotesAction",action:"save-note",text:"Save"},c))+z.M(z.vB({U:"button--editNotesAction",action:"cancel-note",text:"Cancel"},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesDisclaimer"\x3e'+z.M(I7())+"\x3c/div\x3e\x3c/div\x3e":"")+"\x3c/div\x3e\x3c/div\x3e")};
var Iga=function(a,b,c){var d=a.note.author?a.note.author.userId:null;b='\x3cdiv class\x3d"notesItem-inner"\x3e\x3cdiv class\x3d"notesItem-main"\x3e'+('\x3cdiv class\x3d"notesControls"\x3e'+(a.Im?'\x3cul class\x3d"notesState notesState-dropdown" data-action\x3d"toggle-note-dropdown"\x3e'+("NEW"==a.note.state?'\x3cli\x3e\x3cspan class\x3d"icon icon--invisible"\x3e\x3c/span\x3ePrivate\x3cspan class\x3d"icon icon--notesStateDown"\x3e\x3c/span\x3e\x3c/li\x3e\x3cli data-action\x3d"approve-note" data-action-value\x3d"'+
z.N(a.note.noteId)+'"\x3e\x3cspan class\x3d"icon icon--group"\x3e\x3c/span\x3ePublic\x3c/li\x3e':"PUBLIC"==a.note.state?'\x3cli\x3e\x3cspan class\x3d"icon icon--group"\x3e\x3c/span\x3ePublic\x3cspan class\x3d"icon icon--notesStateDown"\x3e\x3c/span\x3e\x3c/li\x3e\x3cli data-action\x3d"unapprove-note" data-action-value\x3d"'+z.N(a.note.noteId)+'"\x3e\x3cspan class\x3d"icon icon--invisible"\x3e\x3c/span\x3ePrivate\x3c/li\x3e':"")+(a.HI.userId!=d?'\x3cli data-action\x3d"hide-note" data-action-value\x3d"'+
z.N(a.note.noteId)+'"\x3e\x3cspan class\x3d"icon icon--remove"\x3e\x3c/span\x3eDismiss\x3c/li\x3e':"")+"\x3c/ul\x3e":"PUBLIC"!=a.note.state?'\x3cul class\x3d"notesState"\x3e\x3cli data-tooltip\x3d"'+z.N(I7())+'"\x3e\x3cspan class\x3d"icon icon--invisible"\x3e\x3c/span\x3ePrivate\x3c/li\x3e\x3c/ul\x3e':"")+("PUBLIC"==a.note.state?'\x3cbutton data-action\x3d"show-note-permalink" data-action-value\x3d"'+z.N(a.note.anchor)+"-"+z.N(a.note.noteId)+'" class\x3d"notesLink icon icon--link" data-tooltip\x3d"Click to update the address bar with this note’s shareable link"\x3e':
"")+'\x3c/div\x3e\x3cdiv class\x3d"notesAvatar"\x3e'+z.M(z.LD({user:a.note.author},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e'+(d?'\x3ca href\x3d"/@'+z.N(a.note.author.username)+'" title\x3d"Go to the profile of '+z.N(a.note.author.name)+'"\x3e'+z.G(a.note.author.name)+"\x3c/a\x3e":"\x3ci\x3e"+z.G(z.yD())+"\x3c/i\x3e")+'\x3c/div\x3e\x3cdiv class\x3d"notesContent"\x3e'+p7(z.M(z.Gx(String(a.note.content))))+"\x3c/div\x3e"+(c.isAuthenticated?'\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+
(d==c.currentUser.userId?z.M(z.vB({U:"button--notesTextAction",action:"edit-note",actionValue:a.note.noteId,text:"Edit"},c))+z.M(z.vB({isPrimary:!0,bB:!0,U:"button--editNotesAction",action:"save-note",actionValue:a.note.noteId,text:"Save"},c))+z.M(z.vB({U:"button--editNotesAction",action:"cancel-note",actionValue:a.note.noteId,text:"Cancel"},c))+z.M(z.vB({U:"button--editNotesAction",action:"delete-note",actionValue:a.note.noteId,text:"Delete"},c)):"")+"\x3c/div\x3e":"")+"\x3c/div\x3e");var e=a.note.replies.length,
g=Math.max(a.note.replies.length-a.hn,0);if(e){b+='\x3cdiv class\x3d"notesReplies '+(0<g?"notesReplies--hidden":"")+'"\x3e\x3cdiv class\x3d"notesReplies-inner"\x3e';if(0<g){b+=z.M(z.vB({U:"button--hiddenNotesReplies",action:"show-hidden-note-replies",text:(0,z.Q)("View "+z.G(g)+(a.hn?" more":"")+(1<g?" replies":" reply"))},c))+'\x3cdiv class\x3d"notesReplies-container"\x3e';for(var h=a.note.replies,k=h.length,m=0;m<k;m++){var q=h[m];b+=m<g?N7(z.J(a,{Df:q}),c):""}b+="\x3c/div\x3e"}h=a.note.replies;
k=h.length;for(m=0;m<k;m++)q=h[m],b+=m>=g?N7(z.J(a,{Df:q}),c):"";b+="\x3c/div\x3e\x3c/div\x3e"}b+='\x3cdiv class\x3d"notesReplies-footer"\x3e'+(c.isAuthenticated?'\x3cdiv class\x3d"notesReply notesReply--creator is-notesEditMode"\x3e\x3cdiv class\x3d"notesAvatar"\x3e'+z.M(z.JD({user:c.currentUser},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e\x3ca href\x3d"/@'+z.N(c.currentUser.username)+'" title\x3d"Go to the profile of '+z.N(c.currentUser.name)+'"\x3e'+z.G(c.currentUser.name)+'\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"notesReply-editor notesEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+
z.M(z.vB({isPrimary:!0,bB:!0,U:"button--editNotesAction",action:"save-reply",actionValue:a.note.noteId,text:"Save"},c))+z.M(z.vB({U:"button--editNotesAction",action:"cancel-reply",actionValue:a.note.noteId,text:"Cancel"},c))+"\x3c/div\x3e\x3c/div\x3e":"")+z.M(z.vB({isPrimary:!0,U:"button--notesReplyLink",action:"start-reply",source:"new_note_reply",actionValue:a.note.noteId,ec:!0,title:"Leave a reply",text:(0,z.Q)(""+(e||!a.note.author?"Reply to conversation":d==c.currentUser.userId?"Leave a reply":
"Reply to "+z.G(a.note.author.name)))},c))+"\x3c/div\x3e\x3c/div\x3e";return(0,z.I)(b)};
var N7=function(a,b){return(0,z.I)('\x3cdiv class\x3d"notesReply"\x3e'+(a.Im&&(null==a.Df.author?null:a.Df.author.userId)!=b.currentUser.userId?'\x3cdiv class\x3d"notesReply-hider" data-action\x3d"hide-reply" data-action-value\x3d"'+z.N(a.note.noteId)+","+z.N(a.Df.replyId)+'" data-tooltip\x3d"Dismiss this reply"\x3e\x3cspan class\x3d"icon icon--remove"\x3e\x3c/span\x3e\x3c/div\x3e':"")+'\x3cdiv class\x3d"notesAvatar"\x3e'+z.M(z.JD({user:a.Df.author},b))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e'+
(a.Df.author?'\x3ca href\x3d"/@'+z.N(a.Df.author.username)+'" title\x3d"Go to the profile of '+z.N(a.Df.author.name)+'"\x3e'+z.G(a.Df.author.name)+"\x3c/a\x3e":"\x3ci\x3e"+z.G(z.yD())+"\x3c/i\x3e")+'\x3c/div\x3e\x3cdiv class\x3d"notesContent"\x3e'+p7(z.M(z.Gx(String(a.Df.content))))+"\x3c/div\x3e"+(b.isAuthenticated?a.Df.author&&a.Df.author.userId==b.currentUser.userId?'\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+z.M(z.vB({U:"button--notesTextAction",action:"edit-reply",actionValue:z.L(""+
a.note.noteId+","+(""+a.Df.replyId)),text:"Edit"},b))+z.M(z.vB({isPrimary:!0,bB:!0,U:"button--editNotesAction",action:"save-reply",actionValue:a.Df.replyId,text:"Save"},b))+z.M(z.vB({U:"button--editNotesAction",action:"cancel-reply",actionValue:a.Df.replyId,text:"Cancel"},b))+z.M(z.vB({U:"button--editNotesAction",action:"delete-reply",actionValue:a.Df.replyId,text:"Delete"},b))+"\x3c/div\x3e":"":"")+"\x3c/div\x3e")};
var Jga=function(a){var b="";if(10<a.count)b+='\x3cdiv class\x3d"slideIndicator-fraction"\x3e1 of '+z.G(a.count)+"\x3c/div\x3e";else if(1<a.count){b+='\x3cul class\x3d"slideIndicators"\x3e';a=a.count;for(var c=0;c<a;c++)b+='\x3cli class\x3d"slideIndicator"\x3e\x3c/li\x3e';b+="\x3c/ul\x3e"}return(0,z.I)(b)};
var O7=function(a,b,c,d){z.XA.call(this);this.O0=a;this.cb=b;this.hc=null;this.Ag=c;this.Ia=d;a=window.document.createElement("div");a.className="notesMarkers";z.jf(a,this.O0);this.Rn=a;this.mf={};this.lq=this.Hq=null};
var P7=function(a,b){var c=Q7(a.cb,b),d=a.hc?R7(a.hc,b):[],e=c?c.sb():0,g=0,h=!1,k=!1,m={},q={};c.Sd(function(a){var b=a.mA();b&&((a=m7(a))&&a.forEach(function(a){g++;a.author&&(a.author.userId==z.Fk().userId&&(h=!0),a.author.social&&a.author.social.isFollowing&&(m[a.author.userId]=a.author))}),q[b.userId]=!0,b.userId==z.Fk().userId&&(h=!0),b.social&&b.social.isFollowing&&(m[b.userId]=b))});c=z.x.Ja();c.enable_quotes&&c.combined_margin_quotes&&d.forEach(function(a){a=a.user;q[a.userId]=!0;a.userId==
z.Fk().userId&&(k=!0);a.social&&a.social.isFollowing&&!m[a.userId]&&(m[a.userId]=a)});return{postId:a.Ia,Ho:b,Zj:e+g,eB:h,Es:d.length,sB:k,gQ:Object.keys(q).length,u3:z.Eb(m)}};
var S7=function(a,b,c){var d=a.Ag.get(b);if(d){var e=a.mf[b];e&&(z.zd(e,"is-active",c),c="left"==z.$p(d,"float")?0:-1*z.qq(d,"margin").right,e.style.left=(767>=window.innerWidth||0!==c?c:10)+"px",a=z7(a.Ag,b))&&(b=z.Sv(a.className),z.zd(e,"is-notesSourceFloated",2==b||4==b),z.zd(e,"u-hide",z.bz(a,!1)),b=3==b,z.zd(e,"is-notesSourceOutsetCenter",b),a=b||7==z.cI(a),z.zd(e,"is-withoutSocialLine",a))}};
var Kga=function(a){var b={};A7(a.Ag,function(a,d){if(!(d in b)){var e;e=z.fq(a,this.Rn).y+z.rq(a).top;b[d]=e}},a);return b};var T7=function(a){var b=Kga(a),c={};A7(a.Ag,function(a,d){if(!c[d]){var h;if(this.mf[d])h=this.mf[d];else{h=P7(this,d);var k=z.Ky(Gga,h);this.Rn.appendChild(k);if(0<h.Zj||0<h.Es)z.u(a,"is-withNotes"),z.u(k,"is-withNotes");h=this.mf[d]=k}h.style.top=b[d]+"px";S7(this,d,d==this.cb.Va);c[d]=!0;D7(this.Ag,h,a)}},a);for(var d in a.mf)c[d]||(z.lf(a.mf[d]),delete a.mf[d])};
var U7=function(a,b,c){z.VA.call(this);this.nM={};this.CL={};this.iu={};this.jm=null;this.ca=a;this.ri=a.get("request");this.L=a.get("routeBuilder");this.ea=a.get("modelStore");this.Ia=b;this.KM=0;this.Ul=c;this.SK=!1;this.Cg=null;this.Va=""};var Q7=function(a,b){var c=a.nM[b];c||(c=a.nM[b]=new z.i1,a.S("new_note_list",c,a));return c};var Lga=function(a){var b=z.Fk().userId;return a.uH().find(function(a){return a.Lj()==b})};
var Mga=function(a,b){if(!b)return!1;var c=b.X();if(a.content==c.substring(a.startIndex,a.endIndex))return!0;var d=new RegExp(z.Ma(a.content),"gi"),e=d.exec(c),c=e&&d.exec(c);return e&&!c?(c=a.endIndex-a.startIndex,a.startIndex=e.index,a.endIndex=e.index+c,a.content=e[0],!0):!1};var V7=function(a,b){b=z.EH(a.ea,b);Q7(a,b.yc()).add(b)};
var Nga=function(a,b,c){var d=b.gb(),e=Q7(a,b.yc()),g=e?e.indexOf(b):-1,h=b.Rj();b.Xf(c);"HIDDEN"==c?a.ea.remove(b):b=z.EH(a.ea,b);var k=e?e.indexOf(b):-1;return{he:a.ri.put(z.w(a.L,z.tba,{postId:a.Ia,noteId:d}),{state:c},{json:!0}),LR:function(){b.Xf(h);-1==k&&(-1==g?e.add(b):e.wi(b,g))}}};var Oga=function(a,b,c){return a.ri.put(z.w(a.L,z.wba,{postId:a.Ia,noteId:c,replyId:b}),{state:"HIDDEN"},{json:!0})};
var W7=function(a,b,c){this.range=a;this.anchor=b;this.Ho=b.getAttribute("name");this.highlight=c};var X7=function(a,b,c,d,e){F7.call(this,a,b,"Leave a reply",200,d);this.L=a.get("routeBuilder");this.Ia=c;this.Ry=e||null};var Y7=function(a){z.mo.call(this);var b=z.Bp();this.Hg=b&&new Z7(z.Aq(b,!0),a);this.jj=b&&new Z7(z.Aq(b,!1),a)};var Z7=function(a,b){this.Ve=a;this.CV=b;var c=z.eI(a.node,b);this.xK=(this.zg=c)&&c.getAttribute("name");this.ky=c?z.xz(a,c):-1};
var $7=function(a){var b=window.document.body;return z.uf(b,a.Ve.node)?a.Ve:a.zg&&z.uf(b,a.zg)?z.yz(a.ky,a.zg):a.xK&&(b=z.vz(a.CV,a.xK))?z.yz(a.ky,b):null};
var a8=function(a,b,c){z.VA.call(this);this.BB=a;this.screen=a.get("screen");this.Ya=a.get("screenService");this.lG=a.get("app");this.oe=b;this.BN=this.oe.$a().clone();var d;(d=this.oe.$a().oi)&&d.subscribe(z.aZ,this.rL,this);this.zd={};this.Ic=[];this.xG=a.get("butter-bar");this.gv=a.get("dialog");this.rc=b=b.rc;this.WL=0;d=b.querySelector(".js-notesSource");this.anchors=new y7(d);var e=z.Xe("div","layoutSingleColumn notesPositionContainer");z.kf(this.rc,e,0);this.Q4=e;e=window.document.createElement("div");
e.className="notesContainer";z.Jy(e,Hga);this.Q4.appendChild(e);this.Nf=e;this.Nz=b.querySelector(".js-postField");this.Jc=this.Nf.querySelector(".notesList");this.pn=z.jz(d);this.isAuthenticated=!!z.Hk();this.Im=c;this.data=new U7(a,this.oe.aa(),this.oe.Ul);this.data.subscribe("new_note_list",this.OY,this);this.hc=null;if(this.Eo=a.get("voteWidget"))a=this.Eo,c=this.data,a.pE=c,a.Sa()&&(c=c.load(),z.p(z.jd(z.tT(a),c),a.sK,a));this.Id=new O7(this.Nf,this.data,this.anchors,this.oe.aa());this.Id.N();
this.Jb=new z.TA;this.dv=z.p(this.data.load(),this.sI,this);z.QM(this.Id.Rn).J("select-anchor",this.tI,this);z.QM(this.Nf).J("show-hidden-note-replies",this.dR,this).J("start-reply",this.uZ,this).J("save-reply",this.hZ,this).J("edit-reply",this.qY,this).J("cancel-reply",this.TX,this).J("delete-reply",this.gY,this).J("approve-note",this.OX,this).J("unapprove-note",this.EZ,this).J("edit-note",this.pY,this).J("save-note",this.gZ,this).J("cancel-note",this.SX,this).J("delete-note",this.eY,this).J("hide-note",
this.xY,this);this.Ya.subscribe("historyUpdate",this.xM,this)};var Pga=function(a){if(a.ne&&a.ne.HA())return!0;for(var b in a.zd)if(a.zd[b].HA())return!0;return!1};var Qga=function(a){var b=new z.ad,c=a.gv.open({title:(0,z.I)("Uh oh!"),bodyHtml:(0,z.I)("You have unsaved notes. Are you sure you want to abandon them?"),type:z.W5});c?(c.subscribe(z.YU,b.kb.bind(b,!0)),c.subscribe(z.ZU,function(){this.iP();b.cancel()},a)):b.cancel();return b};
var b8=function(a){z.qo(a.ne);a.ne=null;for(var b in a.zd)z.qo(a.zd[b]),delete a.zd[b]};
var c8=function(a,b,c){var d=b.Rj(),e="PUBLIC"==c?(0,z.I)("Note was made public."):"HIDDEN"==c?(0,z.I)("Note was dismissed."):"NEW"==c?(0,z.I)("Note was made private."):"",g=Nga(a.data,b,c);z.r(z.p(g.he,function(){z.p(this.xG.N(e,{type:z.DW,Lw:!0}),function(){g.LR();c8(this,b,d)},this);d8(this,z.Vca,b,{noteState:c,previousNoteState:d})},a),function(a){this.xG.N((0,z.I)("Could not change note state"),z.NT);g.LR();(400>a.status||499<a.status)&&c8(this,b,d)},a);return g.he};
var e8=function(a,b){var c=b.value;return c?a.zd[c]:a.ne};var Rga=function(a,b){var c=a.oe.qg(a.anchors.get(b));return{text:c.X(),image:4==c.type?c.Td():null}};
var f8=function(a,b){var c=b||a.Ch,d=a.data.Dd(c,a.data.Va),e=a.Jc.querySelector('[data-note-id\x3d"'+c+'"]');z.u(e,"is-showingNotesReplyCreator");var g=a.zd["reply_"+c];g||(e=e.querySelector(".notesReply-editor"),g=new X7(a.BB,e,a.oe.aa(),c),g.subscribe("change",a.Pk,a),g.subscribe("cancel",function(){g.Yc("")},a),g.subscribe("save",function(a){g.Yc("");m7(d).push(a);d8(this,z.Wca,d,{replyId:a.Ud()});w7(this.Vi,d)},a),a.zd["reply_"+c]=g);g.focus()};
var d8=function(a,b,c,d){d=d||{};d.postId=a.oe.aa();d.noteId=c.gb();d.noteType=c.Li()?"highlight":"paragraph";z.T(b,d)};var g8=function(a,b,c){var d=z.Bp(),d=d&&B7(a.anchors,z.zo(d)),e=c&&d&&new Y7(d);z.p(h8(a,b&&b.anchor||a.data.Va),function(){if(b!=this.Dj){var a=this.Dj;a&&i8(this,a,!1);b&&i8(this,b,!0);this.Dj=b}(a=e&&e.restore())&&a.select()},a)};
var i8=function(a,b,c){var d=b.anchor,e=z7(a.anchors,d);if(e=a.oe.qg(e)){z.bu(e,4);if(c){if(!Mga(b,e))return;z.Yt(e,z.tu(b.startIndex,b.endIndex,b.id))}a.anchors.get(d).innerHTML=z.Xw(e,z.x,{mode:a.oe.Ul?"edit":"view",isPublished:!!a.oe.$a().Uk(),media:null,sections:!0,Ui:!1,yi:!1,rf:!1})}};
var j8=function(a,b,c){if(b!=a.Ch){c||z.HU(a.lG,"");(c=a.Jc.querySelector(".is-activeNote"))&&z.v(c,"is-activeNote");c=a.Ch=null;if(b&&a.data.Va){var d=a.data.Dd(b,a.data.Va);d&&(c=a.Jc.querySelector('[data-note-id\x3d"'+b+'"]'))&&(z.u(c,"is-activeNote"),a.Ch=b,b=(b=d.Li())?a.data.Mr(b):null,g8(a,b||null))}z.zd(a.Jc,"notesItem--selected",!!c)}};
var h8=function(a,b){a.WL=(0,z.Oa)();var c=b!=a.data.Va;if(c&&Pga(a))return z.p(Qga(a),function(){b8(this);return h8(this,b)},a);a.Dj&&(i8(a,a.Dj,!1),a.Dj=null);if(!c)return z.pd();j8(a,null);a.data.Va&&S7(a.Id,a.data.Va,!1);b8(a);z.qo(a.Vi);a.Vi=null;z.u(a.Jc,"is-hidingNotesEditor");a.data.Va=b&&a.Id.mf[b]?b:"";a.data.Va?a.Vu():a.OG();a.Pk();return z.pd()};
var k8=function(a,b,c,d){(b=z7(a.anchors,b))&&(0,z.Tb)(b.querySelectorAll(".markup--quote"),function(a){var b=a.getAttribute("data-creator-ids").split(" "),b=z.bb(b,c);z.zd(a,"is-selected",d&&b)},a)};
var l8=function(a,b){if(a.isAuthenticated){z.qo(a.ne);var c=a.query(".notesItemEditor"),d=null,e=null;if("string"==typeof b)d=b;else if(b instanceof W7)e=b.highlight,d=e.anchor;else throw Error("Missing assoc for note editor");c.innerHTML="";a.ne=new H7(a.BB,c,a.oe.aa());Dga(a.ne,d,Rga(a,d));e&&Ega(a.ne,e.startIndex,e.endIndex,e.content);a.ne.subscribe("change",a.Pk,a);a.ne.subscribe("save",a.rI,a);a.ne.subscribe("cancel",function(){Q7(this.data,d).sb()?z.u(this.Jc,"is-hidingNotesEditor"):h8(this,
null);j8(this,null)},a);z.v(a.Jc,"is-hidingNotesEditor")}};
var m8=function(a,b,c,d){a8.call(this,a,b,c);this.jo=z.cB(a.get("screen"));this.eb=a.get("dom-monitor");this.eb.subscribe("resize-end",this.ry,this);this.eb.subscribe("inner-resize-end",this.ry,this);this.ue=a.get("element-tracker");z.QM(this.Nf).J("hide-reply",this.yY,this).J("start-note",this.tZ,this).J("show-note-permalink",this.rZ,this);d&&(d.subscribe("highlight",this.wM,this),this.Qc=d);[this.anchors.Rq].forEach(function(a){this.Ic.push(z.Ry(a,"click",this.lZ,this))},this);this.jy=new z.rT;
this.jy.N();z.po(this,z.sa(z.qo,this.jy));yga(this.jy,this.cX.bind(this));this.jy.subscribe("dismiss",this.jY,this)};var n8=function(a){if(a.ne){var b=a.jo,c=b.scrollTop,d=b.scrollLeft;a.ne.focus();b.scrollTop=c;b.scrollLeft=d}};var o8=function(a,b){for(var c=b?1:-1,d=a.parentNode.childNodes,e=d.length,g=(0,z.db)(d,a),h=z.GI(a,0),k=z.$q(h),h=1!=z.Qh(h),m=a,g=g+c;0<=g&&g<e;g+=c){var q=d[g];if("SECTION"===q.tagName){var t=z.GI(q,0),A=z.$q(t),t=1!=z.Qh(t);if(k!=A||t||h)break;else m=q}}return m};
var p8=function(a){var b=a.Nz.querySelectorAll(".js-is-spacedForNoteList"),c=!1;(0,z.zb)(b,function(a){a.style.paddingBottom="";a.style.paddingTop="";z.v(a,"js-is-spacedForNoteList");c=!0});c&&(T7(a.Id),a.ue.il())};var q8=function(a,b){g8(a,b.highlight);r8(a,{scroll:!0,dk:!0});l8(a,b);a.ne&&n8(a);a.S("show")};var Sga=function(a){return!!z.dz(a,function(a){a=z.oI(a);return 3==a||7==a})};var s8=function(a,b){Q7(a.data,b).sb()||(l8(a,b),a.ne&&n8(a))};
var t8=function(a,b){z.p(h8(a,b),function(){s8(this,b);p8(this);u8(this,{scroll:!0,dk:!0});this.Jc.style.top=Math.round(z.iz(this.Id.mf[b]))+"px";this.Pk()},a)};var Tga=function(a,b,c){if(!a.data.Va)return z.pd(!0);p8(a);var d=z.iz(b);c&&(d-=z.hz(c,a.Jc).y);d=Math.round(d+z.rq(b).top);a.Jc.style.top=d+"px";a.Pk();if(1>Math.abs(a.Jc.offsetTop-d)||!(0,z.h5)())return z.pd(!0);b=new z.ad;z.Qy(a.Jc,z.N3,b.kb.bind(b,a));return b};
var v8=function(a,b,c){var d=a.anchors.get(a.data.Va);if(!a.isAuthenticated){var e=a.data.Va,e=a.Dj?e+("--highlight-"+a.Dj.startIndex+"-"+a.Dj.endIndex):e+"--newNote";a.Jc.querySelector(".button--addNotes").setAttribute("data-redirect",z.aS.xH()+"#"+e)}d&&(e=d.querySelector(".markup--highlight"),d=c.dk&&e?e:d,(e=z.dz(b,function(a){return z.vd(a,"js-notesList")}))&&(b=e),a=Tga(a,d,b),c.scroll&&z.p(a,function(){z.qz(b,z.yfa)}))};
var r8=function(a,b){var c=a.Jc.querySelector(".newNoteEditor");c&&v8(a,c,b)};var w8=function(a,b,c){b=a.Jc.querySelector('[data-note-id\x3d"'+b+'"]');v8(a,b,c)};var u8=function(a,b){if(a.data.Va){var c=Q7(a.data,a.data.Va),d=c.sb();(c=d?c.Uo(0).gb():null)?(1==d&&j8(a,c),b.dk=!1,w8(a,c,b)):r8(a,b)}};var x8=function(a,b){return b==a.data.Va?z.p(h8(a,null),z.BM):z.p(h8(a,b),z.fc(!!b))};
var y8=function(a,b,c){var d=z.If(b.target,"notesItem");!d||b.relatedTarget&&z.uf(d,b.relatedTarget)||!(b=a.data.Dd(d.getAttribute("data-note-id"),a.data.Va))||(d=null,c?d=b.Li():a.Ch&&(d=a.data.Dd(a.Ch,a.data.Va).Li()),g8(a,d?a.data.Mr(d):null,a.oe.Ul))};var z8=function(a){z.mo.call(this);this.ca=a};var A8=function(a,b){z.VA.call(this);this.ca=a;this.bc=b;this.jt()};var B8=function(a){a=z.Zp(a.bc,"transform").match(/translate3d\(([^,]*)/);return(0,window.parseInt)(a?a[1]:0,10)};
var C8=function(a,b,c,d){var e=b!=a.fz;a.fz=b;a.ly=b*a.gz;z.Wp(a.bc,"transition-duration",c);z.Wp(a.bc,"transform","translate3d("+a.ly+"px,0,0)");if(e||d){c=b=Math.abs(b);d=a.bc.children;if(10<d.length){if(e=a.bc.parentNode.getElementsByClassName("slideIndicator-fraction")[0])e.innerHTML=c+1+" of "+d.length}else if(d=a.bc.parentNode.getElementsByClassName("slideIndicators")[0])(e=d.getElementsByClassName("is-active")[0])&&z.v(e,"is-active"),(e=d.children[c])&&z.u(e,"is-active");a.S("slide",b,a)}};
var D8=function(a,b,c){a8.call(this,a,b,c);this.oM=this.query(".notesItems");this.bD=a.get("diagnostics");this.bc=new A8(a,this.oM);this.bc.subscribe("slide",this.AM,this);this.Bg=this.ez=null;z.QM(this.Nf).J("dismiss-note",this.sE,this).J("toggle-note-dropdown",function(a){z.Ed(a.target,"is-open")});this.Ic.push(z.Ry(this.Nf,"click",this.vM,this));this.Ic.push(z.Ry(this.Nz,"click",this.vM,this));this.Ic.push(z.Ry(this.Nf,"focusout",this.vY,this))};
var E8=function(a,b){if(a.Dj){var c=a.Nz.querySelector(".markup--highlight"),d=a.Jc.querySelector(".is-activeNote");if(d&&c){var d=window.innerHeight-d.offsetHeight+20,e=c.offsetHeight,c=z.iz(c);e<d&&(c-=(d-e)/2);a.Bg&&a.Bg.cancel();b?a.Bg=new z.gW(a.pn,"scrollTop",200,Math.max(c,0)):z.gz(a.pn,0,c)}}};var F8=function(a,b){a.bc.enable();z.p(h8(a,b),function(){var a=Q7(this.data,this.data.Va).sb();this.ez=z.Ky(Jga,{count:a});this.Jc.appendChild(this.ez);C8(this.bc,0,"0",!0)},a)};
var G8=function(a){z.mo.call(this);this.ca=a};var H8=function(a,b){z.mo.call(this);this.Ca=a.get("modelRequest");this.ea=a.get("modelStore");this.Ty=a.get("request");this.L=a.get("routeBuilder");this.Ia=b;this.yd=null;this.Xq={};this.sj=new z.i1;this.sj.subscribe("add",this.UN,this);this.sj.subscribe("remove",this.UN,this);z.po(this,z.sa(z.qo,this.sj))};var Uga=function(a,b,c,d){return(0,z.xd)(a.Xq[b.name]||[],function(a){return a.Xb()==c&&a.Ac()==d})};var R7=function(a,b){return I8(a,a.Xq[b]||[])};
var Vga=function(a,b,c,d){b=Uga(a,b,c,d);return I8(a,b)};var J8=function(a,b,c,d,e){return z.p(a.create(b,c,d,0,e),function(a){this.sj.add(a);return a},a)};var K8=function(a,b,c,d){return(a=L8(a,b,c,d))&&a.ua()==z.Fk().userId?a:null};var L8=function(a,b,c,d){a=a.Xq[b.name]||[];if(!a.length)return null;b=null;for(var e=0;e<a.length;e++){var g=a[e];if(!(c<g.Xb()||d>g.Ac())&&(b&&"anon"!=b.ua()||(b=g),g.ua()==z.Fk().userId))return g}return b};
var Wga=function(a){var b=a.pb()[0].name,c=a.$a().Za().bodyModel.paragraphs;return c?z.Wa(c,function(a){return a.name==b}):(z.S("Malformed post data for quote: "+JSON.stringify(a.Fb())),null)};var M8=function(a,b){return q7(b,function(a){return a.pb()[0].getName()},a)};var I8=function(a,b){b=b.filter(function(a){return"anon"!=a.ua()});var c=q7(b,function(a){return a.ua()},a);return z.Eb(c).map(function(a){return new Xga(a[0].Cc(),a)},a)};var Xga=function(a,b){this.user=a;this.quotes=b};
var N8=function(a,b,c){z.XA.call(this);this.hc=new H8(a,b.aa());z.po(this,z.sa(z.qo,this.hc));var d=this.hc.sj;d.subscribe("add",this.cN,this);d.subscribe("remove",this.cN,this);this.ub=b;this.rc=b.ej;this.ki=c;this.ki.Bw(this.hc);this.UK=[];this.xa=a.get("app");this.la=a.get("popover");this.L=a.get("routeBuilder");this.wD=a.get("global-event-bus")};
var O8=function(a,b,c,d){var e=P8(a,b);e&&(c=z.hY(z.TR(z.VR(z.iY(z.UR(z.WR(a.la),Fga,e),"top"),c),"popover--dark popover--quoteAttributions"),d).N())&&(c.Ee("deactivate",function(){this.Kk===b&&Q8(this,null)},a),c.Zk().J("quote",a.vW.bind(a,c)).J("quote-respond",a.wW.bind(a,c)))};
var P8=function(a,b){if("anon"==b.ua())return{Sa:!1,D3:!0};var c=R8(a,b),d=b.Xb(),e=b.Ac(),c=Vga(a.hc,c,d,e);if(!c||!c.length)return null;c=(0,z.Tb)(c,function(a){return a.user});d=(0,z.xd)(c,function(a){return a.userId!=z.Fk().userId});return{Sa:(0,z.ld)(c,function(a){return a.userId==z.Fk().userId}),social:d,df:c.length}};var Yga=function(a,b){var c=a.rc.querySelectorAll('.markup--quote[name~\x3d"'+b.Ze()+'"]');return z.ib(c)};
var R8=function(a,b){var c=b.pb()[0].name;return(c=z.vz(a.rc,c))?a.ub.qg(c):null};var S8=function(a,b){var c=z.Dp(b);return(c=z.QW(a.ki,c))?L8(a.hc,c.Yr,c.start,c.end):null};var Q8=function(a,b){a.Kk!==b&&(a.Kk&&T8(a,a.Kk,!1),b&&T8(a,b,!0),a.Kk=b)};var T8=function(a,b,c){Yga(a,b).map(function(a){z.zd(a,"is-targeted",c)})};var U8=function(a,b){var c=b.pb(),d=z.vz(a.rc,c[0].getName()),c=z.vz(a.rc,z.Va(c).getName());(d=z.yM(d,b.Xb(),c,b.Ac()))&&z.UM(a.pg(),d)};
var V8=function(a,b,c,d){z.T(c?z.p5:z.$ca,{postId:a.ub.aa(),quoteId:b,source:d})};var W8=function(a){this.ca=a};z.cW.prototype.HA=z.Y(172,function(){return this.Ln.trim()!=this.Za().trim()});z.lP.prototype.eJ=z.Y(170,function(a){a!=this.Px&&this.La&&(this.La.De.contentEditable=a);this.Px=a});z.Ri.prototype.Pj=z.Y(141,function(){return z.B(this,"quotes")});z.nk.prototype.Pj=z.Y(140,function(){return z.B(this,"quotes")});z.vm.prototype.Pj=z.Y(139,function(){return z.B(this,"quotes")});
z.Bm.prototype.Pj=z.Y(138,function(){return z.B(this,"quotes")});z.J1.prototype.Pj=z.Y(137,function(a){return z.p(this.R.get(z.w(this.L,z.S4,{postId:a}),{background:!0,json:!0}),this.Fc.bind(this,z.wm))});z.rh.prototype.zw=z.Y(93,function(a){return z.C(this,"highlight",a)});z.rh.prototype.Mr=z.Y(92,function(){return z.B(this,"highlight")});z.rh.prototype.vw=z.Y(91,function(a){return z.C(this,"author",a)});z.th.prototype.vw=z.Y(90,function(a){return z.C(this,"author",a)});
z.rh.prototype.Li=z.Y(89,function(){return z.B(this,"highlightId")});z.wh.prototype.Li=z.Y(88,function(){return z.B(this,"highlightId")});z.Xi.prototype.Li=z.Y(87,function(){return z.B(this,"highlightId")});z.rh.prototype.Wi=z.Y(86,function(a){return z.C(this,"authorId",a)});z.th.prototype.Wi=z.Y(85,function(a){return z.C(this,"authorId",a)});z.Xi.prototype.Wi=z.Y(84,function(a){return z.C(this,"authorId",a)});z.Yi.prototype.Wi=z.Y(83,function(a){return z.C(this,"authorId",a)});
z.$m.prototype.Wi=z.Y(82,function(a){return z.C(this,"authorId",a)});z.rh.prototype.Lj=z.Y(81,function(){return z.B(this,"authorId")});z.th.prototype.Lj=z.Y(80,function(){return z.B(this,"authorId")});z.Xi.prototype.Lj=z.Y(79,function(){return z.B(this,"authorId")});z.Yi.prototype.Lj=z.Y(78,function(){return z.B(this,"authorId")});z.$m.prototype.Lj=z.Y(77,function(){return z.B(this,"authorId")});z.Ng.prototype.Xf=z.Y(47,function(a){return z.C(this,"state",a)});
z.rh.prototype.Xf=z.Y(46,function(a){return z.C(this,"state",a)});z.th.prototype.Xf=z.Y(45,function(a){return z.C(this,"state",a)});z.Xi.prototype.Xf=z.Y(44,function(a){return z.C(this,"state",a)});z.Yi.prototype.Xf=z.Y(43,function(a){return z.C(this,"state",a)});z.tk.prototype.Xf=z.Y(42,function(a){return z.C(this,"state",a)});z.uk.prototype.Xf=z.Y(41,function(a){return z.C(this,"state",a)});z.Gg.prototype.Ud=z.Y(33,function(){return z.B(this,"replyId")});
z.Hg.prototype.Ud=z.Y(32,function(){return z.B(this,"replyId")});z.th.prototype.Ud=z.Y(31,function(){return z.B(this,"replyId")});z.xh.prototype.Ud=z.Y(30,function(){return z.B(this,"replyId")});z.Yi.prototype.Ud=z.Y(29,function(){return z.B(this,"replyId")});z.lk.prototype.Ud=z.Y(28,function(){return z.B(this,"replyId")});z.nk.prototype.Ud=z.Y(27,function(){return z.B(this,"replyId")});z.Mk.prototype.Ud=z.Y(26,function(){return z.B(this,"replyId")});
z.Wk.prototype.Ud=z.Y(25,function(){return z.B(this,"replyId")});z.Gg.prototype.gb=z.Y(24,function(){return z.B(this,"noteId")});z.Hg.prototype.gb=z.Y(23,function(){return z.B(this,"noteId")});z.Kg.prototype.gb=z.Y(22,function(){return z.B(this,"noteId")});z.rh.prototype.gb=z.Y(21,function(){return z.B(this,"noteId")});z.th.prototype.gb=z.Y(20,function(){return z.B(this,"noteId")});z.wh.prototype.gb=z.Y(19,function(){return z.B(this,"noteId")});
z.xh.prototype.gb=z.Y(18,function(){return z.B(this,"noteId")});z.Xi.prototype.gb=z.Y(17,function(){return z.B(this,"noteId")});z.Yi.prototype.gb=z.Y(16,function(){return z.B(this,"noteId")});z.Zi.prototype.gb=z.Y(15,function(){return z.B(this,"noteId")});z.lk.prototype.gb=z.Y(14,function(){return z.B(this,"noteId")});z.nk.prototype.gb=z.Y(13,function(){return z.B(this,"noteId")});z.Mk.prototype.gb=z.Y(12,function(){return z.B(this,"noteId")});z.Wk.prototype.gb=z.Y(11,function(){return z.B(this,"noteId")});
z.ql.prototype.gb=z.Y(10,function(){return z.B(this,"noteId")});var o7=/^[@＠][a-z0-9_]{1,15}$/i;z.n(r7,z.XA);z.f=r7.prototype;z.f.cM=function(a){return a.Fb()};z.f.Uu=null;z.f.WC=null;z.f.ga=function(){return this.Ka};z.f.V=function(){r7.H.V.call(this);z.YA(this,this.fi,"change",this.bY,this);z.YA(this,this.fi,"add",this.HY,this);z.YA(this,this.fi,"remove",this.IY,this);t7(this,!0)};z.f.ka=function(){this.Ka.innerHTML="";delete this.Ka;r7.H.ka.call(this)};z.f.getData=function(){return this.fi};
z.f.HY=function(a,b){if(this.Sa())for(var c=0;c<a.length;c++){var d=b.indexOf(a[c]),d=u7(this,a[c],d);this.S("after-draw",a[c],d)}};z.f.IY=function(a){if(this.Sa()){var b=this.Ka.querySelector("#"+x7(this,a));this.S("before-clear",a,b);this.S("destroy",a,b);z.lf(b)}};z.f.bY=function(a){for(var b=0;b<a.length;b++)w7(this,a[b])};y7.prototype.get=function(a){return z7(this,a)};z.n(E7,z.jY);E7.prototype.zs="bottom";E7.prototype.Is=function(){var a=z.w(this.xB,z.X4,{},{source:"typeahead",q:this.query.substring(1)});return this.request.get(a,{json:!0})};z.n(F7,z.lP);z.f=F7.prototype;z.f.jF=!1;z.f.Ln="";z.f.Du=0;z.f.rp=z.k4;z.f.HA=function(){return this.Ln.trim()!=this.Za().trim()};z.f.gb=function(){return this.IX};z.f.save=function(){this.Za().length<=this.qh&&this.ho()};z.f.RG=function(){this.uO()&&(0,window.confirm)(this.oP())?(z.r(this.ri.ie(this.yH()),z.nR(this.Z,(0,z.I)("Sorry, your attempt to delete failed. Please try again."))),this.S("delete")):G7(this)};z.f.Na=function(){(0,window.clearTimeout)(this.Du);F7.H.Na.call(this)};
z.f.V=function(){function a(a){a.stopPropagation()}F7.H.V.call(this);this.Ln=this.Za();this.Yc(this.Ln);this.rr(13,this.uE,this);this.rr(27,this.vE,this);this.La.za("blur",this.tE,!1,this);var b=this.La.ga();z.Ry(b,"keydown",a);z.Ry(b,"keyup",a);z.Ry(b,"keypress",a)};z.f.Ds=function(a){return a};
z.f.ho=function(){if(this.isEnabled()){var a=this.Za().trim();if(a){this.eJ(!1);var b=this.yH(),c=this.zP(),a=this.AP(a);z.hd(z.r(z.p(this.ri.send(c,b,a,{json:!0}),this.QY,this),z.nR(this.Z,(0,z.I)("Saving failed. You may be having connectivity issues or notes might be disabled on this post. Please try again."))),this.eJ.bind(this,!0))}else z.Oq(this.RG,this)}};z.f.QY=function(a){a=z.nW(a.value,a.references);this.S("save",this.Ds(a))};
z.f.uE=function(a){if(this.ym&&z.lY(this.ym))return!1;a.shiftKey||(a.preventDefault(),this.save());return!0};z.f.vE=function(a){if(this.ym&&z.lY(this.ym))return!1;a.preventDefault();G7(this);return!1};z.f.tE=function(){this.jF&&(this.Za().length>=this.qh?(0,window.confirm)(this.DP())?G7(this):this.focus():this.Du=(0,window.setTimeout)(this.ho.bind(this),100))};z.n(H7,F7);z.f=H7.prototype;z.f.zC=null;z.f.wK=null;z.f.AC=null;z.f.PD=null;z.f.OD=null;z.f.BL=null;z.f.oP=function(){return(0,z.I)("Are you sure you want to delete this note?")};z.f.DP=function(){return(0,z.I)("Your note is too long; do you want to abandon your changes?")};z.f.uO=function(){return!!this.gb()};
z.f.Ds=function(a){var b=z.Hy();return(new z.rh({postId:a.postId,anchor:a.anchor,noteId:a.noteId,content:a.content,state:a.state,createdAt:a.createdAt,replies:[],highlight:a.highlight||null,highlightId:a.highlightId||null})).vw(b).Wi(b.ua())};z.f.zP=function(){return this.gb()?"put":"post"};z.f.yH=function(){return this.gb()?z.w(this.L,z.sba,{postId:this.Ia,noteId:this.gb()}):z.w(this.L,z.qba,{postId:this.Ia})};
z.f.AP=function(a){a={content:a};this.zC&&(a.anchor=this.zC,a.anchorContent=this.wK,a.anchorImage=this.AC?this.AC.Fb():null);null!=this.PD&&null!=this.OD&&(a.highlightStart=this.PD,a.highlightEnd=this.OD,a.highlightContent=this.BL);return a};z.n(O7,z.XA);z.f=O7.prototype;z.f.Bw=function(a){this.hc=a;Object.keys(a.Xq).map(this.Nw,this);a=a.sj;a.subscribe("add",this.VN,this);a.subscribe("remove",this.VN,this)};z.f.VN=function(a){Object.keys(M8(this.hc,a instanceof Array?a:[a])).map(this.Nw,this)};z.f.Nw=function(a){if(this.cb.Pi()){var b=a||this.cb.Va;if(a=this.mf[b]){var b=P7(this,b),c=z.x.Ja();c.enable_quotes&&c.combined_margin_quotes?(z.Jy(a,L7,b),z.zd(a,"is-withNotes",0<b.Zj||0<b.Es)):(z.Jy(a,L7,b),z.zd(a,"is-withNotes",0<b.Zj))}}};
z.f.MX=function(a){if(a=C7(this.Ag,a.target)){var b=z7(this.Ag,a),c=this.mf[a];!c||c===this.Hq||!b||z.bz(b,!1)||z.vd(b,"graf--layoutInsetLeft")||z.vd(b,"graf--layoutOutsetLeft")||(this.Hq&&z.v(this.Hq,"is-highlighted"),z.u(c,"is-highlighted"),this.Hq=c,z.qo(this.lq),this.lq=new z.OT(b),this.lq.Nb(c),this.lq.N(),this.lq.Ee("dismiss",function(){z.v(c,"is-highlighted");this.Hq===c&&(this.Hq=null)},this))}};
z.f.V=function(){O7.H.V.call(this);z.Ly()||[this.Ag.Rq].forEach(function(a){this.za(a,"mouseover",this.MX)},this)};z.f.Na=function(){z.qo(this.lq);z.lf(this.Rn);this.mf=this.Rn=null;O7.H.Na.call(this)};z.n(U7,z.VA);z.f=U7.prototype;z.f.load=function(){this.Cg||(this.Cg=z.r(z.p(this.ri.get(z.w(this.L,z.rba,{postId:this.Ia}),{json:!0,background:!0}),this.i_,this),z.S));return this.Cg.Bb()};z.f.Pi=function(){return this.SK};z.f.vA=function(){return this.KM};z.f.qg=function(a){var b=a&&a.getAttribute("name");if(!b||!a)return null;var c=this.iu[b];return c&&!this.Ul?c:this.iu[b]=z.LI(a)};z.f.Mr=function(a){return this.CL[a]||null};z.f.Dd=function(a,b){return Q7(this,b).Fr(a)};
z.f.uH=function(){return Q7(this,"vote")};z.f.zw=function(a,b){this.CL[a]=b};z.f.aa=function(){return this.Ia};
z.f.i_=function(a){var b=a.references.User;this.jm=b[a.post.creatorId];this.KM=a.post.visibility;var c=a.value;if(c)for(var d=0;d<c.length;d++){var e=c[d];if("HIDDEN"!=e.state){var g=e.replies,h=b;if(g)for(var k=0;k<g.length;k++){var m=g[k],q=m.authorId||null;m.author=q&&h[q]||null}g=e.anchor;h=e.authorId||null;e.author=h&&b[h]||null;g=Q7(this,g);e=z.sh(e);g.add(z.EH(this.ea,e))}}if(a=a.highlights)for(b=0;b<a.length;b++)this.zw(a[b].id,z.Vg.rb(z.vh,a[b]));this.SK=!0};
z.f.ha=function(){this.Cg.cancel();U7.H.ha.call(this)};z.n(X7,F7);z.f=X7.prototype;z.f.oP=function(){return(0,z.I)("Are you sure you want to delete this reply?")};z.f.DP=function(){return(0,z.I)("Your reply is too long; do you want to abandon your changes?")};z.f.uO=function(){return!!this.Ry};z.f.Ds=function(a){var b=z.Hy();return(new z.th({postId:a.postId,noteId:a.noteId,replyId:a.replyId,content:a.content,createdAt:a.createdAt})).vw(b).Wi(b.ua())};z.f.zP=function(){return this.Ry?"put":"post"};
z.f.yH=function(){return this.Ry?z.w(this.L,z.vba,{postId:this.Ia,noteId:this.gb(),replyId:this.Ry}):z.w(this.L,z.uba,{postId:this.Ia,noteId:this.gb()})};z.f.AP=function(a){return{content:a}};z.n(Y7,z.so);Y7.prototype.qw=function(){if(!this.Hg)return null;var a=$7(this.Hg);if(!a)return null;var b=$7(this.jj);return b?z.cp(a.node,a.offset,b.node,b.offset):null};z.n(a8,z.VA);z.f=a8.prototype;z.f.ne=null;z.f.Ch=null;z.f.Dj=null;z.f.Vi=null;z.f.hn=0;z.f.ha=function(){b8(this);h8(this,null);var a;(a=this.oe.$a().oi)&&a.unsubscribe(z.aZ,this.rL,this);this.Ya.unsubscribe("historyUpdate",this.xM,this);this.lM&&z.Sy(this.lM);z.Sy(this.Ic);this.Ic.length=0;z.EP(this.Id.Rn);z.EP(this.Nf);z.lf(this.Nf);this.data.Tc();this.dv&&this.dv.cancel();z.qo(this.Id);z.qo(this.Jb);this.lM=this.hc=this.dv=this.data=this.Nf=this.anchors=this.Id=null;a8.H.ha.call(this)};
z.f.Bw=function(a){this.hc=a;this.Id.Bw(a)};z.f.rL=function(){var a=this.oe.$a();z.x.Ja().enable_recommend_notes&&this.BN.ep()!=a.ep()&&(this.BN=a.clone(),!a.ep()&&(a=Lga(this.data)))&&(d8(this,z.o5,a),this.data.uH().remove(a))};z.f.sI=function(){};z.f.gB=function(){};z.f.rI=function(a){a.Mr()&&(this.data.zw(a.Li(),a.Mr()),a.zw(null));V7(this.data,a);d8(this,z.Tca,a)};z.f.tI=function(){};z.f.cR=function(){};z.f.Pk=function(){};z.f.iP=function(){};z.f.JV=function(a){return a.Fb()};
z.f.uZ=function(a){f8(this,a.value)};z.f.hZ=function(a){(a=this.zd["reply_"+a.value])&&a.save()};z.f.TX=function(a){var b=this.zd["reply_"+a.value];b&&G7(b);(a=z.If(a.target,"notesItem"))&&z.v(a,"is-showingNotesReplyCreator")};
z.f.qY=function(a){function b(){var a=this.data.Dd(d,this.data.Va);w7(this.Vi,a);z.v(g,"is-notesEditMode");z.qo(h);delete this.zd["reply_"+e]}var c=a.value.split(","),d=c[0],e=c[1],c=z.If(a.target,"notesItem"),g=z.If(a.target,"notesReply");z.u(g,"is-notesEditMode");z.v(c,"is-showingNotesReplyCreator");a=g.querySelector(".notesContent");var h=new X7(this.BB,a,this.oe.aa(),d,e);h.subscribe("save",function(a){for(var c=this.data.Dd(d,this.data.Va),g=m7(c),h=0;h<g.length;h++)if(g[h].Ud()==e){g[h]=a;break}d8(this,
z.Xca,c,{replyId:e});b.call(this)},this);h.subscribe("delete",function(){for(var a=this.data.Dd(d,this.data.Va),c=m7(a),g=0;g<c.length;g++)if(c[g].Ud()==e){z.fb(c,g);break}d8(this,z.Yca,a,{replyId:e});b.call(this)},this);h.subscribe("cancel",function(){b.call(this)},this);h.subscribe("change",this.Pk,this);h.focus(1);this.zd["reply_"+e]=h};z.f.gY=function(a){(a=this.zd["reply_"+a.value])&&a.RG()};
z.f.PX=function(a){a=a.gb();this.zd[a]&&(z.qo(this.zd[a]),delete this.zd[a]);this.zd["reply_"+a]&&(z.qo(this.zd["reply_"+a]),delete this.zd["reply_"+a])};z.f.LX=function(a,b){z.v(b,"is-showingNotesReplyCreator");b.setAttribute("data-note-id",a.gb())};z.f.OX=function(a){z.r(c8(this,this.data.Dd(a.value,this.data.Va),"PUBLIC"),z.nR(this.gv,(0,z.I)("Sorry, we couldn’t approve the note. Please try again later and make sure you are logged in.")))};
z.f.EZ=function(a){z.r(c8(this,this.data.Dd(a.value,this.data.Va),"NEW"),z.nR(this.gv,(0,z.I)("Sorry, we couldn’t unapprove the note. Please try again later and make sure you are logged in.")))};
z.f.pY=function(a){function b(){z.v(d,"is-notesEditMode");z.qo(g);delete this.zd[c]}var c=a.value,d=z.If(a.target,"notesItem");z.u(d,"is-notesEditMode");z.v(d,"is-showingNotesReplyCreator");var e=d.querySelector(".notesContent"),g=new H7(this.BB,e,this.oe.aa(),a.value);g.subscribe("save",function(a){V7(this.data,a);d8(this,z.Uca,a);b.call(this)},this);g.subscribe("delete",function(){var a=Q7(this.data,this.data.Va),d=a.Fr(c);d8(this,z.o5,d);a.remove(d);b.call(this)},this);g.subscribe("cancel",function(){var a=
this.data.Dd(c,this.data.Va);w7(this.Vi,a);b.call(this)},this);g.subscribe("change",this.Pk,this);g.focus(1);this.zd[c]=g};z.f.gZ=function(a){(a=e8(this,a))&&a.save()};z.f.SX=function(a){(a=e8(this,a))&&G7(a)};z.f.eY=function(a){(a=e8(this,a))&&a.RG()};z.f.PY=function(a){for(var b=0;b<a.length;b++)this.Id.Nw(a[b].yc())};z.f.xY=function(a){var b=a.value,c=this.data.Dd(b,this.data.Va);z.r(z.p(c8(this,c,"HIDDEN"),function(){this.gB(c);this.Ch==b&&(this.Ch=null)},this),z.nR(this.gv,(0,z.I)("Sorry, we couldn’t hide the note. Please try again later and make sure you are logged in.")))};
z.f.OY=function(a){a.subscribe("add",this.PY,this);a.subscribe("change",this.cR,this);a.subscribe("remove",this.gB,this)};z.f.query=function(a){return this.Nf.querySelector(a)};z.f.Zp=function(){T7(this.Id);this.Id.mf[this.data.Va]||h8(this,null)};z.f.dR=function(a){this.sJ(a)};z.f.sJ=function(a){(a=z.If(a.target,"notesReplies"))&&z.v(a,"notesReplies--hidden")};
z.f.Vu=function(){var a=this.data.Va,b=this.query(".notesItems"),c=Q7(this.data,a),d=z.x.Ja();if(d.enable_quotes&&d.combined_margin_quotes){var a=this.hc?R7(this.hc,a):[],d=this.query(".js-quotesList"),e=z.Ky(J7,{NI:a});z.mf(e,d);z.Ly()||z.Ry(e,"mouseover",this.AW,this);a.length||z.Cz(e)}b=new r7(b,c,Iga);b.RL="notesItem";b.cM=this.JV.bind(void 0);t7(b);this.Vi=s7(b,{Im:this.Im,HI:this.data.jm,hn:this.hn});this.Vi.subscribe("before-clear",this.PX,this);this.Vi.subscribe("after-draw",this.LX,this);
this.Vi.N();S7(this.Id,this.data.Va,!0);z.u(this.screen.W(),"is-notesListVisible");z.OA(z.Sca)};z.f.AW=function(a){if((a=z.dz(a.target,function(a){return!!a.getAttribute("data-quote-ids")},a.currentTarget))&&this.oK!=a){this.An&&this.An.TO();var b=this.data.Va,c=a.getAttribute("data-quote-creator-id");this.oK=a;this.An=new z.OT(z7(this.anchors,b),300);this.An.Nb(a);this.An.subscribe("dismiss",function(){k8(this,b,c,!1);z.qo(this.An);this.An=this.oK=null},this);this.An.N();k8(this,b,c,!0)}};
z.f.OG=function(){z.HU(this.lG,"");z.v(this.screen.W(),"is-notesListVisible")};z.f.getSelection=function(a){var b=z.Bp();if(!b||b.isCollapsed())if(a&&(b=a),!b||b.isCollapsed())return null;a=z.zo(b);var c=B7(this.anchors,a);if(!c)return null;c=(a=z.dz(a,z.gI,c))&&this.oe.qg(a);if(!a)return null;var d=z.wz(b,a,!0),e=z.wz(b,a,!1);return-1==d||-1==e?null:new W7(b,a,new z.vh({anchor:a.getAttribute("name"),startIndex:d,endIndex:e,content:c.X().substring(d,e)}))};z.f.xM=function(){this.Mz(z.tX())};z.n(m8,a8);z.f=m8.prototype;z.f.hn=3;z.f.Tl=!1;z.f.Qc=null;
z.f.sI=function(){var a=(0,z.Oa)();this.dv=null;this.Tl=!0;var b=z.tX();this.Zp();if(this.isAuthenticated){var c=this.data.jm.userId===z.Fk().userId;z.zd(this.Jc,"is-notesCreator",c)}z.c6(this.query(".js-notesPostCreator"),this.data.jm.name);this.Mz(b);this.Ic.push(z.Ry(this.Nf,"mouseover",this.$X,this));this.Ic.push(z.Ry(this.Nf,"mouseout",this.ZX,this));this.Ic.push(z.Ry(this.Jc,"click",this.UX,this));this.Ic.push(z.Ry(this.Nz,z.N3,this.BE,this));z.PA("notes.renderMarkers",(0,z.Oa)()-a)};
z.f.Mz=function(a){if(a.Tf&&this.Id.mf[a.Tf])if("highlight"==a.Km){t8(this,a.Tf);var b=this.anchors.get(a.Tf),c=a.startIndex,d=a.endIndex;if(z.ia(c)&&z.ia(d)){var e=z.yM(b,c,b,d);e&&(b=new W7(e,b,new z.vh({anchor:a.Tf,startIndex:c,endIndex:d,content:e.X()})),q8(this,b))}}else a.noteId?(z.p(h8(this,a.Tf),function(){s8(this,a.Tf)},this),j8(this,a.noteId,!0),w8(this,a.noteId,{scroll:!0,dk:!0}),"reply"==a.Km&&f8(this)):"newNote"==a.Km&&t8(this,a.Tf)};
z.f.rI=function(a){m8.H.rI.call(this,a);this.ne.Yc("");j8(this,a.gb());z.u(this.Jc,"is-hidingNotesEditor")};z.f.iP=function(){var a={scroll:!0,dk:!0};if(this.ne)r8(this,a),n8(this);else{var b;a:{b=this.zd;for(var c in b){b=b[c];break a}b=void 0}if(c=b&&b.gb())j8(this,c),w8(this,c,a),b.focus()}};z.f.Vu=function(){m8.H.Vu.call(this);D7(this.anchors,this.Nf,this.anchors.get(this.data.Va))};
z.f.Pk=function(){var a=this.jo.scrollTop;p8(this);var b=(0,window.parseInt)(this.Jc.style.top,10);if(!(0,window.isNaN)(b)){var c=this.data.Va;if(c=c?this.anchors.get(c):null)if(c=z.fI(c,B7(this.anchors,c))){var d=o8(c,!1),c=o8(c,!0),e=!1,g=z.iz(d);b<g&&(e=g-b,d.style.paddingTop=z.rq(d).top+e+"px",this.Jc.style.top=b+e+"px",z.u(d,"js-is-spacedForNoteList"),e=!0);b+=this.Jc.offsetHeight;d=z.iz(c)+c.offsetHeight;b>d&&(b-=d,c.style.paddingBottom=z.rq(c).bottom+b+"px",z.u(c,"js-is-spacedForNoteList"),
e=!0);this.jo.scrollTop=a;e&&(T7(this.Id),this.ue.il())}}};z.f.tI=function(a){z.p(x8(this,a.value),function(a){a&&(this.data.Va&&Q7(this.data,this.data.Va).sb()||((a=this.getSelection())&&a.highlight.anchor==this.data.Va?(g8(this,a.highlight),l8(this,a)):l8(this,this.data.Va),this.ne&&n8(this),this.S("show")),u8(this,{scroll:!0,dk:!0}))},this)};z.f.gB=function(a){this.Id.Nw(a.yc());a.gb()==this.Ch&&g8(this,null)};z.f.sJ=function(a){z.v(z.If(a.target,"notesReplies"),"notesReplies--hidden");this.Pk()};
z.f.lZ=function(a){if(!this.oe.Ul&&!Sga(a.target)&&(z.Ly()||this.data.Va)){var b=this.getSelection();if(!b||b.Ho!=this.data.Va){if(this.data.Va&&z.Ly())return h8(this,null);500>(0,z.Oa)()-this.WL||(a=C7(this.anchors,a.target),z.p(x8(this,a),function(a){var b=this.data.Va;a&&b&&(s8(this,b),u8(this,{scroll:!0,dk:!0}))},this))}}};z.f.ry=function(){this.Zp()};
z.f.cX=function(a){if(!this.data.Va)return!1;a=a.target;return z.zz(a)?!0:!!z.dz(a,function(a){return a==this.Jc||a==this.Id.Rn||this.Qc&&a==this.Qc.ga()||a.getAttribute("data-action")&&"zoom"!=a.getAttribute("data-action")}.bind(this))};z.f.jY=function(){this.data.Va&&h8(this,null)};z.f.rZ=function(a){z.HU(this.lG,a.value)};z.f.$X=function(a){y8(this,a,!0)};z.f.ZX=function(a){y8(this,a,!1)};z.f.wM=function(){if(!this.Qc)return!1;var a=this.getSelection(this.Qc.wo);z.RM(this.Qc);a&&q8(this,a);return!1};
z.f.yY=function(a){a=a.value.split(",");var b=a[0],c=a[1];z.r(z.p(Oga(this.data,c,b),function(){for(var a=m7(this.data.Dd(b,this.data.Va)),e=0;e<a.length;e++)if(a[e].Ud()==c){z.fb(a,e);break}d8(this,z.Zca,this.data.Dd(b,this.data.Va),{replyId:c});this.xG.N((0,z.I)("The reply has been dismissed."),z.DW)},this),z.nR(this.gv,(0,z.I)("Sorry, we couldn’t hide the reply. Please try again later and make sure you are logged in.")))};
z.f.UX=function(a){a=a.target;var b=z.If(a,"notesItem");if(b){var c=b.getAttribute("data-note-id");c==this.Ch?z.dz(a,function(a){return!!a.getAttribute("data-action")||z.vd(a,"editable")},b,!0)==b&&j8(this,null):(j8(this,c),w8(this,c,{scroll:!0,dk:!0}))}};z.f.tZ=function(){var a=this.getSelection();j8(this,null);a&&g8(this,a.highlight);l8(this,a||this.data.Va);this.ne&&(a&&r8(this,{scroll:!0,dk:!0}),n8(this))};
z.f.BE=function(a){(a=a.target.getAttribute("name"))&&z7(this.anchors,a)&&S7(this.Id,a,a==this.data.Va)};z.f.Zp=function(){if(this.Tl){if(this.uf)return z.S(Error("UpdatePositions called after dispose"));m8.H.Zp.call(this);var a={scroll:!1,dk:!0};this.Ch?w8(this,this.Ch,a):u8(this,a)}};z.f.x4=function(){if(this.data.Va){var a=this.anchors.get(this.data.Va);if(!a)h8(this,null);else if(!this.oe.Ul){var b=z.Bp();b&&(b=z.zo(b),z.uf(a,b)||h8(this,null))}}};
z.f.ha=function(){this.eb.unsubscribe("resize-end",this.ry,this);this.eb.unsubscribe("inner-resize-end",this.ry,this);this.Qc&&this.Qc.unsubscribe("highlight",this.wM,this);m8.H.ha.call(this)};z.n(z8,z.mo);z8.prototype.GG=function(a,b,c,d){return new m8(a.wa(),b,c,d)};z.n(A8,z.VA);z.f=A8.prototype;z.f.hu=0;z.f.GE=0;z.f.pk=0;z.f.aD=0;z.f.ly=0;z.f.XL=0;z.f.qo=0;z.f.gF=1;z.f.gz=0;z.f.fz=0;z.f.lN=0;z.f.ei=void 0;z.f.Wa=[];z.f.jt=function(){this.Wa.length||(this.Wa=[z.Ry(this.bc,"touchstart",this.DZ,this),z.Ry(this.bc,"touchmove",this.AE,this),z.Ry(this.bc,"touchend",this.CZ,this)])};
z.f.DZ=function(a){var b=this.bc.firstChild;this.aD=this.pk=0;this.lN=b.offsetWidth*this.bc.children.length;this.ei=void 0;this.gz=this.bc.offsetWidth;this.gF=1;this.XL=-(this.bc.children.length-1);this.qo=+new Date;this.hu=a.touches[0].pageX;this.GE=a.touches[0].pageY;z.Wp(this.bc,"transition-duration",0)};
z.f.AE=function(a){1<a.touches.length||(this.pk=a.touches[0].pageX-this.hu,this.aD=a.touches[0].pageY-this.GE,this.hu=a.touches[0].pageX,this.GE=a.touches[0].pageY,"undefined"==typeof this.ei&&(this.ei=Math.abs(this.aD)>Math.abs(this.pk)),this.ei||(this.ly=this.pk/this.gF+B8(this),a.preventDefault(),this.gF=0===this.fz&&0<this.pk?this.hu/this.gz+1.25:this.fz==this.XL&&0>this.pk?Math.abs(this.hu)/this.gz+1.25:1,z.Wp(this.bc,"transform","translate3d("+this.ly+"px,0,0)")))};
z.f.CZ=function(){if(!this.ei){var a=1E3>+new Date-this.qo&&15<Math.abs(this.pk)?0>this.pk?-1:1:0,b=Math[a?0>this.pk?"ceil":"floor":"round"](B8(this)/(this.lN/this.bc.children.length)),b=Math.min(b+a,0),b=Math.max(-(this.bc.children.length-1),b);C8(this,b,".2s")}};z.f.disable=function(){z.Wp(this.bc,"transition-duration","0");z.Wp(this.bc,"transform","translate3d(0,0,0)");z.Sy(this.Wa);this.Wa=[]};z.f.enable=A8.prototype.jt;z.n(D8,a8);z.f=D8.prototype;z.f.ha=function(){this.oM=null;this.bc&&(this.bc.disable(),this.bc.unsubscribe("slide",this.AM,this),this.bc=null);this.Bg&&(this.Bg.cancel(),this.Bg=null);D8.H.ha.call(this)};z.f.Vu=function(){D8.H.Vu.call(this);l7(this.bD,!0)};z.f.OG=function(){l7(this.bD,!1);D8.H.OG.call(this)};
z.f.sI=function(){this.dv=null;var a=(0,z.Oa)(),b=z.tX();this.Zp();if(this.isAuthenticated){var c=this.data.jm.userId===z.Fk().userId;z.zd(this.Jc,"is-notesCreator",c)}z.c6(this.query(".js-notesPostCreator"),this.data.jm.name);this.Mz(b);z.PA("notes.renderMarkers",(0,z.Oa)()-a)};z.f.Mz=function(a){a.Tf&&this.Id.mf[a.Tf]&&a.noteId&&this.data.Dd(a.noteId,a.Tf)&&F8(this,a.Tf)};z.f.cR=function(){};
z.f.dR=function(a){this.sJ(a);z.u(this.pn,"is-showingNotesReplies");this.bc.disable();s7(this.Vi,{Im:this.Im,HI:this.data.jm,hn:window.Infinity})};z.f.tI=function(a){a=a.value;this.Id.mf[a]&&(a==this.data.Va?h8(this,null):F8(this,a))};z.f.gB=function(a){this.Id.Nw(a.yc());if(!this.data.Va||!Q7(this.data,this.data.Va).sb())return this.sE();C8(this.bc,0,"0")};z.f.vY=function(){E8(this,!0)};z.f.vM=function(a){this.data.Va&&!z.uf(this.Jc,a.target)&&(a.stopPropagation(),this.sE())};
z.f.AM=function(a){if(a=Q7(this.data,this.data.Va).Uo(a)){j8(this,a.gb());if(!a.Li()){a=a.yc();var b=this.anchors.get(a),b=z.Zy(b);g8(this,new z.vh({anchor:a,startIndex:0,endIndex:b.length-1,content:b}),!0)}E8(this,!0)}};
z.f.sE=function(){z.vd(this.pn,"is-showingNotesReplies")?z.vd(this.pn,"is-showingNotesReplies")&&(z.u(this.Jc.querySelector(".is-activeNote .notesReplies"),"notesReplies--hidden"),z.v(this.pn,"is-showingNotesReplies"),this.bc.enable(),C8(this.bc,0,"0",!0),E8(this,!1),s7(this.Vi,{Im:this.Im,HI:this.data.jm,hn:this.hn})):z.p(h8(this,null),function(){z.v(this.pn,"is-showingNotesReplies");z.v(this.pn,"is-newNoteEditorActivated");z.v(this.Nf,"is-showingNewNoteEditor");z.v(this.screen.W(),"is-notesListVisible");
l7(this.bD,!1);this.ez&&z.lf(this.ez);this.bc.disable();this.Zp()},this)};z.n(G8,z.mo);G8.prototype.GG=function(a,b,c){return new D8(a.wa(),b,c)};z.n(H8,z.mo);z.f=H8.prototype;z.f.load=function(){this.yd||(this.yd=z.p(this.Ca.Pj(this.Ia),this.hW,this));return this.yd.Bb()};z.f.toggle=function(a,b,c,d){var e=L8(this,a,b,c);return e&&e.ua()==z.Fk().userId?this.remove(e):e&&d?J8(this,a,e.Xb(),e.Ac(),!d):J8(this,a,b,c,!0)};z.f.N2=function(a,b,c){var d=K8(this,a,b,c);return d?z.pd(d):(d=L8(this,a,b,c))?J8(this,a,d.Xb(),d.Ac(),!1):J8(this,a,b,c,!0)};
z.f.create=function(a,b,c,d,e){if(e){for(;" "==z.Rt(a,b)&&c>b+1;)b++;for(;" "==z.Rt(a,c-1)&&c>b+1;)c--}return z.p(this.Ty.post(z.w(this.L,z.S4,{postId:this.Ia}),{paragraphs:[a.rb().Fb()],startOffset:b,endOffset:c,quoteType:d},{json:!0}),function(a){return z.EH(this.ea,z.Ni(a.value))},this)};z.f.remove=function(a){this.sj.remove(a);this.ea.remove(a);return z.p(this.Ty.ie(z.w(this.L,z.xba,{postId:this.Ia,quoteId:a.Ze()})),function(){return a},this)};
z.f.hW=function(a){z.BH(this.ea,a);a=(a.value||[]).filter(this.sX,this);this.sj.addAll(a);return this.sj};z.f.sX=function(a){var b=a.pb()[0],c=Wga(a)||{};c instanceof z.Ch||(c=z.Vg.rb(z.Ch,c));if(b.X()==c.X())return!0;var b=b.X().substring(a.startOffset,a.endOffset),d=c.X().indexOf(b);return-1<d?(a.startOffset=d,a.endOffset=d+b.length,a.paragraphs=[c],!0):!1};z.f.UN=function(){this.Xq=M8(this,this.sj.Sc())};z.n(N8,z.XA);z.f=N8.prototype;z.f.pg=function(){return this.ki.pg()};z.f.V=function(){N8.H.V.call(this);z.YA(this,this.wD,"data-redirect-type-quote",this.cY,this);this.za(this.rc,"click",this.Mt,this);z.VW(this.ub)&&z.Oy()&&this.za(this.rc,"mouseover",this.nW,this);z.r(this.hc.load(),z.S);var a=this.pg();a&&(z.YA(this,a,"quote",this.iW,this),z.YA(this,a,"quote-respond",this.jW,this),z.YA(this,a,"show",this.SF,this),z.YA(this,a,"hide",this.zY,this))};
z.f.cY=function(a){var b=z.QW(this.ki,this.pg().wo);b&&(a.url=new z.Kd(z.w(this.L,z.yba,{postId:this.ub.aa()},{paragraphs:JSON.stringify([b.Yr.rb().Fb()]),startOffset:b.start,endOffset:b.end})))};z.f.Mt=function(a){z.dz(a.target,function(a){if(a===this.rc)return!0;var c=z.oI(a);if(3==c)return!0;if(7==c){if(c=S8(this,a))if(Q8(this,c),z.Oy())U8(this,c);else{var d=new z.rT;O8(this,c,a,d)}return!0}return!1}.bind(this))};
z.f.nW=function(a){z.dz(a.target,function(a){if(a===this.rc)return!0;var c=z.oI(a);if(3==c)return!0;if(7==c){c=z.Bp();if(!(c&&!c.isCollapsed()||this.pg()&&this.pg().up())&&(c=S8(this,a))){var d=this.rc.querySelector('.markup--quote[name~\x3d"'+c.Ze()+'"]');a=new z.OT(a,100);O8(this,c,d,a);Q8(this,c)}return!0}return!1}.bind(this))};
z.f.SF=function(){var a=z.Bp();a&&!a.isCollapsed()&&Q8(this,null);if(z.VW(this.ub)&&(a=z.QW(this.ki,this.pg().wo))){var a=K8(this.hc,a.Yr,a.start,a.end),b=this.pg().ga().querySelector(".js-highlightMenuQuoteButton");z.zd(b,"is-active",!!a)}};z.f.zY=function(){this.Kk&&Q8(this,null)};
z.f.iW=function(){if(z.VW(this.ub)){var a=z.NM(this.pg());if(a){var b=a.range,c=a.e4,a=this.pg().ga().querySelector(".js-highlightMenuQuoteButton"),d=z.vd(a,"is-active"),b=z.QW(this.ki,b);z.r(z.p(this.hc.toggle(b.Yr,b.start,b.end,!c),function(a){z.Gp();d?z.RM(this.pg()):U8(this,a);var b=c?"selection_menu":"quote_click_menu";V8(this,a.Ze(),!d,b)},this),z.S)}}};
z.f.jW=function(){if(z.WW(this.ub)){var a=z.NM(this.pg());a&&(a=z.QW(this.ki,a.range),z.r(z.p(this.hc.create(a.Yr,a.start,a.end,1,!0),function(a){V8(this,a.Ze(),!0,"selection_menu_quote_respond");this.xa.navigate(z.w(this.L,z.Lx,{},{inResponseToQuoteId:a.quoteId}))},this),z.S))}};
z.f.vW=function(a){var b=this.Kk,c=R8(this,b),d=b.Xb(),e=b.Ac(),b=a.query(".js-quoteAttributions-pileOn"),g=z.vd(b,"is-active");z.r(z.p(this.hc.toggle(c,d,e,!0),function(b){var k=a.query(".js-quoteAttributions-pileOn");z.Ed(k,"is-active");if(k=L8(this.hc,c,d,e)){var m=P8(this,k),q=a.query(".js-quoteAttributions-info");z.Jy(q,K7,m)}else a.ob();!g&&z.Oy()&&(a.ob(),U8(this,k));k=z.Oy()?"quote_hover":"quote_click_mobile";V8(this,b.Ze(),!g,k)},this),z.S)};
z.f.wW=function(){if(z.WW(this.ub)){var a=R8(this,this.Kk),b=this.Kk.Xb(),c=this.Kk.Ac();z.r(z.p(this.hc.create(a,b,c,1,!0),function(a){V8(this,a.Ze(),!0,"quote_respond");this.xa.navigate(z.w(this.L,z.Lx,{},{inResponseToQuoteId:a.quoteId}))},this),z.S)}};
z.f.cN=function(){var a=new Y7(this.rc),b=this.hc.Xq,c=Object.keys(b).concat(this.UK);z.qb(c);c.forEach(function(a){var c=b[a]||[],g=this.ub;if(g=(a=g.rc&&z.vz(g.rc,a))&&this.ub.qg(a))zga(g,c),a.innerHTML=z.Xw(g,z.x,z.YI)},this);this.UK=Object.keys(b);(a=a.restore())&&a.select()};W8.prototype.q2=function(a,b){return new N8(this.ca,a,b)};var X8=z.tU;X8.wa().scope("screen").add("notes",z8).add("notes-mobile",G8).add("quotes",W8);z.Z5(X8,"notes");}).call(this, _mdm);
