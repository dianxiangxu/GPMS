var SpectrumUtils={GetCart:function(){var a=this.GetCartFromPage();if(!a){a=new Cart();var c="";var b=this.GetOrderLimit();var d=0;a.Init(window.giPathID,c,d,b,true);}return a;},ClearInMemoryCart:function(){var a=this.GetCartFromPage();if(a){a.Items=[];a.Ct=undefined;}},GetCartFromPage:function GetInMemoryCartOnPage(){var a=null;if(!IsEo()&&window._cart&&window._cart.Cart){a=window._cart.Cart;}else{if(IsEo()){if(window._eoCart){a=window._eoCart.Cart;}else{window._eoCart=CartControllerFactory.CreateEoCart();a=window._eoCart.Cart;}if(a&&!a.HasSeenEO){a.LoadFromCookie(a.Path);}}else{if(window._cart){a=window._cart.Cart;}}}return a;},HasCartItems:function(){var b=0;var a=this.GetCart();if(a){b=a.CountOrderable();}return b>0;},PopulateOrder:function(c,b){var a=this.GetCart();if(a!=null&&a.CountOrderable()>0){a.ForEachItem(true,function(d){var e={OrderId:0,ProductId:d.Id,ProdName:c+"/"+d.Step+"/"+d.TabName+"/"+d.Name,OfferTypeId:d.OfferTypeId,UnitPrice:d.Price,Quantity:d.Quantity};b.Items.push(e);b.PathStepName=c+"/"+d.Step;});b.TotalOrderPrice=a.SubTotal();return;}b.TotalOrderPrice=0;},GetCookieValueAsMap:function(b){var a=GetCookie(b);if(!a||a==null||a==""){return{};}var c=a;if(a.indexOf(b)>-1){c=a.substr(b.length+1);if(c==null||c==""){c=a;}}var e=c.split("^");var f={};if(e==null||e.length==0){var j=c.split("~");if(j&&j.length==2){f[j[0]]=j[1];}return f;}for(var g=0;g<e.length;g++){var h=e[g];var d=h.split("~");if(d&&d.length==2){f[d[0]]=d[1];}}return f;},IsMobile:function(){return window.spectrumDeviceType==="MOBILE";},GetSpectrumDeviceType:function(){return window.spectrumDeviceType?window.spectrumDeviceType:"DESKTOP";},GetSpectrumUserAgentId:function(){return parseInt(window.spectrumDeviceUserAgentId?window.spectrumDeviceUserAgentId:0);},ConvertHashtableToDelimitedString:function(b,d,c,f){if(!b){return"";}if(!d||!d.length){d="^";}if(!c||!c.length){c="~";}var a="";for(var e in b){if(!e||!b[e]){continue;}if(a.length!=0){a=a+d;}var g=f?escape(b[e]):b[e];a=a+e+c+g;}return a;},ParseValueAsHashtable:function(h,a,f,d){if(!h){return a;}if(!a){a={};}if(!f||!f.length){f="^";}if(!d||!d.length){d="~";}var g=new RegExp("[^\\"+d+"^\\"+f+"]+\\"+d+"[^\\"+f+"]*","g");var e=h.match(g);if(!e||!e.length){return a;}for(var b=0;b<e.length;b++){if(!e[b]||!e[b].length){continue;}var c=e[b].split(d);if(!c||c.length!=2){continue;}a[c[0]]=c[1];}return a;},UrlDecode:function(a){if(!a||!a.length){return"";}return decodeURIComponent((a+"").replace(/\+/g,"%20"));},GetUrlParams:function(a){a=a||{};if(!window.location.search||window.location.search.length<=0){return a;}var c=window.location.search.substring(1);SpectrumUtils.ParseValueAsHashtable(c,a,"&","=");for(var b in a){if(!b){continue;}if(!a[b]){continue;}a[b]=SpectrumUtils.UrlDecode(a[b]);}return a;},Trim:function(a){return $.trim(a);},IsLeap:function(a){return a%4==0&&(a%100!=0||a%400==0);},GetPageName:function(){var a=document.URL.substr(0,document.URL.indexOf(".aspx"));var c=a.lastIndexOf("/");if(c<0){c=a.lastIndexOf("\\");}var b=a.substr(c+1,a.length-c);return b;},GetAge:function(c){var e=new Date();var b=new Date(c);var a=e.getFullYear()-b.getFullYear();var d=e.getMonth()-b.getMonth();if(d<0||(d===0&&e.getDate()<b.getDate())){a--;}return a;},GetAgeOrDefault:function(a,b){if(!a||!a.length){return b;}return this.GetAge(a);},GetDaysBetween:function(a,b){var g=(window.SERVER_DATETIME&&window.SERVER_DATETIME.length>0)?new Date(window.SERVER_DATETIME):null;var f=new Date("01/01/0001 12:00:00 AM");var d=new Date(a);if(d.toString()==f.toString()){return NaN;}if(!b&&!g){return NaN;}var e=b?new Date(b):g;var c=Math.abs(e-d);return Math.round(c/(1000*60*60*24));},GetOrderLimit:function(){if(typeof iOrderLimit!=="undefined"){return iOrderLimit;}return window.SpectrumRegistrationCore?window.SpectrumRegistrationCore.GetOrderLimit():null;},GetBillMeOrderId:function(){return parseInt(GetCookie("order_"+window.giPathID));},InitializeUniNav:function(){if(!window.SpectrumUniNavController){return;}var a={IsIdentPage:window.SpectrumRegistrationCore.IsIdentPage(),IsUserRecognized:window.SpectrumRegistrationCore.IsUserRecognized()};window.SpectrumUniNavController.Initialize(a);window.SpectrumUniNavPresenter.Initialize(a);},ScrollEvent:{CurrentlyPlayingVideo:null,Init:function(){var a=SpectrumUtils.ScrollEvent;if(window.Notifications){window.Notifications.Subscribe("need-video-stopped",a.PauseCurrentlyPlayingVideo);}},SetCurrentlyPlayingVideo:function(a){SpectrumUtils.ScrollEvent.CurrentlyPlayingVideo=a;},PauseCurrentlyPlayingVideo:function(){var a=SpectrumUtils.ScrollEvent;a.PauseVideo(a.CurrentlyPlayingVideo);a.CurrentlyPlayingVideo=null;},PauseVideo:function(a){if(a){adUnits_PauseVideo(a);}}},StringFormat:function(){var c=arguments[0];for(var a=0;a<arguments.length-1;a++){var b=new RegExp("\\{"+a+"\\}","gm");c=c.replace(b,arguments[a+1]);}return c;},AddAkamaiQueryStringToUrl:function(a,d){var b=a!=null&&a.length>0;if(!b){return a;}var c=window._multipageSettings;return !c||!c.IsMobileOptimizationOn?a:(a+this.StringFormat("?output-quality={0}&output-format={1}&resize={2}",c.AkamaiOutputQuality,c.AkamaiOutputFormat,(d&&d=="MERCH")?c.AkamaiMerchResize:c.AkamaiMagResize));},GetOfferType:function(a){if(a.closest(".merch").length){return"MERCH";}return"MAG";},ParamsToUrl:function(c){if(!c){return"";}var b="";var a=0;for(var d in c){var e=c[d];if(!d||!c.hasOwnProperty(d)||!e){continue;}if(a>0){b=b+"&";}if(Array.prototype.isPrototypeOf(e)){e=e.join("&"+d+"=");}b=b+d+"="+e;a++;}return b;},AppendFusionKeyValueToArgument:function(a,c){if(!c||c.length<=0){return;}for(var b=0;b<c.length;b++){a[c[b].FusionKey]=c[b].FusionValue;}},ForwardFunctionCall:function(b,a){if(typeof a!=="function"){return null;}return function(){var c=a.apply(b,arguments);return c;};},SortCollection:function(a){return a&&typeof a.sort==="function"?a.sort():a;},GetMailId:function(){return window.pathData.CurrentStep.MailId;},GetLineupName:function(){return window.pathData.CurrentStep.LineupName;},GetTrackingToken:function(){return window.pathData.CurrentToken.Id;},GetUserAgentId:function(){return(window.SpectrumDeviceAnalyzerResponseDto)?window.SpectrumDeviceAnalyzerResponseDto.UserAgentProperties.UserAgentId:0;},GetPathAndStepName:function(){return"/"+window.pathData.Name+"/"+window.pathData.CurrentStep.Name;},GetEmailDomain:function(a){if(a.length<0||a.indexOf("@")<0){return"";}return a.split("@")[1];},HideProcessingLayer:function(){if($("#spinnerDiv").is(":visible")){if($("html").is(".ie8")){$("#spinnerDiv").fadeOut("slow");return;}$("#spinnerDiv").modal("hide");}},ShowProcessingLayer:function(){var a=$("#spinnerDiv");if(!a.length){a=$('<div id="spinnerDiv" class="modal fade"></div>');$("body").append(a);}if($("html").is(".ie8")){a.fadeIn(null,function(){a.css("filter","alpha(opacity=40)");});return;}$("#spinnerDiv").modal({backdrop:false});},CloneObject:function(a){return $.extend(true,{},a);}};function setVariables(c,d){var a=document.getElementById("hidVariableNames");var b=document.getElementById("hidVariableValues");alert(a.value);a.value="";b.value="";if(a!=null){for(i=0;i<c.length;i++){if(a.value.length==0){a.value=c[i];}else{a.value=a.value+","+c[i];}}}if(b!=null){for(i=0;i<d.length;i++){if(b.value.length==0){b.value=d[i];}else{b.value=b.value+","+d[i];}}}}function getVariables(c,d){var a=document.getElementById("hidVariableNames");var b=document.getElementById("hidVariableValues");c=a.value.split(",");d=b.value.split(",");}var arrSubmitEvents=[];var vIsProductPage=false;function fSubmitMe(){_globalSubmit=true;var vResult=true;vResult=typeof(Page_IsValid)!="undefined"?Page_IsValid:true;if(vIsProductPage==true&&vResult==true){vResult=fValOrderLimit();}if(vResult==true){for(var i=0;i<arrSubmitEvents.length;i++){vResult=eval(arrSubmitEvents[i]);if(vResult==false){break;}}}return vResult;}function fValOrderLimit(){var a=true;var c=document.getElementById("hidOrderLimit").value;var b=0;if(typeof iCount!="undefined"){b=b+iCount;}if(typeof checkCount!="undefined"){b=b+checkCount;}if(c>=b){a=true;}else{a=false;}if(a==false){alert("You exceeded the maximum number of products allowed. \n Please review your selections.");}return a;}function ishideSelectExist(){if(typeof(hideSelect)!="undefined"){hideSelect();}}function addLoadEvent(a){var b=window.onload;if(typeof window.onload!="function"){window.onload=a;}else{window.onload=function(){if(b){b();}a();};}}function addGlobalSubmit(){_globalSubmit=true;}function IsEo(){var a=$("body");return a.hasClass("eo")||a.hasClass("oForm");}function IsContestEntry(){return window.pathData.CurrentStep.IsContestEntry;}function IsSummaryTab(){return window.OrderMode==="SummaryTab";}function getCookieVal(c,b){if(arguments.length<2){b=";";}var a=document.cookie.indexOf(b,c);if(a==-1){a=document.cookie.length;}return unescape(document.cookie.substring(c,a));}function GetCookie(h,e){var b=h+"=";var a=b.length;var c=document.cookie.length;var f=0;while(f<c){var g=f+a;if(document.cookie.substring(f,g)==b){var d=getCookieVal(g);return(e)?decode64(d).replace(/[\u0000-\u0001]+/g,""):d;}f=document.cookie.indexOf(" ",f)+1;if(f==0){break;}}return null;}function SetCookie(c,f,b,d,a,e){document.cookie=c+"="+escape(f)+((b)?"; expires="+b.toGMTString():"")+((d)?"; path="+d:"")+((a)?"; domain="+a:"")+((e)?"; secure":"");}function DeleteCookie(c,d,b){var a=document.cookie&&document.cookie.match(c+"=");if(a&&a.length){document.cookie=c+"="+((d)?"; path="+d:"")+((b)?"; domain="+b:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT";}}function decode64(k){if(typeof noBase64Decode!="undefined"&&noBase64Decode==true){return k;}var l="";var b,c,d="";var e,f,g,h="";var j=0;var a=/[^A-Za-z0-9\+\/\=]/g;if(a.exec(k)){if(console){console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, ?+?, ?/?, and ?=?\nExpect errors in decoding.");}}k=k.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=keyStr.indexOf(k.charAt(j++));f=keyStr.indexOf(k.charAt(j++));g=keyStr.indexOf(k.charAt(j++));h=keyStr.indexOf(k.charAt(j++));b=(e<<2)|(f>>4);c=((f&15)<<4)|(g>>2);d=((g&3)<<6)|h;l=l+String.fromCharCode(b);if(g!=64){l=l+String.fromCharCode(c);}if(h!=64){l=l+String.fromCharCode(d);}b=c=d="";e=f=g=h="";}while(j<k.length);return l;}addLoadEvent(function(){if(!document.attachEvent){return;}$("a").each(function(){var a=this;if(a&&a.onclick==null){a.attachEvent("onclick",addGlobalSubmit);}});});var Notifications={Callbacks:{},Subscribe:function(c,a,d){var b=this.Callbacks[c];if(!b){b=[];this.Callbacks[c]=b;}b.push({callback:a,isCancellable:d});},Remove:function(d,b){if(!b||!b.callback){return;}var c=this.Callbacks[d];if(!c){return;}var a=-1;for(var e=0;e<c.length;e++){if(!c[e]||!c[e].callback||c[e].callback!=b.callback){continue;}a=e;break;}if(a<=-1){return;}c.splice(a,1);},Notify:function(e,g,a){var c=this.Callbacks[e];if(!c){return NotificationResults.Continue;}for(var f=0;f<c.length;f++){var d=c[f];if(!d){continue;}if(typeof d.callback!="function"){continue;}var b=d.callback(g,a);if(this.ShouldCancel(b,d.isCancellable)){return NotificationResults.Cancel;}}return NotificationResults.Continue;},IsSubscribed:function(c,a){var b=this.Callbacks[c];if(!b){return false;}for(var d=0;d<b.length;d++){if(a===b[d]){return true;}}return false;},ShouldCancel:function(b,a){if(!a){return false;}return(b===NotificationResults.Cancel);}};var NotificationResults={Cancel:false,Continue:1};var _globalSubmit=false;var _fullOverride=false;var strAlert=window.strAlert?window.strAlert:"";var showAlert=window.showAlert?window.showAlert:"true";window.onbeforeunload=function(){if(_fullOverride){return;}if(_globalSubmit){_globalSubmit=false;return;}if(showAlert=="false"){return;}return strAlert;};function NotYouActions(){showAlert="false";for(var b=0;b<arguments.length;b++){if(typeof DeleteCookie==="function"){DeleteCookie(arguments[b],"/",globalDomainName);}}if(window.notYouUrl){window.location.href=window.notYouUrl;return false;}switch(window.tokenSourceType){case"Acquisition":window.location.href=window.location.protocol+"//"+window.location.host+window.location.pathname;break;case"Main Path":window.location.href=window.mainNotYouUrl;break;default:var a=window.spectrumUrlsAreRelative?window.baseUrl:"";window.location.href=a+window.houseNotYouUrl;break;}return false;}