/*!CK:4044763664!*//*1437620355,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["u2q8E"]); }

__d("BrowseFacebarHighlighter",["CSS","csx","NodeHighlighter"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={};Object.assign(j,i,{getHighlightCandidates:function(){return ["._53ad"];},isDiscardNode:function(k){return g.hasClass(k,'DefaultText');},createSegmentedRegex:function(k){k=this.escapeAndAddBidirectionalCharsToTokens(k);return '(^|\\s|\\b)('+k.join('|')+')';}});e.exports=j;},null);
__d("getElementChildren",["toArray","isElementNode"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){return g(j.children||j.childNodes).filter(h);}e.exports=i;},null);
__d("TypeaheadFacepileX.react",["React","joinClasses"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g.createClass({displayName:"TypeaheadFacepile",renderPic:function(j,k){var l=("url("+this.props.photos[j]+")");return (g.createElement("span",{className:h('splitpic',k),key:j,style:{backgroundImage:l}}));},renderPics:function(){var j=this.props.size;if(j>=3){return [this.renderPic(0,'leftpic'),this.renderPic(1,'toppic'),this.renderPic(2,'bottompic')];}else return [this.renderPic(0,'leftpic'),this.renderPic(1)];},render:function(){return (g.createElement("span",g.__spread({},this.props,{className:h(this.props.className,"splitpics clearfix")}),this.renderPics()));}});e.exports=i;},null);
__d("FacebarSemanticQuery",["CurrentUser","URI"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='str',j=/\*[\w\-]+\(/g;function k(u){var v={me:g.getID()};return Object.assign(v,Array.isArray(u.semantic_map)?{}:u.semantic_map);}function l(u,v){var w=k(u);if(typeof w[v]!=='undefined')return String(w[v]);return v;}function m(u){return new h("/profile.php").addQueryData({id:u});}function n(u,v){var w=[v],x=[],y=u.browse_functions,z=u.search_path;while(w.length>0){var aa=w.pop();if(!q(aa)){x.push(aa);continue;}var ba=aa.substring(0,aa.indexOf('(')),ca=ba,da=r(aa);if(!y[ba]){x=[];break;}var ea=y[ba].minNumParams,fa=y[ba].maxNumParams;if(w.length>0)if(y[ba].numParamsUnbounded){if(x.length>0)ba+='-'+da.length;}else if((da.length!=1&&da.length>ea)||(da.length===0&&ea!=fa))ba+='-'+da.length;w.push(ba);for(var ga=0;ga<da.length;ga++){if(da[ga].length===0)continue;if(y[ca].allowsFreeText){w.push(i+'/'+encodeURIComponent(encodeURIComponent(da[ga])));}else w.push(da[ga]);}}return new h(z+x.join('/'));}function o(u){return u.replace(/['"\[\]]/g,'');}function p(u,v){var w=JSON.parse(v),x=[];if(w.length>0)x=[w[0]];var y=[],z=u.browse_functions,aa=u.search_path;while(x.length>0){var ba=x.pop();if(typeof(ba)!=='object'){y.push(o(ba));continue;}var ca=Object.keys(ba)[0],da=ca,ea=ba[ca];if(!z[ca]){y=[];break;}var fa=z[ca].minNumParams,ga=z[ca].maxNumParams;if(x.length>0)if(z[ca].numParamsUnbounded){if(y.length>0)ca+='-'+ea.length;}else if((ea.length!=1&&ea.length>fa)||(ea.length===0&&fa!=ga))ca+='-'+ea.length;x.push(ca);for(var ha=0;ha<ea.length;ha++){if(ea[ha].length===0)continue;if(z[da].allowsFreeText){x.push(i+'/'+encodeURIComponent(ea[ha]));}else x.push(ea[ha]);}}return new h(aa+y.join('/'));}function q(u){return (/^[a-z\-]+\(.*\)$/).test(u);}function r(u){if(!q(u)&&u.indexOf('param_')!==0)return [u];var v=u.substring(u.indexOf('(')+1,u.length-1);if(v.length===0)return [];return s(v);}function s(u){var v=[],w=0,x=0;for(var y=0;y<u.length;++y)if(u[y]==','&&x===0){v.push(u.substring(w,y));w=y+1;}else if(u[y]=='('){x++;}else if(u[y]==')')x--;v.push(u.substring(w,u.length));return v;}function t(u,v,w){"use strict";this.facebarConfig=u;this.unmapped=(v||"").trim();this.mapped=l(u,this.unmapped);this.position=null;this.$FacebarSemanticQuery0=typeof w!=='undefined'?w:false;}t.prototype.isEntity=function(){"use strict";return (/^\d+$/).test(this.mapped);};t.prototype.isShortcut=function(){"use strict";return this.mapped.indexOf('shortcut(')===0;};t.prototype.isImplemented=function(){"use strict";return this.mapped&&!this.mapped.match(j);};t.prototype.isSemanticForest=function(){"use strict";return this.$FacebarSemanticQuery0;};t.prototype.getUnimplemented=function(){"use strict";return (this.mapped.match(j)||[]).map(function(u){return u.substr(1,u.length-2);});};t.prototype.getURI=function(){"use strict";if(this.isEntity()){return m(this.mapped);}else if(this.isShortcut()){return new h(this.mapped.substr(9,this.mapped.length-10));}else if(this.isSemanticForest()){return p(this.facebarConfig,this.unmapped);}else return n(this.facebarConfig,this.unmapped);};e.exports=t;},null);
__d("FacebarURI",["FacebarJSConstants","FacebarSemanticQuery","URI","WWWBase"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={event:{ref:g.eventLinkRef},user:{fref:'ts'},page:{fref:'ts'}},l={getSearchRawPrefix:function(){return 'search';},getSearchPath:function(){return '/'+this.getSearchRawPrefix()+'/';},getURI:function(m,n){var o=null,p=!n.song&&!n.isExtendedResult&&n.path;if(p){o=new i(p);if(n.type in k)o.addQueryData(k[n.type]);}else{var q=new h(m,n.semantic);if(q&&q.isImplemented())o=q.getURI();}return o&&l.getQualifiedURI(o);},getQualifiedURI:function(m){var n=new i(m);if(!n.getDomain()){var o=new i(j.uri);n.setProtocol(o.getProtocol()).setDomain(o.getDomain()).setPort(o.getPort());}return n;}};e.exports=l;},null);
__d("FacebarFindPeopleAndPages",["FacebarGlobalOptions","FacebarJSConstants","FacebarStructuredText","FacebarURI","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n={insertInto:function(o,p,q){o=this._cleanQuery(o);var r=this._getInsertionIndex(o,p);if(r>-1){var s=this._createFindPeopleAndPagesResult(o,q);p.splice(r,0,s);}},_getInsertionIndex:function(o,p){if(!o||!g.findPeopleAndPages)return -1;var q=p.some(this._isUserOrPageSuggestion);if(!q)return -1;var r=-1;for(var s=0;s<p.length;s++)if(this._isEntitySuggestion(p[s]))r=s+1;return r;},_isUserOrPageSuggestion:function(o){return o.type==='user'||o.type==='page';},_isEntitySuggestion:function(o){return o.type!==h.keywordType&&o.type!==h.grammarType;},_cleanQuery:function(o){return String(o).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'');},_createFindPeopleAndPagesResult:function(o,p){var q=("str/"+o+"/keywords_entities"),r=m._("Find all people and pages named \"{query}\"",[m.param("query",o)]);return {type:'grammar',results_set_type:'browse_type_blended',text:o,id:o,uid:o,query_string:o,icon_class:"_207",isSeeMore:true,isPeopleAndPagesSuggestion:true,structure:i.fromString(r),semantic:q,uri:j.getQualifiedURI(new k('/search/'+q)),fromCache:p,tags:{displayedSeeMore:true}};}};e.exports=n;},null);
__d("FacebarKeywordSearchUtils",["FacebarURI","FacebarStructuredText","KeywordsSearchResultConfig","URI"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=function(m){var n=0;while(n<m.length)if(m[n].exactMatchKeyword){m.splice(n,1);}else ++n;},l={addExactMatch:function(m,n,o){if(!n.length)return;var p,q;for(var r=0,s=n.length;r<s;r++){q=n[r];if(q.type==='grammar')continue;p=true;break;}if(!p)return;var t=this.getExactMatchKeywordResult(m);if(!t)return;var u=Math.min(n.length,o),v=u;for(r=0;r<u;r++){q=n[r];if(q.exactMatchKeyword)return;if(q.cost>i.default_cost)--v;if(q.type!==i.result_type)continue;t.backendCost=q.cost+i.exact_match_cost_delta_from_best;t.cost=q.backendCost;k(n);n.splice(r,0,t);return;}k(n);n.splice(Math.min(Math.min(u,o-1),v),0,t);},getExactMatchKeywordResult:function(m){if(!m||m.is_empty||!m.raw_text)return;var n=m.raw_text.toLowerCase().replace(/\s{2,}/g,' ').trim(),o=i.query_prefix_blacklist;for(var p=0;p<o.length;p++)if(n.startsWith(o[p]))return;var q=this.makeFacebarEntry(n);return this._makeFacebarResult(q,m.cache_id.length);},makeFacebarEntry:function(m){var n=null,o=null;if(i.gsv2_results_page){o='str/'+encodeURIComponent(m)+'/'+i.gsv2_browse_edge;n=g.getQualifiedURI(new j('/search/'+o));}else{n=g.getQualifiedURI(new j(i.results_page_url).addQueryData('q',m));o=i.shortcut+'('+n.toString()+')';}return {semantic:o,text:m,type:i.result_type,resultsSetType:i.result_set_type,uid:i.uid_prefix+m,iconClass:i.icon_class,uri:n,structure:h.fromString(m)};},_makeFacebarResult:function(m,n){var o={semantic:m.semantic,structure:[{type:'grammar',text:m.text,uid:m.semantic}],type:m.type,resultsSetType:m.resultsSetType,cost:i.default_cost,cache_id_length:n,parse:{display:[{type:'grammar',uid:i.uid_prefix+m.text}],remTokens:[],suffix:''},iconClass:m.iconClass,exactMatchKeyword:true};o.tuid=JSON.stringify({semantic:o.semantic,structure:o.structure});return o;}};e.exports=l;},null);
__d("FacebarGSv2Echo",["FacebarGlobalOptions","FacebarJSConstants","FacebarKeywordSearchUtils","FacebarStructuredText","FacebarURI","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o={insertInto:function(p,q,r){if(this._shouldInsert(p,q)){var s=q.findIndex(this._isKeywordSuggestion,this);if(s<0)s=q.length;var t=this._removeExactMatchAndReturnSubtext(p,q);if(g.showEcho)q.splice(s,0,this._createEchoResult(p,r,t));if(g.findPostsSemantic)q.splice(s,0,this._createFindPostsResult(p,r));}},_shouldInsert:function(p,q){p=this._normalizeValue(p);if(!p||!g.graphSearchV2)return false;for(var r=0;r<q.length;r++){var s=q[r];if(s.isRecentSearchSuggestion&&p===this._normalizeValue(s.text))return false;}return true;},_isKeywordSuggestion:function(p){return p.type===h.keywordType||p.type===h.grammarType;},_removeExactMatchAndReturnSubtext:function(p,q){var r="";p=this._normalizeValue(p);for(var s=0;s<q.length;s++){var t=q[s];if(this._isKeywordSuggestion(t)&&p===this._normalizeValue(t.text)){if(t.subtext)r=t.subtext;q.splice(s,1);return r;}}return r;},_normalizeValue:function(p){return String(p).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();},_createEchoResult:function(p,q,r){p=this._normalizeValue(p);var s=i.makeFacebarEntry(p);return {type:'keyword',results_set_type:h.browseTypes.keyword,text:p,id:p,uid:p,query_string:p,icon_class:"_5b1w",exactMatchKeyword:true,structure:j.fromString(p),semantic:s.semantic,uri:s.uri,fromCache:q,subtext:r};},_createFindPostsResult:function(p,q){p=this._normalizeValue(p);var r=g.findPostsSemantic.replace('{QUERY}',p),s=g.findPostsSemantic.replace('{QUERY}',encodeURIComponent(p)),t=n._("Find all posts for \"{query}\"",[n.param("query",p)]);return {type:'keyword',results_set_type:h.browseTypes.keyword,text:p,id:p,uid:p,query_string:p,icon_class:"_4-vy",isSeeMore:true,structure:j.fromString(t),semantic:r,uri:k.getQualifiedURI(new l('/search/'+s)),fromCache:q,tags:{displayedSeeMore:true}};}};e.exports=o;},null);
__d("FacebarResultStore",["FacebarGlobalOptions","FacebarJSConstants","FacebarKeywordSearchUtils","FacebarResultStoreUtils","FacebarSemanticUtils","FacebarStructuredText","KeywordsSearchResultConfig","TokenizeUtil","UnicodeMatch","concatMap","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();function r(s,t,u,v){"use strict";this.facebarConfig=s;this.facebarConfig.grammar_stop_words_penalty=this.facebarConfig.grammar_stop_words_penalty||2;this.facebarConfig.grammar_stop_words=this.facebarConfig.grammar_stop_words||{};this.facebarConfig.options=v;this.tokenize=t;this.getEntry=u;this.typeaheadTypeMap=this.facebarConfig.mapped_types;this.facebarConfig.typeahead_types.forEach(function(w){this.typeaheadTypeMap[w]=w;},this);this.unicodeMatch=new o({prefix_hangul_conjoining_jamo:true});this.resetCaches();}r.prototype.transformStructured=function(s){"use strict";var t=[],u=[],v='',w='';s.forEach(function(z,aa){if(z.isType('text')){v+=z.getText();w=(w==null)?null:w+z.getText();}else{var ba=v.match(/\"/g);if(ba&&ba.length%2)v=v.replace(/\s+$/,'')+'"';if(v.length){Array.prototype.push.apply(t,this.tokenize(v));u.push(v);v='';}t.push(z.toStruct());u.push({uid:String(z.getUID()),type:this._getFBObjectType(z.getTypePart(1)),text:z.getText()});w=null;}},this);if(v.length){if(v[v.length-1]=='\'')v=v.substr(0,v.length-1);Array.prototype.push.apply(t,this.tokenize(v));u.push(v);if(v[v.length-1]==' ')t.push('');}var x=JSON.stringify(u),y=x.replace(/\]$/,'').replace(/\"$/,'');y=y.replace(/\s{2,}/g,' ');return {tokens:t,text_form:x,is_empty:!!x.match(/^\[(\"\s*\")?\]$/),raw_text:w,cache_id:y};};r.prototype.resetCaches=function(){"use strict";this.resetBootstrapCache();this.resetQueryCache();};r.prototype.resetBootstrapCache=function(){"use strict";this.bootstrapCache={};};r.prototype.resetQueryCache=function(){"use strict";this.queryCache={'':{tokens:[],results:[]}};};r.prototype.setNullState=function(s){"use strict";this.facebarConfig.null_state=s.map(this._extractStructure,this);};r.prototype.addEntryToNullState=function(s){"use strict";if(this.facebarConfig.null_state){var t=this.facebarConfig.entity_cost+s.grammar_costs['{'+s.type+'}'],u=j.processEntityResult(s.type,s.uid,s.text,t);this.facebarConfig.null_state.unshift(u);}};r.prototype.addRecentEntryToNullState=function(s){"use strict";if(!this.facebarConfig.null_state)return;var t=decodeURIComponent(s.semantic);for(var u=0;u<this.facebarConfig.null_state.length;u++){var v=this.facebarConfig.null_state[u];if(v.semantic===t){this.facebarConfig.null_state.splice(u,1);break;}}var w=Object.assign({},s,{isRecent:true,isNullState:true,type:h.keywordType,structure:l.fromString(s.text),tuid:JSON.stringify({semantic:s.semantic,structure:s.structure})});if(s.icon_class)w.iconClass=s.icon_class;if(s.isRecentSearchSuggestion){w.iconClass="_5b1w";delete w.isRecentSearchSuggestion;}if(s.results_set_type)w.resultsSetType=s.results_set_type;this.facebarConfig.null_state.unshift(w);};r.prototype.clearRecentSearches=function(){"use strict";if(!this.facebarConfig.null_state)return;this.facebarConfig.null_state=this.facebarConfig.null_state.filter(function(s){return !s.isRecent;});};r.prototype.setSortFunction=function(s){"use strict";this._sortFunction=s;};r.prototype.addBootstrap=function(s){"use strict";var t=this.bootstrapCache;s.forEach(function(u){var v=this.getEntry(u);v.bootstrapped=true;var w=this.tokenize(v.textToIndex,true);if(v.tokens)Array.prototype.push.apply(w,v.tokens.split(' '));Array.prototype.push.apply(w,this.getExtraTokensToIndex(v));w.forEach(function(x){if(!t.hasOwnProperty(x))t[x]={};t[x][u]=true;});},this);};r.prototype.getExtraTokensToIndex=function(s){"use strict";var t=[];if(s.alias!=null)t.push(s.alias.toLowerCase());return t;};r.prototype.addNullStateToQueryCache=function(s,t){"use strict";this.saveResults(this.facebarConfig.null_state,s,true);if(g.includeInitialTypeNamedX)this.saveResults(t,s,true);};r.prototype.extendResult=function(s,t){"use strict";var u=s.cache_id.substr(t.cache_id_length);if((u.indexOf("\"")>=0||t.tokens.length===0)&&!t.isTypeNamedXBootstrap)return null;var v;if(!!t.isTypeNamedXBootstrap){if(s.raw_text!==null){v=t.ext_text+u;}else if(s.tokens.length!==0&&s.tokens[0].text){v=s.tokens[0].text;}else return null;}else if(t.tokens[t.tokens.length-1].length!==0){v=t.ext_text+u;}else v=t.ext_text+" "+u;if(v.length===0)return null;t.ext_node.text=v;t.parse.entTokens=[v];t.parse.suffix="";this._extractStructure(t);if(!this._punctRegexp)this._punctRegexp=new RegExp(n.getPunctuation(),'g');t.semantic=t.ext_semantic.replace('(ext_string)','('+v.replace(this._punctRegexp,"")+')');t.isExtendedResult=true;return t;};r.prototype.getResults=function(s,t){"use strict";if(s.tokens.length===0||(s.tokens.length==1&&s.tokens[0]===''))return {results:this.facebarConfig.null_state||[],null_state:true};var u=this._getBestQueryCache(s.cache_id),v=u.results.filter(function(da){return !da.isRecent;}),w={},x=this._getBootstrapMatchByType(s.tokens,w),y=this._addMatchingBootstrapResults(s,x[0]||{},w);if(g.limitBootstrapResult)y=y.slice(0,g.limitBootstrapResultNum);Array.prototype.push.apply(y,p(this._getResultsFromCache.bind(this,x,s),v));var z={},aa=[],ba=false,ca=0;y.sort(this._sortFunction);if(!g.graphSearchV2&&g.keywordSearchEnabled)i.addExactMatch(s,y,t);y.forEach(function(da){var ea=l.fromStruct(da.structure);if(ea.hasType('blank')){aa.push(da);return;}da.semantic=da.semantic.toLowerCase();if(!da.termMatches)da.termMatches=w[da.semantic];var fa=r.getUniqueSemantic(da.semantic),ga=r.getUniqueSemantic(da.alternateSemantic);if(!fa)return;var ha=z[fa]||(ga&&z[ga]);if(ha){if(da.isJSBootstrapMatch){ha.isJSBootstrapMatch=true;ha.bootstrapCost=da.bootstrapCost;}else if(ha.isJSBootstrapMatch&&da.backendCost!==(void 0)&&ha.backendCost===(void 0))ha.backendCost=da.backendCost;if(!!da.tags)Object.assign(ha.tags||{},da.tags);return;}if(ba&&da.blankFilled)return;if(da.type.indexOf('browse_type')>=0){ca+=1;if(this.facebarConfig.maxGrammarResults!==(void 0)&&ca>this.facebarConfig.maxGrammarResults)return;}ba=ba||!!da.blankFilled;z[fa]=da;if(ga)z[ga]=da;aa.push(da);},this);return {results:aa};};r.prototype.saveResults=function(s,t,u,v,w){"use strict";s=s.map(this._processBackendResult,this);var x=[],y={},z={};s.forEach(function(ba){z[ba.semantic]=true;ba.parse&&ba.parse.disambiguation&&ba.parse.disambiguation.forEach(function(ca){var da=k.semanticForestConversion(ca);y[da]=true;});});var aa=this._getBestQueryCache(t.cache_id);aa.results.forEach(function(ba){if(ba.type==='websuggestion')return;if(ba.exactMatchKeyword)return;if(ba.isExtendedResult)return;if(ba.semantic in y)return;var ca=this._getDifferenceArrayTokens(ba.tokens,t.tokens),da=this._getNumTokensMatching(ca,ba);da=this._tryMatchingFinalInsertedEntity(ca,da,ba);if((da>0&&da==ca.length)||(ba.type==="shortcut"&&ba.termMatches.indexOf(t.tokens[t.tokens.length-1]))>=0){ba.cacheOnlyResult=!z[ba.semantic];x.push(ba);}},this);if(g.limitCacheResult)x=x.slice(0,g.limitCacheResultNum);s.forEach(function(ba){ba.tokens=t.tokens;ba.cache_id_length=t.cache_id.length;if(!!ba.isTypeNamedXBootstrap)++ba.cache_id_length;x.push(ba);},this);if(w)Array.prototype.push.apply(x,w);if(this.queryCache[t.cache_id]===(void 0))this.queryCache[t.cache_id]={};Object.assign(this.queryCache[t.cache_id],{tokens:t.tokens,results:x,incomplete:u},v);};r.prototype.alreadyKnown=function(s){"use strict";return !!this.queryCache[s]&&!this.queryCache[s].incomplete;};r.prototype.stripBrackets=function(s){"use strict";return s.replace(/^[\[\{]/,'').replace(/[\]\}]$/,'');};r.prototype._extractStructure=function(s){"use strict";function t(w,x,y){return {type:w==='ent:extend_string'?'text':w,text:x,uid:y||null};}function u(w,x){w.split(' ').forEach(function(y){if(y!==''){if(x)s.chunks.push(s.structure.length);s.structure.push(t('text',y));}s.structure.push(t('text',' '));});s.structure.pop();}function v(w){if(s.structure.length!==0||h.nonGrammarTypes[s.type])return w;return w.charAt(0).toUpperCase()+w.substr(1);}s.structure=[];s.chunks=[];s.parse.display.forEach(function(w){if(typeof w==='string'){u(v(w),true);}else if(w.type==='ent:extend_string'){u(w.text,true);}else if(w.uid){var x=this.getEntry(w.uid,w.fetchType);s.chunks.push(s.structure.length);if(x==null)throw new Error('No entry found for uid \"'+w.uid+'\", type \"'+w.fetchType+'\" and piece text \"'+w.text+'\"');if(x.grammar_like){u(v(x.text),false);}else{var y=w.type;if(w.fetchType)y+=':'+w.fetchType;s.structure.push(t(y,x.text,w.uid));}}else if(w.type=='blank'){s.chunks.push(s.structure.length);s.structure.push(t(w.type,'...'));}},this);return s;};r.prototype._getDifferenceArrayTokens=function(s,t){"use strict";if(!s.length)return [''].concat(t);var u=s.length-1,v=s[u];if(v==='')v=s[--u];var w='';if(typeof(v)=='string'&&u<t.length)w=t[u].substr(v.length);if(w===''&&u+1<t.length&&t[u+1]==='')return [''];return [w].concat(t.slice(u+1));};r.prototype._processBackendResult=function(s){"use strict";if(s.isTypeNamedXBootstrap&&s.cache_id_length)return s;s.semantic=s.semantic.toString();s.backendCost=s.cost;this._extractStructure(s);if(s.type.match(/^\{.*\}$/))s.useExtendedIndex=true;if(s.alternateSemantic)s.alternateSemantic=s.alternateSemantic.toLowerCase().replace(/\[(\d*)\]/g,'$1');if(s.parse.extendable){var t=null;s.parse.display.forEach(function(z){if(z.type!=="ent:extend_string")return;t=z;},this);if(!t||s.semantic.match(/\[.*\]/).length!==1){s.parse.extendable=false;}else{s.ext_node=t;s.ext_semantic=s.semantic.replace(/\[(.*)\]/g,'ext_string');s.ext_text=t.text;}}if(s.semantic.match(/\[\d*\]/)){var u=s.parse,v=u.pos;if(v===(void 0)){s.semantic=s.semantic.replace(/\[(\d*)\]/g,'$1');}else{var w=u.remTokens[u.remTokens.length-1];if(u.remTokens.length&&s.structure[s.chunks[w]]&&s.structure[s.chunks[w]].uid){v=u.remTokens[u.remTokens.length-1];s.completed=true;}var x=s.structure[s.chunks[v]].uid;if(x===null){s.semantic=s.semantic.replace(/\[(\d*)\]/g,'$1');}else{var y=new RegExp('\\['+x+'\\]','g');s.unsubstituted_semantic=s.semantic;s.semantic=s.semantic.replace(y,x);if(u&&u.disambiguation&&u.disambiguation.length>0){u.disambiguation=u.disambiguation.filter(function(z){return z.indexOf('['+x+']')!==-1;});u.unsubstituted_disambiguation=u.disambiguation.splice(0);u.disambiguation=u.disambiguation.map(function(z){return z.replace(y,x);});}}}}s.semantic=s.semantic.replace(/\[(.*)\]/g,'$1');s.tuid=JSON.stringify({semantic:s.semantic,structure:s.structure});return s;};r.prototype._sortFunction=function(s,t){"use strict";return (s.cost||0)-(t.cost||0);};r.prototype._getResultsFromCache=function(s,t,u){"use strict";var v=t.tokens,w=this._getDifferenceArrayTokens(u.tokens,v),x=[],y=this._getNumTokensMatching(w,u),z=this._tryMatchingFinalInsertedEntity(w,y,u);if(u.parse.extendable||u.isExtendedResult){var aa=this.extendResult(t,u);if(aa)x.push(aa);if(u.isExtendedResult)return x;}if(z>0&&z==w.length&&!(u.type===m.result_type&&w.length===1&&w[0]==='"'))x.push(u);if(u.type==="shortcut"&&u.termMatches.indexOf(t.tokens[v-1])>=0)x.push(u);return x;};r.prototype._addMatchingBootstrapResults=function(s,t,u){"use strict";var v=s.tokens;return p(function(w){var x=t[w];if(x===(void 0))return [];var y=[],z=j.getQueryFeatures(s);x.forEach(function(aa){var ba=this.getEntry(aa,w);if(!this._isTitleTermMatch(v,ba)&&!this._isAliasMatch(s.raw_text,ba))return;var ca=(this._isExactNameMatch(v,ba)||this._isAliasMatch(s.raw_text,ba)),da=ca?0:this.facebarConfig.non_title_term_match_penalty,ea=this._isNonGrammarTermMatch(v,ba),fa=ba.grammar_costs['{'+w+'}']+da+this.facebarConfig.entity_cost+this.facebarConfig.grammar_stop_words_penalty*!ea,ga=j.processEntityResult(w,aa,ba.text,fa,s,z,u,ca,!ea);ga.bootstrapCost=fa;ga.isJSBootstrapMatch=true;y.push(ga);},this);return y;}.bind(this),this.facebarConfig.bootstrap_types);};r.prototype._isTitleTermMatch=function(s,t){"use strict";var u=s[0]||{};if(typeof(u)=='object')return false;var v=t.titleToIndex;return s.length===1?this._isTokenizePrefixMatch(u,v):n.isExactMatch(u,v);};r.prototype._isExactNameMatch=function(s,t){"use strict";var u=s[0]||{};if(typeof(u)=='object')return false;var v=t.text;for(var w=0;w<s.length-1;++w)if(s[w]!==''&&!n.isExactMatch(s[w],v))return false;return s.length>0&&this._isTokenizePrefixMatch(s[s.length-1],v);};r.prototype._isAliasMatch=function(s,t){"use strict";return (t.alias!=null&&s!=null&&n.isExactMatch(t.alias,s));};r.prototype._isNonGrammarTermMatch=function(s,t){"use strict";var u=n.parse(t.titleToIndex.toLowerCase()),v=u.tokens.filter(function(y){return y!==''&&!this.facebarConfig.grammar_stop_words[y];},this);v=v.join(' ');for(var w=0;w<s.length;++w){if(typeof(s[w])=='object')return true;var x=w===s.length-1?this._isTokenizePrefixMatch(s[w],v):n.isQueryMatch(s[w],v);if(x)return true;}return false;};r.prototype._getBootstrapMatchByType=function(s,t){"use strict";if(s.length===0)return [];var u=s.map(function(){return {};}),v=(s[s.length-1]===''),w={},x,y=(v?s.length-1:s.length),z=s[y-1];if(y&&z.uid){this._pushBootstrapEntryAtPosition(u,y-1,z.uid);return u;}for(var aa in this.bootstrapCache)if(y&&this.unicodeMatch.prefixMatch(aa,z)&&(!v||aa===z))for(x in this.bootstrapCache[aa])if(!w[x]){w[x]=1;this._addMatchedTerm(x,aa,t);this._pushBootstrapEntryAtPosition(u,y-1,x);}for(var ba=y-2;ba>=0;ba--){if(typeof(s[ba])=='object')break;if(s[ba].length&&s[ba][0]=='"')break;for(x in this.bootstrapCache[s[ba]]){if(!w[x])w[x]=0;if(w[x]+ba==y-1){++w[x];this._addMatchedTerm(x,s[ba],t);this._pushBootstrapEntryAtPosition(u,ba,x);}}}return u;};r.prototype._addMatchedTerm=function(s,t,u){"use strict";(u[s]=u[s]||[]).push(t);return u;};r.prototype._pushBootstrapEntryAtPosition=function(s,t,u){"use strict";var v=this.getEntry(u);if(!v)return;for(var w in v.grammar_costs){var x=this.stripBrackets(w);if(s[t][x]===(void 0))s[t][x]=[];s[t][x].push(u);}};r.prototype._getNumTokensMatching=function(s,t){"use strict";var u=0,v=t.parse,w=s.length,x=null,y=null;if(v.pos!==(void 0)){var z=t.structure[t.chunks[v.pos]];if(z){x=z.uid;y=z.type.split(':')[2];}}t.outputTokensUsed=[];t.termMatches=[];if(x){u=this._prefixMatchEntity(s,v,x,t.outputTokensUsed,y,!!t.useExtendedIndex,t.termMatches);if(u===0||u===w)return u;}else if(v.suffix&&w==1&&v.suffix.indexOf(s[0])===0){return w;}else if(v.suffix==s[0]){++u;}else return 0;var aa=[];v.remTokens=v.remTokens||[];for(var ba=0;ba<v.remTokens.length;ba++){if(typeof(s[u])!='string'||t.chunks.length<=v.remTokens[ba]||t.structure.length<=t.chunks[v.remTokens[ba]]||t.structure[t.chunks[v.remTokens[ba]]].uid)break;var ca=t.structure[t.chunks[v.remTokens[ba]]].text;aa.push(ca.toLowerCase());}u=this._greedyMatchText(aa,s,u,v.remTokens,t.outputTokensUsed,t.isNullState);if(u==w-1&&s[u]==='')return w;return u;};r.prototype._prefixMatchEntity=function(s,t,u,v,w,x,y){"use strict";t.entTokens=t.entTokens||[];if(t.entTokens.length===0){if(s[0]!=='')return 0;if(t.possessive&&s.length>1&&s[1]=='\'s'){v.push([t.pos+1]);return 2;}else return 1;}var z=false,aa=this.getEntry(u,w);if(typeof(w)!=='undefined'&&w!==aa.fetchType)return 0;var ba=this.tokenize(x?aa.textToIndex:aa.text,true),ca=[];for(var da=0;da<s.length+t.entTokens.length-1;da++)if(da<t.entTokens.length-1){ca.push(t.entTokens[da]);}else if(da==t.entTokens.length-1){ca.push(t.entTokens[da]+s[0]);}else ca.push(s[da-t.entTokens.length+1]);var ea=-t.entTokens.length+1;for(var fa=0;fa<ca.length;++fa){var ga=ca[fa];if(typeof(ga)!='string')break;if(ga===''){ea++;continue;}var ha=false;for(var ia=0;ia<ba.length;ia++)if(ba[ia]==ga||(fa===ca.length-1&&ba[ia].indexOf(ga)===0)){if(y)y.push(ba[ia]);ba[ia]='';ha=true;++ea;break;}if(ha)continue;if(!t.possessive||ga.length<=2||ga.substr(ga.length-2)!='\'s')break;var ja=ga.substr(0,ga.length-2);for(ia=0;ia<ba.length;ia++)if(ba[ia]==ja){++ea;if(v)z=true;break;}break;}if(ea>0){if(z)v.push([t.pos+1]);return ea;}if(v===(void 0))return 0;var ka=s[0],la=ka;if(t.possessive&&ka.length>=2&&ka.substr(ka.length-2)=='\'s')la=ka.substr(0,ka.length-2);t.suffix=t.suffix||'';if((s.length==1&&t.suffix.indexOf(ka)===0)||t.suffix==la||t.suffix==ka){if(la!=ka&&t.suffix==la)v.push([t.pos+1]);return 1;}return 0;};r.prototype._tryMatchingFinalInsertedEntity=function(s,t,u){"use strict";if(!u.completed||t<0)return t;var v=u.parse,w=v.remTokens[v.remTokens.length-1],x=u.structure[u.chunks[w]],y=this.getEntry(x.uid,x.type),z=this.tokenize(y.text,true);t=this._greedyMatchText(z,s,t);if(t==s.length-1&&s[t]==='')return s.length;return t;};r.prototype._greedyMatchText=function(s,t,u,v,w,x){"use strict";for(var y=0;y<s.length;y++){var z=s[y];if(z==t[u]){if(w!==(void 0))w.push(v[y]);++u;continue;}if(u===t.length-1&&z.indexOf(t[u])===0){if(w!==(void 0))if(z==t[u]){w.push([v[y]]);}else w.push([v[y],t[u].length]);return t.length;}if(x)break;}return u;};r.prototype._getBestQueryCache=function(s){"use strict";for(var t=s.length;t>=0;t--){var u=this.queryCache[s.slice(0,t)];if(u)return u;}};r.prototype._getFBObjectType=function(s){"use strict";if(this.typeaheadTypeMap[s]){return this.typeaheadTypeMap[s];}else return 'page';};r.prototype._isTokenizePrefixMatch=function(s,t){"use strict";return n.isPrefixMatch(this.unicodeMatch.prefixMatchPrepare(s),this.unicodeMatch.prefixMatchPrepare(t));};r.EPSILON=1e-05;r.getUniqueSemantic=function(s){if(!s)return;var t=[],u=[],v=[];s='('+s+')';var w=s,x=false;s.replace(/[\(\),]/g,function(y,z){var aa;switch(y){case ',':var ba=v.length-1;aa=w.substr(v[ba],z-v[ba]);t[ba].push(aa);v[ba]=z+1;break;case '(':v.push(z+1);t.push([]);u.push(z+1);break;case ')':if(v.length===0)throw s+' is not a valid semantic string';var ca=v.pop();aa=w.substr(ca,z-ca);aa=decodeURI(aa.replace(/%/g,'%25').replace(/\s/g,'+').trim());var da=t.pop();da.push(aa);var ea=da.sort();for(var fa=1;fa<ea.length;fa++)if(ea[fa]==ea[fa-1])x=true;var ga=ea.join(',');w=w.substr(0,u.pop())+ga+w.substr(z);break;}return y;});if(x)return '';return w.replace(/\((.*)\)/,'$1');};e.exports=r;},null);
__d("FacebarTimerUtils",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={getTimestamp:function(){return Date.now();}};e.exports=g;},null);
__d("FacebarTokenizer",["TokenizeUtil"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h="[^\"]",i=["\\s's","'s","\""+h+"*\"?"],j=[[/\s+$/,''],[/\"\s+/,'"'],[/\s+\"/,'"'],[/\"\"/,''],[/^\"$/,''],[/\s+/,' ']],k={tokenize:function(l,m){var n=[],o=0;l=l.replace(/\s/g,' ').toLowerCase();l.replace(new RegExp(i.join('|'),'g'),function(q,r){if(r>o){var s=l.substr(o,r-o);Array.prototype.push.apply(n,g.parse(s).tokens.slice(0));}var t=q;for(var u=0;u<j.length;u++){var v=j[u];t=t.replace(v[0],v[1]);}if(n.length&&t=='\'s'){n[n.length-1]+=t;}else if(t!=='')n.push(t);if(m)Array.prototype.push.apply(n,g.parse(q).tokens);o=r+q.length;});if(o<l.length){var p=l.substr(o,l.length-o);Array.prototype.push.apply(n,g.parse(p).tokens.slice(0));}return n;}};e.exports=k;},null);
__d("FacebarTypeaheadTypeNamedX",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={browse_type_user:'user',browse_type_page:'page',browse_type_place:'place',browse_type_group:'group',browse_type_application:'app'},h=1,i=2;function j(){"use strict";}j.addTypeNamedX=function(k,l,m,n){"use strict";var o=new j(),p=[],q=[];k.forEach(function(v){delete v.tags.hiddenSeeMore;if(v.isSeeMore){p.push(v);}else q.push(v);});if(!n.showTypeNamedX){p.forEach(function(v){v.tags.hiddenSeeMore=true;});return q;}var r=o.buildTypeNamedXBuckets(q,p,m,n),s=r[0],t=r[1];s.forEach(function(v){v.tags.displayedSeeMore=true;});var u=o.replaceResults(q,l,s);Array.prototype.push.apply(u,t);u.forEach(function(v){v.tags.hiddenSeeMore=true;});return q;};j.prototype.buildTypeNamedXBuckets=function(k,l,m,n){"use strict";var o={};n=n||{};k.forEach(function(s,t){var u=s.render_type||s.type;if(o[u]===(void 0))o[u]={index:t,matchCount:0};if(!n.alwaysDisplayTypeNamedX&&s.text.toLowerCase().indexOf(m.toLowerCase())<0)return;o[u].matchCount++;});var p=[],q=[];l.forEach(function(s){var t=g[s.results_set_type];if(o[t]!==(void 0)&&o[t].matchCount>=h){p.push([s,o[t].index]);}else q.push(s);});p.sort(function(s,t){return s[1]-t[1];});var r=p.map(function(s){return s[0];});Array.prototype.push.apply(q,r.slice(i));r.length=Math.min(r.length,i);return [r,q];};j.prototype.replaceResults=function(k,l,m){"use strict";var n=[],o=Math.min(0,k.length-l)+m.length;for(var p=0;p<o;++p){var q=-1;for(var r=0;r<Math.min(l-p,k.length);++r){var s=k[r];if(!s.exactMatchKeyword&&s.type!=='websuggestion')q=r;}if(q>=0){n.push(k[q]);k.splice(q,1);}}Array.prototype.unshift.apply(k,m);return n;};e.exports=j;},null);
__d("FacebarTypeaheadL2Terms",["FacebarJSConstants"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=3,i={addL2Terms:function(j,k,l,m){if(!m.suggestBackendL2Terms)return j;var n=[],o=[];j.forEach(function(q){if(q.exactMatchKeyword){q.tags.l2_suggestion=true;n.push(q);}else if(q.isKeywordL2){q.tags.l2_suggestion=true;q.type='l2suggestion';n.push(q);}else if(q.type!=='keywords')o.push(q);});var p=0;return o.map(function(q){if(g.entityTypes[q.type])if(p<h){p++;}else if(n.length)return n.pop();return q;});}};e.exports=i;},null);
__d("ResultsBucketizer",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h,i){"use strict";this.$ResultsBucketizer0=h;this.$ResultsBucketizer1=i;}g.trimResults=function(h,i,j){"use strict";var k=[];h.forEach(function(l,m){if(l.indexBeforeBuckets>i)k.push({index:m,originalIndex:l.indexBeforeBuckets});});k.sort(function(l,m){return l.originalIndex-m.originalIndex;}).slice(j).sort(function(l,m){return m.index-l.index;}).forEach(function(l){h.splice(l.index,1);});};g.mergeBuckets=function(h,i){"use strict";var j=[];for(var k in i)if(!i[k].rule.hidden&&(!i[k].rule.xor||!i[i[k].rule.xor]))j.push(i[k]);j.sort(function(l,m){var n=(l.rule.position||0)-(m.rule.position||0);if(n!==0)return n;return l.results[0].indexBeforeBuckets-m.results[0].indexBeforeBuckets;});h.length=0;j.forEach(function(l,m){if(l.rule.maxPromotions!=null&&m<j.length-1)g.trimResults(l.results,j[m+1].results[0].indexBeforeBuckets,l.rule.maxPromotions);Array.prototype.push.apply(h,l.results);}.bind(this));};g.prototype.$ResultsBucketizer2=function(h,i){"use strict";if(i.propertyName==null)return i.bucketName||'default';var j=this.$ResultsBucketizer1(h,i.propertyName);if(j==null||(i.propertyValue!=null&&(''+j)!==i.propertyValue))return false;return i.bucketName||(i.propertyName+'.'+j);};g.prototype.$ResultsBucketizer3=function(h,i){"use strict";var j={};h.forEach(function(k,l){i.some(function(m){var n=this.$ResultsBucketizer2(k,m);if(n===false)return false;if(j[n]==null)j[n]={results:[],rule:m};if(!!m.maxResults&&j[n].results.length>=m.maxResults)return true;k.bucketLineage.push({bucketName:n,bucketIndex:j[n].results.length});j[n].results.push(k);return true;}.bind(this));}.bind(this));return j;};g.prototype.$ResultsBucketizer4=function(h,i){"use strict";var j=this.$ResultsBucketizer0[i];if(!j)return {};var k=this.$ResultsBucketizer3(h,j);for(var l in k){var m=k[l].rule.subBucketRules;if(!!m)this.$ResultsBucketizer4(k[l].results,m);}g.mergeBuckets(h,k);return k;};g.prototype.$ResultsBucketizer5=function(h,i,j){"use strict";if(i.length<=j)return i.slice();var k=i.map(function(m){return m.indexBeforeBuckets;}),l=k.sort(function(m,n){return m-n;})[j];return i.filter(function(m){return m.indexBeforeBuckets<l;});};g.prototype.bucketize=function(h,i,j){"use strict";h.forEach(function(k,l){k.bucketLineage=[];k.indexBeforeBuckets=l;});j=j||{};Object.assign(j,this.$ResultsBucketizer4(h,'main'));return this.$ResultsBucketizer5(j,h,i);};e.exports=g;},null);
__d("FacebarDataSource",["Arbiter","AsyncRequest","FacebarFindPeopleAndPages","FacebarGlobalOptions","FacebarGSv2Echo","FacebarJSConstants","FacebarResultStore","FacebarResultStoreUtils","FacebarStructuredText","FacebarTimerUtils","FacebarSemanticUtils","FacebarTokenizer","FacebarTypeaheadTypeNamedX","FacebarTypeNamedXBootstrap","FacebarTypeaheadL2Terms","FacebarTypeNamedXTokenOptions","FacebarURI","ResultsBucketizer","ResultsBucketizerConfig","SearchDataSource","Vector","ViewportBounds","throttle","invariant","queryThenMutateDOM","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){b.__markCompiled&&b.__markCompiled();for(var ga in z)if(z.hasOwnProperty(ga))ia[ga]=z[ga];var ha=z===null?null:z.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=z;function ia(ja){"use strict";z.call(this,ja);this._fetched_null_state=null;this._initialQueryData=null;this._curQueryId=-1;this._maxRemoteQueryId=-1;this._single_state=true;this._waitingQueries=0;this.mixGrammarAndEntity=ja.mixGrammarAndEntity!==(void 0)?ja.mixGrammarAndEntity:true;this.grammarVersion=ja.grammarVersion||'';if(!ja.grammarOptions)ja.grammarOptions={};this.recordingRoute='banzai_vital';this._maxGrammarResults=ja.grammarOptions.maxGrammarResults;this.nullStateEndpoint=ja.nullStateEndpoint||'/ajax/browse/null_state.php';this.setNullStateData(ja.nullStateData||{},true);this._minQueryLength=ja.minQueryLength||-1;this._fixProcessLean=ja.grammarOptions.fixProcessLean||false;this.hasGSPreload=j.hasGSPreload;this.gsPreloadOptions=j.gsPreloadParams;this.throttleExecuteQuery();this.throttleSendRemoteQuery();this.throttleRenderResults();this.resultStoreOptions=ja.grammarOptions||{};this.resultStoreOptions.useNewExactNameMatch=(ja.grammarOptions.useNewExactNameMatch==="true");this.defaultQuery=null;this._bypassBucketizer=false;this._resultsBucketizer=new x(y.rules,function(ka,la){switch(la){case 'isSeeMore':return ka.isSeeMore;case 'objectType':return ka.type;case 'resultSetType':return ka.results_set_type;case 'renderType':return ka.render_type||ka.type;case 'cacheOnlyResult':return ka.cacheOnlyResult;case 'closeEntity':return ka.bootstrapped||(!!ka.tags?ka.tags[la]:(void 0));default:return !!ka.tags?ka.tags[la]:(void 0);}});this.fetchNullState();this.initWithConfig(j.grammarConfig);}ia.prototype.initWithConfig=function(ja){"use strict";this.facebarConfig=ja;this.createResultStore();this.blockees={};if(this._fetched_null_state){this.setNullState(this._fetched_null_state);this._fetched_null_state=null;}};ia.prototype.throttleExecuteQuery=function(){"use strict";var ja=j.executeQueryThrottleTime;this.executeQueryThrottled=ca.withBlocking(this.executeQuery,ja,this);};ia.prototype.throttleSendRemoteQuery=function(){"use strict";var ja=j.sendRemoteQueryThrottleTime;if(ja===0){this.sendRemoteQueryThrottled=this.sendRemoteQuery;}else if(j.lazyThrottleRemoteQuery){var ka=Date.now(),la=j.enableSendRemoteQueryDelay,ma=j.sendRemoteQueryDelayTime;this.sendRemoteQueryThrottled=function(){for(var na=[],oa=0,pa=arguments.length;oa<pa;oa++)na.push(arguments[oa]);var qa=Date.now();if(ka+ja<qa){ka=qa;if(la){fa(function(){this.sendRemoteQuery.apply(this,na);}.bind(this),ma);}else this.sendRemoteQuery.apply(this,na);}}.bind(this);}else this.sendRemoteQueryThrottled=ca.withBlocking(this.sendRemoteQuery,ja,this);};ia.prototype.throttleRenderResults=function(){"use strict";var ja=j.renderThrottleTime;if(ja===0){this.renderResultsThrottled=this.renderResults;return;}var ka=Date.now();this.renderResultsThrottled=function(la,ma,na,oa){var pa=Date.now();if(na||ka+ja<pa){ka=pa;this.renderResults(la,ma,na,oa);}}.bind(this);};ia.prototype.createResultStore=function(){"use strict";this.facebarConfig.maxGrammarResults=this._maxGrammarResults;this.resultStore=new m(this.facebarConfig,r.tokenize,this.getEntry.bind(this),this.resultStoreOptions);if(this._fixProcessLean)this._processLean();this.subscribe('setSortFunction',function(ja,ka){this.resultStore.setSortFunction(ka);}.bind(this));};ia.prototype.dirty=function(){"use strict";this._nullStateFetched=false;this.resultStore.resetCaches();ha.dirty.call(this);};ia.prototype.addEntries=function(ja){"use strict";this.resultStore.addBootstrap(this.processEntries(ja));};ia.prototype._processLean=function(){"use strict";if(this._fixProcessLean){if(this._leanPayload&&this.resultStore){var ja,ka=this._leanPayload.entries;for(var la in ka){ja=this.getEntry(la);if(!ja)continue;for(var ma in ka[la]){if(!ja.grammar_costs)ja.grammar_costs={};ja.grammar_costs['{'+ma+'}']=ka[la][ma];}}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}}else ha._processLean.call(this);};ia.prototype.setNullStateData=function(ja,ka){"use strict";if(ka)this.nullStateData={grammar_version:this.grammarVersion};Object.assign(this.nullStateData,ja);return this;};ia.prototype.setNullState=function(ja){"use strict";this._null_state=ja;this.processEntries(this._null_state.entities);this.resultStore.setNullState(this._null_state.queries);var ka=t.typeNamedX;ka.forEach(function(la){la.parse.extendable=true;la.qid=this._curQueryId;la.isTypeNamedXBootstrap=true;},this);this.resultStore.addNullStateToQueryCache(this.getRawStructure(o.fromString('')),ka);this._typeNamedXResults={};ka.forEach(function(la){this._typeNamedXResults[l.grammarToEntityTypes[la.resultsSetType]]=la;},this);};ia.prototype.getNullStateTrending=function(){"use strict";return this._null_state.trending;};ia.prototype.setSingleState=function(ja){"use strict";this._single_state=ja;};ia.prototype.overrideNullState=function(ja){"use strict";da(this._null_state!=null);this._original_null_state=this._original_null_state||this._null_state;this.setNullState(ja);};ia.prototype.restoreNullState=function(){"use strict";if(this._original_null_state)this.setNullState(this._original_null_state);};ia.prototype.fetchNullState=function(){"use strict";if(this._nullStateFetched){this.activityStart();setTimeout(this.activityEnd.bind(this),0);return;}var ja=new h().setURI(this.nullStateEndpoint).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ka){if(this.resultStore){this.setNullState(ka.payload);this.inform('nullstateReady',true);}else this._fetched_null_state=ka.payload;this._nullStateFetched=true;}.bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();ja.send();};ia.prototype.fetchNUXResults=function(ja){"use strict";if(!j.allowGrammar)return;ja=ja||{};var ka=new h().setURI(ja.URI).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(la){if(this.resultStore){this.overrideNullState(la.payload);ja.success&&ja.success();}}.bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();ka.send();};ia.prototype.toTypeaheadEntryUid=function(ja){"use strict";var ka,la=o.fromStruct(ja.structure),ma=la.getFragment(0);if(la.getCount()==1&&ma.isType('ent')){var na=ma.getType().split(':')[2];ka=this.getEntry(ma.getUID(),na);ka.type=this.resultStore.stripBrackets(ja.type);}else{ka=this.getEntry(ja.tuid);if(!ka){ka={dynamic_cost:ja.dynamic_cost,extra_uri_params:ja.extra_uri_params,memcache:ja.fromMemcache,photo:ja.photo,results_set_type:ja.resultsSetType,tuid:ja.tuid,type:ja.type,uid:ja.tuid,tags:ja.tags,is_redirect:ja.isRedirect};this.processEntries([ka]);ka=this.getEntry(ja.tuid);}ka.icon_class=ja.isSingleState&&ja.singleStateIconClass?ja.singleStateIconClass:ja.iconClass;if(j.renderKeywordSnippets){ka.category=ja.category;ka.subtext=ja.subtext;}}if(ka.is_redirect)ka.path=ja.path;ka.error_info=ja.errorInfo;ka.logInfo=ja.logInfo;ka.structure=la;ka.text=ka.structure.toString();ka.queryTypeText=ja.queryTypeText;ka.semantic=!!ja.isSingleState&&ja.singleStateSemantic?ja.singleStateSemantic:ja.semantic;ka.alternateSemantic=ja.alternateSemantic;ka.tree=ja.tree;ka.cost=ja.cost;ka.isSeeMore=!!ja.isSeeMore;ka.isNullState=!!ja.isNullState;ka.isSingleState=!!ja.isSingleState;ka.isTrending=!!ja.isTrending;ka.isRecent=!!ja.isRecent;ka.isAdminedPage=!!ja.isAdminedPage;ka.isPrefetched=!!ja.isPrefetched;ka.isSuggestion=!!ja.isSuggestion;ka.isFromGSEF=!!ja.isFromGSEF;ka.isRecentSearchSuggestion=!!ja.isRecentSearchSuggestion;ka.entityInfo=ja.entityInfo;ka.cacheOnlyResult=ja.cacheOnlyResult||false;ka.isExtendedResult=ja.isExtendedResult||false;if(ja.isExtendedResult){ka.uri=w.getURI(this.facebarConfig,ka);}else ka.uri=ka.uri||w.getURI(this.facebarConfig,ka);ka.semanticForest=ja.semanticForest;ka.parse=ja.parse;ka.tags=ja.tags||{};ka.isKeywordL2=ja.isKeywordL2||false;ka.exactMatchKeyword=ja.exactMatchKeyword||false;ka.qid=ja.qid;ka.templateID=ja.templateID;if(ja.isJSBootstrapMatch){ka.isJSBootstrapMatch=ja.isJSBootstrapMatch;ka.backendCost=ja.backendCost;ka.bootstrapCost=ja.bootstrapCost;}this._replaceCategoryWithTermMatches(ka,ja);return ka.tuid;};ia.prototype._replaceCategoryWithTermMatches=function(ja,ka){"use strict";if(ja.type!=="user"||!ja.term_to_subtitle||!ka.termMatches)return;var la=[];ka.termMatches.forEach(function(na){if(ja.term_to_subtitle[na])la.push(ja.term_to_subtitle[na]);},this);if(ja.category===(void 0))ja.category="";var ma=ja.category.split(" \xB7 ");ma.unshift.apply(ma,la);ma=ma.filter(function(na,oa,pa){return oa==pa.indexOf(na);});ja.category=ma.splice(0,2).join(" \xB7 ");};ia.prototype.getRawStructure=function(ja){"use strict";if(typeof ja=='string')ja=o.fromString(ja);if(this.resultStore)return this.resultStore.transformStructured(ja.toArray());};ia.prototype.saveResult=function(ja){"use strict";this._initialQueryData=this.getUID(ja.uid,ja.fetchType);};ia.prototype.isDefaultKeywordQuery=function(ja){"use strict";return (ja.type==='keyword')&&(n.getTextFromResult(ja).toLowerCase()===this.value.getHash().trim().toLowerCase());};ia.prototype.buildUids=function(ja){"use strict";if(!ja||!this.resultStore)return [];if(typeof ja==='string')ja=o.fromString(ja);var ka=this.getRawStructure(ja),la=this.resultStore.getResults(ka,this.getMaxResults()),ma=la.results;if(typeof ma==='undefined')return [];var na=la.null_state===true,oa=0;ma=ma.filter(function(sa,ta){if(!j.allowGrammar&&sa.type=='grammar')return false;return sa.semantic!='<blank>'&&(sa.type!='unimplemented'||oa++===0);},this);var pa=[],qa=[],ra=[];ma.forEach(function(sa){if(sa.forcedPosition>0){ra.push(sa);}else if(sa.isSeeMore){pa.push(sa);}else qa.push(sa);});if(na){ma=this.orderNullState(ma,this.getMaxResults());}else ma=qa;if(ra.length>0){ra.sort(function(sa,ta){return sa.forcedPosition-ta.forcedPosition;});ra.forEach(function(sa){ma.splice(sa.forcedPosition,0,sa);});}if(pa.length>0)ma.push.apply(ma,pa);return ma.map(this.toTypeaheadEntryUid,this);};ia.prototype.orderNullState=function(ja,ka){"use strict";var la={top:[],bottom:[],middle:[]},ma=function(pa){var qa=pa.null_state_position;return la.hasOwnProperty(qa)?qa:'middle';},na=function(pa,qa){return pa.original_cost-qa.original_cost;};ja&&ja.forEach(function(pa){la[ma(pa)].push(pa);},this);for(var oa in la){la[oa]=la[oa].sort(na).slice(0,ka);ka-=la[oa].length;}return [].concat(la.top,la.middle,la.bottom);};ia.prototype.handleResponse=function(ja,ka){"use strict";if(!(ja.payload.errors)){this.processEntries(ja.payload.entities);if(ja.payload.blockees)ja.payload.blockees.forEach(function(la){if(!(this.blockees.hasOwnProperty(la)))this.blockees[la.toLocaleLowerCase()]=la;}.bind(this));ja.payload.results.forEach(function(la){la.qid=ja.queryId;if(!la.parse)la.parse={};la.parse.entTokens=la.parse.entTokens||[];la.parse.remTokens=la.parse.remTokens||[];la.parse.suffix=la.parse.suffix||'';if(q.isEntity(la.semantic))la=this._buildCommonEntityFields(la,ka.tokens);}.bind(this));this.saveResults(ja,ka);}};ia.prototype.saveResults=function(ja,ka){"use strict";var la=[];if(ja.payload.seemore&&this._typeNamedXResults)ja.payload.seemore.forEach(function(ma){la.push(this._typeNamedXResults[ma]);},this);if(ja.payload.prefetched)this.processPrefetched(ja.payload.prefetched);this.resultStore.saveResults(ja.payload.results,ka,ja.payload.incomplete,{},la);};ia.prototype.processPrefetched=function(ja){"use strict";for(var ka in ja){var la=o.fromString(ka),ma=this.getRawStructure(la),na=ja[ka];this.processEntries(na.entities);na.results.forEach(function(oa){if(q.isEntity(oa.semantic))oa=this._buildCommonEntityFields(oa,ma.tokens);}.bind(this));this.resultStore.saveResults(na.results,ma,na.incomplete);}};ia.prototype.processEntries=function(ja){"use strict";return ja.map(function(ka,la){var ma=(ka.uid=ka.uid+'');ka.textToIndex=this.getTitleTerms(ka);ka.titleToIndex=this.getTitleTerms(ka);ma=this.getUID(ma,ka.fetchType);var na=this.getEntry(ma);if(!na){this.setEntry(ma,{});na=this.getEntry(ma);}else{delete ka.photo;if(!j.facebarUpdateSnippets){delete ka.category;delete ka.subtext;}}Object.assign(na,ka);na.tuid=ma;na.index===(void 0)&&(na.index=la);return ma;},this);};ia.prototype.getUID=function(ja,ka){"use strict";ja=ja+'';if(ka!==(void 0)){ka=/([^:]+:)?([^:]+)(:.*)?/.exec(ka)[2];return JSON.stringify([ja,ka]);}return ja;};ia.prototype.getEntry=function(ja,ka){"use strict";var la;ja=''+ja;la=ka!=null?ha.getEntry.call(this,this.getUID(ja,ka))||ha.getEntry.call(this,ja):ha.getEntry.call(this,ja);return la;};ia.prototype.getEntryForFragment=function(ja){"use strict";return this.getEntry(ja.getUID(),ja.getTypePart(2));};ia.prototype.getMaxResults=function(){"use strict";return this._numResults.max;};ia.prototype.query=function(ja,ka,la){"use strict";this.executeQueryThrottled(ja,this._initialQueryData,{keyPress:p.getTimestamp()});this._initialQueryData=null;};ia.prototype.executeQuery=function(ja,ka,la){"use strict";this._curQueryId++;la.queryId=this._curQueryId;la.startCacheQuery=p.getTimestamp();var ma=(this.getMaxResults()+v.additionalResultsToFetch);this.setQueryData({qid:this._curQueryId,max_results:ma});this.inform('beforeQuery',{value:ja,queryId:this._curQueryId});this.value=ja;var na=this.buildUids(ja,[]);la.endCacheQuery=p.getTimestamp();if(ka&&na.length===0)na.push(ka);if(j.sendExistingIDs){var oa=[];na.forEach(function(pa){var qa=this.getEntry(pa);if(qa&&qa.type in l.entityTypes)oa.push(qa.uid);},this);if(oa.length>0)this.setQueryData({qid:this._curQueryID,existing_ids:JSON.stringify(oa),max_results:ma});}this.inform('query',{value:ja,results:na,queryId:this._curQueryId});if(this.resultStore)this.respond(ja,na,false,false,la);};ia.prototype.shouldFetchMore=function(ja,ka){"use strict";if(ja.is_empty)return false;if(this.resultStore.alreadyKnown(ja.cache_id))return false;if(ja.raw_text&&this._isQueryTooShort(ja.raw_text))return false;if(j.alwaysFetchMore)return true;if(ka.length<this.getMaxResults())return true;return this.countValidResults(ka)<this.getMaxResults();};ia.prototype.countValidResults=function(ja){"use strict";var ka=0;ja.forEach(function(la){if(la&&!la.isNullState&&!la.isSeeMore)ka++;},this);return ka;};ia.prototype.sendRemoteQuery=function(ja,ka,la,ma,na){"use strict";var oa=this._single_state,pa=this.getQueryData(ja.text_form);pa.gs_prefetch_mode=ma;if(na)pa.max_results=na;var qa=new h().setURI(this.queryEndpoint).setData(pa).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ra,sa){if(ma&&sa.payload.is_user)return;sa.queryId=ra;sa.inputQuery=ja.text_form;if(sa.payload.results!=null)sa.payload.results.forEach(function(ua){ua.isSingleState=oa;ua.isFromGSEF=ma;});la.endRemoteQuery=p.getTimestamp();this.inform('response_received',sa);this.handleResponse(sa,ja);var ta=[];if(sa.payload.abandon_cache)ta=sa.payload.results.map(this.toTypeaheadEntryUid,this);this.respond(ka,ta,true,sa.payload&&(!sa.payload.results||sa.payload.results.length===0),la);this.inform('backend_response',sa);if(j.disable_snowballing){this.resultStore.resetQueryCache();this.saveResults(sa,ja);}}.bind(this,la.queryId)).setFinallyHandler(this.activityEnd.bind(this));this.inform('sending_request',qa);this._maxRemoteQueryId=la.queryId;la.waitingQueries=this._waitingQueries;la.inflightRequests=h.getInflightCount();la.startRemoteQuery=p.getTimestamp();qa.send();this.activityStart();};ia.prototype.activityStart=function(){"use strict";if(!this._waitingQueries)this.inform('activity',{activity:true},g.BEHAVIOR_STATE);this._waitingQueries++;};ia.prototype.activityEnd=function(){"use strict";this._waitingQueries--;if(!this._waitingQueries)this.inform('activity',{activity:false},g.BEHAVIOR_STATE);};ia.prototype._bucketizeResults=function(ja,ka){"use strict";ka=this._tagKeywordsSuggestions(ka);ka=u.addL2Terms(ka,this.getMaxResults(),ja.toString(),j);ka=s.addTypeNamedX(ka,this.getMaxResults(),ja.toString(),j);var la=Math.min(ka.length,this.getMaxResults());return this._resultsBucketizer.bucketize(ka,la);};ia.prototype._tagKeywordsSuggestions=function(ja){"use strict";if(!ja||ja.length===0)return ja;var ka=ja[0];if(ka.bootstrapped)return ja;if(ka.type==='grammar'||(ka.cost<j.closeEntityThreshold&&ka.type==='user'))return ja;return ja.map(function(la){if(la.type!==l.keywordType)return la;la=Object.assign({},la);la.tags.topBucket=true;return la;});};ia.prototype._buildCommonEntityFields=function(ja,ka){"use strict";if(ja.queryTypeText)return ja;if(j.unbreakParseDisplay){ja.parse.display=[{type:'ent:'+ja.type,uid:ja.semantic}];}else ja.parse.display=[{type:'ent:'+ja.type,uid:parseInt(ja.semantic,10)}];if(ja.parse.fetchType)ja.parse.display[0].fetchType=ja.parse.fetchType;ja.parse.entTokens=ka;ja.parse.pos=0;ja.resultsSetType='{'+ja.type+'}';ja.queryTypeText=l.defaultQueryTypeText;return ja;};ia.prototype.setBypassBucketizer=function(ja){"use strict";this._bypassBucketizer=ja;};ia.prototype.respond=function(ja,ka,la,ma,na){"use strict";if(la&&this.value){if(typeof this.value==='string')this.value=o.fromString(this.value);this.inform('remote_query_match',{isMatch:this.value.matches(ja),queryId:na?na.queryId:0});ja=this.value;if(!ka||ka.length===0)ka=this.buildUids(ja);}this.inform('reorderResults',ka);this.inform('respondValidUids',ka);var oa=ka.map(this.getEntry,this);oa.forEach(function(qa,ra){qa.fromCache=!la;});if(!la){var pa=this.getRawStructure(ja);if(this.shouldFetchMore(pa,oa)){if(na!=null)na.dispatchRemoteQuery=p.getTimestamp();if(this.hasGSPreload){this.sendRemoteQueryThrottled(pa,ja,na,true,this.gsPreloadOptions.max_entities_to_fetch);this.sendRemoteQueryThrottled(pa,ja,na);}else this.sendRemoteQueryThrottled(pa,ja,na);}}if(!la||!na||na.queryId===this._maxRemoteQueryId)this.renderResultsThrottled(ja,oa,la,ma);if(na!=null)this.logLatencies(la,na);};ia.prototype.renderResults=function(ja,ka,la,ma){"use strict";if(!!ja&&(ja instanceof o&&!ja.isEmptyOrWhitespace())&&!this._bypassBucketizer)ka=this._bucketizeResults(ja,ka);ka.length=Math.min(ka.length,this.getMaxResults());this.injectExtraResults(ja,ka);ma=la&&ka.length===0;this.inform('respond',{value:ja,results:ka,isAsync:!!la,isEmptyResults:ma});};ia.prototype.injectExtraResults=function(ja,ka,la){"use strict";k.insertInto(ja,ka,!la);i.insertInto(ja,ka,!la);};ia.prototype.logLatencies=function(ja,ka){"use strict";var la=p.getTimestamp();if(ja){this.inform('remote_query_latency',{queryId:ka.queryId,latencies:{queryStart:Math.max(ka.startRemoteQuery-ka.dispatchRemoteQuery,0),queryEnd:Math.max(ka.endRemoteQuery-ka.startRemoteQuery,0),keyPressToQueryDispatch:Math.max(ka.dispatchRemoteQuery-ka.keyPress,0),keyPressToQueryStart:Math.max(ka.startRemoteQuery-ka.keyPress,0),keyPressToQueryEnd:Math.max(ka.endRemoteQuery-ka.keyPress,0),render:Math.max(la-ka.endRemoteQuery,0),inflightRequests:ka.inflightRequests,waitingQueries:ka.waitingQueries,keyPressToRender:Math.max(la-ka.keyPress,0)}});}else this.inform('cache_query_latency',{queryId:ka.queryId,latencies:{queryStart:Math.max(ka.startCacheQuery-ka.keyPress,0),queryEnd:Math.max(ka.endCacheQuery-ka.startCacheQuery,0),keyPressToQueryEnd:Math.max(ka.endCacheQuery-ka.keyPress,0),render:Math.max(la-ka.endCacheQuery,0),keyPressToRender:Math.max(la-ka.keyPress,0)}});};ia.prototype._updateMaxResults=function(){"use strict";ea(function(){var ja=aa.getViewportDimensions().y,ka=ba.getTop()||42,la=56,ma=48,na=ja-ka-ma-25;this._maxResults=Math.max(this._numResults.min,Math.min(this._numResults.max,Math.floor((na)/la)-1));this.value&&this.query(this.value);}.bind(this));};ia.prototype.getCurQueryId=function(){"use strict";return this._curQueryId;};ia.prototype.setTypenamedXOption=function(ja){"use strict";j.showTypeNamedX=ja;};ia.prototype.setMinQueryLength=function(ja){"use strict";this._minQueryLength=ja;};ia.prototype.setGrammarOption=function(ja){"use strict";j.allowGrammar=ja;};Object.assign(ia.prototype,{events:['query','respond','bootstrapped','activity','ready']});e.exports=ia;},null);
__d("FacebarTypeaheadDebugPane.react",["Banzai","LeftRight.react","React","Image.react"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=i,l=k.PropTypes,m=i.createClass({displayName:"FacebarTypeaheadDebugPane",propTypes:{result:l.object.isRequired},getInitialState:function(){return {feedbackSent:false};},componentWillReceiveProps:function(n){if(n.result!==this.props.result)this.setState({feedbackSent:false});},sendFeedback:function(n){var o=this.props.result;if(o.decoration.entity===o)o.decoration.entity='';var p=JSON.stringify(o),q=JSON.stringify(o.debug.allResults),r={result:p,query:o.debug.query,position:o.debug.position,sid:o.debug.sid,allResults:q,isOK:n};g.post('facebar_feedback',r,{delay:0});this.setState({feedbackSent:true});this.setState({feedbackOK:n});return false;},renderDebugText:function(n){return i.createElement("div",null,n);},render:function(){var n=this.sendFeedback.bind(this,true),o=this.sendFeedback.bind(this,false),p=this.state.feedbackSent,q=p&&this.state.feedbackOK,r=p&&!this.state.feedbackOK;return (i.createElement("div",{className:"fsm pam"},i.createElement(h,null,i.createElement("div",null,this.props.result.debug.map(this.renderDebugText)),i.createElement("div",null,i.createElement("div",{className:q?'':'hidden_elem'},i.createElement("strong",null,"Feedback sent"),i.createElement(j,{className:"mls",src:'/images/green_up.gif'})),i.createElement("div",{className:r?'':'hidden_elem'},i.createElement("strong",null,"Feedback sent"),i.createElement(j,{className:"mls",src:'/images/red_down.gif'})),i.createElement("div",{className:p?'hidden_elem':''},i.createElement("a",{href:"#",onClick:n},i.createElement(j,{src:'/images/green_up.gif'})),i.createElement("a",{href:"#",onClick:o},i.createElement(j,{className:"mls",src:'/images/red_down.gif'})))))));}});e.exports=m;},null);
__d("FacebarTypeaheadDiffText.react",["React","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g,j=i.PropTypes,k=g.createClass({displayName:"FacebarTypeaheadDiffText",propTypes:{prefix:j.string,text:j.string},renderDiff:function(l,m){return (g.createElement("span",{className:"diffNode _5td3",key:m},l));},renderParts:function(){var l=this.props.prefix,m=this.props.text;if(l==null)return this.renderDiff(m,0);var n=m.toLowerCase().indexOf((l.toLowerCase()));l=l.trim();if(n===0)m=m.slice(l.length);var o=m.split(/\b/).map(this.renderDiff);if(n===0)o.unshift(l);return o;},render:function(){return (g.createElement("span",g.__spread({},this.props),this.renderParts()));}});k.generatePrefixes=function(l,m){var n=[],o,p;for(var q=0,r=m.length;q<r;q++){p=m[q].getText();o=l.slice(0,Math.min(l.length,p.length));if(o==='')return n;if(p.toLowerCase().indexOf(o.toLowerCase())===0){n.push(o);l=l.slice(o.length);}else return n;}return n;};e.exports=k;},null);
__d("FacebarTypeaheadHighlightedText.react",["BrowseFacebarHighlighter","React"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=h,j=i.PropTypes,k=h.createClass({displayName:"FacebarTypeaheadHighlightedText",propTypes:{text:j.string,tokens:j.array},renderHighlight:function(l,m){if((m+1)%3===0){return h.createElement("span",{className:"highlightNode",key:m},l);}else if(l)return l;},renderParts:function(){var l=this.props.text,m=this.props.tokens;if(m&&l){var n=g.createRegex(m),o=l.split(n);return o.map(this.renderHighlight);}else return l;},render:function(){return (h.createElement("span",h.__spread({},this.props),this.renderParts()));}});e.exports=k;},null);
__d("FacebarTypeaheadItem.react",["Badge.react","React","FacebarGlobalOptions","FacebarTypeaheadDebugPane.react","FacebarTypeaheadDiffText.react","FacebarTypeaheadHighlightedText.react","TimelineFilterOptions","URI","XUICloseButton.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r=h,s=r.PropTypes;function t(v){var w=v.getTypePart(0);return w?"fragment"+w.charAt(0).toUpperCase()+w.substr(1):"fragment";}var u=h.createClass({displayName:"FacebarTypeaheadItem",propTypes:{result:s.object.isRequired,className:s.string,icon:s.object,token:s.object,highlight:s.array,prefix:s.string,message:s.object,valign:s.bool},getDefaultProps:function(){return {valign:true};},renderHighlightedFragment:function(v,w){return (h.createElement(l,{className:t(v),key:w,text:v.getText(),tokens:this.props.highlight}));},renderDiffedFragment:function(v,w,x){return (h.createElement(k,{className:t(v),key:x,prefix:w,text:v.getText()}));},renderText:function(){var v=this.props.result,w=v.structure.toArray(),x=this.props.prefix;if(i.graphSearchV2&&!v.isSeeMore&&x!=null&&x.trim()!==''){var y=k.generatePrefixes(x,w);return w.map(function(z,aa){if(!y[aa])y[aa]='';return this.renderDiffedFragment(z,y[aa],aa);}.bind(this));}else return w.map(this.renderHighlightedFragment);},renderBadge:function(){if(this.props.result.is_verified){return (h.createElement(g,{type:"verified",size:"medium"}));}else if(this.props.result.is_work_user){return (h.createElement(g,{type:"work",size:"medium"}));}else if(this.props.result.pages_verified_badge===1){return (h.createElement(g,{type:"page_blue_seal",size:"medium"}));}else if(this.props.result.pages_verified_badge===2)return (h.createElement(g,{type:"page_gray_seal",size:"medium"}));},renderIcon:function(){var v=this.props.result,w=v.icon_class;if(w){return (h.createElement("span",{className:"_k83"},h.createElement("span",{className:w})));}else if(v.photo)return (h.createElement("img",{className:"_20h",alt:"",src:v.photo}));},renderLabel:function(){var v=' \u00B7 ',w=this.props.result,x=(("_53ad")+(this.props.valign&&this.props.token&&this.props.token.props&&this.props.token.props.text.length>0?' '+"_55y-":'')+(!w.category&&!w.subtext?' '+"_2vzo":'')+((!w.category&&!!w.subtext)||(w.category&&w.category.indexOf(v)<0&&!w.subtext)?' '+"_2vzp":'')+((w.category&&!!w.subtext)||(w.category&&w.category.indexOf(v)>0)?' '+"_2vzq":'')),y=h.createElement("span",{className:x},this.renderText(),this.renderBadge(),this.props.token),z=(("_7gk")+(this.props.message?' '+"_5byz":''));return (h.createElement("span",{className:z},y,this.props.message));},renderMain:function(){return (h.createElement("span",{className:"_205",rel:"ignore"},this.renderActivityLogXButton(),h.createElement("a",{className:"_6i1",href:this.props.result.uri},h.createElement("span",null,this.props.icon||this.renderIcon(),this.renderLabel()))));},renderActivityLogXButton:function(){if(!this.props.result.isRecentSearchSuggestion)return null;var v=new n('/me/allactivity');v.setQueryData({privacy_source:'activity_log',log_filter:m.SEARCH});return (h.createElement(o,{size:"medium",className:"_2d9t",href:v}));},renderDebug:function(){return this.props.result.debug?h.createElement(j,{result:this.props.result}):null;},render:function(){var v=(("_202")+(' '+"_5bl2")+(' '+"_6_k")+(i.graphSearchV2?' '+"_1et7":'')+(i.renderKeywordSnippets?' '+"_28vg":'')+(i.typeaheadkeywordStyle==='relaxed'?' '+"_3bzk":'')+(i.typeaheadkeywordStyle==='baggy'?' '+"_3bzl":''));return (h.createElement("li",{className:q(v,this.props.className),onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,"aria-label":this.props.result.structure.toString(),role:"option"},this.renderMain(),this.renderDebug()));}});e.exports=u;},null);
__d("FacebarTypeaheadToken.react",["FacebarTypeaheadHighlightedText.react","React","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=h,k=j.PropTypes,l=' \u00B7 ',m=h.createClass({displayName:"FacebarTypeaheadToken",propTypes:{text:k.array.isRequired,highlight:k.array,limit:k.number,innerClass:k.string,leadingMiddot:k.bool,savedContext:k.string},render:function(){var n=null;if(this.props.savedContext)n=h.createElement("span",{className:"_10j2"},this.props.savedContext);var o=this.props.text;if(this.props.limit)o.splice(this.props.limit);o.forEach(function(s,t){if(t!==0||this.props.leadingMiddot||n)o[t]=l+s;}.bind(this));var p=h.createElement(g,{tokens:this.props.highlight,text:o.shift()}),q=o.length?h.createElement(g,{tokens:this.props.highlight,className:"_53ab",text:o.join('')}):null,r=this.props.innerClass||"_53aa";return (h.createElement("span",{className:"_53a9"},h.createElement("span",{className:r},n,p,q)));}});e.exports=m;},null);
__d("FacebarTypeaheadTokenText",["HTML","getElementText"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='\u00B7';function j(n){if(typeof n==='object'){return h(g(n).getRootNode());}else return n||'';}function k(n){return j(n).split(i).map(function(o){return o.trim();});}function l(n){var o={};return n.filter(function(p){var q=!o[p];o[p]=true;return q&&p;});}var m={textForEntity:function(n,o){var p=n.category||o[n.type]||'',q=n.subtext||'',r=k(p).concat(k(q));return l(r);},text:function(n){return l(k(n));}};e.exports=m;},null);
__d("FacebarTypeaheadEntityItem.react",["FacebarGlobalOptions","FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","FacebarTypeaheadTokenText","React","TypeaheadFacepileX.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=k.createClass({displayName:"FacebarTypeaheadEntityItem",renderToken:function(){return (k.createElement(i,{highlight:this.getHighlightTokens(),text:j.textForEntity(this.props.result,{}),savedContext:this.props.result.saved_context}));},renderIcon:function(){if(this.props.result.isNullState){var p=this.props.result.icon_class?k.createElement("span",{className:this.props.result.icon_class}):k.createElement("img",{className:"_20h",src:this.props.result.photo});return (k.createElement("span",{className:((!g.renderKeywordSnippets?"_k83":''))},p));}if(this.props.result.size>1&&this.props.result.photos){return (k.createElement(l,{className:"_51l_",photos:this.props.result.photos,size:this.props.result.size}));}else if(this.props.result.photo)return (k.createElement("img",{className:"_20h",alt:"",src:this.props.result.photo}));},getHighlightTokens:function(){if(this.props.result.original_query){var p=this.props.result.original_query.toString().trim(),q=p.split(' '),r=q.length>1?[p].concat(q):[p];return r.filter(function(s){return (s!=='');});}},render:function(){var p=this.props.className;if(this.props.result.isNullState)p=n(this.props.className,((!g.renderKeywordSnippets?"_207":'')));return (k.createElement(h,k.__spread({},this.props,{className:p,icon:this.renderIcon(),token:this.renderToken(),highlight:this.getHighlightTokens(),valign:true})));}});e.exports=o;},null);
__d("FacebarDisambiguationDialog",["Event","BrowseLogger","CSS","cx","Dialog","DOM","FacebarStructuredText","FacebarTypeaheadEntityItem.react","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=650;function r(s,t,u,v,w){"use strict";this._sets=s;this._path=t;this._ondone=u;this._oncancel=v;this._selection=[];this._typeaheadSID=w;}r.prototype.show=function(){"use strict";new k().setTitle(p._("Which of these did you mean?")).setBody(this._createBody()).setContentWidth(q).setModal(true).setButtons([k.CONFIRM,k.CANCEL]).setHandler(this._handleDone.bind(this)).setCancelHandler(this._handleCancel.bind(this)).show();this._sets.forEach(function(s){var t=[];s.forEach(function(v){t.push(v.uid);});var u=s[0];h.logDisambiguationImpression(u.text,u.type,this._path,t.join(','),this._typeaheadSID);}.bind(this));};r.prototype._createBody=function(){"use strict";var s=[];this._sets.forEach(function(t,u){s.length&&s.push(l.create('li',{className:"_200"}));t.forEach(function(v){var w=this._createItem(v,u);this._selection[u]||this._selectItem(w);s.push(w.root);}.bind(this));}.bind(this));return l.create('ul',{className:'viewList disambiguationList'},s);};r.prototype._createItem=function(s,t){"use strict";var u={uri:null,subtext:s.subtext,category:s.category,photo:s.photo,type:s.type,structure:m.fromStruct([{text:s.text,type:'ent:'+s.type,uid:s.uid}])},v=l.create('div',{className:"_201"}),w=o.createElement(n,{result:u}),x=l.create('div');o.render(w,x);var y=x.firstChild;i.addClass(y,"_6i3");l.appendContent(y,i.hide(v));var z={setId:t,result:s,root:y,check:v};g.listen(y,'mouseover',this._toggleHover.bind(this,z,true));g.listen(y,'mouseout',this._toggleHover.bind(this,z,false));g.listen(y,'click',function(event){this._selectItem(z);return event.kill();}.bind(this));return z;};r.prototype._toggleHover=function(s,t){"use strict";i.conditionClass(s.root,'selected',t);};r.prototype._toggleCheck=function(s,t){"use strict";i.conditionShow(s.check,t);};r.prototype._selectItem=function(s){"use strict";var t=this._selection[s.setId];this._selection[s.setId]=s;t&&this._toggleCheck(t,false);this._toggleCheck(s,true);};r.prototype._handleDone=function(s){"use strict";this._ondone(s==k.CONFIRM?this._selection.map(function(t){var u=t.result;h.logDisambiguationClick(u.text,u.type,this._path,u.index,u.uid,this._typeaheadSID);return u;}.bind(this)):null);};r.prototype._handleCancel=function(){"use strict";this._oncancel();};e.exports=r;},null);
__d("FacebarTypeahead",["Arbiter","Typeahead","emptyFunction"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();for(var j in h)if(h.hasOwnProperty(j))l[j]=h[j];var k=h===null?null:h.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=h;function l(m,n,o,p,q,r){"use strict";h.call(this,m,n,o,p);this.getCore();this.proxyEvents();this.initBehaviors(q||[]);var s=this.core.subscribe('focus',function(){if(r)r.init(this);this.core.unsubscribe(s);this.data.bootstrap(false);this.core.input.focus();}.bind(this));this.data.bootstrap(true);this.inform('init',this,g.BEHAVIOR_PERSISTENT);g.inform('Facebar/init',this,g.BEHAVIOR_PERSISTENT);}l.prototype.proxyEvents=function(){"use strict";var m,n=[],o=null,p=(function(){while(m=n.shift())this.inform(m[0],m[1]);o=null;}).bind(this);[this.data,this.view,this.core].forEach(function(q){q.subscribe(q.events,function(r,s){n.push([r,s]);o=o||setTimeout(p,0);}.bind(this));},this);};Object.assign(l.prototype,{init:i});e.exports=l;},null);
__d("StructuredInputDOM",["createArrayFromMixed","CSS","cx","DOM","FacebarGlobalOptions","getElementText"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=function(){return k.graphSearchV2?"_4v1s":"_586o";},n={ENTITY_CLASS:m(),encodeText:function(o){return o.replace(/ /g,'\u00a0');},decodeText:function(o){return o.replace(/\u00a0/g,' ');},createIconNode:function(o){if(o&&typeof o=='object'){var p=j.create('i',{className:o.className,style:o.uri&&{backgroundImage:'url("'+o.uri+'")'}});p.setAttribute('data-select','ignore');return p;}},createTextNode:function(o){return j.create('span',{'data-si':true},n.encodeText(o||""));},createEntityNode:function(o,p){var q=n.encodeText(o.text),r=n.createIconNode(p.icon),s=j.create('span',{},r?[r,q]:q),t=(p.className||'').split(/\s+/);t.push(n.ENTITY_CLASS);t.forEach(h.addClass.bind(h,s));var u={si:true,uid:o.uid,type:o.type,text:q,fulltext:q,group:p.group,select:p.select,icon:JSON.stringify(p.icon||null)};for(var v in u)if(u[v]!=null)s.setAttribute('data-'+v,u[v]);return s;},convertToTextNode:function(o){o.className='';o.setAttribute('data-type','text');o.removeAttribute('data-group');o.removeAttribute('data-select');o.removeAttribute('data-icon');o.removeAttribute('data-uid');for(var p=o.firstChild;p;p=p.nextSibling)if(!j.isTextNode(p))j.remove(p);},isEntityNode:function(o){return j.isElementNode(o)&&h.hasClass(o,n.ENTITY_CLASS);},containsOnlyText:function(o,p){p=g(p);for(var q=o.firstChild;q;q=q.nextSibling)if(!(j.isTextNode(q)||o.nodeName in p))return false;return true;},getText:function(o){return l(o).replace(/ /g,'\u00a0');},getDecodedText:function(o){return n.decodeText(l(o));},getLength:function(o){return l(o).length;},getMarker:function(o,p,q){var r=o.firstChild;while(r){var s=n.getLength(r);if(s>p||!r.nextSibling){if(j.isTextNode(r)||!q){return {node:r,offset:Math.min(p,s)};}else return n.getMarker(r,p);}else p-=s;r=r.nextSibling;}}};e.exports=n;},null);
__d("StructuredInputUtil",["StructuredInputDOM"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(n,o,p){var q=n.substr(0,o).lastIndexOf(p);return q!==-1?q+1:0;}function i(n,o,p){var q=n.indexOf(p,o);return q!==-1?q:n.length;}function j(n,o,p){return (o===0||o===n.length||n.substr(o,p.length)==p);}function k(n,o,p,q){switch(o){case 'none':return p;case 'all':return q?n.length:0;case 'word':if(j(n,p,'\u00a0')){return p;}else if(q){return i(n,p,'\u00a0');}else return h(n,p,'\u00a0');}}function l(n,o){return o&&g.isEntityNode(n)&&!g.isEntityNode(o);}var m={getMarkerAtOffset:function(n,o){var p=n.firstChild,q=0,r=0;while(p){q+=r;r=g.getLength(p);if(q+r>o){break;}else p=p.nextSibling;}return {node:p||n.lastChild,offset:o-q};},validateEntityText:function(n){var o=g.getText(n),p=n.getAttribute('data-fulltext'),q=n.getAttribute('data-group');if(q=='hashtag'){var r=o.match(/#[^\s]+/);p=r&&r[0];}var s=o.indexOf(p),t={prefix:null,entity:null,suffix:null};switch(q){case 'none':t.entity=o;break;case 'hashtag':case 'all':if(s!=-1){t.prefix=o.substr(0,s);t.entity=o.substr(s,p.length);t.suffix=o.substr(s+p.length);}else t.suffix=o;break;case 'word':if(s!=-1){t.prefix=o.substr(0,s);o=o.substr(s);}var u=0,v=0;while(u<p.length){v=i(p,u+1,'\u00a0');if(o.substr(0,v)!=p.substr(0,v)){break;}else u=v;}t.entity=o.substr(0,u)||null;t.suffix=o.substr(u)||null;}return t;},getGrouping:function(n,o){var p=n.getAttribute('data-group'),q=n.getAttribute('data-select');if(o=='select'){return q=='group'?p:'none';}else return p;},snapMarkerToText:function(n,o){var p=n.node;if(g.isEntityNode(p)){var q=n.offset,r=m.getGrouping(p,o);if(r!='none')if(q===0){var s=p.previousSibling;if(l(p,s))return {node:s,offset:g.getLength(s)};}else if(q==g.getLength(p)){var t=p.nextSibling;if(l(p,t))return {node:t,offset:0};}}return n;},nextMarkerBoundary:function(n,o,p){var q=n.node;if(g.isEntityNode(q)&&(!o||n.offset!==0)){var r=m.getGrouping(q,p);if(r!='none')return {node:n.node,offset:k(g.getText(q),r,n.offset,o)};}return n;}};e.exports=m;},null);
__d("StructuredInputCleaner",["DOM","createArrayFromMixed","StructuredInputUtil","StructuredInputDOM","UserAgent_DEPRECATED","getElementText"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(n,o,p){"use strict";this._node=n;this._selection=o;this._wrapText=p;}m.prototype._cleanEntityNode=function(n){"use strict";var o=n.getAttribute('data-text'),p=j.getText(n);n.style.cssText='';if(o==p&&j.containsOnlyText(n,{I:true}))return null;var q=[],r=i.validateEntityText(n),s=j.createIconNode(JSON.parse(n.getAttribute('data-icon')));if(!r.entity&&((r.suffix&&!r.prefix)||(r.prefix&&!r.suffix))){j.convertToTextNode(n);n.setAttribute('data-text',p);return null;}if(r.prefix)q.push(this._createTextNode(r.prefix));if(r.entity){if(this._selection&&l(n)!==r.entity)this._selection.markDirty(n);g.setContent(n,s?[s,r.entity]:r.entity);n.setAttribute('data-text',r.entity);q.push(n);}if(r.suffix)q.push(this._createTextNode(r.suffix));return q;};m.prototype._removeSpecialNodes=function(){"use strict";var n=h(this._node.getElementsByTagName('script')),o=h(this._node.getElementsByTagName('style'));n.forEach(g.remove);o.forEach(g.remove);};m.prototype._collapseNodes=function(){"use strict";for(var n,o=this._node.firstChild;o;o=n){n=o.nextSibling;if(!g.isTextNode(o)&&!j.isEntityNode(o)&&!j.containsOnlyText(o))for(var p=o.lastChild;p;p=o.lastChild){this._node.insertBefore(p,n);n=p;}}};m.prototype._createTextNode=function(n){"use strict";if(this._wrapText){return j.createTextNode(n);}else return document.createTextNode(n);};m.prototype.replaceNodes=function(n,o){"use strict";if(o==null)return;var p=n.length?n[n.length-1].nextSibling:null;n.forEach(function(q){if(o.indexOf(q)===-1)g.remove(q);},this);o.reverse().forEach(function(q){if(n.indexOf(q)===-1)this._node.insertBefore(q,p);p=q;},this);};m.prototype.clean=function(){"use strict";this._removeSpecialNodes();this._collapseNodes();var n=[],o=function(){if(n.length){this.replaceNodes(n,this._cleanTextNodes(n));n.length=0;}}.bind(this);h(this._node.childNodes).forEach(function(p){if(j.isEntityNode(p)){this.replaceNodes([p],this._cleanEntityNode(p));o(n);}else n.push(p);}.bind(this));o();if(!this._node.firstChild&&k.firefox())this._node.appendChild(this._createTextNode());};m.prototype.endOnText=function(){"use strict";var n=function(o,p){if(j.isEntityNode(o))this._node.insertBefore(this._createTextNode(),p?o:null);}.bind(this);n(this._node.firstChild,true);n(this._node.lastChild,false);};Object.assign(m.prototype,{_cleanTextNodes:(function(){var n=function(p){return (p.nodeName==='BR'||p.nodeName==='SPAN'&&o(p));},o=function(p){return p.getAttribute('data-si')&&j.containsOnlyText(p)&&j.getLength(p)>0;};return function(p){if(p.length!=1||!n(p[0])){var q=p.map(j.getText).join('').replace(/\s+/g,' ');return q?[this._createTextNode(q)]:[];}else{p[0].style.cssText='';return;}};})()});e.exports=m;},null);
__d("DOMSelection",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();(function(){var g=this,h={isPreceding:function(n,o){return o.compareDocumentPosition(n)&2;},contains:function(n,o){if(n.compareDocumentPosition!=null){return n.compareDocumentPosition(o)&16;}else return n.contains(o);},isCursorPreceding:function(n,o,p,q){if(n===p)return o<=q;if(h.isText(n)&&h.isText(p))return h.isPreceding(n,p);if(h.isText(n)&&!h.isText(p))return !h.isCursorPreceding(p,q,n,o);if(!h.contains(n,p))return h.isPreceding(n,p);if(n.childNodes.length<=o)return false;if(n.childNodes[o]===p)return 0<=q;return h.isPreceding(n.childNodes[o],p);},isText:function(n){return (n!=null?n.nodeType==3:false);},getChildIndex:function(n){var o=0;while(n=n.previousSibling)o++;return o;}},i=g.Selection=(function(){function n(o){this.win=o;}n.prototype.hasSelection=function(){return n.hasSelection(this.win);};n.prototype.isBidirectional=function(){return n.isBidirectional(this.win);};n.prototype.getOrigin=function(){return n.getOrigin(this.win);};n.prototype.getFocus=function(){return n.getFocus(this.win);};n.prototype.getStart=function(){return n.getStart(this.win);};n.prototype.getEnd=function(){return n.getEnd(this.win);};n.prototype.trySelection=function(o,p,q,r){return n.trySelection(this.win,o,p,q,r);};n.prototype.setSelection=function(o,p,q,r){return n.setSelection(this.win,o,p,q,r);};n.prototype.clearSelection=function(){return n.clearSelection(this.win);};return n;})();function j(){if(g.document.selection&&/MSIE 9\./.test(navigator.userAgent)){return false;}else return !!g.getSelection;}if(j()){i.supported=true;i.hasSelection=function(n){var o;return (o=n.getSelection())&&(o.focusNode!=null)&&(o.anchorNode!=null);};i.isBidirectional=function(n){return true;};i.getOrigin=function(n){var o;if(!((o=n.getSelection())&&(o.anchorNode!=null)))return null;return [o.anchorNode,o.anchorOffset];};i.getFocus=function(n){var o;if(!((o=n.getSelection())&&(o.focusNode!=null)))return null;return [o.focusNode,o.focusOffset];};i.getStart=function(n){var o,p,q,r,s,t;if(!i.hasSelection(n))return null;s=i.getOrigin(n),o=s[0],q=s[1];t=i.getFocus(n),p=t[0],r=t[1];if(h.isCursorPreceding(o,q,p,r))return [o,q];return [p,r];};i.getEnd=function(n){var o,p,q,r,s,t;if(!i.hasSelection(n))return null;s=i.getOrigin(n),o=s[0],q=s[1];t=i.getFocus(n),p=t[0],r=t[1];if(h.isCursorPreceding(o,q,p,r))return [p,r];return [o,q];};var k=function(n,o,p,q,s,t){var u=o.getSelection();if(!u)return;if(s==null)s=p;if(t==null)t=q;if(u.collapse&&u.extend){u.collapse(p,q);u.extend(s,t);}else{r=o.document.createRange();r.setStart(p,q);r.setEnd(s,t);if(n||!i.hasSelection(o)||(r.endContainer===s&&r.endOffset===t&&r.startContainer===p&&r.startOffset===q)){try{u.removeAllRanges();}catch(v){}u.addRange(r);}}};i.setSelection=k.bind(i,true);i.trySelection=k.bind(i,false);i.clearSelection=function(n){try{var p=n.getSelection();if(!p)return;p.removeAllRanges();}catch(o){}};i.getText=function(n){var o=n.getSelection();if(!o)return;return o.toString();};}else if(g.document.selection){var l=function(n,o,p){var q,r,s,t,u;r=n.createElement('a');q=o.duplicate();q.collapse(p);u=q.parentElement();while(true){u.insertBefore(r,r.previousSibling);q.moveToElementText(r);if(!(q.compareEndPoints((p?'StartToStart':'StartToEnd'),o)>0&&(r.previousSibling!=null)))break;}if(q.compareEndPoints((p?'StartToStart':'StartToEnd'),o)===-1&&r.nextSibling){q.setEndPoint((p?'EndToStart':'EndToEnd'),o);s=r.nextSibling;t=q.text.length;}else{s=r.parentNode;t=h.getChildIndex(r);}r.parentNode.removeChild(r);return [s,t];},m=function(n,o,p,q,r){var s,t,u,v,w;w=0;s=h.isText(q)?q:q.childNodes[r];t=h.isText(q)?q.parentNode:q;if(h.isText(q))w=r;v=n.createElement('a');t.insertBefore(v,s||null);u=n.body.createTextRange();u.moveToElementText(v);v.parentNode.removeChild(v);o.setEndPoint((p?'StartToStart':'EndToEnd'),u);return o[p?'moveStart':'moveEnd']('character',w);};i.supported=true;i.hasSelection=function(n){var o;if(!n.document.selection)return false;o=n.document.selection.createRange();return o&&o.parentElement().document===n.document;};i.getStart=function(n){var o;if(!i.hasSelection(n))return null;o=n.document.selection.createRange();return l(n.document,o,true);};i.getEnd=function(n){var o;if(!i.hasSelection(n))return null;o=n.document.selection.createRange();return l(n.document,o,false);};i.isBidirectional=function(n){return false;};i.getOrigin=function(n){return i.getStart(n);};i.getFocus=function(n){return i.getEnd(n);};var k=function(n,o,p,q,r,s){if(r==null)r=p;if(s==null)s=q;var t=o.document.body.createTextRange();m(o.document,t,false,r,s);m(o.document,t,true,p,q);return t.select();};i.setSelection=k.bind(i,true);i.trySelection=k.bind(i,false);i.clearSelection=function(n){return n.document.selection.empty();};i.getText=function(n){if(!i.hasSelection(n))return null;var o=n.document.selection.createRange();return o&&o.text;};}else i.supported=false;}).call(this);e.exports=Selection;},null);
__d("StructuredInputSelection",["DOM","DOMSelection","Scroll","Vector","StructuredInputUtil","StructuredInputDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(o){"use strict";var p=o.ownerDocument;this.window=p.defaultView||p.parentWindow;this.root=o;this.selection=false;this.start=new n(this,[]);this.end=new n(this,[]);this.update();}m.prototype.isSupported=function(){"use strict";return !!(h&&h.hasSelection);};m.prototype.update=function(){"use strict";this.selection=false;if(this.isSupported()&&this.root==document.activeElement)if(h.hasSelection(this.window)){var o=h.getStart(this.window),p=h.getEnd(this.window),q=h.getFocus(this.window);this.start=this.makeMarker(o);this.end=this.makeMarker(p);this.backward=o[0]==q[0]&&o[1]==q[1];this.selection=this.start.node&&this.end.node;}};m.prototype.makeMarker=function(o){"use strict";if(o[0]===this.root){return new n(this,[this.root.childNodes[o[1]],0]);}else return new n(this,o);};m.prototype.getFocus=function(){"use strict";return this.backward?this.start:this.end;};m.prototype.getOrigin=function(){"use strict";return this.backward?this.end:this.start;};m.prototype.move=function(o){"use strict";if(this.selection){this.start.move(o);this.start.snap();this.end.setPosition(this.start);return this.apply();}};m.prototype.expand=function(o){"use strict";if(this.selection){if(h.isBidirectional()){this.start.move(!o);this.start.snap();this.end.move(o);this.end.snap();}return this.apply();}};m.prototype.getText=function(){"use strict";if(this.selection&&this.isSupported()){var o=h.getText(this.window);return o;}};m.prototype.getOffset=function(){"use strict";if(this.selection)return this.start.rootOffset;};m.prototype.getLength=function(){"use strict";return (this.getText()||"").length;};m.prototype.setPosition=function(o,p){"use strict";this.backward=false;this.selection=true;this.start.setPosition(k.getMarkerAtOffset(this.root,o));this.start.snap();if(p>0){this.end.setPosition(k.getMarkerAtOffset(this.root,o+p));this.end.snap();}else this.end.setPosition(this.start);return this.apply();};m.prototype.hasRange=function(){"use strict";return this.selection&&(this.start.node!=this.end.node||this.start.offset!=this.end.offset);};m.prototype.scrollToFocus=function(){"use strict";var o=5,p=this.getFocus();if(p.node){var q=j.getElementDimensions(this.root).x,r=i.getLeft(this.root),s=p.node.offsetLeft+p.node.offsetWidth;if(s-r<o){i.setLeft(this.root,s-o);}else if(s-r>q-o)i.setLeft(this.root,s-q+o);}};m.prototype.apply=function(){"use strict";if(this.start.hasChanged()||this.end.hasChanged()){var o=this.getOrigin().getMarker(true),p=this.getFocus().getMarker(true);this.selection=this.selection&&o&&o.node&&p&&p.node;if(this.selection&&this.isSupported()){this.start.changed=false;this.end.changed=false;h.trySelection(this.window,o.node,o.offset,p.node,p.offset);return true;}}};m.prototype.markDirty=function(o){"use strict";if(g.contains(o,this.start.node,o))this.start.changed=true;if(g.contains(o,this.end.node,o))this.end.changed=true;};function n(o,p){"use strict";this.selection=o;this.node=p[0];this.offset=p[1];this.rootOffset=this.getRootOffset(p[0],p[1]);this.sibling=this.node&&this.node.previousSibling;this.changed=false;}n.prototype.hasChanged=function(){"use strict";return this.changed||!this.isNodeValid();};n.prototype.isNodeValid=function(){"use strict";if(l.getLength(this.node)>this.offset){var o=this.node;while(o=o.parentNode)if(o==this.selection.root)return true;}};n.prototype.getMarker=function(o){"use strict";if(this.isNodeValid()&&((o&&!this.node.firstChild)||(!o&&this.node.parentNode==this.selection.root))){return this;}else return l.getMarker(this.selection.root,this.rootOffset,o);};n.prototype.move=function(o){"use strict";this.node&&this.setPosition(k.nextMarkerBoundary(this.getMarker(false),o,'select'));};n.prototype.snap=function(){"use strict";this.node&&this.setPosition(k.snapMarkerToText(this.getMarker(false),'select'));};n.prototype.setPosition=function(o){"use strict";if(o.offset!=this.offset||o.node!=this.node){this.changed=true;this.node=o.node;this.offset=o.offset;this.rootOffset=this.getRootOffset(this.node,this.offset);}};n.prototype.getRootOffset=function(o,p){"use strict";var q=0,r=5;while(o&&q++<r)if(o===this.selection.root){return p;}else{var s=o;while(s=s.previousSibling)p+=l.getLength(s);o=o.parentNode;}};e.exports=m;},null);
__d("StructuredInput",["Arbiter","ArbiterMixin","CSS","DOM","DataStore","Event","Input","InputSelection","JSLogger","Keys","Locale","Parent","Scroll","StructuredInputCleaner","StructuredInputDOM","StructuredInputSelection","StructuredInputUtil","Style","UserAgent_DEPRECATED","createArrayFromMixed","createObjectFrom","cx","csx","emptyFunction","getActiveElement","setTimeoutAcrossTransitions","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){b.__markCompiled&&b.__markCompiled();var ha=229,ia=aa([p.UP,p.DOWN,p.LEFT,p.RIGHT,p.HOME,p.END]),ja=aa([p.BACKSPACE,p.DELETE]),ka=aa([p.SPACE,p.RETURN]),la=aa('IUB'.split('').map(function(ta){return ta.charCodeAt(0);})),ma=y.firefox(),na=y.ie(),oa=y.webkit(),pa=ga(h);for(var qa in pa)if(pa.hasOwnProperty(qa))sa[qa]=pa[qa];var ra=pa===null?null:pa.prototype;sa.prototype=Object.create(ra);sa.prototype.constructor=sa;sa.__superConstructor__=pa;function sa(ta){"use strict";pa.call(this);k.set(ta,'StructuredInput',this);this._root=ta;this._richInput=j.find(ta,"._586i");this._textInput=j.find(ta,"._586f");this._placeholderText=j.scry(ta,"._586j")[0];this._hintText=j.find(ta,"._586k");this._contentWidth=null;this._richWidth=null;this._hintNodes=[];g.subscribe(o.DUMP_EVENT,function(ua,va){va.structuredInputState={initInputsFinished:!!this._initInputsFinished,initEventsFinished:!!this._initEventsFinished,cleanInputPreTogglesFinished:!!this._cleanInputPreTogglesFinished,cleanInputFinished:!!this._cleanInputFinished,elements:{richInput:!!this._richInput,textInput:!!this._textInput,placeholderText:!!this._placeholderText,hintText:!!this._hintText}};}.bind(this));this.init();}sa.prototype.init=function(){"use strict";this.init=da;this._initSelection();this._initCleaner();this._initInputs();this._initInputsFinished=true;this._initEvents();this._initEventsFinished=true;this._scheduledCleanInput=false;this._richChanged=false;this._textChanged=false;this._selectionChanged=false;this._selectionIgnore=false;this._imeMode=false;this.cleanInput();this.inform('init',null,g.BEHAVIOR_PERSISTENT);};sa.prototype._initInputs=function(){"use strict";this._richInput.contentEditable=true;this._richInput.spellcheck=false;this._richInput.tabIndex=1;this._textInput.tabIndex=-1;this._multiline=this._textInput.nodeName=='TEXTAREA';if(!i.shown(this._richInput)){var ta=n.get(this._textInput),ua=ea()===this._textInput;j.setContent(this._richInput,u.encodeText(m.getValue(this._textInput)));i.hide(this._textInput);i.show(this._richInput);this.cleanInput();if(ua){this._richInput.focus();this.setSelection({offset:ta.start,length:ta.end-ta.start});}}this.togglePlaceholder();this._toggleHint();};sa.prototype._initEvents=function(){"use strict";var ta=null,ua=false,va=function(){this._richChanged=true;ua||this.scheduleCleanInput(true);}.bind(this),wa=function(){this._textChanged=true;ua||this.scheduleCleanInput(false);}.bind(this),xa=function(){this._selectionChanged=true;this.scheduleCleanInput(false);}.bind(this),ya=function(){this._imeMode=true;this._placeholderText&&i.hide(this._placeholderText);i.hide(this._hintText);}.bind(this),za=function(){this._imeMode=false;this._richChanged=true;this.cleanInput();}.bind(this);l.listen(this._richInput,'keydown',function(ab){ta=ab.keyCode;if(ab.ctrlKey&&ab.keyCode in la){return ab.kill();}else if(ab.keyCode in ia){xa();}else if(ab.keyCode===p.BACKSPACE&&this._deleteTrailingChunk()){this._richChanged=true;this.cleanInput();return ab.kill();}else if(ab.keyCode in ja){va();}else if(ab.keyCode==ha)ya();}.bind(this));l.listen(this._richInput,'keypress',function(ab){if(ab.keyCode==p.RETURN){this._multiline&&this._insertText("\n");return ab.kill();}else if(!this._selectionChanged&&this._selectionIsText()){wa();}else va();}.bind(this));if(!ua){l.listen(this._richInput,'keyup',function(ab){if((this._imeMode||ab.keyCode!=ta)&&ab.keyCode in ka){za();return ab.kill();}else if(this._imeMode){this._textChanged=true;this.cleanInput();}}.bind(this));if(ma)l.listen(this._richInput,'input',function(){this._textChanged=true;this.cleanInput();}.bind(this));}else{l.listen(this._richInput,'compositionstart',ya);l.listen(this._richInput,'compositionend',function(){setTimeout(za,0);});l.listen(this._richInput,'input',function(){this._textChanged=true;if(!this._imeMode)if(!this._richChanged){this.cleanInput();}else this.scheduleCleanInput();}.bind(this));}l.listen(document,'selectionchange',function(){if(this._selectionIgnore){this._selectionIgnore=false;}else this._selectionChanged=true;}.bind(this));l.listen(this._richInput,'mousedown',function(){this._selectionChanged=true;this._selectionLength=0;this._selectionOffset=0;}.bind(this));l.listen(this._richInput,'mouseup',function(){this._selectionChanged=true;this.scheduleCleanInput();}.bind(this));l.listen(this._richInput,'cut',function(){this._richChanged=true;this.scheduleCleanInput(false);}.bind(this));l.listen(this._richInput,'paste',function(ab){this._richChanged=true;this.scheduleCleanInput(true);}.bind(this));l.listen(this._richInput,'drop',function(ab){this.focus();this.selectAll();this._insertClipboard(ab&&ab.dataTransfer);return ab.kill();}.bind(this));l.listen(this._richInput,'dragover',function(ab){ab.dataTransfer.dropEffect='move';ab.dataTransfer.effectAllowed='move';return ab.kill();});l.listen(this._richInput,'focus',function(ab){this._toggleHint();this.inform('focus');}.bind(this));l.listen(this._richInput,'blur',function(ab){i.hide(this._hintText);this._imeMode=false;this._richChanged=true;this.scheduleCleanInput(false);this.inform('blur');}.bind(this));};sa.prototype._initCleaner=function(){"use strict";this._cleaner=new t(this._richInput,this._selection,true);};sa.prototype._initSelection=function(){"use strict";this._selection=new v(this._richInput);this._selectionLength=0;this._selectionOffset=0;};sa.prototype._insertClipboard=function(ta){"use strict";if(ta&&typeof ta.getData==='function'){var ua=ta.getData('Text');this._insertText(ua);}};sa.prototype._deleteTrailingChunk=function(ta){"use strict";var ua=this.getSelection();if(ua.length>0||ua.offset===0)return false;var va=this.getSelection().offset-1,wa=w.getMarkerAtOffset(this._richInput,va);if(wa&&u.isEntityNode(wa.node)&&w.getGrouping(wa.node,'select')!=='none'){j.remove(wa.node);return true;}return false;};sa.prototype._selectionIsText=function(){"use strict";var ta=this._selection.start.node,ua=this._selection.end.node;return ta&&ta===ua&&!u.isEntityNode(ta)&&!u.isEntityNode(ta.parentNode);};sa.prototype._insertText=function(ta){"use strict";if(ta){var ua=j.create('div',{},ta);return this._insertNodes(ua);}};sa.prototype._insertHTML=function(ta){"use strict";if(ta){var ua=j.create('div'),va=new t(ua,null,false);ua.innerHTML=ta;va.clean();return this._insertNodes(ua);}};sa.prototype._insertNodes=function(ta){"use strict";if(document.selection){document.selection.createRange().pasteHTML(ta.innerHTML);}else document.execCommand('insertHTML',false,ta.innerHTML);this._richChanged=true;this.cleanInput();};sa.prototype.togglePlaceholder=function(ta){"use strict";if(!this._placeholderText)return;var ua=u.getLength(this._richInput)===0;if(ta&&ua){i.show(this._placeholderText);}else i.conditionShow(this._placeholderText,ua&&!this._imeMode);};sa.prototype._toggleHint=function(){"use strict";var ta=z(this._hintNodes),ua=null,va='',wa=u.getText(this._richInput).toLowerCase();if(!this.hasFocus())return;if(this._contentOverflows()){i.hide(this._hintText);return;}while(ta.length&&va.length<wa.length){ua=ta.shift();va+=u.getText(ua);}if(wa.length&&va.substr(0,wa.length).toLowerCase()==wa.toLowerCase()){j.setContent(this._hintText,z(this._richInput.cloneNode(true).childNodes).filter(function(ya){return ya.tagName!=='BR';}));var xa=u.createTextNode(va.substr(wa.length));ta.unshift(xa);j.appendContent(this._hintText,j.create('span',{className:"_586h"},ta));i.show(this._hintText);i.hide(this._placeholderText);}else i.hide(this._hintText);};sa.prototype._contentOverflows=function(){"use strict";if(this._richWidth===null)this._richWidth=this._richInput.clientWidth;if(this._contentWidth===null){var ta=this._richInput.lastChild;this._contentWidth=j.isElementNode(ta)?ta.offsetLeft+ta.offsetWidth:0;}return this._contentWidth>this._richWidth;};sa.prototype._forceTop=function(){"use strict";if(!this._multiline)s.setTop(this._richInput,0);s.setTop(this._root,0);};sa.prototype._createStructureNodes=function(ta){"use strict";return ta.map(function(ua){return ua.uid||(ua.type&&ua.type!='text')?u.createEntityNode(ua,ua.display||{}):u.createTextNode(ua.text);}.bind(this));};sa.prototype._suppressInput=function(){"use strict";if(ma||na){if(this._richClean)return;this._richClean=this._richInput.cloneNode(true);this._richClean.contentEditable=false;this._root.insertBefore(this._richClean,this._richInput.nextSibling);s.setLeft(this._richClean,s.getLeft(this._richInput));x.set(this._richInput,'padding',0);x.set(this._richInput,'height',0);}};sa.prototype._revealInput=function(){"use strict";if(!this._richClean)return;x.set(this._richInput,'height','');x.set(this._richInput,'padding','');this._root.removeChild(this._richClean);this.focus();this._richClean=null;};sa.prototype._cleanInput=function(){"use strict";var ta;if(this._textChanged&&!this._richChanged){this._selection.update();ta='change';}else if(this._richChanged||this._selectionChanged){this._selection.update();if(this._richChanged){this._contentWidth=null;this._cleaner.clean();this._cleaner.endOnText();this._selection.apply();ta='change';}if(this._selectionChanged){this._cleanSelection();if(this._selectionLength||!this._richChanged)ta='select';}}this._revealInput();this._forceTop();this._cleanInputPreTogglesFinished=true;if(this._richChanged||this._textChanged){this.togglePlaceholder();this._toggleHint();}this._selectionIgnore=true;this._selectionChanged=false;this._richChanged=false;this._textChanged=false;this._cleanInputFinished=true;ta&&this.inform(ta);};sa.prototype._cleanSelection=function(){"use strict";var ta=this._selection.getLength(),ua=this._selection.getOffset();if(ta){this._selection.expand(ta>=this._selectionLength);ta=this._selection.getLength();ua=this._selection.getOffset();}this._selectionLength=ta;this._selectionOffset=ua;};sa.prototype.cleanInput=function(){"use strict";this._scheduledCleanInput||this._cleanInput();};sa.prototype.scheduleCleanInput=function(ta){"use strict";ta&&this._suppressInput();if(!this._scheduledCleanInput){this._scheduledCleanInput=true;fa(function(){this._cleanInput();this._scheduledCleanInput=false;}.bind(this),0);}};sa.prototype.setEnabled=function(ta){"use strict";this._textInput.disabled=!ta;this._richInput.contentEditable=ta;};sa.prototype.getRoot=function(){"use strict";return this._root;};sa.prototype.getRichInput=function(){"use strict";return this._richInput;};sa.prototype.getEnabled=function(){"use strict";return !this._textInput.disabled;};sa.prototype.getText=function(){"use strict";return u.getDecodedText(this._richInput);};sa.prototype.setText=function(ta){"use strict";j.setContent(this._richInput,u.createTextNode(ta));this._richChanged=false;this._selectionChanged=false;this.inform('change');};sa.prototype.setHint=function(ta){"use strict";this._hintNodes=this._createStructureNodes(ta);this._toggleHint();};sa.prototype.getStructure=function(){"use strict";var ta=[];z(this._richInput.childNodes).forEach(function(ua){var va=!j.isTextNode(ua),wa=u.getDecodedText(ua);wa.length&&ta.push({text:wa,uid:va?ua.getAttribute('data-uid'):null,type:(va&&ua.getAttribute('data-type'))||'text'});}.bind(this));return ta;};sa.prototype.setStructure=function(ta){"use strict";j.setContent(this._richInput,this._createStructureNodes(ta));this._cleaner.clean();this._cleaner.endOnText();this.togglePlaceholder();this._toggleHint();this._richChanged=false;this._selectionChanged=false;this.inform('change');};sa.prototype.getContentDimensions=function(){"use strict";var ta=this._richInput.lastChild;return {width:ta?ta.offsetLeft+ta.offsetWidth:0,height:ta?ta.offsetTop+ta.offsetHeight:0};};sa.prototype.getSelection=function(){"use strict";if(this._selection)return {offset:this._selection.getOffset(),length:this._selection.getLength()};};sa.prototype.setSelection=function(ta){"use strict";if(this.hasFocus()&&this._selection){this._selection.update();this._selection.setPosition(ta.offset,ta.length);this._selection.scrollToFocus();this._selectionChanged=false;this.inform('select');}};sa.prototype.moveSelectionToEnd=function(){"use strict";this.setSelection({length:0,offset:u.getLength(this._richInput)});};sa.prototype.isSelectionAtEnd=function(){"use strict";var ta=this.getSelection().offset,ua=u.getLength(this._richInput);return ta>=ua;};sa.prototype.selectAll=function(){"use strict";this.setSelection({offset:0,length:u.getLength(this._richInput)});};sa.prototype.hasFocus=function(){"use strict";return j.contains(this._root,document.activeElement);};sa.prototype.focus=function(){"use strict";this._richInput.focus();};sa.prototype.blur=function(){"use strict";var ta={position:'absolute',top:0,width:'1px',height:'1px'};if(q.isRTL()){ta.right='-100px';}else ta.left='-100px';var ua=j.create('input',{type:'text',tabIndex:-1,style:ta});j.appendContent(this._root,ua);var va=function(){if(this.hasFocus()||(oa&&document.activeElement===document.body)){ua.focus();ua.blur();}};this.blur=va;this.blur();};sa.getInstance=function(ta){var ua=r.byClass(ta,"_586g");if(!ua)throw new Error('No DOMElement structured input found using '+ta);return k.get(ua,'StructuredInput')||new sa(ua);};e.exports=sa;},null);
__d("FacebarTypeaheadInput",["ArbiterMixin","csx","DOM","FacebarStructuredText","StructuredInput","Vector","Locale","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o={text:{className:"text",group:"all",select:"none"},ent:{className:"entity",group:"all",select:"group"},'ent:hashtag_exact':{className:"entity",group:"hashtag",select:"none"}};function p(u){return Object.assign(u.toStruct(),{display:o[u.getType()]||o[u.getTypePart(0)]});}var q=n(g);for(var r in q)if(q.hasOwnProperty(r))t[r]=q[r];var s=q===null?null:q.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=q;function t(u){"use strict";q.call(this);this.root=u;this.input=k.getInstance(u);this.value=null;this.selection={offset:0,length:0};this.resetOnChange=true;this.initEvents();}t.prototype.initEvents=function(){"use strict";var u=function(v,w){this.inform(v,w);}.bind(this);this.input.subscribe('blur',u);this.input.subscribe('focus',u);this.input.subscribe('change',function(v,w){if(this.resetOnChange)this.value=null;this.inform('change',w);}.bind(this));};t.prototype.togglePlaceholder=function(u){"use strict";return this.input.togglePlaceholder(u);};t.prototype.focus=function(){"use strict";this.input.focus();};t.prototype.blur=function(){"use strict";this.input.blur();};t.prototype.getElement=function(){"use strict";return this.root;};t.prototype.getRawPlaceholderElement=function(){"use strict";return i.find(this.root,"._586j");};t.prototype.getRawInputElement=function(){"use strict";return i.scry(this.root,"._586i")[0];};t.prototype.getValue=function(){"use strict";if(this.value===null)this.value=j.fromStruct(this.input.getStructure());return this.value;};t.prototype.getLength=function(){"use strict";return this.getValue().getLength();};t.prototype.resetPlaceholder=function(){"use strict";this.input.resetPlaceholder();};t.prototype.setValue=function(u,v){"use strict";this.value=u;this.resetOnChange=!!v;var w=u.toArray().map(p);this.input.setStructure(w);this.input.setSelection({offset:u.getLength(),length:0});this.resetOnChange=true;};t.prototype.storeSelection=function(){"use strict";this.selection=this.input.getSelection();};t.prototype.restoreSelection=function(){"use strict";if(this.selection)this.input.setSelection(this.selection);};t.prototype.setHint=function(u){"use strict";var v=u&&!u.hasRTL()&&!m.isRTL()?u.toArray().map(p):[];this.input.setHint(v);};t.prototype.isSelectionAtEnd=function(){"use strict";return this.input.isSelectionAtEnd();};t.prototype.selectInput=function(u){"use strict";this.input.setSelection({offset:u||0,length:this.getLength()});};t.prototype.getEndOffset=function(){"use strict";var u=l.getElementDimensions(this.root),v=this.input.getContentDimensions();return Math.min(u.x,v.width);};Object.assign(t.prototype,{events:['change','focus','blur']});e.exports=t;},null);
__d("FacebarTypeaheadWebSearch",["FacebarStructuredFragment","FacebarStructuredText"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=new g({type:'ent:websuggestion',text:'Web Search: ',uid:null}),j=i.getText().toLowerCase().trim();function k(n,o){if(!n||n.type!=='websuggestion')return;var p=o.getValue().toArray();p.forEach(function(q){if(q.isType('ent')&&!q.isType('ent','user')&&q.getUID())if(n.extra_uri_params){n.extra_uri_params.qh=q.getUID();return;}});}function l(n){return n.getType()===i.getType();}function m(n){"use strict";this._core=n.getCore();this._view=n.getView();this._input=this._core.input;this._isEnabled=false;}m.prototype.enable=function(){"use strict";this._isEnabled=true;this.changeListener=this._input.subscribe('change',this._changeWebSearch.bind(this));this.lockListener=this._input.subscribe('shortcut',this._lockWebSearch.bind(this));this.beforeSelectListener=this._view.subscribe('beforeSelect',this._beforeSelect.bind(this));this.beforeRenderListener=this._view.subscribe('beforeRender',this._beforeRender.bind(this));};m.prototype._changeWebSearch=function(){"use strict";var n=this._input.getValue(),o=n.toArray(),p=o[0];if(p&&p.getType()==='text')if(p.getText().toLowerCase().startsWith(j)){o.splice(0,1,i,new g({text:p.getText().substr(j.length).replace(/^ /,'')}));this._replaceFragments(o);}else if(o.length>1&&o.some(l)){var q='';o.forEach(function(r){if(l(r))return;q+=r.getText();});this._input.storeSelection();this._input.setValue(h.fromString(q));this._input.restoreSelection();}};m.prototype._replaceFragments=function(n){"use strict";this._input.storeSelection();this._input.setValue(new h(n));this._input.restoreSelection();};m.prototype._beforeSelect=function(n,o){"use strict";k(o.selected,this._input);return true;};m.prototype._beforeRender=function(n,o){"use strict";var p=this._input.getValue().toArray()[0],q=p&&l(p);o.results.forEach(function(r){if(r.type==='websuggestion')r.isLockedWebSearchMode=q;});return true;};m.prototype._lockWebSearch=function(n,o){"use strict";if(o.shift){var p=this._input.getValue().toArray()[0];if(!p||!l(p))this._input.setValue(new h([i]));}};m.prototype.disable=function(){"use strict";this.beforeSelectListener.unsubscribe();this.changeListener.unsubscribe();this.lockListener.unsubscribe();this.beforeRenderListener.unsubscribe();this._isEnabled=false;};m.addPrefix=function(n){"use strict";var o=l(n.getFragment(0))||n.getFragment(0).getText().toLowerCase().startsWith(j);if(!o){var p=[i].concat(n.toArray());return new h(p);}else return n;};e.exports=m;},null);
__d("FacebarTypeaheadCore",["Animation","Arbiter","ArbiterMixin","Base64","DOM","Event","FacebarGlobalOptions","FacebarJSConstants","FacebarKeywordSearchUtils","FacebarResultStoreUtils","FacebarStructuredText","FacebarTypeaheadInput","FacebarTypeaheadWebSearch","Keys","KeywordsSearchResultConfig","Parent","Style","URI","arrayContains","cx","csx","getActiveElement","invariant","mixin","setTimeout"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){b.__markCompiled&&b.__markCompiled();var fa=da(i);for(var ga in fa)if(fa.hasOwnProperty(ga))ia[ga]=fa[ga];var ha=fa===null?null:fa.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=fa;function ia(ja){"use strict";fa.call(this);Object.assign(this,ja);}ia.prototype.init=function(ja,ka,la){"use strict";if(window.getSelection===null)throw new Error('Facebar: window.getSelection is null!');this.init=function(){};this.data=ja;this.view=ka;this.root=la;this.facebarRoot=v.byClass(la,"_585-");this.windowFocused=true;this.isFocused=false;this.hoverAnimation=null;this.stickyQuery=null;this.settedQuery=null;this.selectedQuery=null;this.currentQuery=null;this.initSubcomponents();this.initEvents();this.checkValue();};ia.prototype.initSubcomponents=function(){"use strict";var ja=k.find(this.root,"._5861");this.input=new r(ja);this.view.setInputElement(this.input.getRawInputElement());};ia.prototype.initEvents=function(){"use strict";l.listen(this.root,'keydown',this.keydown.bind(this));l.listen(this.root,'keyup',this.keyup.bind(this));l.listen(this.root.parentNode,'mousedown',this.mousedown.bind(this));l.listen(this.view.getElement(),'mousedown',this.mousedown.bind(this));l.listen(window,'focus',this.focusWindow.bind(this));l.listen(window,'blur',this.blurWindow.bind(this));this.view.subscribe('select',this.selectView.bind(this));this.view.subscribe('highlight',this.highlightView.bind(this));this.view.subscribe('render',this.highlightView.bind(this));this.view.subscribe('hideHelp',this.performQuery.bind(this));this.input.subscribe('focus',this.focusInput.bind(this));this.input.subscribe('blur',this.blurInput.bind(this));this.input.subscribe('change',this.changeInput.bind(this));this.data.subscribe('activity',this.typeaheadActivity.bind(this));this.data.subscribe('respond',this.completeData.bind(this));this.data.subscribe('nullstateReady',this.performQueryIfVisible.bind(this));h.subscribe('FacebarTypeahead.clearRecentSearches',function(){return this.clearRecentSearches();}.bind(this));ea(this.initFocus.bind(this),0);};ia.prototype.initFocus=function(){"use strict";if(!this.lazyFocused&&k.contains(this.input.root,ba())){this.lazyFocused=true;this.isFocused=true;this._newSession();this.inform('focus',{catchup:true});this.open();}};ia.prototype.cleanQuery=function(ja){"use strict";ja=Object.assign({},ja)||{};if(!ja.structure)ja.structure=new q();if(!m.allowGrammar||n.nonGrammarTypes[ja.type])ja.structure=q.fromString(ja.structure.toString());ca(ja.structure instanceof q);if(ja.type=='websuggestion'&&m.allowGrammar&&m.webSearchLockedInMode)ja.structure=s.addPrefix(ja.structure);return ja;};ia.prototype._unlockQuery=function(){"use strict";var ja=this.input.getValue();if(ja.hasType('ent')&&ja.trim().getCount()===1){this.input.storeSelection();this.input.setValue(q.fromString(ja.toString()));this.input.restoreSelection();}};ia.prototype.setPageQuery=function(ja){"use strict";ja=this.cleanQuery(ja);var ka=this.input.getValue(),la=ja.structure,ma=!la.isEmptyOrWhitespace()&&(ka.isEmptyOrWhitespace()||ka.toString().trim()==la.toString().trim());return this.selectQuery(ja,ma);};ia.prototype.selectQuery=function(ja,ka){"use strict";ka=ka!==false;ja=this.cleanQuery(ja);if(ka||!this.selectedQuery){if(ka||this.getValue().isEmptyOrWhitespace())this.setQuery(ja);this.selectedQuery=ja;}return ja;};ia.prototype.completeSelection=function(){"use strict";var ja=this.view.getSelection();if(ja&&!ja.search){this.data.saveResult(ja);ja.structure=ja.structure.pad();this.setQuery(ja);return true;}};ia.prototype.setQuery=function(ja,ka){"use strict";ja=this.cleanQuery(ja);if(ja.structure.hasType('blank'))ja.structure=new q(ja.structure.toArray().filter(function(la){return la.getType()!='blank';}));this.input.setValue(ja.structure);this.settedQuery=ja;this.stickyQuery=ka===false?this.stickyQuery:ja;this.checkValue();};ia.prototype.checkValue=function(){"use strict";if(this.value&&this.value.getHash()==this.input.getValue().getHash())return;this.checkBlockedSearch();this.performQueryIfVisible();};ia.prototype.checkBlockedSearch=function(){"use strict";var ja=this.input.getValue().toString().toLocaleLowerCase();if(!this.data.blockees||!(this.data.blockees.hasOwnProperty(ja))){this.view.hideBlockNotification();}else this.view.showBlockNotification(this.data.blockees[ja]);};ia.prototype.isNullState=function(){"use strict";return (this.input.getValue().getHash()==='');};ia.prototype.performQueryIfVisible=function(){"use strict";if(!this.view.visible)return;this.value=this.nextQuery=this.getValue();this.performQuery();};ia.prototype.performQuery=function(){"use strict";if(m.graphSearchV2)this.view.resetIndex();this.data.query(this.nextQuery);this.currentQuery=this.nextQuery;};ia.prototype.requery=function(){"use strict";if(this.currentQuery)this.data.query(this.currentQuery);};ia.prototype.executeQuery=function(ja){"use strict";ja=this.cleanQuery(ja);var ka=this.inform('execute',ja),la=this.getSessionID();this.close();if(m.allowGrammar){this.selectQuery(ja);}else this.selectQuery();if(m.hasRecentSearchNullState&&ja.type!=='shortcut')this.data.resultStore.addRecentEntryToNullState(ja);if(!ka)this._navigateToQuery(ja,la);};ia.prototype.getSearchType=function(){"use strict";return 'facebar';};ia.prototype._newSession=function(){"use strict";if(this._sessionID!=null)return;this._sessionID=Math.random().toString();this.inform('session',this._sessionID,h.BEHAVIOR_STATE);};ia.prototype._closeSession=function(){"use strict";this._sessionID=null;this.inform('session',null,h.BEHAVIOR_STATE);};ia.prototype.getSessionID=function(){"use strict";return this._sessionID;};ia.prototype._navigateToQuery=function(ja,ka){"use strict";var la=this.data.facebarConfig;if(ja.uri){ja.uri.addQueryData(ja.extra_uri_params);ja.uri.addQueryData({ref:'br_tf'});if(ja.structure&&(ja.type=='websuggestion'||ja.type==u.result_type||(ja.type=='grammar'&&(!la||String(ja.uri.getPath()).startsWith(la.search_path))))){var ma=this.data.getRawStructure(ja.structure).text_form,na=j.encode(encodeURIComponent(ma)).replace(/\=+$/,''),oa={sid:ka,qs:na,gv:this.data.getQueryData().grammar_version},pa=j.encode(JSON.stringify(oa)).replace(/\=+$/,'');ja.uri.addQueryData({ref:pa,bs:ja.alternateSemantic});}ja.uri.go();return;}};ia.prototype.reset=function(){"use strict";this.selectQuery();this.inform('reset');};ia.prototype.animateInputValue=function(ja,ka,la){"use strict";this.hoverAnimation&&this.hoverAnimation.stop();var ma=new g(ka).from('opacity',1).to('opacity',0).duration(150).ondone(function(){this.input.setValue(la);this.hoverAnimation=na.go();}.bind(this)),na=new g(ja).from('opacity',0).to('opacity',1).duration(150).ondone(function(){this.hoverAnimation=null;w.set(ka,'opacity','');w.set(ja,'opacity','');}.bind(this));w.set(ja,'opacity',0);this.hoverAnimation=ma.go();};ia.prototype.open=function(){"use strict";this.inform('open');this.view.show(this.facebarRoot.offsetWidth);this.input.focus();this.checkValue();if(!this.isFocused){this.isFocused=true;this._newSession();this.inform('focus');}};ia.prototype.close=function(){"use strict";this._closeSession();if(this.inform('close')===false)return;if((!this.value||this.value.isEmptyOrWhitespace())&&this.selectedQuery){this.input.setValue(this.selectedQuery.structure);}else if(this.stickyQuery)this.input.setValue(this.stickyQuery.structure);this.input.blur();this.view.hide();this.view.setAutoSelect(false);this.inform('session',null,h.BEHAVIOR_STATE);if(this.isFocused){this.isFocused=false;ea(this.inform.bind(this,'blur'),0);}};ia.prototype.getElement=function(){"use strict";return this.root;};ia.prototype.getValue=function(){"use strict";return this.input.getValue();};ia.prototype.getText=function(){"use strict";return this.getValue().toString();};ia.prototype.submitQuery=function(){"use strict";if(m.graphSearchV2&&this.view.index<0){var ja=this.input.getValue(),ka=this.data.getRawStructure(ja);if(ka&&!ka.is_empty){var la=!ka.raw_text?p.getRawTextFromStructured(ja.toArray()):ka.raw_text,ma=o.makeFacebarEntry(la);this.inform('magSearch',ma);this.executeQuery(ma);}}else this.view.select();};ia.prototype.keydown=function(event){"use strict";var ja=true,ka=l.getKeyCode(event);switch(ka){case t.ESC:this.close();break;case t.RIGHT:if(!m.disableLockingEntitiesOnRightArrow){ja=this.input.isSelectionAtEnd()&&this.completeSelection();}else ja=false;break;case t.TAB:var la=this.cleanQuery(this.view.getSelection()),ma=la.structure.hasType('blank');if(event.getModifiers().shift||(!this.completeSelection()&&!this.loading)){this.view.setAutoSelect(false);this.view.hide();ja=false;}else if(!ma&&!m.graphSearchV2)this.tabQueued=true;break;case t.UP:this.view.prev();break;case t.DOWN:this.view.next();break;case t.RETURN:this.submitQuery();break;case t.PAGE_UP:this.view.first();break;case 222:var na=this.input.value.trim();if(!event.getModifiers().shift&&na.endsOnType('ent'))this.input.setValue(na);ja=false;break;default:var oa=(ka<=46&&ka!==8&&ka!==32),pa=(ka>=112&&ka<=126),qa=(ka===144||ka===145);if(!oa&&!pa&&!qa&&!event.metaKey){this.data.setSingleState(false);if(m.autohighlight)this.view.setAutoSelect(true);}this.stickyQuery=null;ja=false;break;}this.input.storeSelection();if(ja)return event.kill();};ia.prototype.keyup=function(event){"use strict";var ja=l.getKeyCode(event),ka=(ja<=46&&ja!==8&&ja!==32),la=(ja>=112&&ja<=126),ma=(ja===144||ja===145);if(!ka&&!la&&!ma&&!event.metaKey)if(m.unlockTextOnKeypress)this._unlockQuery();};ia.prototype.mousedown=function(event){"use strict";if(m.autohighlight)this.view.setAutoSelect(true);this.input.storeSelection();if(v.byClass(event.target,"_50c9"))event.preventDefault();};ia.prototype.focusWindow=function(){"use strict";this.windowFocused=true;};ia.prototype.blurWindow=function(){"use strict";this.windowFocused=false;};ia.prototype.selectView=function(ja,ka){"use strict";if(!ka||!ka.selected)return;this.data.setSingleState(true);this.inform('select',ka);var la=this.cleanQuery(ka.selected);this.executeQuery(la);};ia.prototype.highlightView=function(){"use strict";var ja=this.view.getSelection();if(m.graphSearchV2){this.input.setHint(ja?ja.structure:null);}else ja&&this.input.setHint(ja.structure);};ia.prototype.blurInput=function(){"use strict";ea((function(){if(this.windowFocused||x.getRequestURI().getSubdomain()==='apps'){this.input.togglePlaceholder();this.close();}}).bind(this),0);};ia.prototype.changeInput=function(){"use strict";this.inform('change');this.checkValue();this.inform('change_end');};ia.prototype.focusInput=function(){"use strict";this.open();this.input.togglePlaceholder(false);};ia.prototype.updateData=function(){"use strict";this.view.setLoading(this.loading);};ia.prototype.completeData=function(ja,ka){"use strict";this.checkBlockedSearch();if(ka.forceDisplay||(this.value&&this.value.matches(ka.value))){var la=m.graphSearchV2?!ka.results.length:(!ka.results.length&&!this.loading&&ka.isEmptyResults);this.view.render(ka.value,ka.results,ka.isAsync,la);if(this.tabQueued&&this.completeSelection())delete this.tabQueued;}};ia.prototype.typeaheadActivity=function(ja,ka){"use strict";this.fetching=ka.activity;if(this.loading!==this.fetching){this.loading=this.fetching;this.updateData();}};ia.prototype.getNameTextFromSelected=function(){"use strict";var ja=this.settedQuery&&this.settedQuery.semantic,ka=this.data.facebarConfig&&this.data.facebarConfig.name_functions,la=ja&&ka&&ja.match(/[a-z-]+\([^()]+\)/g);if(la)for(var ma=0;ma<la.length;ma++){var na=la[ma].match(/([a-z-]+)\(([^()]+)\)/);if(na&&y(ka,na[1]))return na[2];}return this.value.toString();};ia.prototype.clearRecentSearches=function(){"use strict";this.data.resultStore.clearRecentSearches();};ia.clearRecentSearches=function(){"use strict";h.inform('FacebarTypeahead.clearRecentSearches');};Object.assign(ia.prototype,{events:['session','focus','select','change','execute','blur']});e.exports=ia;},null);
__d("FacebarTypeaheadRecorder",["clickRefAction","Event","Keys","SearchTypeaheadRecorder","URI","Arbiter","FacebarTimerUtils","FacebarGlobalOptions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();for(var o in j)if(j.hasOwnProperty(o))q[o]=j[o];var p=j===null?null:j.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=j;function q(r){"use strict";j.call(this,r);this.userText="";this.queryTimes={};this._sessionDisabled=false;this.type="facebar";this._maxQueryID=0;this._isQueryMatch=true;}q.prototype.initEvents=function(r){"use strict";r.getCore().subscribe('session',function(s,t){if(t===null){this.sessionEnd();}else this.sessionStart(t);}.bind(this));r.getCore().subscribe('select',function(s,t){this.recordSelectInfo(t);}.bind(this));r.getCore().subscribe('magSearch',function(s,t){this.recordMagSearch(t);}.bind(this));r.getCore().input.subscribe('shortcut',function(s,t){this.recordShortcut(t);}.bind(this));r.getCore().subscribe('quickSelectRedirect',function(s,t){this.recordQuickSelectInfo(t);}.bind(this));r.getView().subscribe('render',function(s,t){this.recordRender(t);}.bind(this));r.getView().subscribe('logPerformanceTiming',function(s,t){this.performanceTimings[t.field]=t.value;}.bind(this));r.data.subscribe('query',function(s,t){if(!t.value.isEmpty())this.recordCountStat('num_queries');this.recordAvgStat('num_results_from_cache',t.results.length);this.queryTimes[t.queryId]={send:m.getTimestamp()};}.bind(this));r.data.subscribe('sending_request',function(s,t){var u=t.data.value;if(!u)return;this.backendQueries.push(u);}.bind(this));r.subscribe('navigation',function(s,t){if(t&&t.structure){this.recordStat('navigation_input',JSON.stringify(t.structure.toStruct()));this.recordStat('navigation_text',t.structure.toString());}}.bind(this));r.data.subscribe('response_received',function(s,t,u){if(this.queryTimes[t.queryId]){var v=this.queryTimes[t.queryId];v.recv=m.getTimestamp()-v.send;if(t&&t.payload)v.payload_size=JSON.stringify(t.payload).length;}}.bind(this));r.data.subscribe('remote_query_latency',function(s,t){if(this.queryTimes[t.queryId]){var u=this.queryTimes[t.queryId];u.remoteQueryLatencies=t.latencies;}}.bind(this));r.data.subscribe('cache_query_latency',function(s,t){if(this.queryTimes[t.queryId]){var u=this.queryTimes[t.queryId];u.cacheQueryLatencies=t.latencies;}}.bind(this));r.data.subscribe('backend_response',function(s,t){if(this.queryTimes[t.queryId]){var u=this.queryTimes[t.queryId];u.render=m.getTimestamp()-u.send;if(t.payload.incomplete)u.incomplete=true;u.backendInfo=t.payload.info;if(this.core.scubaInfo)this.logToScuba(t,u,this.core.scubaInfo,t.inputQuery,this.type);}}.bind(this));r.getCore().subscribe('change',function(s,t){this.userInput(this.core.getText());}.bind(this));r.data.subscribe('remote_query_match',function(s,t){if(this._maxQueryID<t.queryId){this._maxQueryID=t.queryId;this._isQueryMatch=t.isMatch;}}.bind(this));l.subscribe('BrowseNUX/typing',this.disableThisSession.bind(this));l.subscribe('TestConsole/typing',this.disableThisSession.bind(this));r.subscribe('clear',function(){this.recordAppendStat('before_clear_queries',this.userText);}.bind(this));h.listen(this.element,'keydown',function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(h.getKeyCode(event)==i.BACKSPACE){if(!this._backspacing){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.core.getText());}}else this._backspacing=false;}.bind(this));this.core.subscribe('focus',function(){this.data.lastNullOrSingleStateFetchStartTime=Date.now();}.bind(this));this.data.subscribe('beforeQuery',function(s,t){if(!this.queryStartTime)this.queryStartTime=[];this.queryStartTime[this.query]=Date.now();}.bind(this));r.subscribe('filter',function(s,t){this._unsupportedGrammarInfo=this.buildUnsupportedGrammarInfo(t);}.bind(this));r.getCore().subscribe('recordFunction',function(s,t){this._extraRecorder.push(t);}.bind(this));};q.prototype._reset=function(r){"use strict";this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};};q.prototype.sessionStart=function(r){"use strict";this._sessionEnded=false;this.data.setQueryData({sid:r});this.recordStat('sid',r);if(!this.stats.session_start_time){this.recordStat('session_start_time',m.getTimestamp());var s=new Date(),t=s.getTimezoneOffset(),u=Date.now()-t*60*1000;this.recordStat('session_start_time_user_timezone',u);}this.recordStat('keypressed',0);this.queryTimes={};};q.prototype.sessionEnd=function(){"use strict";if(this._sessionEnded||this._sessionDisabled){if(this._sessionDisabled){this.reset();this._sessionDisabled=false;this._sessionEnded=true;}return;}this._sessionEnded=true;this.recordStat('session_end_time',m.getTimestamp());this.recordStat('grammar_version',this.data.getQueryData().grammar_version);this.submit();};q.prototype.disableThisSession=function(){"use strict";this._sessionDisabled=true;};q.prototype.userInput=function(r){"use strict";this.userText=r;};q.prototype.buildUnsupportedGrammarInfo=function(r){"use strict";var s=r.results?r.results[0]:null;if(!s||s.results_set_type!=='unimplemented')return null;return {unsupported_grammar:{category:s.error_info.category||'unknown',edge:s.error_info.blamed_edge}};};q.prototype.buildTypeaheadRecord=function(r,s){"use strict";var t=r.rankType||r.render_type||r.type,u=0,v=s;if(typeof r.groupIndex=='number'){u=r.groupIndex;v=r.indexInGroup;}var w={group_index:u,index_in_group:v,cost:r.cost,s_value:r.s_value||0,semantic:r.semantic,text:r.structure.toString(),cache_only:(r.cacheOnlyResult?1:0),prefetched:(r.isPrefetched?1:0),parse:r.parse,semantic_forest:r.semanticForest,category:r.category,type:t,source:r.bootstrapped,grammar_results_type:(r.results_set_type||'').replace(/[\[\{](.*)[\]\}]/,'$1'),result_from_memcache:r.memcache,websuggestion_source:r.websuggestion_source,dynamic_cost:r.dynamic_cost,is_js_bootstrap_match:r.isJSBootstrapMatch,backend_cost:r.backendCost,bootstrap_cost:r.bootstrapCost,match_type:r.match_type,l_type:r.l_type,vertical_type:r.vertical_type,prefix_match:r.prefix_match,prefix_length:r.prefix_length,index_before_buckets:r.indexBeforeBuckets,bucket_lineage:r.bucketLineage,nullstate:r.isNullState,singlestate:r.isSingleState,query_id:r.qid,template_id:r.templateID,coeff_cost:(typeof r.grammar_costs=='undefined')?-1:r.grammar_costs["{"+r.type+"}"],suggestion:r.isSuggestion,recent_search_suggestion:r.isRecentSearchSuggestion};if(r.logInfo)w.backend_log_info=r.logInfo;if(r.s_token)w.s_token=r.s_token;if(r.s_categories)w.s_categories=r.s_categories;return w;};q.prototype.buildListTypeaheadRecords=function(){"use strict";var r=[];this.results&&this.results.forEach(function(s,t){if(s.uid!=='search')r.push(this.buildTypeaheadRecord(s,t));}.bind(this));return r;};q.prototype.recordShortcut=function(r){"use strict";this.recordStat('shortcut',1);this.recordStat('shortcut_with_shift',r.shift);};q.prototype.recordStats=function(r,s){"use strict";for(var t in s)this.recordStat(r+'_'+t,s[t]);};q.prototype.getTypeaheadIndex=function(r,s){"use strict";var t=typeof r.groupIndex=='number'?r.groupIndex+1:0;return s-t;};q.prototype.recordQuickSelectInfo=function(r){"use strict";var s={input_query:r.input_query,semantic:r.semantic,type:r.type,position:r.position,with_mouse:r.with_mouse,text:r.text,quick_select:1};this.recordStats('selected',s);this.recordStat('quick_select',1);};q.prototype.recordMagSearch=function(r){"use strict";var s={};s.text=r.text;s.semantic=r.semantic;s.type=r.type;s.input_query=r.text;this.recordStats('selected',s);};q.prototype.recordSelectInfo=function(r){"use strict";var s=r.selected,t=this.getTypeaheadIndex(s,r.index),u={};if(s.uid=='search'){u.selected_search=1;}else{u=this.buildTypeaheadRecord(s);var v=(u.type=='friend'?'user':u.type);u.position=t;u[v]=1;}u.with_mouse=r.clicked?1:0;u.quick_select=0;u.input_query=this.userText;u.input_fragments=JSON.stringify(this.core.currentQuery.toStruct());var w=s.dataGT?{gt:JSON.parse(s.dataGT)}:{},x={href:s.path};g('click',x,null,null,w);this.recordStats('selected',u);this.recordAppendStat('selection_history',{selected:u,candidate_results:this.buildListTypeaheadRecords(),timestamp:m.getTimestamp()});var y={};this._extraRecorder.forEach(function(z){z(r,this.results,y);}.bind(this));this.recordStat('extra_select_info',JSON.stringify(y));this.recordStat('selected_with_mouse',r.clicked?1:0);};q.prototype._dataToSubmit=function(){"use strict";this.recordStat('max_results',this.data._maxResults);if(this.stats&&this.stats.selected_input_query){this.recordStat('input_query',this.stats.selected_input_query);}else this.recordStat('input_query',this.userText);this.recordStat('uri',new k(window.location.href).toString());if(!this.stats.shortcut){this.recordStat('shortcut',0);this.recordStat('shortcut_with_shift',false);}var r=this.stats;for(var s in this.avgStats){var t=this.avgStats[s];r[s]=t[0]/t[1];}var u={candidate_results:this.buildListTypeaheadRecords(),timestamp:m.getTimestamp(),input_query:this.userText,remote_query_match:this._isQueryMatch};if(this._unsupportedGrammarInfo)Object.assign(u,this._unsupportedGrammarInfo);this.recordAppendStat('suggestions_at_end_of_session',u);this.recordAppendStat('query_times',this.queryTimes);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(n.taSessionLoggingSample){var v=[];this.results.forEach(function(x){v.push([x.text||'',x.category||'',x.subtext||'']);});this.recordStat('raw_suggestions_text',v);}if(n.graphSearchV2){this.recordStat('experience_type','gsv2');}else this.recordStat('experience_type','facebar');for(var w in this.appendStats)r[w]=JSON.stringify(this.appendStats[w]);return r;};q.prototype.getDataToSubmit=function(){"use strict";return this._dataToSubmit();};q.prototype.reset=function(){"use strict";return this._reset();};q.prototype.submit=function(){"use strict";if(!this._sessionDisabled)p.submit.call(this);this.view.inform('feedback');this._reset();};Object.assign(q.prototype,{_sessionEnded:true,_extraRecorder:[],_banzaiRoute:'facebar'});e.exports=q;},null);
__d("FacebarTypeaheadV2",["CSS","csx","cx","DOM","Event","Parent"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={init:function(n){this._view=n.getView();this._root=l.byClass(n.getElement(),"_585-");this._button=j.find(this._root,"._4w98");this._core=n.getCore();k.listen(this._button,'click',this.buttonDownAndClick.bind(this));k.listen(this._button,'mousedown',this.buttonDownAndClick.bind(this));k.listen(this._button,'mouseup',this.buttonUp.bind(this));this._core.subscribe('open',this.showButton.bind(this));this._core.subscribe('close',this.hideButton.bind(this));},showButton:function(){g.addClass(this._button,"_4w97");},hideButton:function(){if(g.hasClass(this._button,"_4w97"))g.removeClass(this._button,"_4w97");},buttonDownAndClick:function(event){event.preventDefault();},buttonUp:function(){if(!this._core.isFocused){this._core.focusInput();}else this._core.submitQuery();}};e.exports=m;},null);
__d("FacebarTypeaheadGrammarItem.react",["React","FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","FacebarTypeaheadTokenText","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n={user:l._("Person")},o=g.createClass({displayName:"FacebarTypeaheadGrammarItem",renderToken:function(){var p=this.props.result.decoration,q=this.props.result.ambiguity,r=q&&q.text,s=(p&&p.entity)||(q&&q.entity);if(this.props.result.isRecent){var t=l._("Recent search");return (g.createElement(i,{text:[t],innerClass:"_53ab"}));}else if(r){return (g.createElement(i,{text:j.text(r)}));}else if(s)return (g.createElement(i,{text:j.textForEntity(s,n),limit:2,leadingMiddot:true}));},getClassName:function(){var p=this.props.result;if(p.isPeopleAndPagesSuggestion)return "_2enu";if(p.tags&&p.tags.displayedSeeMore)return "_10gs";return "_207";},render:function(){var p=this.renderToken(),q=p&&!p.props.leadingMiddot;return (g.createElement(h,g.__spread({},this.props,{className:m(this.props.className,this.getClassName()),valign:q,token:p})));}});e.exports=o;},null);
__d("FacebarTypeaheadKeywordItem.react",["FacebarGlobalOptions","FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","FacebarTypeaheadTokenText","React","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=k.createClass({displayName:"FacebarTypeaheadKeywordItem",render:function(){var p=[m._("Search")];if(this.props.result.isTrending){p.push(m._("Trending"));}else if(this.props.result.type=='related')p=[m._("Related search")];if(g.renderKeywordSnippets){var q=j.textForEntity(this.props.result,{});if(q&&q.length)p=q;}var r=k.createElement(i,{text:p,innerClass:"_53ab"});return (k.createElement(h,k.__spread({},this.props,{className:n(this.props.className,((!g.renderKeywordSnippets?"_207":''))),token:r,prefix:this.props.result.query_string.toLowerCase()})));}});e.exports=o;},null);
__d("FacebarTypeaheadNodeItem.react",["React","DOM"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g.createClass({displayName:"FacebarTypeaheadNodeItem",render:function(){var j=this.props.result.node;return (g.createElement("li",g.__spread({},this.props),!h.isElementNode(j)?j:null));},attachNode:function(j){var k=this.props.result.node;if(h.isElementNode(k))h.setContent(j,k);},componentDidMount:function(){this.attachNode(g.findDOMNode(this));},componentDidUpdate:function(j,k,l){this.attachNode(g.findDOMNode(this));},shouldComponentUpdate:function(j){return this.props.result.node!==j.result.node;}});e.exports=i;},null);
__d("FacebarTypeaheadRecentItem.react",["FacebarGlobalOptions","FacebarTypeaheadItem.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=i.createClass({displayName:"FacebarTypeaheadRecentItem",render:function(){return (i.createElement(h,i.__spread({},this.props,{className:k(this.props.className,((!g.renderKeywordSnippets?"_207":''))),icon:this.renderIcon()})));},renderIcon:function(){var m=this.props.result;if(!g.allowGrammar)return (i.createElement("img",{className:"_20h",src:m.photo}));var n=m.icon_class?i.createElement("span",{className:m.icon_class}):i.createElement("img",{className:"_20h",src:m.photo});return (i.createElement("span",{className:((!g.renderKeywordSnippets||(m.icon_class&&g.renderKeywordSnippets)?"_k83":''))},n));}});e.exports=l;},null);
__d("FacebarTypeaheadTrendingItem.react",["FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=i.createClass({displayName:"FacebarTypeaheadTrendingItem",render:function(){var m=this.props.result.articleTitle||'',n=i.createElement(h,{text:[m],innerClass:"_53ab",leadingMiddot:true});return (i.createElement(g,i.__spread({},this.props,{className:k(this.props.className,"_207"),token:n,valign:false})));}});e.exports=l;},null);
__d("FacebarTypeaheadList.react",["ARIA","React","StaticContainer.react","FacebarTypeaheadEntityItem.react","FacebarTypeaheadGrammarItem.react","FacebarTypeaheadKeywordItem.react","FacebarTypeaheadNodeItem.react","FacebarTypeaheadRecentItem.react","FacebarTypeaheadTrendingItem.react","LoadingIndicator.react","FacebarJSConstants","FacebarGlobalOptions","CSS","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=h,w=v.PropTypes,x={grammar:k,trending:o,related:l};x[q.browseTypes.keyword]=l;x[q.keywordType]=l;var y=h.createClass({displayName:"FacebarTypeaheadList",propTypes:{results:w.array,onRender:w.func,onSelect:w.func.isRequired,onHighlight:w.func.isRequired,isKeywordList:w.bool},getItemComponentConstructor:function(z,aa){if(z.node)return m;if(z.isRecent)return n;if(z.results_set_type===q.browseTypes.keyword)return l;if(z.type&&x[z.type])return x[z.type];return j;},renderItem:function(z,aa){var ba=this.getItemComponentConstructor(z),ca;if(z.type===q.keywordType){ca=z.query_string+z.semantic+z.isRecentSearchSuggestion;}else{ca=z.semantic||z.uid||z.tuid;ca=ca+z.isNullState;if(r.facebarUpdateSnippets)ca=ca+z.category+z.subtext;}return (h.createElement(i,{key:ca},h.createElement(ba,{result:z,onClick:this.handleClick.bind(null,z),onMouseEnter:this.handleMouseEnter.bind(null,z)})));},renderFooter:function(){var z=(("_3su")+(!this.props.loading?' '+"hidden_elem":''));return (h.createElement("li",{className:z},h.createElement("div",{className:"_21f"},u._("Finding results"),h.createElement(p,{size:"medium",color:"white"}))));},componentDidMount:function(){var z=h.findDOMNode(this);g.owns(this.props.accessibilityElement,z);},hasValidRecentSearches:function(){if(!r.hasRecentSearchNullState||!this.props.results)return false;return this.props.results.some(function(z){return z.isRecent;});},render:function(){var z=this.props.results,aa=[],ba=[],ca=false;if(z)z.forEach(function(ha){if(ha.isTrending)ca=true;if(ha.isSuggestion){ba.push(this.renderItem(ha));}else aa.push(this.renderItem(ha));},this);var da=null,ea=null,fa=ca?u._("In the News"):u._("Search Suggestions");if(ba.length>0){var ga=null;if(this.hasValidRecentSearches()||r.hasGrammarNullState)ga=(h.createElement("div",{className:(("_3zsi")+(r.renderKeywordSnippets?' '+"_1ejo":''))},fa));da=(h.createElement("div",null,ga,h.createElement("ul",{id:"facebar_typeahead_view_list",className:"_21c",role:"listbox"},ba,this.renderFooter())));}else ea=this.renderFooter();return (h.createElement("div",null,h.createElement("ul",{id:"facebar_typeahead_view_list",className:(("_21c")+(this.props.isKeywordList?' '+"_2yob":'')),"data-click":"Search",role:"listbox"},aa,ea),da));},handleClick:function(z,aa){if(s.hasClass(aa.target,"_2d9t"))return;if(!aa.nativeEvent.isMiddleClick()&&!aa.nativeEvent.getModifiers().any){this.props.onSelect(z);aa.preventDefault();}},handleMouseEnter:function(z){this.props.onHighlight(z);},componentDidUpdate:function(z,aa,ba){this.props.onRender();},shouldComponentUpdate:function(z){return this.props.loading!==z.loading||this.props.results!==z.results;}});e.exports=y;},null);
__d("FacebarTypeaheadView",["Arbiter","CSS","ContextualLayer","DOM","FacebarGlobalOptions","FacebarJSConstants","FacebarStructuredText","FacebarTypeaheadList.react","Parent","React","ScriptPath","Style","TypeaheadView","performanceNow","csx","cx","fbt","URI","Link.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){b.__markCompiled&&b.__markCompiled();var z='unimplemented';for(var aa in s)if(s.hasOwnProperty(aa))ca[aa]=s[aa];var ba=s===null?null:s.prototype;ca.prototype=Object.create(ba);ca.prototype.constructor=ca;ca.__superConstructor__=s;function ca(da,ea){"use strict";s.call(this,da,ea);this.element=da;this.sid='';this.index=-1;this.warningShown=false;this.autoSelect=false;this.loading=false;this.handleRender=this.handleRender.bind(this);this.handleHighlight=this.handleHighlight.bind(this);this.handleSelect=this.handleSelect.bind(this);this.events=['highlight','render','filter'];}ca.prototype.init=function(){"use strict";this.initializeElements();};ca.prototype.initGSV2Elements=function(){"use strict";var da=this.element;this.contentKeyword=j.find(da,"._f7s");this.contentEntity=j.find(da,"._f7t");this.contentRecent=j.find(da,"._mn8");this.contentSuggestion=j.find(da,"._2pl-");this.contentAdminedPages=j.find(da,"._1e-s");this.keywordResultsContainer=j.create('div');this.entityResultsContainer=j.create('div');this.keywordResults=[];this.entityResults=[];};ca.prototype.initGSV2Construct=function(){"use strict";this.currentKeywordContainer=this.contentKeyword;this.currentEntityContainer=this.contentEntity;this.contentKeyword.appendChild(this.keywordResultsContainer);this.contentEntity.appendChild(this.entityResultsContainer);if(this.entityTop){this.resultsContainer.appendChild(this.contentEntity);this.resultsContainer.appendChild(this.contentKeyword);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}};ca.prototype.initializeElements=function(){"use strict";var da=this.element;this.isGSV2=k.graphSearchV2;this.dynamicRank=this.isGSV2;this.fixedBlendingOrder=k.blendingOrderKeywordFirst||k.blendingOrderEntityFirst;this.entityTop=k.blendingOrderEntityFirst;this.content=j.find(da,"._21r");this.warningNode=j.find(da,"._553e");this.blockNotificationNode=j.find(da,"._2hh");this.resultsContainer=j.create('div');if(this.isGSV2)this.initGSV2Elements();};ca.prototype.initializeList=function(){"use strict";this.renderTypeaheadList();this.content.appendChild(this.resultsContainer);if(this.isGSV2)this.initGSV2Construct();};ca.prototype.initializeLayer=function(){"use strict";this.layer=new i({context:o.byClass(this.causalElement,"_585-"),position:'below',causalElement:this.causalElement},this.element);var da=this.layer.getContentRoot();this.root=j.find(da,"._50c9");h.addClass(da,"_5tlx");if(this.isGSV2)h.addClass(da,"_5xzd");this.wrapper=da;};ca.prototype.setInputElement=function(da){"use strict";this.setAccessibilityControlElement(da);this.causalElement=da;this.initializeLayer();this.initializeList();};ca.prototype.setAutoSelect=function(da){"use strict";this.autoSelect=da;if(this.index===-1&&da)this.first();};ca.prototype.getIndexOf=function(da,ea){"use strict";for(var fa=0;fa<ea.length;fa++)if(da.semantic===ea[fa].semantic)return fa;return -1;};ca.prototype.handleHighlight=function(da){"use strict";this.highlight(this.getIndexOf(da,this.results),false);};ca.prototype.handleSelect=function(da){"use strict";this.handleHighlight(da);this.select(true);};ca.prototype.show=function(da){"use strict";if(!this.visible){this.inform('beforeShow',this.layer);r.set(this.wrapper,'minWidth',da+'px');var ea=ba.show.call(this);this.first();this.layer.show();this.layer.updatePosition();this.inform('show');g.inform('layer_shown',{type:'FacebarTypeahead'});return ea;}};ca.prototype.hide=function(){"use strict";if(this.visible){this.layer.hide();ba.hide.call(this);this.inform('hide');g.inform('layer_hidden',{type:'FacebarTypeahead'});}return this;};ca.prototype.select=function(da){"use strict";var ea=this.results&&this.results[this.index];if(!ea){this.inform('quickSelect');return;}var fa=this.inform('beforeSelect',{index:this.index,selected:ea});if(fa!==false){q.setClickPointInfo({click:'Search'});ba.select.call(this,da);}};ca.prototype.doesResultBelongToEntitySection=function(da){"use strict";switch(da.type){case l.keywordType:return false;case l.grammarType:return da.tags&&da.tags.displayedSeeMore;default:return true;}};ca.prototype.processGSV2Results=function(da){"use strict";this.keywordResults=[];this.entityResults=[];var ea=[],fa=[],ga=da.some(function(ha){return ha.isSingleState;});da.forEach(function(ha){if(this.doesResultBelongToEntitySection(ha)){this.entityResults.push(ha);}else if(ga){if(ha.alternateSemantic){fa.push(ha);}else ea.push(ha);}else this.keywordResults.push(ha);}.bind(this));if(ga)this.keywordResults=fa.concat(ea);if(this.entityTop)return this.entityResults.concat(this.keywordResults);return this.keywordResults.concat(this.entityResults);};ca.prototype.reGenerateContainer=function(){"use strict";var da=j.create('div');if(this.entityTop){da.appendChild(this.currentEntityContainer);da.appendChild(this.currentKeywordContainer);}else{da.appendChild(this.currentKeywordContainer);da.appendChild(this.currentEntityContainer);}return da;};ca.prototype.buildResultsNoRegeneration=function(da){"use strict";if(this.dynamicRank)if(da.length>0&&!this.fixedBlendingOrder)this.entityTop=da[0].type!==l.keywordType;var ea=String(this.value);da.forEach(function(ga){ga.query_string=ea;});this.results=da;if(this.isGSV2)this.results=this.processGSV2Results(da);var fa=t();this.renderTypeaheadList({results:this.results,loading:this.loading});this.inform('logPerformanceTiming',{field:'build_results_set_props_duration',value:t()-fa});};ca.prototype.buildResults=function(da){"use strict";this.buildResultsNoRegeneration(da);if(this.dynamicRank)this.resultsContainer=this.reGenerateContainer();return this.resultsContainer;};ca.prototype.getGSV2Items=function(){"use strict";var da=ba.getItems.call(this),ea,fa;if(this.entityTop){fa=da.slice(0,this.entityResults.length);ea=da.slice(this.entityResults.length+1,-1);da=fa.concat(ea);}else{ea=da.slice(0,this.keywordResults.length);fa=da.slice(this.keywordResults.length+1,-1);da=ea.concat(fa);}return da;};ca.prototype.getItems=function(){"use strict";if(this.isGSV2)return this.getGSV2Items();return ba.getItems.call(this).slice(0,-1);};ca.prototype.handleRender=function(){"use strict";this.items=this.getItems();};ca.prototype.render=function(da,ea,fa,ga){"use strict";this.inform('filter',{results:ea,value:da});this.seeMoreResult=null;if(da.getLength()){this.seeMoreResult=this.inform('seeMore',{value:da,results:ea});if(!this.loading&&this.seeMoreResult)ea.push(this.seeMoreResult);}var ha=!da||(da instanceof m&&da.isEmptyOrWhitespace());h.conditionClass(this.wrapper,"_5qz2",!ea.length&&ha&&!this.getMegaphone());var ia=ea[0];if(ga&&!ha){if(!this.isGSV2)this.showWarning(w._("There are no results for '{query}'",[w.param("query",da.toString())]));}else if(ia&&ia.results_set_type===z){if(!ia.error_info.suppress)this.showWarning(ia.error_info.errorMessage||w._("This search isn't currently supported."));}else this.hideWarning();if(this.inform('removeUnimplementedGrammar')!==false)ea=ea.filter(function(ja){return ja.results_set_type!==z;}.bind(this));ba.render.call(this,da,ea,fa);};ca.prototype.reset=function(){"use strict";this.index=-1;this.items=[];this.results=[];this.value='';this.buildResults([]);this.inform('reset');return this;};ca.prototype.resetIndex=function(){"use strict";this.index=-1;};ca.prototype.getMegaphone=function(){"use strict";return j.scry(this.element,'.megaphone_location_gsv2_typeahead')[0];};ca.prototype.showBlockNotification=function(da){"use strict";var ea=new x('https://www.facebook.com').setPath('/settings').addQueryData('tab','blocking'),fa=p.createElement("div",null,w._("You've blocked {fullName}. For more info on privacy and blocking, go to your {settings}.",[w.param("fullName",da),w.param("settings",p.createElement(y,{href:{url:ea}},w._("settings")))]));h.show(this.blockNotificationNode);p.render(fa,this.blockNotificationNode);};ca.prototype.hideBlockNotification=function(){"use strict";h.hide(this.blockNotificationNode);j.setContent(this.blockNotificationNode,'');};ca.prototype.showWarning=function(da){"use strict";h.show(this.warningNode);j.setContent(this.warningNode,da);this.warningShown=true;this.highlight(-1,false);};ca.prototype.hideWarning=function(){"use strict";h.hide(this.warningNode);this.warningShown=false;this.highlight(this.index,false);};ca.prototype.setLoading=function(da){"use strict";if(this.loading!=da){this.loading=da;if(this.seeMoreResult){if(this.loading){this.results.splice(this.results.indexOf(this.seeMoreResult),1);}else this.results.push(this.seeMoreResult);this.buildResultsNoRegeneration(this.results);}else this.renderTypeaheadList({results:this.results,loading:da});}};ca.prototype.first=function(){"use strict";this.index=this.autoSelect?0:-1;this.highlight(this.index);};ca.prototype.prev=function(){"use strict";if(this.isGSV2){if(this.index<0||this.index===0&&this.autoSelect)this.index=this.items.length;}else if(this.index<=0)this.index=this.items.length;this.ignoreMouseover=true;ba.prev.call(this);};ca.prototype.next=function(){"use strict";if(this.isGSV2&&this.autoSelect&&this.index>=this.items.length-1)this.index=-1;if(!this.isGSV2&&this.index+1>=this.items.length)this.index=-1;this.ignoreMouseover=true;ba.next.call(this);};ca.prototype.highlight=function(da,ea){"use strict";ea=ea!==false&&(this.index!=da);if(!ea||this.inform('beforeHighlight')!==false){var fa=this.warningShown||!this.autoSelect?-1:0;ba.highlight.call(this,Math.max(fa,da),ea);}};ca.prototype.updateCurrentKeywordContainer=function(){"use strict";var da=this.currentKeywordContainer,ea=!String(this.value).trim();if(ea&&this.hasValidRecentSearches()){this.currentKeywordContainer=this.contentRecent;}else if(ea&&k.hasKeywordSuggestionNullState&&!k.hasGrammarNullState){this.currentKeywordContainer=this.contentSuggestion;}else this.currentKeywordContainer=this.contentKeyword;if(da&&da!==this.currentKeywordContainer){h.hide(da);da.removeChild(this.keywordResultsContainer);this.currentKeywordContainer.appendChild(this.keywordResultsContainer);}};ca.prototype.updateCurrentEntityContainer=function(){"use strict";var da=this.currentEntityContainer,ea=!String(this.value).trim();if(ea&&this.entityResults){this.currentEntityContainer=this.contentAdminedPages;}else this.currentEntityContainer=this.contentEntity;if(da&&da!=this.currentEntityContainer){h.hide(da);da.removeChild(this.entityResultsContainer);this.currentEntityContainer.appendChild(this.entityResultsContainer);}};ca.prototype.hasValidRecentSearches=function(){"use strict";if(!k.hasRecentSearchNullState||!this.keywordResults)return false;return this.keywordResults.some(function(da){return da.isRecent;});};ca.prototype.copyProps=function(da){"use strict";return Object.assign({accessibilityElement:this.accessibilityElement,onRender:this.handleRender,onHighlight:this.handleHighlight,onSelect:this.handleSelect},da);};ca.prototype.renderList=function(da,ea){"use strict";p.render(p.createElement(n,p.__spread({},this.copyProps(da))),ea);};ca.prototype.renderGSV2TypeaheadList=function(da){"use strict";var ea=this.copyProps(Object.assign({},da,{isKeywordList:true})),fa=this.copyProps(da);ea.results=this.keywordResults;fa.results=this.entityResults;if(this.entityTop||fa.results.length===0){fa.loading=false;}else ea.loading=false;var ga=this.entityResults.length===0&&ea.loading&&this.keywordResults.length===1&&this.keywordResults[0].exactMatchKeyword;this.renderList(ea,this.keywordResultsContainer);this.renderList(fa,this.entityResultsContainer);this.updateCurrentKeywordContainer();this.updateCurrentEntityContainer();h.conditionShow(this.currentKeywordContainer,!!this.keywordResults.length);h.conditionShow(this.currentEntityContainer,!!this.entityResults.length);h.conditionClass(this.element,"_1z7e",ga);h.conditionClass(this.element,"_3gbv",k.typeaheadkeywordStyle==='relaxed');h.conditionClass(this.element,"_3gbw",k.typeaheadkeywordStyle==='baggy');};ca.prototype.renderTypeaheadList=function(da){"use strict";da=da||{};if(this.isGSV2){this.renderGSV2TypeaheadList(da);}else this.renderList(da,this.resultsContainer);};e.exports=ca;},null);
__d("FacebarTypeaheadDecorateEntities",["arrayContains","emptyFunction"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(m){var n=[];m.forEach(function(o){if(o.isType('ent'))n.push(o.getUID());});return n;}function j(m,n){var o=null;m.structure.forEach(function(p){if(p.isType('ent')&&!g(n,p.getUID()))o=p;});return o;}function k(m,n,o){m.forEach(function(p){var q=j(p,n);p.decoration={entity:q&&o.getEntryForFragment(q)};});}function l(m){"use strict";this._typeahead=m;}l.prototype.enable=function(){"use strict";this._typeahead.view.subscribe('filter',function(m,n){k(n.results,i(this._typeahead.core.getValue()),this._typeahead.data);}.bind(this));};Object.assign(l.prototype,{disable:h});e.exports=l;},null);
__d("FacebarTypeaheadDisambiguateResults",["FacebarDisambiguationDialog","FacebarStructuredFragment","FacebarStructuredText","URI","emptyFunction","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(v,w){var x={};v.forEach(function(aa){if(aa.type=='grammar'){var ba=w(aa.structure).toLowerCase();x[ba]=x[ba]||[];x[ba].push(aa);}});var y=[];for(var z in x)if(x[z].length>1)y.push(x[z]);return y;}function n(v){var w=[];v.toArray().forEach(function(x,y){if(x.isType('ent'))w.push(y);});return w;}function o(v,w,x){var y={},z={},aa={};w.forEach(function(ca){var da=v[0].structure.getFragment(ca),ea=da.getHash();z[ea]=z[ea]||[];aa[ca]=z[ea];v.forEach(function(fa){var ga=fa.structure.getFragment(ca),ha=ga&&ga.getUID();if(ha&&!y.hasOwnProperty(ha)){z[ea].push(x.getEntryForFragment(ga));y[ha]=true;}});});for(var ba in aa)if(aa[ba].length<=1)delete aa[ba];return aa;}function p(v,w){var x={},y=[];v.forEach(function(z){var aa=z.structure.getFragment(w).getUID();if(!x.hasOwnProperty(aa)){x[aa]=y.length;y.push([]);}y[x[aa]].push(z);});return y;}function q(v,w,x){var y=v.shift();y.ambiguity.entities=w;x.push.apply(x,v);return y;}function r(v,w){var x=[],y=[],z=false;v.forEach(function(ba){ba.ambiguity={fragment:null,entities:null,text:null};});m(v,function(ba){return ba.getHash();}).forEach(function(ba){var ca=ba[0].structure,da=n(ca),ea=o(ba,da,w);if(z){q(ba,ea,x);return;}var fa=da.pop();if(typeof fa=='number'){var ga=p(ba,fa);z=ga.length>1;if(z)delete ea[fa];ga.forEach(function(ha){var ia=q(ha,ea,x);if(z){var ja=ia.structure.getFragment(fa).getUID();ia.ambiguity.entity=w.getEntry(ja);y.push(ia);}});}});x.forEach(function(ba){var ca=v.indexOf(ba);ca!=-1&&v.splice(ca,1);});m(v,function(ba){return ba.toString();}).forEach(function(ba){ba.forEach(function(ca){if(!ca.ambiguity.entities)ca.ambiguity.text=ca.queryTypeText;});});var aa=v.indexOf(y[0]);y.slice(1).forEach(function(ba){var ca=v.indexOf(ba);if(ca!=-1&&ca!=++aa){v.splice(ca,1);v.splice(aa,0,ba);}});}function s(v,w){var x=v&&v.ambiguity&&v.ambiguity.entities,y=x&&Object.keys(x).map(Number),z=w.core.input;if(!y||y.length===0)return false;var aa=function(da){w.core.executeQuery(t(v,y,da));},ba=function(){z.focus();z.input.moveSelectionToEnd();};x=x?l(x):[];var ca=new g(x,v.uri.getPath(),aa,ba,w.getCore().getSessionID());z.blur();ca.show();return true;}function t(v,w,x){var y=v.structure.toArray(),z=new j(v.uri),aa=z.getPath().split('/');w.forEach(function(ba){var ca=y[ba],da=x.shift(),ea=aa.indexOf(String(ca.getUID()));if(ea!=-1)aa[ea]=da.uid;y[ba]=new h({uid:da.uid,text:da.text,type:'ent:'+da.type});});return {uri:z.setPath(aa.join('/')),structure:new i(y)};}function u(v){"use strict";this._typeahead=v;}u.prototype.enable=function(){"use strict";this._typeahead.view.subscribe('filter',function(v,w){r(w.results,this._typeahead.data);}.bind(this));this._typeahead.view.subscribe('beforeSelect',function(v,w){return !s(w.selected,this._typeahead);}.bind(this));};Object.assign(u.prototype,{disable:k});e.exports=u;},null);
__d("FacebarTypeaheadNavigation",["Arbiter","FacebarNavigation","emptyFunction"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this._core=k.core;this._preserveQuery=false;this._typeahead=k;}j.prototype.enable=function(){"use strict";h.registerBehavior(this);this._core.subscribe('execute',this.executedUserQuery.bind(this));};j.prototype.executedUserQuery=function(k,l){"use strict";this._preserveQuery=true;};j.prototype.pageTransition=function(){"use strict";if(!this._preserveQuery){this._core.close();this._core.reset();}else this._preserveQuery=false;};j.prototype.setPageQuery=function(k){"use strict";k=this._core.setPageQuery(k);this._typeahead.inform('navigation',k,g.BEHAVIOR_PERSISTENT);};Object.assign(j.prototype,{disable:i});e.exports=j;},null);
__d("FacebarTypeaheadPrefixLengthOrderedCache",["emptyFunction","Arbiter"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this._typeahead=j;}i.prototype.enable=function(){"use strict";this._typeahead.data.inform('setSortFunction',function(j,k){if(j.cache_id_length!==k.cache_id_length)return j.cache_id_length-k.cache_id_length;var l=(j.cost||0)-(k.cost||0);if(l!==0)return l;return (j.semantic||'').localeCompare(k.semantic||'');},h.BEHAVIOR_STATE);};Object.assign(i.prototype,{disable:g});e.exports=i;},null);
__d("FacebarTypeaheadQuickSelect",["FacebarStructuredText","URI"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='/search/web/direct_search.php';function j(k){"use strict";this._core=k.getCore();this._view=k.getView();this._input=this._core.input;this._beforeSelectListener=null;this._quickSelectListener=null;}j.prototype.enable=function(){"use strict";this._beforeSelectListener=this._view.subscribe('beforeSelect',this._quickSelect.bind(this));this._quickSelectListener=this._view.subscribe('quickSelect',this._quickSelect.bind(this));};j.prototype._quickSelect=function(k,l){"use strict";if(l&&l.selected)return true;var m=this._input.getValue().toArray(),n=new g(m),o=n.toString();if(!o)return true;var p=new h(i).addQueryData('q',o),q={input_query:o,type:'quickselect',text:o,position:0,with_mouse:0,semantic:'quickselect('+p.toString()+')',extra_uri_params:{source:'quickselect',sid:this._core.getSessionID()},uri:p};this._core.inform('quickSelectRedirect',q);this._core.executeQuery(q);return false;};j.prototype.disable=function(){"use strict";this._beforeSelectListener&&this._view.unsubscribe(this._beforeSelectListener);this._quickSelectListener&&this._view.unsubscribe(this._quickSelectListener);};e.exports=j;},null);
__d("FacebarTypeaheadRecorderBasic",["FacebarTypeaheadRecorder"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){"use strict";this._typeahead=i;}h.prototype.enable=function(){"use strict";var i=this._typeahead;this._recorder=new g(i);};h.prototype.disable=function(){"use strict";this._typeahead.unsubscribe(this._subscription);this._recorder=null;this._subscription=null;};Object.assign(h.prototype,{_subscription:null});e.exports=h;},null);
__d("FacebarTypeaheadSelectAll",["requestAnimationFrame"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){"use strict";this._core=i.getCore();this._listener=null;}h.prototype.enable=function(){"use strict";var i=this._core.input;this._listener=this._core.subscribe('focus',function(j,k){var l=k&&k.catchup;l||g(function(){i.selectInput();});});};h.prototype.disable=function(){"use strict";this._listener&&this._core.unsubscribe(this._listener);};e.exports=h;},null);
__d("FacebarTypeaheadShortcut",["FacebarTypeaheadShortcutConfig","KeyEventController","Run","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l){"use strict";this._input=l.core.input;this._view=l.view;this._listener=null;}k.prototype.enable=function(){"use strict";this._registerListener();};k.prototype.disable=function(){"use strict";};k.prototype._registerListener=function(){"use strict";this._listener&&this._listener.remove();this._listener=h.registerKey('SLASH',this._handleKeydown.bind(this));i.onLeave(function(){j(this._registerListener.bind(this),0);}.bind(this));};k.prototype._handleKeydown=function(l){"use strict";var m=l.getModifiers().shift;if(m&&!g.gkWebShortcut)return;this._selectInput(m);return false;};k.prototype._selectInput=function(l){"use strict";this._view.setAutoSelect(true);this._input.focus();this._input.selectInput();this._input.inform('shortcut',{shift:l});};e.exports=k;},null);
__d("FacebarTypeaheadSizeAdjuster",["getElementChildren","confine","emptyFunction","isTextNode","Style","Vector"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=12,n=20,o=50,p=200,q=5;function r(t){if(j(t))return 0;return l.getElementDimensions(t).x;}function s(t){"use strict";this._core=t.getCore();this._view=this._core.view;this._input=this._core.input;this._cachedSizes={};this._appliedSize=null;this._defaultSize=this.getDefaultFontSize();this._calculatedSize=this._defaultSize;this._containerWidth=this.getContainerWidth();}s.prototype.enable=function(){"use strict";this._input.subscribe('change',this.adjustFontSize.bind(this));this.adjustFontSize();};s.prototype.getContainerWidth=function(){"use strict";return l.getElementDimensions(this._input.getElement()).x;};s.prototype.getDefaultFontSize=function(){"use strict";var t=k.get(this._input.getElement(),'font-size'),u=/^([\d\.]+)px$/.exec(t),v=u&&Number(u[1]);return Math.max(m,Math.min(n,v));};s.prototype.calculateFontSize=function(){"use strict";var t=this.getTextWidth(),u=this._calculatedSize;if(t>this._containerWidth-o){u--;}else if(t<this._containerWidth-p)u++;this._calculatedSize=h(u,m,this._defaultSize);return this._calculatedSize;};s.prototype.getTextWidth=function(){"use strict";var t=this._calculatedSize+this.getValueKey();if(!this._cachedSizes.hasOwnProperty(t))this._cachedSizes[t]=this.measureTextWidth();return this._cachedSizes[t];};s.prototype.getValueKey=function(){"use strict";var t=this._core.getValue().getHash(),u=q*Math.floor(t.length/q);return t.substr(0,u);};s.prototype.measureTextWidth=function(){"use strict";var t=g(this._input.getRawInputElement());return t.reduce(function(u,v){return u+r(v);},0);};s.prototype.adjustFontSize=function(){"use strict";for(var t=0;t<10;t++){var u=this.calculateFontSize();if(u!=this._appliedSize){this._appliedSize=u;k.set(this._input.getElement(),'font-size',u+'px');k.set(this._view.content,'font-size',u+'px');}else break;}};Object.assign(s.prototype,{disable:i});e.exports=s;},null);
__d("TypeaheadSearchMegaphone",["AsyncRequest","DOM","DOMQuery","Event","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(m){"use strict";this.$TypeaheadSearchMegaphone0=m;}l.prototype.enable=function(){"use strict";var m=i.scry(this.$TypeaheadSearchMegaphone0.getView().getElement(),'.megaphone_location_gsv2_typeahead')[0];if(!m)return;this.ajaxify=i.scry(m,'a.megaphone_hide_link[ajaxify]')[0].getAttribute('ajaxify');i.scry(m,'a').forEach(this.processLink,this);j.listen(m,'click',this.onClick.bind(this));};l.prototype.disable=function(){"use strict";};l.prototype.processLink=function(m){"use strict";if(m.getAttribute('ajaxify'))return;h.setAttributes(m,{target:'_blank'});};l.prototype.onClick=function(event){"use strict";var m=k.byTag(event.target,'a');if(!m||m.getAttribute('ajaxify'))return;g.bootstrap(this.ajaxify,m);};e.exports=l;},null);