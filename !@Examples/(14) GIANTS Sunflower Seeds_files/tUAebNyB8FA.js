/*!CK:947988072!*//*1437526407,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nJsgb"]); }

__d("MercurySendMessageFields",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"};},null);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("ChatDispatcher",["Dispatcher"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("WebMessengerEvents",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=Object.assign(new g(),{MASTER_DOM_CHANGED:'master-dom-changed',DETAIL_DOM_CHANGED:'detail-dom-changed',FOCUS_COMPOSER:'focus-composer',FOCUS_SEARCH:'focus-search',FOCUS_AND_SELECT_SEARCH:'focus-and-select-search',STICKER_CLICKED:'sticker-clicked',SUBMIT_REPLY:'submit-reply',UPDATE_SELECTION:'update-selection',masterDOMChanged:function(){this.inform(h.MASTER_DOM_CHANGED);},detailDOMChanged:function(){this.inform(h.DETAIL_DOM_CHANGED);},focusComposer:function(){this.inform(h.FOCUS_COMPOSER);},focusSearch:function(){this.inform(h.FOCUS_SEARCH);},focusAndSelectSearch:function(){this.inform(h.FOCUS_AND_SELECT_SEARCH);},updateSelection:function(i){this.inform(h.UPDATE_SELECTION,i);},stickerClicked:function(i,j){this.inform(h.STICKER_CLICKED,{packID:i,stickerID:j});},submitReply:function(){this.inform(h.SUBMIT_REPLY);}});e.exports=h;},null);
__d("WebMessengerSubscriptionsHandler",["SubscriptionsHandler"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=new g('webmessenger');e.exports=h;},null);
__d("isWebMessengerURI",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){return (/^(\/messages)/).test(h.getPath());}e.exports=g;},null);
__d("WebMessengerWidthControl",["Arbiter","BlueBar","CSS","CSSClassTransition","DOMDimensions","Event","Style","URI","ViewportBounds","WebMessengerEvents","WebMessengerSubscriptionsHandler","$","cx","isWebMessengerURI","requestAnimationFrame","setTimeoutAcrossTransitions","shield","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();var y=205,z=981,aa=257,ba=18,ca=848,da=724,ea=.57,fa=56,ga,ha,ia;function ja(oa,pa,qa){this.masterChanged=oa;this.detailChaned=pa;q.addSubscriptions(l.listen(window,'resize',x(w(ka,this,this),100)),g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide','minisidebar/show'],w(ka,this,this),g.SUBSCRIBE_NEW));var ra=na()?fa:0;if(qa)ra=y;this._width=na()?0:ca;ia=true;ka(this,ra);}function ka(oa,pa){var qa=o.getRight()+o.getLeft();qa=qa||pa||0;var ra=k.getViewportWithoutScrollbarDimensions().width-qa,sa=Math.round(Math.max(0,ra/2-z/2));ra=z+sa-aa;ra-=ba;ra=Math.max(da,Math.min(ca,ra));if(!isNaN(ra)&&oa._width!==ra){oa._width=ra;var ta=Math.round(ra/(1+ea)),ua=ra-ta;oa.masterChanged(ua);oa.detailChaned(ta);if(na()){var va=ra+aa;la(function(){if(ha){document.body.className=ha;ha='';}ma(va+'px');i.removeClass(document.body,"_5uj5");ia&&p.detailDOMChanged();ia=false;},ha);}}}function la(oa,pa){pa&&i.addClass(document.documentElement,"_5uj6");u(oa);pa&&v(i.removeClass.bind(null,document.documentElement,"_5uj6"),1000);}function ma(oa){m.set(h.getNavRoot(),'width',oa);m.set(r('globalContainer'),'width',oa);}function na(){if(!ga)ga=i.hasClass(document.body,"_6nw");return ga;}j.registerHandler(function(oa,pa,qa,ra){function sa(ta){return na()&&t(new n(ta));}if(sa(ra)){ha=pa;return true;}else if(sa(qa)){la(function(){oa.className=pa;ma('');},true);return true;}});e.exports=ja;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","BlueBar","ChatQuietLinks","CSS","DataStore","DOM","Parent","Scroll","Style","Toggler","Vector","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();b('WebMessengerWidthControl');function w(){}Object.assign(w,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(x){this.init=v;this.rootEl=x;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();l.removeEmptyHrefs(this.rootEl);g.listen(x,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));s.subscribe(['show','hide'],function(y,z){var aa=z.getActive();if(!o.contains(x,aa))return;if(m.hasClass(aa,'fbNub')){this.notifyNub(aa,y);if(y==='show')this._resizeNubFlyout(aa);}else{var ba=p.byClass(aa,'fbNubFlyout');if(ba)m.conditionClass(ba,'menuOpened',y==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=t.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+t.getElementDimensions(this.rootEl).y;var x=k.getBar();if(x){var y=r.isFixed(x)?'viewport':'document';this.flyoutHeightOffset+=t.getElementPosition(x,y).y+t.getElementDimensions(x).y;}},toggle:function(x){var y=this._findFlyout(x);if(!y)return;this.subscribe('init',function(){s.toggle(x);});},show:function(x){this.subscribe('init',function(){s.show(x);});},showNub:function(x){m.show(x);},hide:function(x){this.subscribe('init',function(){var y=s.getInstance(x);o.contains(x,y.getActive())&&y.hide();});},hideNub:function(x){m.hide(x);this.hide(x);},setUseMaxHeight:function(x,y){m.conditionClass(x,'maxHeight',y!==false);this._resizeNubFlyout(x);},_resizeNubFlyout:function(x){var y=this._findFlyout(x);if(!y||m.hasClass(x,'placeholder')||!(m.hasClass(x,'openToggler')||m.hasClass(x,'opened')))return;var z=o.find(y,'div.fbNubFlyoutOuter'),aa=o.find(z,'div.fbNubFlyoutInner'),ba=o.find(aa,'div.fbNubFlyoutBody'),ca=q.getTop(ba),da=ba.offsetHeight;r.set(ba,'height','auto');var ea=t.getElementDimensions(y),fa=t.getElementDimensions(ba),ga=this.getMaxFlyoutHeight(x);r.set(y,'max-height',ga+'px');r.set(z,'max-height',ga+'px');ea=t.getElementDimensions(y);var ha=t.getElementDimensions(aa),ia=ha.y-fa.y,ja=ea.y-ia,ka=parseInt(ba.style.height||ba.clientHeight,10),la=ja!==ka;if(ea.y>ia&&la)r.set(ba,'height',ja+'px');m.removeClass(y,'swapDirection');var ma=t.getElementPosition(y).x;m.conditionClass(y,'swapDirection',function(){if(ma<0)return true;return (ma+ea.x>this.viewportDimensions.x);}.bind(this)());if(la&&ca+da>=fa.y){q.setTop(ba,ba.scrollHeight);}else q.setTop(ba,ca);this.notifyNub(x,'resize');},getMaxFlyoutHeight:function(x){var y=this._findFlyout(x),z=t.getElementPosition(y,'viewport'),aa=t.getElementDimensions(y),ba=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-z.y-aa.y);return Math.max(ba,0);},resizeAllFlyouts:function(){var x=this._getAllNubs(),y=x.length;while(y--)this._resizeNubFlyout(x[y]);},hideAllFlyouts:function(){var x=this._getAllNubs(),y=x.length;while(y--)this.hide(x[y]);},_getAllNubs:function(){var x=o.scry(this.rootEl,"div._50-v.openToggler");return x.concat(o.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var x=event.getTarget(),y=p.byClass(x,'fbNub');if(y){if(p.byClass(x,'fbNubFlyoutTitlebar')){var z=p.byTag(x,'a'),aa=x.nodeName=='INPUT'&&x.getAttribute('type')=='submit';if(!z&&!aa){this.hide(y);return false;}}this.notifyNub(y,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(x){return m.hasClass(x,'fbNubFlyout')?x:o.scry(x,'div.fbNubFlyout')[0]||null;},registerNubController:function(x,y){n.set(x,'dock:nub:controller',y);y.subscribe('nub/button/content-changed',h(this.inform,this,'resize',x));y.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,x));},unregisterNubController:function(x){n.remove(x,'dock:nub:controller');},notifyNub:function(x,y,z){var aa=n.get(x,'dock:nub:controller');aa&&aa.inform(y,z);}});e.exports=a.Dock||w;},null);
__d("PureStoreBasedStateMixin",["StoreBasedStateMixinHelper","invariant","setImmediate"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=function(){for(var k=[],l=0,m=arguments.length;l<m;l++)k.push(arguments[l]);return {getInitialState:function(){return this.constructor.calculateState();},componentWillMount:function(){h(this.constructor.calculateState);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState());this._recalculateStateID=null;}.bind(this);this._mixin=new g(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=i(n);}.bind(this));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}.bind(this);e.exports=j;},null);
__d("keyMirrorRecursive",["invariant"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';function h(k,l){return i(k,l);}function i(k,l){var m={},n;g(j(k));for(n in k){if(!k.hasOwnProperty(n))continue;var o=k[n],p=l?l+'.'+n:n;if(j(o)){o=i(o,p);}else o=p;m[n]=o;}return m;}function j(k){return k instanceof Object&&!Array.isArray(k);}e.exports=h;},null);
__d("mergeDeepInto",["invariant","mergeHelpers"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=h.ArrayStrategies,j=h.checkArrayStrategy,k=h.checkMergeArrayArgs,l=h.checkMergeLevel,m=h.checkMergeObjectArgs,n=h.isTerminal,o=h.normalizeMergeArg,p=function(t,u,v,w){m(t,u);l(w);var x=u?Object.keys(u):[];for(var y=0;y<x.length;y++){var z=x[y];r(t,u,z,v,w);}},q=function(t,u,v,w){k(t,u);l(w);var x=Math.max(t.length,u.length);for(var y=0;y<x;y++)r(t,u,y,v,w);},r=function(t,u,v,w,x){var y=u[v],z=u.hasOwnProperty(v),aa=z&&n(y),ba=z&&Array.isArray(y),ca=z&&!ba&&!ba,da=t[v],ea=t.hasOwnProperty(v),fa=ea&&n(da),ga=ea&&Array.isArray(da),ha=ea&&!ga&&!ga;if(fa){if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else if(!z)t[v]=da;}else if(ga){if(aa){t[v]=y;}else if(ba){g(i[w]);if(w===i.Clobber)da.length=0;q(da,y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else !z;}else if(ha){if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){p(da,y,w,x+1);}else !z;}else if(!ea)if(aa){t[v]=y;}else if(ba){t[v]=[];q(t[v],y,w,x+1);}else if(ca){t[v]={};p(t[v],y,w,x+1);}else !z;},s=function(t,u,v){var w=o(u);j(v);p(t,w,v,0);};e.exports=s;},null);
__d("mergeDeep",["mergeHelpers","mergeDeepInto"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g.checkArrayStrategy,j=g.checkMergeObjectArgs,k=g.normalizeMergeArg,l=function(m,n,o){var p=k(m),q=k(n);j(p,q);i(o);var r={};h(r,p,o);h(r,q,o);return r;};e.exports=l;},null);
__d("ReactComponentRenderer",["React","Object.assign","warning"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';function j(k,l){this.klass=k;this.container=l;this.props={};this.component=null;}j.prototype.replaceProps=function(k,l){this.props={};this.setProps(k,l);};j.prototype.setProps=function(k,l){if(this.klass==null)return;h(this.props,k);var m=g.createElement(this.klass,this.props);this.component=g.render(m,this.container,l);};j.prototype.unmount=function(){g.unmountComponentAtNode(this.container);this.klass=null;};e.exports=j;},null);
__d("DropdownContextualHelpLink",["DOM","ge"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={set:function(j){var k=h('navHelpCenter');if(k!==null)g.replace(k,j);}};e.exports=i;},null);
__d("MercuryLocalIDs",["PresenceUtil","randomInt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i={generateMessageID:function(k){var l=k||Date.now(),m=h(0,4294967295),n=g.getSessionID();return ("<"+l+":"+m+"-"+n+"@mail.projektitan.com>");},generateThreadID:function(k){return 'root:'+i.generateMessageID(k);},generateOfflineThreadingID:function(k){var l=k||Date.now(),m=h(0,4294967295),n=('0000000000000000000000'+m.toString(2)).slice(-22),o=l.toString(2)+n;return j(o);}};function j(k){var l='';while(k!='0'){var m=0,n='';for(var o=0;o<k.length;o++){m=2*m+parseInt(k[o],10);if(m>=10){n+='1';m-=10;}else n+='0';}l=m.toString()+l;k=n.slice(n.indexOf('1'));}return l;}e.exports=i;},null);
__d("MercuryMessageObject",["MercuryActionStatus","MercuryActionType","MercuryIDs","MercuryLocalIDs","MercuryMessageClientState","MercuryMessageSourceTags","MercurySingletonMixin","MercurySourceType","MercuryTimePassed","MercurySendMessageFields","fbt","formatDate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(v){"use strict";this.$MercuryMessageObject0=v;}s.prototype.constructUserGeneratedMessageObject=function(v,w,x,y,z){"use strict";var aa=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);if(typeof v=='string')v=v.replace(/^\s+/,'').replace(/\s+$/,'');aa.body=v;aa.has_attachment=false;aa.html_body=false;aa.attachments=[];aa.specific_to_list=y||[];aa.creator_info=z;return aa;};s.prototype.constructStickerMessageObject=function(v,w,x){"use strict";var y=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,w,x);y.has_attachment=true;y.html_body=false;y.attachments=[];y.sticker_id=v;y.specific_to_list=[];return y;};s.prototype.constructAttachmentMessageObject=function(v,w){"use strict";var x=t(this.$MercuryMessageObject0,h.USER_GENERATED_MESSAGE,v,w);x.attachments=[];x.specific_to_list=[];return x;};s.prototype.constructLogMessageObject=function(v,w,x,y){"use strict";var z=t(this.$MercuryMessageObject0,h.LOG_MESSAGE,v,w);z.log_message_type=x;z.log_message_data=y;return z;};s.prototype.normalizeNewMessage=function(v){"use strict";if(v.status===undefined)v.status=g.UNSENT;v.timestamp_absolute=q._("Today");v.threading_id=v.threading_id||j.generateMessageID(v.timestamp);v.offline_threading_id=v.offline_threading_id||j.generateOfflineThreadingID(v.timestamp);v.message_id=v.message_id||v.offline_threading_id;var w=i.getParticipantIDFromUserID(this.$MercuryMessageObject0);v.specific_to_list=v.specific_to_list||[];if(v.specific_to_list.length&&v.specific_to_list.indexOf(w)===-1)v.specific_to_list.push(w);if(!v.thread_id){if(v.specific_to_list.length==1){v.thread_id='user:'+this.$MercuryMessageObject0;}else if(v.specific_to_list.length==2){var x=v.specific_to_list[0]==w?v.specific_to_list[1]:v.specific_to_list[0];v.thread_id=i.getThreadIDFromParticipantID(x);}v.thread_id=v.thread_id||'root:'+v.threading_id;}if(!v.specific_to_list.length){var y=i.tokenize(v.thread_id),z=y.type,aa=y.value;if(z=='user')v.specific_to_list=['fbid:'+aa,w];}if(!v[p.MANUAL_RETRY_CNT])v[p.MANUAL_RETRY_CNT]=0;};s.prototype.normalizeResendMessage=function(v){"use strict";v.status=g.RESENDING;v.timestamp=Date.now();v[p.MANUAL_RETRY_CNT]+=1;};s.prototype.normalizeAddAttachmentPlaceholder=function(v,w,x){"use strict";if(x.preview_attachments.length>0){v.has_attachment=true;v.preview_attachments=x.preview_attachments;}v.client_state=k.DO_NOT_SEND_TO_SERVER;v.status=g.RESENDING;v.upload_id=w;};function t(v,w,x,y){var z=u(x)?[l.CHAT]:[],aa=Date.now(),ba=r(new Date(aa),'g:ia'),ca={action_type:w,thread_id:y,author:i.getParticipantIDFromUserID(v),author_email:null,timestamp:aa,timestamp_absolute:(new Date(aa)).toLocaleDateString(),timestamp_relative:ba,timestamp_time_passed:o.TODAY,is_unread:false,is_forward:false,is_filtered_content:false,is_filtered_content_bh:false,is_filtered_content_account:false,is_spoof_warning:false,source:x,source_tags:z};return ca;}function u(v){switch(v){case n.CHAT_WEB:case n.CHAT_JABBER:case n.CHAT_IPHONE:case n.CHAT_MEEBO:case n.CHAT_ORCA:case n.CHAT_TEST:case n.CHAT:case n.DESKTOP:return true;default:return false;}}Object.assign(s,m);e.exports=s;},null);
__d("MercuryMessageActions",["MercuryActionType","MercuryDispatcher","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n){this.$MercuryMessageActions0=n;this.$MercuryMessageActions1=i.getForFBID(this.$MercuryMessageActions0);this.$MercuryMessageActions2=k.getForFBID(this.$MercuryMessageActions0);this.$MercuryMessageActions3=h.getForFBID(this.$MercuryMessageActions0);}m.prototype.send=function(n,o,p){o=o||Function.prototype;this.$MercuryMessageActions1.normalizeNewMessage(n);this.$MercuryMessageActions3.handleUpdate(this.$MercuryMessageActions4(Object.assign({},n),j.CLIENT_SEND_MESSAGE));this.$MercuryMessageActions2.sendNewMessage(n,p);o(n.thread_id);};m.prototype.resend=function(n,o){var p=Object.assign({},n);this.$MercuryMessageActions1.normalizeResendMessage(p);this.send(p,(void 0),o);};m.prototype.addAttachmentPlaceholder=function(n,o,p){this.$MercuryMessageActions1.normalizeAddAttachmentPlaceholder(n,o,p);this.$MercuryMessageActions1.normalizeNewMessage(n);this.$MercuryMessageActions3.handleUpdate(this.$MercuryMessageActions4(Object.assign({},n),j.CLIENT_SEND_MESSAGE));};m.prototype.cancelAttachmentPlaceholder=function(n,o){this.$MercuryMessageActions3.handleUpdate(this.$MercuryMessageActions4({upload_id:n,upload_data:o,action_type:g.CANCEL_ATTACHMENT_PLACEHOLDER},j.CLIENT_SEND_MESSAGE));};m.prototype.confirmAttachmentPlaceholder=function(n,o){this.$MercuryMessageActions3.handleUpdate(this.$MercuryMessageActions4({upload_id:n,upload_data:o,action_type:g.CONFIRM_ATTACHMENT_PLACEHOLDER},j.CLIENT_SEND_MESSAGE));};m.prototype.markSpam=function(n,o){this.$MercuryMessageActions3.handleUpdate(this.$MercuryMessageActions5(n,o,g.MARK_MESSAGES_SPAM,j.CLIENT_MARK_MESSAGES_SPAM));};m.prototype["delete"]=function(n,o,p){this.$MercuryMessageActions3.handleUpdate(this.$MercuryMessageActions5(n,o,g.DELETE_MESSAGES,p||j.CLIENT_DELETE_MESSAGES));};m.prototype.$MercuryMessageActions4=function(n,o){return {actions:[n],from_client:true,payload_source:o};};m.prototype.$MercuryMessageActions6=function(n,o){return {actions:[n],from_client:false,payload_source:o};};m.prototype.$MercuryMessageActions5=function(n,o,p,q){return {actions:[{action_type:p,action_id:null,thread_id:n,message_ids:o}],from_client:true,payload_source:q};};Object.assign(m,l);e.exports=m;},null);
__d("MercuryThreadActions",["AsyncDialog","AsyncRequest","MercuryActionType","MercuryDispatcher","MercuryIDs","MercuryMessengerBlockingUtils","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin","MessagingTag","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';function r(s){this.$MercuryThreadActions0=s;this.__serverRequests=n.getForFBID(this.$MercuryThreadActions0);this.__dispatcher=j.getForFBID(this.$MercuryThreadActions0);}r.prototype.markRead=function(s,t){this.batchMarkRead([s],t);};r.prototype.batchMarkRead=function(s,t){this.__dispatcher.handleUpdate(this.$MercuryThreadActions1(s,true,t));};r.prototype.markUnread=function(s,t){this.batchMarkUnread([s],t);};r.prototype.batchMarkUnread=function(s,t){this.__dispatcher.handleUpdate(this.$MercuryThreadActions1(s,false,t));};r.prototype.markSeen=function(s,t){this.__dispatcher.handleUpdate(this.__constructClientPayload([s],i.MARK_THREAD_SEEN,m.CLIENT_MARK_THREAD_SEEN,{persistent:t}));};r.prototype.archive=function(s,t){this.batchArchive([s],t);};r.prototype.batchArchive=function(s,t){s.forEach(function(u){this.__serverRequests.changeThreadArchivedStatus(u,true,t);}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions2(s,true));};r.prototype.unarchive=function(s,t){this.batchUnarchive([s],t);};r.prototype.batchUnarchive=function(s,t){s.forEach(function(u){this.__serverRequests.changeThreadArchivedStatus(u,false,t);}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions2(s,false));};r.prototype.markSpam=function(s,t){this.batchMarkSpam([s],t);};r.prototype.batchMarkSpam=function(s,t){s.forEach(function(u){this.__serverRequests.markThreadSpam(u,t);}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions3(s,p.SPAM));};r.prototype.unmarkSpam=function(s,t){this.batchUnmarkSpam([s],t);};r.prototype.batchUnmarkSpam=function(s,t){s.forEach(function(u){this.__serverRequests.unmarkThreadSpam(u,t);}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions3(s,p.INBOX));};r.prototype.changeFolder=function(s,t){this.batchChangeFolder([s],t);};r.prototype.batchChangeFolder=function(s,t){s.forEach(function(u){this.__serverRequests.changeThreadFolder(u,t);}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions3(s,t));};r.prototype["delete"]=function(s,t){this.batchDelete([s],t);};r.prototype.batchDelete=function(s,t){s.forEach(function(u){this.__serverRequests.deleteThread(u,t);}.bind(this));this.__dispatcher.handleUpdate(this.__constructClientPayload(s,i.DELETE_THREAD,m.CLIENT_DELETE_THREAD));};r.prototype.openNotificationSettings=function(s){this.__serverRequests.openNotificationSettings(s);};r.prototype.unmute=function(s){this.updateMuteSetting(s,0);};r.prototype.updateMuteSetting=function(s,t){this.__serverRequests.changeMutingOnThread(s,t);this.__dispatcher.handleUpdate(this.__constructClientPayload([s],i.CHANGE_MUTE_SETTINGS,m.CLIENT_CHANGE_MUTE_SETTINGS,{mute_settings:t}));};r.prototype.blockMessages=function(s){var t=JSON.stringify({reportable_ent_token:k.getUserIDFromThreadID(s),initial_action_name:l.block_messages});g.send(new h(new q('/ajax/nfx/messenger_direct_action').addQueryData({story_location:'messenger',context:t})));};r.prototype.unblockMessages=function(s){var t=JSON.stringify({reportable_ent_token:k.getUserIDFromThreadID(s),initial_action_name:l.block_messages});new h(new q('/ajax/nfx/messenger_undo_block').addQueryData({story_location:'messenger',context:t})).send();};r.prototype.addParticipants=function(s,t){this.__dispatcher.handleUpdate(this.__constructClientPayload([s],i.ADD_PARTICIPANTS,m.CLIENT_ADD_PARTICIPANTS,{participants:t}));};r.prototype.unpinThread=function(s){this.__serverRequests.unpinThread(s);this.__dispatcher.handleUpdate(this.__constructClientPayload([s],i.UNPIN_THREAD,m.CLIENT_UNPIN_THREAD));};r.prototype.movePendingToInbox=function(s){this.__dispatcher.handleUpdate(this.__constructClientPayload([s],i.MOVE_PENDING_TO_INBOX,m.CLIENT_MOVE_PENDING_TO_INBOX));};r.prototype.$MercuryThreadActions1=function(s,t,u){return this.__constructClientPayload(s,i.CHANGE_READ_STATUS,m.CLIENT_CHANGE_READ_STATUS,{mark_as_read:t,source:u});};r.prototype.$MercuryThreadActions2=function(s,t){return this.__constructClientPayload(s,i.CHANGE_ARCHIVED_STATUS,m.CLIENT_CHANGE_ARCHIVED_STATUS,{archived:t});};r.prototype.$MercuryThreadActions3=function(s,t){return this.__constructClientPayload(s,i.CHANGE_FOLDER,m.CLIENT_CHANGE_FOLDER,{new_folder:t});};r.prototype.__constructClientPayload=function(s,t,u,v){return {actions:s.map(function(w){return Object.assign({action_type:t,action_id:null,thread_id:w},v);}),from_client:true,payload_source:u};};Object.assign(r,o);e.exports=r;},null);
__d("ChatTabModel",["Arbiter","ArbiterMixin","ChatBehavior","ChatDispatcher","ChatConfig","ChatCookieInterface","ChatTabActions","InitialServerTime","LogHistory","JSLogger","MercuryAssert","MercuryLocalIDs","PresenceState","PresenceUtil","MercuryThreadIDMap","MercuryThreads","MercuryTimestampTracker"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=b('MercuryThreadIDMap').get(),v=b('MercuryThreads').get(),w=b('MercuryTimestampTracker').get(),x=n.serverTime,y=k.get('tab_max_load_age')||3600000,z=20,aa=o.getInstance('chat_tab_model'),ba={tabs:[],promotedID:null,lastChangeTime:0,lastChangeReason:null,isInitialized:false,localRaised:null};function ca(xa){var ya=l.load(xa,ba);ya&&ga();return ya;}function da(xa,ya,za){var ab=ca(s.get());if(ya===(void 0)||ya>ba.lastChangeTime){if(xa()){ab=true;ba.lastChangeReason=za||null;fa(ya);}}else aa.error('rejected',{change_time:ya,state_time:ba.lastChangeTime});ab&&ea();}function ea(){if(ba.isInitialized)va.inform('change');}function fa(xa){if(xa===(void 0))xa=Math.max(w.getLastUserMessageTimestamp()||1,ba.lastChangeTime+1);ba.lastChangeTime=xa;s.doSync();}function ga(xa){var ya=ba.tabs.length-z;if(ya>0)ba.tabs=ba.tabs.filter(function(za){return za.raised||za.id==xa||ya--<=0;});if(ya>0)ba.tabs=ba.tabs.filter(function(za){return za.id==ba.promotedID||za.id==xa||ya--<=0;});}function ha(xa){for(var ya=0;ya<ba.tabs.length;ya++)if(ba.tabs[ya].id==xa)return ya;return -1;}function ia(xa,ya){var za=v.getThreadMetaNow(xa);if(!za)return false;if(za.is_canonical_user){return la(xa,ya);}else{var ab=ka(xa);if(ab)u.getFBIDFromClientID(xa,function(bb){if(oa(xa,bb)){fa();ea();}});return ab;}}function ja(xa){q.isThreadID(xa);if(ka(xa))ea();}function ka(xa){if(ha(xa)===-1){ba.tabs.push({id:xa,fragile:true});aa.log('open_fragile_tab',{tabs:JSON.stringify(ba.tabs),opened:xa,window_id:t.getSessionID()});return true;}return false;}function la(xa,ya){var za=ha(xa);if(za!=-1)if(ba.tabs[za].fragile){ba.tabs.splice(za,1);}else{ya&&(ba.tabs[za].signatureID=ya);return true;}for(var ab=0;ab<=ba.tabs.length;ab++)if(ab==ba.tabs.length||ba.tabs[ab].fragile){ba.tabs.splice(ab,0,{id:xa,signatureID:ya});ga(xa);aa.log('open_tab',{tabs:JSON.stringify(ba.tabs),opened:xa,window_id:t.getSessionID()});return true;}}function ma(xa,ya,za){q.isThreadID(xa);var ab=false;if(ba.localRaised&&ya){ba.localRaised[xa]=true;ab=true;}da(function(){if(ia(xa,za))ab=true;var bb=ha(xa);if(bb!=-1&&!ba.tabs[bb].raised){ba.tabs[bb].raised=true;ab=true;aa.log('raise_tab',{tabs:JSON.stringify(ba.tabs),raised:xa,window_id:t.getSessionID()});}return ab;});}function na(xa){if(ha(xa)!==-1&&ba.promotedID!==xa){ba.promotedID=xa;return true;}return false;}function oa(xa,ya){var za=ha(xa);if(za!=-1&&ba.tabs[za].fragile){var ab=ba.tabs[za];ab.fragile=false;ab.server_id=ya;var bb=[];ba.tabs.forEach(function(cb){if(cb.id!=xa){if(ab&&cb.fragile){bb.push(ab);ab=null;}bb.push(cb);}});if(ab)bb.push(ab);ba.tabs=bb;aa.log('make_permanent',{tabs:JSON.stringify(ba.tabs),tab_id:xa,window_id:t.getSessionID()});return true;}return false;}function pa(xa,ya){q.isThreadID(xa);var za=false;if(ba.localRaised){delete ba.localRaised[xa];za=true;}da(function(){if(qa(xa))za=true;return za;},(void 0),ya);}function qa(xa){var ya=ha(xa);if(xa==ba.promotedID)ba.promotedID=null;if(ya!=-1){ba.tabs.splice(ya,1);aa.log('close_tab',{tabs:JSON.stringify(ba.tabs),closed:xa,window_id:t.getSessionID()});return true;}return false;}function ra(){if(ba.tabs.length){aa.log('close_all_tabs',{closed_tabs:JSON.stringify(ba.tabs),window_id:t.getSessionID()});ba.tabs=[];ba.promotedID=null;if(ba.localRaised)ba.localRaised={};fa();ea();}}function sa(){var xa=[];for(var ya=0;ya<ba.tabs.length;ya++)if(ba.tabs[ya].fragile&&!v.isNewEmptyLocalThread(ba.tabs[ya].id)){xa.push(ba.tabs[ya]);ba.tabs.splice(ya);ea();break;}aa.log('close_fragile_tabs',{tabs:JSON.stringify(ba.tabs),fragile_closed:xa,window_id:t.getSessionID()});}function ta(xa){q.isThreadID(xa);var ya=false;if(ba.localRaised){delete ba.localRaised[xa];ya=true;}da(function(){var za=ha(xa);if(za!=-1&&ba.tabs[za].raised){delete ba.tabs[za].raised;aa.log('lower_tab',{tabs:JSON.stringify(ba.tabs),lowered:xa,window_id:t.getSessionID()});ya=true;}return ya;});}function ua(){if(ba.localRaised){da(function(){var xa=false;ba.tabs.forEach(function(ya){if(ya.raised!=ba.localRaised[ya.id]){xa=true;if(ba.localRaised[ya.id]){ya.raised=true;}else delete ya.raised;}});return xa;});aa.log('persist_local_raise',{tabs:JSON.stringify(ba.tabs),window_id:t.getSessionID()});}}s.registerStateStorer(function(xa){return l.store(xa,ba);});s.registerStateLoader(function(xa){if(ca(xa))ea();});function va(){}Object.assign(va,h,{isTabPromoted:function(xa){if(xa)return xa==ba.promotedID;return false;},indexOf:function(xa){return ha(xa);},getTab:function(xa){q.isThreadID(xa);var ya=this.indexOf(xa);if(ya>-1){var za=ba.tabs[ya];return Object.assign({},za);}return null;},getEmptyTab:function(){var xa;for(var ya=0;ya<ba.tabs.length;ya++){xa=ba.tabs[ya].id;if(v.isNewEmptyLocalThread(xa))return xa;}xa=r.generateThreadID();v.createNewLocalThread(xa,[]);return xa;},get:function(){var xa=ba.tabs.map(function(ya){var za=Object.assign({},ya);delete za.fragile;if(ba.localRaised)za.raised=ba.localRaised[za.id];return za;});return {tabs:xa,promoted:ba.promotedID};},promoteThreadInPlaceOfThread:function(xa,ya,za,ab){q.isThreadID(xa);q.isThreadID(ya);da(function(){var bb=ha(xa),cb=ha(ya);if(ab){ba.promotedID=xa;}else if(ba.promotedID===ya)return true;var db=ba.tabs[bb];if(za){q.isThreadID(za);var eb=ha(za),fb=ba.tabs[cb];ba.tabs[cb]=db;ba.tabs.splice(bb,1);ba.tabs.splice(eb,0,fb);}else{ba.tabs[bb]=ba.tabs[cb];ba.tabs[cb]=db;}return true;});},addListener:function(xa){return va.subscribe('change',xa);}});g.subscribe(p.DUMP_EVENT,function(xa,ya){ya.chat_tabs={promoted:ba.promotedID,tabs:ba.tabs.map(function(za){return Object.assign({},za);}),time:ba.lastChangeTime,max_load_age:y};});function wa(){var xa=i.ignoresRemoteTabRaise();if(xa&&!ba.localRaised){aa.log('start_ignore_remote_raise');ba.localRaised={};ea();}else if(!xa&&ba.localRaised){aa.log('stop_ignore_remote_raise');ba.localRaised=null;ea();}}j.register(function(xa){switch(xa.actionType){case m.Types.CLOSE_TAB:pa(xa.threadID,xa.reason);break;case m.Types.CLOSE_ALL_TABS:ra();break;case m.Types.CLOSE_FRAGILE_TABS:sa();break;case m.Types.LOWER_TAB:ta(xa.threadID);break;case m.Types.OPEN_FRAGILE_TAB:ja(xa.threadID);break;case m.Types.OPEN_TAB:q.isThreadID(xa.threadID);da(function(){return ia(xa.threadID);});break;case m.Types.PERSIST_LOCAL_STATE:ua();break;case m.Types.PROMOTE_TAB:q.isThreadID(xa.threadID);da(na.bind(null,xa.threadID));break;case m.Types.RAISE_TAB:ma(xa.threadID,xa.userAction,xa.signatureID);break;}});i.subscribe(i.ON_CHANGED,wa);wa();ca(s.getInitial(),true);if(ba.lastChangeTime===0)ba.lastChangeTime=x-600000;ba.isInitialized=true;e.exports=va;},null);
__d("MercuryDelayedDispatcher",["MercuryDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonMixin","MercuryThreadIDMap"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';function l(m){this.$MercuryDelayedDispatcher0=m;this.$MercuryDelayedDispatcher1=[];this.$MercuryDelayedDispatcher2=k.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher3=g.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher4=i.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher5=h.getForFBID(this.$MercuryDelayedDispatcher0);this.$MercuryDelayedDispatcher3.subscribe('model-update-completed',function(n,o){return this.$MercuryDelayedDispatcher7();}.bind(this));}l.prototype.handleUpdateWaitForThread=function(m,n){var o=this.$MercuryDelayedDispatcher2.getClientIDFromFBIDNow(n);if(o){this.$MercuryDelayedDispatcher8(m);return;}this.$MercuryDelayedDispatcher2.getClientIDFromFBID(n,function(){return this.$MercuryDelayedDispatcher1.push(m);}.bind(this));this.$MercuryDelayedDispatcher4.ensureThreadIsFetched(n);};l.prototype.$MercuryDelayedDispatcher7=function(){if(this.$MercuryDelayedDispatcher1&&this.$MercuryDelayedDispatcher1.length){var m=this.$MercuryDelayedDispatcher1[0];this.$MercuryDelayedDispatcher1=this.$MercuryDelayedDispatcher1.slice(1);this.$MercuryDelayedDispatcher8(m);}};l.prototype.$MercuryDelayedDispatcher8=function(m){if(m.from_client){this.$MercuryDelayedDispatcher3.handleUpdate(m);}else this.$MercuryDelayedDispatcher5.handleUpdate(m);};Object.assign(l,j);e.exports=l;},null);
__d("MercuryMessages",["BanzaiODS","EventEmitter","ImmutableObject","LogHistory","Map","MercuryActionStatus","MercuryActionType","MercuryAssert","MercuryDispatcher","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySingletonMixin","MercuryMessageActions","MercuryMessageIDs","RangedCallbackManager","MercurySendMessageFields","MercuryServerRequests","MercuryThreadActions","MercuryThreadInformer","MercuryThreads","URI","invariant","isMessengerDotComURI","mergeDeep"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){b.__markCompiled&&b.__markCompiled();'use strict';var fa=new h(),ga=j.getInstance('mercury_messages');function ha(qa,ra){var sa=ra;if(qa._localIdsMap[ra])sa=qa._localIdsMap[ra];return qa._messages.get(sa);}function ia(qa){switch(qa){case r.UNKNOWN:case r.SERVER_INITIAL_DATA:case r.SERVER_FETCH_THREAD_INFO:case r.SERVER_THREAD_SYNC:return true;}return false;}function ja(qa,ra){if(!qa._threadsToMessages[ra])qa._threadsToMessages[ra]=new v(function(sa){return ha(qa,sa).timestamp;},function(sa,ta){return ta-sa;});return qa._threadsToMessages[ra];}function ka(qa,ra,sa){ra.forEach(function(ta){var ua=ja(qa,ta);ua.setReachedEndOfArray();qa._emitReorderedChange(ta,sa);});}function la(qa){this._fbid=qa;this._messageActions=t.getForFBID(this._fbid);this._serverRequests=x.getForFBID(this._fbid);this._threadInformer=z.getForFBID(this._fbid);this._threads=aa.getForFBID(this._fbid);this._threadActions=y.getForFBID(this._fbid);this._dispatcher=o.getForFBID(this._fbid);this._didChange=false;this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new k();this._localIdsMap={};this._dispatcher.subscribe('update-messages',function(ra,sa){var ta=(sa.actions||[]).filter(function(va){var wa=va.action_type,xa=((va.is_forward||va.thread_id)&&(wa==m.LOG_MESSAGE||wa==m.USER_GENERATED_MESSAGE||wa==m.SEND_MESSAGE||wa==m.DELETE_THREAD||wa==m.DELETE_MESSAGES||wa==m.MARK_MESSAGES_SPAM)),ya=((va.upload_id&&va.upload_data)&&(wa==m.CANCEL_ATTACHMENT_PLACEHOLDER||wa==m.CONFIRM_ATTACHMENT_PLACEHOLDER));return xa||ya;}),ua=ia(sa.payload_source);this.handleUpdates(ta,ua,sa.payload_source,sa.from_client);if(sa.end_of_history)ka(this,sa.end_of_history,sa.payload_source);if(this._didChange){this._didChange=false;fa.emit('change');}}.bind(this));ga.debug('constructed',{fbid:this._fbid});}Object.assign(la.prototype,{getMessagesFromIDs:function(qa){return (qa||[]).map(ha.bind(null,this)).filter(function(ra){return ra;});},hasLoadedNMessages:function(qa,ra){var sa=ja(this,qa);return sa.hasReachedEndOfArray()||sa.getCurrentArraySize()>=ra;},hasLoadedExactlyNMessages:function(qa,ra){var sa=ja(this,qa);return sa.getCurrentArraySize()==ra;},clearMercuryInternalState_DO_NOT_USE:function(){this._failedHistoryFetchThreads={};this._threadsToMessages={};this._localTitanMessagesCount={};this._messages=new k();this._localIdsMap={};},getThreadMessagesRange:function(qa,ra,sa,ta,ua,va){var wa=ja(this,qa),xa=function(hb){ta(ma(this,hb));}.bind(this),ya=wa.executeOrEnqueue(ra,sa,xa),za=wa.getUnavailableResources(ya),ab=this._failedHistoryFetchThreads[qa];if(za.length&&!ab){var bb=wa.getCurrentArraySize(),cb=this._localTitanMessagesCount[qa]||0,db=bb-cb,eb=za.length+cb,fb=this.getCurrentlyLoadedMessages(qa),gb=fb.length?fb[0].timestamp:0;ga.debug('fetch_missing_messages',{threadID:qa,offset:ra,limit:sa,timestamp:gb,missingIndices:za,messageCount:bb,localMessageCount:cb});this._serverRequests.fetchThreadMessages(qa,db,eb,gb,ua,va);}else this._failedHistoryFetchThreads[qa]=false;return ya;},getThreadMessagesRangeNow:function(qa,ra,sa){var ta=ja(this,qa),ua=[];for(var va=ra;va<ra+sa;va++){var wa=ta.getResourceAtIndex(va),xa=ha(this,wa);xa&&ua.push(xa);}return ua;},getThreadMessagesSinceTimestamp:function(qa,ra){var sa=ja(this,qa),ta=sa.getElementsUntil(ra);return ma(this,ta);},hasLoadedAllMessages:function(qa){return ja(this,qa).hasReachedEndOfArray();},getCurrentlyLoadedMessages:function(qa){var ra=ja(this,qa).getAllResources();return ma(this,ra);},unsubscribe:function(qa,ra){n.isThreadID(ra);var sa=ja(this,ra);sa.unsubscribe(qa);},_addNewMessage:function(qa,ra){pa(ra);this._messages.set(qa,new i(ra));},_updateMessage:function(qa,ra,sa){var ta=i.set(ra,sa);this._messages.set(qa,ta);return ta;},_shouldSortOutOfOrderMessages:function(qa,ra,sa){if(qa==r.CLIENT_CHANNEL_MESSAGE){var ta=this.getThreadMessagesSinceTimestamp(ra,sa);if(ta.length>0){g.bumpEntityKey('chat.web','channel.messages_reordered');return true;}}return false;},_preprocessIncomingAction:function(qa,ra){var sa=qa.action_type;if(ra==r.CLIENT_CHANNEL_MESSAGE&&sa==m.USER_GENERATED_MESSAGE&&qa.offline_threading_id&&this._localIdsMap[qa.offline_threading_id]===qa.offline_threading_id){qa.client_message_id=qa.offline_threading_id;qa.status=l.SUCCESS;qa.action_type=m.SEND_MESSAGE;sa=qa.action_type;}if(ra===r.CLIENT_CHANNEL_MESSAGE&&sa==m.USER_GENERATED_MESSAGE){var ta=this._threads.getThreadMetaNow(qa.thread_id);if(ta&&ta.folder)qa.folder=ta.folder;}return qa;},handleUpdates:function(qa,ra,sa,ta){var ua,va={};for(var wa=0;wa<qa.length;wa++){var xa=this._preprocessIncomingAction(qa[wa],sa),ya=xa.action_type,za=ha(this,xa.message_id);if(ya==m.LOG_MESSAGE)if(this._isLocalMessage(xa))continue;if(xa.is_forward||sa==r.SERVER_SEARCH){if(!this._messages.has(xa.message_id))this._addNewMessage(xa.message_id,xa);continue;}else if(xa.client_state===q.SEND_TO_SERVER){this._addNewMessage(xa.message_id,xa);continue;}else if(ya==m.SEND_MESSAGE){var ab=xa.client_message_id;if(ab&&this._localIdsMap[ab]&&xa.status){var bb=ha(this,ab),cb=bb.status;if(bb.status==l.SUCCESS)continue;if(!va[xa.thread_id])va[xa.thread_id]=[];this._updateLocalMessage(xa);if(typeof cb!==(void 0)||xa.status==l.FAILED_UNKNOWN_REASON||xa.status==l.UNABLE_TO_CONFIRM||xa.status==l.SUCCESS||xa.status==l.ERROR)this._emitUpdatedChange(xa.thread_id,ha(this,ab).message_id,sa);}continue;}else if(ya==m.DELETE_THREAD){ja(this,xa.thread_id).removeAllResources();continue;}else if(ya==m.DELETE_MESSAGES){this._deleteMessages(xa.thread_id,xa.message_ids,sa);continue;}else if(ya===m.MARK_MESSAGES_SPAM){this._markMessagesSpam(xa,sa);continue;}else if((xa.offline_threading_id&&this._localIdsMap[xa.offline_threading_id])||(za&&!za.is_forward)){if(za&&xa.ranges&&xa.ranges.length>0){var db=za.message_id;this._updateMessage(this._localIdsMap[db]||db,za,{ranges:qa.ranges});this._emitUpdatedChange(za.thread_id,za.message_id,'link_shim');}continue;}else if(ya===m.CONFIRM_ATTACHMENT_PLACEHOLDER){this._confirmAttachmentPlaceholder(xa.upload_id,xa.upload_data);continue;}else if(ya===m.CANCEL_ATTACHMENT_PLACEHOLDER){this._cancelAttachmentPlaceholder(xa.upload_id,xa.upload_data);continue;}else{if(sa===r.CLIENT_SEND_MESSAGE){this._localIdsMap[xa.message_id]=xa.message_id;if(xa.thread_id=='root:'+xa.threading_id)ja(this,xa.thread_id).setReachedEndOfArray();}if(ya==m.LOG_MESSAGE&&xa.log_message_type==p.SERVER_ERROR)this._failedHistoryFetchThreads[xa.thread_id]=true;if(xa.client_state===q.DO_NOT_SEND_TO_SERVER&&xa.upload_id)this._uploadMessages[xa.upload_id]=xa;if(!va[xa.thread_id])va[xa.thread_id]=[];va[xa.thread_id].push(xa.message_id);this._addNewMessage(xa.message_id,xa);if(xa.offline_threading_id&&xa.offline_threading_id!=xa.message_id){u.addServerID(xa.offline_threading_id,xa.message_id);if(xa.threading_id)u.addServerID(xa.threading_id,xa.message_id);}if(xa[w.MANUAL_RETRY_CNT]>0){ua=ja(this,xa.thread_id);ua.resortResources([xa.message_id]);this._emitReorderedChange(xa.thread_id,r.CLIENT_SEND_MESSAGE);}ra=ra||this._shouldSortOutOfOrderMessages(sa,xa.thread_id,xa.timestamp);if(!ra)this._emitReceivedChange(ha(this,xa.message_id));continue;}}for(var eb in va){ua=ja(this,eb);var fb=ua.getAllResources(),gb=fb.filter(function(hb){var ib=this._messages.get(hb);return ib.action_type==m.LOG_MESSAGE&&ib.log_message_type==p.SERVER_ERROR;}.bind(this));ua.removeResources(gb);if(ta)na(this,eb,va[eb]);if(ra){ua.addResources(va[eb]);this._emitReorderedChange(eb,sa);}else ua.addResourcesWithoutSorting(va[eb].reverse(),0);this._threadInformer.updatedThread(eb);}this._didChange&&ga.debug('handle_updates',{localMessageCounts:ea(this._localTitanMessagesCount)});},isFirstMessage:function(qa){var ra=ja(this,qa.thread_id);if(ra.getCurrentArraySize()===0)return false;var sa=ra.getResourceAtIndex(ra.getCurrentArraySize()-1),ta=ha(this,sa).message_id,ua=ha(this,qa.message_id).message_id;return ra.hasReachedEndOfArray()&&ta==ua;},_isLocalMessage:function(qa){if(qa.offline_threading_id!==null&&qa.offline_threading_id===qa.message_id)return true;if(qa.threading_id!==null&&qa.threading_id===qa.message_id)return true;return false;},_markMessagesSpam:function(qa,ra){var sa=qa,ta=sa.thread_id,ua=sa.message_ids;if(!ua.length)return;this._deleteIndividualMessages(ta,ua,ra);this._serverRequests.markMessagesSpam(ta,ua);},_deleteMessages:function(qa,ra,sa){if(!ra.length)return;this._deleteIndividualMessages(qa,ra,sa);if(sa!==r.CLIENT_CHANNEL_MESSAGE)this._serverRequests.deleteMessages(qa,ra);},_deleteIndividualMessages:function(qa,ra,sa){var ta=ra.map(function(va){return ha(this,va).message_id;},this),ua=ja(this,qa);ua.removeResources(ta);this._emitReorderedChange(qa,sa);},_updateLocalMessage:function(qa){var ra=ha(this,qa.client_message_id),sa={};sa.status=qa.status;if(qa.status===l.SUCCESS||qa.error_data)sa.error_data=qa.error_data;var ta=qa.message_id,ua=qa.client_message_id;if(this._messages.has(ta)){this._updateMessage(ta,ra,sa);return false;}if(qa.threading_id)sa.threading_id=qa.threading_id;if(qa.timestamp)sa.timestamp=qa.timestamp;if(qa.log_message_data)sa.log_message_data=qa.log_message_data;if(qa.ranges&&qa.ranges.length){pa(qa);sa.ranges=qa.ranges;}if(qa.attachments&&qa.attachments.length){sa.raw_attachments=null;sa.attachments=qa.attachments;}this._localIdsMap[ua]=ta;u.addServerID(ua,ta);var va=this._updateMessage(ta,ra,sa);this._messages.set(ua,new i());if(oa(va))this._localTitanMessagesCount[va.thread_id]--;return true;},getNumberLocalMessages:function(qa){return this._localTitanMessagesCount[qa]||0;},_uploadMessages:{},_confirmAttachmentPlaceholder:function(qa,ra){var sa=this._popPendingAttachmentMessage(qa,ra);this._serverRequests.sendNewMessage(sa);},_cancelAttachmentPlaceholder:function(qa,ra){var sa=this._popPendingAttachmentMessage(qa,ra);this._deleteIndividualMessages(sa.thread_id,[sa.message_id]);if(this._localTitanMessagesCount[sa.thread_id])this._localTitanMessagesCount[sa.thread_id]--;},_popPendingAttachmentMessage:function(qa,ra){var sa=this._uploadMessages[qa];ca(sa);sa.image_ids=ra.image_ids;sa.file_ids=ra.file_ids;sa.audio_ids=ra.audio_ids;sa.gif_ids=ra.gif_ids;sa.client_state=q.SEND_TO_SERVER;delete this._uploadMessages[qa];return sa;},_emitUpdatedChange:function(qa,ra,sa){this._didChange=true;this._threadInformer.updatedMessage(qa,ra,sa);},_emitReceivedChange:function(qa){this._didChange=true;this._threadInformer.receivedMessage(qa);},_emitReorderedChange:function(qa,ra){this._didChange=true;this._threadInformer.reorderedMessages(qa,ra);}});Object.assign(la,s,{addListener:function(qa,ra){return fa.addListener(qa,ra);}});function ma(qa,ra){var sa=ra.map(ha.bind(null,qa));return sa.reverse();}function na(qa,ra,sa){var ta=sa.filter(function(ua){return oa(ha(qa,ua));});if(!qa._localTitanMessagesCount[ra])qa._localTitanMessagesCount[ra]=0;qa._localTitanMessagesCount[ra]+=ta.length;}function oa(qa){var ra=qa.action_type;if(ra==m.USER_GENERATED_MESSAGE)return true;switch(qa.log_message_type){case p.SUBSCRIBE:case p.UNSUBSCRIBE:case p.SERVER_ERROR:case p.LIVE_LISTEN:return false;default:return true;}}function pa(qa){if(!qa.ranges)return;qa.ranges.forEach(function(ra){if(!ra.entity||ra.entity.external||!ra.entity.url)return;var sa=new ba(ra.entity.url);if(da(ba.getRequestURI())&&!sa.getDomain()){sa.setProtocol('https').setDomain('www.facebook.com');ra.entity.url=sa.toString();}});}e.exports=la;},null);
__d("MercuryViewer",["CurrentUser","MercuryAssert"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i='fbid:'+g.getID(),j={getID:function(){return i;},isViewer:function(k){h.isParticipantID(k);return k===i;}};e.exports=j;},null);
__d("MercuryChannelHandler",["Arbiter","ChannelConstants","MercuryActionType","MercuryDelayedDispatcher","MercuryGlobalActionType","MercuryMessages","MercuryPayloadSource","MercuryServerPayloadPreprocessor","MercurySingletonMixin","MercuryThreadInformer","MercuryViewer","MessagingEvent","MessagingReliabilityLogger","MessagingTag","PresenceUtil","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=v(o);for(var x in w)if(w.hasOwnProperty(x))z[x]=w[x];var y=w===null?null:w.prototype;z.prototype=Object.create(y);z.prototype.constructor=z;z.__superConstructor__=w;function z(aa){"use strict";w.call(this);this.$MercuryChannelHandler0=aa;this.__payloadPreprocessor=n.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler1=p.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler2=l.getForFBID(this.$MercuryChannelHandler0);this.__delayedDispatcher=j.getForFBID(this.$MercuryChannelHandler0);this.$MercuryChannelHandler3=[];}z.prototype.getInstanceFBID=function(){"use strict";return this.$MercuryChannelHandler0;};z.prototype.$MercuryChannelHandler4=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!ba.obj.message){s.addEntry('channel_receive','invalid_data');return;}var ca=ba.obj.message,da=ca.other_user_fbid?ca.other_user_fbid:ca.thread_fbid,ea={author:ca.mercury_author_id,author_email:ca.mercury_author_email,body:ca.body,subject:ca.subject,has_attachment:ca.has_attachment,attachments:ca.attachments,html_body:ca.html_body,thread_id:ca.tid,thread_fbid:ca.thread_fbid,other_user_fbid:ca.other_user_fbid,offline_threading_id:ca.offline_threading_id,message_id:ca.mid,is_spoof_warning:ca.is_spoof_warning,ranges:ca.ranges,source:ca.mercury_source,source_tags:ca.mercury_source_tags,threading_id:ca.threading_id,timestamp:ca.timestamp,timestamp_absolute:ca.timestamp_absolute,timestamp_relative:ca.timestamp_relative,timestamp_time_passed:ca.timestamp_time_passed,action_type:i.USER_GENERATED_MESSAGE,is_unread:ca.is_unread,is_forward:false,forward_count:ca.forward_count||ca.forward,forward_message_ids:ca.forward_msg_ids,folder:ba.obj.folder};if("sync_id" in ca){ea.sync_id=ca.sync_id;}else ea.action_id=ca.action_id;var fa=[Object.assign({},ea)];fa=fa.concat(ca.forward_actions||[]);var ga=m.CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:fa,payload_source:ga},da);if(!ca.is_unread&&q.isViewer(ca.mercury_author_id)){var ha={};ha[da]=ba.obj.folder;this.$MercuryChannelHandler6(this.__getMessagingPayloadType(),{obj:{event:r.READ,thread_fbids:ca.thread_fbid?[ca.thread_fbid]:[],other_user_fbids:ca.other_user_fbid?[ca.other_user_fbid]:[],folder_info:ha,timestamp:ca.timestamp}});}s.addEntry('channel_receive','success',[da,ea.message_id,u.getSessionID()]);};z.prototype.$MercuryChannelHandler7=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.other_user_fbid&&!ba.obj.thread_fbid))return;this.__payloadPreprocessor.handleUpdate({delivery_receipts:[{other_user_fbid:ba.obj.other_user_fbid||'',thread_fbid:ba.obj.thread_fbid||'',time:ba.obj.timestamp}]});};z.prototype.$MercuryChannelHandler6=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=[],da=ba.obj.event==r.READ;(ba.obj.thread_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,thread_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});(ba.obj.other_user_fbids||[]).forEach(function(ea){ca.push({action_type:i.CHANGE_READ_STATUS,action_id:null,other_user_fbid:ea,mark_as_read:da,timestamp:ba.obj.timestamp||0,folder:ba.obj.folder_info[ea]});});this.__payloadPreprocessor.handleUpdate({actions:ca,payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler8=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!(ba.obj.thread_fbids||ba.obj.other_user_fbids))return;var ca=[];(ba.obj.thread_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,thread_fbid:da});});(ba.obj.other_user_fbids||[]).forEach(function(da){ca.push({action_type:i.DELETE_THREAD,action_id:null,other_user_fbid:da});});this.__payloadPreprocessor.handleUpdate({actions:ca,payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandler9=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids)||!ba.obj.mids)return;var ca=ba.obj.thread_fbids.length?ba.obj.thread_fbids[0]:null,da=ba.obj.other_user_fbids.length?ba.obj.other_user_fbids[0]:null,ea={action_type:i.DELETE_MESSAGES,action_id:null,thread_fbid:ca,other_user_fbid:da,message_ids:ba.obj.mids};this.__payloadPreprocessor.handleUpdate({actions:[ea],threads:[ba.obj.updated_thread],payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandlera=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||!ba.obj.folder)return;var ca={action_type:k.MARK_ALL_READ,action_id:ba.obj.action_id,folder:ba.obj.folder};this.__payloadPreprocessor.handleUpdate({global_actions:[ca]});};z.prototype.$MercuryChannelHandlerb=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=m.CLIENT_CHANNEL_MESSAGE;(ba.obj.thread_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:da,other_user_fbid:null,archived:ba.obj.state};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[Object.assign({},ea)],payload_source:ca},da);},this);(ba.obj.other_user_fbids||[]).forEach(function(da){var ea={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:null,other_user_fbid:da,archived:ba.obj.state};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[Object.assign({},ea)],payload_source:ca},da);},this);};z.prototype.$MercuryChannelHandlerc=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||(!ba.obj.thread_fbids&&!ba.obj.other_user_fbids))return;var ca=m.CLIENT_CHANNEL_MESSAGE,da;(ba.obj.thread_fbids||[]).forEach(function(ea){if(ba.obj.event==r.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?t.SPAM:t.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,thread_fbid:ea,other_user_fbid:null,new_folder:da};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[Object.assign({},fa)],payload_source:ca},ea);},this);(ba.obj.other_user_fbids||[]).forEach(function(ea){if(ba.obj.event==r.TAG){da=ba.obj.tag;}else da=ba.obj.marked_as_spam?t.SPAM:t.INBOX;var fa={action_type:i.CHANGE_FOLDER,action_id:null,other_user_fbid:ea,thread_fbid:null,new_folder:da};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[Object.assign({},fa)],payload_source:ca},ea);},this);};z.prototype.$MercuryChannelHandlerd=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj.tag)return;switch(ba.obj.tag){case t.ACTION_ARCHIVED:this.$MercuryChannelHandlerb(aa,ba);break;case t.INBOX:case t.OTHER:this.$MercuryChannelHandlerc(aa,ba);break;}};z.prototype.__markAsSeen=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlere(aa)||!ba.obj||!ba.obj.seen_timestamp)return;this.__payloadPreprocessor.handleUpdate({message_counts:[{seen_timestamp:ba.obj.seen_timestamp,folder:t.INBOX}],unseen_thread_fbids:[{thread_fbids:[],other_user_fbids:[],folder:t.INBOX}],payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.__updateModelsFromMercuryPayload=function(aa,ba){"use strict";if(!this.$MercuryChannelHandlerf(aa)||!ba.obj)return;this.$MercuryChannelHandler1.synchronizeInforms(function(){var ca=ba.obj,da=[];(ca.actions||[]).forEach(function(ea){var fa=i.USER_GENERATED_MESSAGE;if(ea.action_type==i.LOG_MESSAGE){var ga=m.CLIENT_CHANNEL_MESSAGE,ha;ha=ea.other_user_fbid||ea.thread_fbid;this.__delayedDispatcher.handleUpdateWaitForThread({actions:[Object.assign({},ea)],payload_source:ga},ha);}else if(ea.action_type!=fa)da.push(ea);},this);ca.actions=da;ca.payload_source=m.CLIENT_CHANNEL_MESSAGE;this.__payloadPreprocessor.handleUpdate(ca);}.bind(this));};z.prototype.$MercuryChannelHandlerg=function(aa,ba){"use strict";var ca,da,ea=ba.obj.time,fa=ba.obj.reader,ga=ba.obj.thread_fbid||'';this.__payloadPreprocessor.handleUpdate({roger:(ca={},ca[ga]=(da={},da[fa]=ea,da),ca)});};z.prototype.$MercuryChannelHandlerh=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||ba.obj.is_message_blocked===(void 0)||!ba.obj.thread_fbid)return;var ca=i.UPDATE_BLOCKER_STATUS,da=[{action_type:ca,action_id:null,thread_fbid:ba.obj.thread_fbid,is_message_blocked:ba.obj.is_message_blocked}];this.__payloadPreprocessor.handleUpdate({actions:da,payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandleri=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||ba.obj.got_blocked===(void 0)||!ba.obj.thread_fbid)return;var ca=i.UPDATE_BLOCKEE_STATUS,da=[{action_type:ca,action_id:null,thread_fbid:ba.obj.thread_fbid,got_blocked:ba.obj.got_blocked}];this.__payloadPreprocessor.handleUpdate({actions:da,payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.$MercuryChannelHandlerj=function(aa,ba){"use strict";if(!this.$MercuryChannelHandler5(aa)||!ba.obj||ba.obj.mute_settings===(void 0)||(!ba.obj.thread_fbid&&!ba.obj.other_user_fbid))return;var ca=i.CHANGE_MUTE_SETTINGS,da=[{action_type:ca,action_id:null,thread_fbid:ba.obj.thread_fbid,other_user_fbid:ba.obj.other_user_fbid,mute_settings:ba.obj.mute_settings}];this.__payloadPreprocessor.handleUpdate({actions:da,payload_source:m.CLIENT_CHANNEL_MESSAGE});};z.prototype.__handleMessagingPayload=function(aa,ba){"use strict";switch(ba.obj.event){case r.DELIVER:this.$MercuryChannelHandler4(aa,ba);break;case r.DELIVERY_RECEIPT:this.$MercuryChannelHandler7(aa,ba);break;case r.READ:case r.UNREAD:this.$MercuryChannelHandler6(aa,ba);break;case r.READ_ALL:this.$MercuryChannelHandlera(aa,ba);break;case r.DELETE:this.$MercuryChannelHandler8(aa,ba);break;case r.DELETE_MESSAGES:this.$MercuryChannelHandler9(aa,ba);break;case r.TAG:this.$MercuryChannelHandlerd(aa,ba);break;case r.REPORT_SPAM:this.$MercuryChannelHandlerc(aa,ba);break;case r.READ_RECEIPT:this.$MercuryChannelHandlerg(aa,ba);break;case r.CHANGE_MUTE_SETTINGS:this.$MercuryChannelHandlerj(aa,ba);break;case r.UPDATE_BLOCKER_STATUS:this.$MercuryChannelHandlerh(aa,ba);break;case r.UPDATE_BLOCKEE_STATUS:this.$MercuryChannelHandleri(aa,ba);break;}};z.prototype.getRouting=function(){"use strict";return {mercury:this.__updateModelsFromMercuryPayload,messaging:this.__handleMessagingPayload,inbox:this.__markAsSeen};};z.prototype.__getMessagingPayloadType=function(){"use strict";return h.getArbiterType('messaging');};z.prototype.__getMercuryPayloadType=function(){"use strict";return h.getArbiterType('mercury');};z.prototype.__getInboxPayloadType=function(){"use strict";return h.getArbiterType('inbox');};z.prototype.$MercuryChannelHandler5=function(aa){"use strict";return (aa==this.__getMessagingPayloadType());};z.prototype.$MercuryChannelHandlerf=function(aa){"use strict";return (aa==this.__getMercuryPayloadType());};z.prototype.$MercuryChannelHandlere=function(aa){"use strict";return (aa==this.__getInboxPayloadType());};z.prototype.turnOn=function(){"use strict";if(!this.$MercuryChannelHandler3.length){var aa=this.getRouting();for(var ba in aa)this.$MercuryChannelHandler3.push(g.subscribe(h.getArbiterType(ba),aa[ba].bind(this)));}return this;};z.prototype.turnOff=function(){"use strict";if(this.$MercuryChannelHandler3.length){this.$MercuryChannelHandler3.forEach(g.unsubscribe);this.$MercuryChannelHandler3=[];}return this;};Object.assign(z,o);e.exports=z;},null);
__d("SoundPlayer",["Arbiter","Flash","URI","createArrayFromMixed"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k={},l=null,m=false,n='so_sound_player',o='/swf/SoundPlayer.swf?v=1',p=null;function q(y){var z=new i(y);if(!z.getDomain())return new i(window.location.href).setPath(z.getPath()).toString();return y;}function r(y){var z=new i(y).getPath();if(/\.mp3$/.test(z))return 'audio/mpeg';if(/\.og[ga]$/.test(z))return 'audio/ogg';return '';}function s(){if(!p){var y=document.createElement('audio');if(!y||!y.canPlayType)return null;y.setAttribute('preload','auto');document.body.appendChild(y);p=y;}return p;}function t(){var y=document[n]||window[n];if(y)if(!y.playSound&&y.length)y=y[0];return (y&&y.playSound&&y.loopSound)?y:null;}function u(){return m;}function v(y,z,aa){l={path:y,sync:z,loop:aa};}function w(){m=true;if(l){var y=t();if(l.loop){y.loopSound(l.path,l.sync);}else y.playSound(l.path,l.sync);}}var x={init:function(y){y=j(y);var z;for(var aa=0;aa<y.length;++aa){z=y[aa];if(k[z])return;}var ba=s();for(aa=0;ba&&aa<y.length;++aa){z=y[aa];if(ba.canPlayType(z)){k[z]=true;return;}}k['audio/mpeg']=true;if(t())return;try{g.registerCallback(w,['sound/player_ready','sound/ready']);var da=document.createElement('div');da.id='sound_player_holder';document.body.appendChild(da);var ea=window[n]=h.embed(o,da,{allowscriptaccess:'always',wmode:'transparent'},{swf_id:n});ea.setAttribute('id',n);ea.setAttribute('width','1px');ea.setAttribute('height','1px');g.inform('sound/player_ready');}catch(ca){}},play:function(y,z){y=j(y);var aa=s(),ba,ca;for(var da=0;aa&&da<y.length;++da){ba=y[da];ca=r(ba);if(!aa.canPlayType(ca))continue;x.init([ca]);aa.src=q(ba);if(z){aa.setAttribute('loop','');}else aa.removeAttribute('loop');aa.play();return;}for(da=0;da<y.length;++da){ba=q(y[da]);ca=r(ba);if(ca!='audio/mpeg')continue;x.init([ca]);var ea=t();if(!u()){v(ba,true,z);return;}else if(ea){if(z){ea.loopSound(ba,true);}else ea.playSound(ba,true);return;}}},stop:function(y){y=j(y);for(var z=0;z<y.length;++z){var aa=q(y[z]),ba=s(),ca=t();if(ba&&ba.src==aa){ba.pause();ba.removeAttribute('src');}else ca&&ca.stopSound(aa);}}};e.exports=x;},null);
__d("SoundSynchronizer",["SoundPlayer","WebStorage","createArrayFromMixed"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j='fb_sounds_playing3';function k(){var o=h.getLocalStorage();if(o)try{var q=o[j];if(q){q=JSON.parse(q);if(Array.isArray(q))return q;}}catch(p){}return [];}function l(o){var p=h.getLocalStorage();if(p){var q=k();q.push(o);while(q.length>5)q.shift();try{p[j]=JSON.stringify(q);}catch(r){}}}function m(o){return k().some(function(p){return p===o;});}var n={play:function(o,p,q){o=i(o);p=p||(o[0]+Math.floor(Date.now()/1000));if(m(p))return;g.play(o,q);l(p);},isSupported:function(){return !!h.getLocalStorage();}};e.exports=n;},null);
__d("SoundRPC",["Event","SoundSynchronizer"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(k,l,m){h.play(k,l,m);}var j={playLocal:i,playRemote:function(k,l,m,n){var o={paths:l,sync:m,loop:n};k.postMessage(JSON.stringify(o),'*');},supportsRPC:function(){return !!window.postMessage;},_listen:function(){g.listen(window,'message',function(k){if(!/\.facebook.com$/.test(k.origin))return;var l=JSON.parse(k.data||'{}');i(l.paths,l.sync,l.loop);});}};e.exports=j;},null);